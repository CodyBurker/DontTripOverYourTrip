Enumerate all tuner configurations done.
2022-11-28 21:17:35,783 P44832 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "64",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_001_e00588ac",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:17:35,785 P44832 INFO Set up feature encoder...
2022-11-28 21:17:35,786 P44832 INFO Reading file: ../data/train.csv
2022-11-28 21:17:37,572 P44832 INFO Reading file: ../data/valid.csv
2022-11-28 21:17:38,030 P44832 INFO Preprocess feature columns...
2022-11-28 21:17:38,165 P44832 INFO Fit feature encoder...
2022-11-28 21:17:38,166 P44832 INFO Processing column: {'active': True, 'dtype': 'str', 'name': 'user_id', 'type': 'categorical'}
2022-11-28 21:17:38,850 P44832 INFO Processing column: {'active': True, 'dtype': 'str', 'name': 'business_id', 'type': 'categorical'}
2022-11-28 21:17:38,931 P44832 INFO Processing column: {'active': True, 'dtype': 'str', 'name': 'bucketed_sentiment_scores_received', 'type': 'categorical'}
2022-11-28 21:17:38,977 P44832 INFO Processing column: {'active': True, 'dtype': 'str', 'name': 'postal_code', 'type': 'categorical'}
2022-11-28 21:17:39,024 P44832 INFO Processing column: {'active': True, 'dtype': 'float', 'name': 'average_stars', 'type': 'numeric'}
2022-11-28 21:17:39,024 P44832 INFO Processing column: {'active': True, 'dtype': 'float', 'name': 'philly_reviews', 'type': 'numeric'}
2022-11-28 21:17:39,024 P44832 INFO Processing column: {'active': True, 'dtype': 'float', 'name': 'philly_share_of_reviews', 'type': 'numeric'}
2022-11-28 21:17:39,025 P44832 INFO Processing column: {'active': True, 'dtype': 'float', 'name': 'gender_score', 'type': 'numeric'}
2022-11-28 21:17:39,025 P44832 INFO Processing column: {'active': True, 'dtype': 'float', 'name': 'business_stars', 'type': 'numeric'}
2022-11-28 21:17:39,025 P44832 INFO Processing column: {'active': True, 'dtype': 'float', 'name': 'business_review_count', 'type': 'numeric'}
2022-11-28 21:17:39,025 P44832 INFO Processing column: {'active': True, 'dtype': 'float', 'name': 'CE_postal_code', 'type': 'numeric'}
2022-11-28 21:17:39,025 P44832 INFO Processing column: {'active': True, 'dtype': 'float', 'name': 'CE_bucketed_sentiment_scores_received', 'type': 'numeric'}
2022-11-28 21:17:39,025 P44832 INFO Set feature index...
2022-11-28 21:17:39,025 P44832 INFO Pickle feature_encoder: ../data/yelp_count_encoding_b2d46040/feature_encoder.pkl
2022-11-28 21:17:39,185 P44832 INFO Save feature_map to json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:17:39,193 P44832 INFO Set feature encoder done.
2022-11-28 21:17:39,193 P44832 INFO Transform feature columns...
2022-11-28 21:17:41,327 P44832 INFO Saving data to h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:17:41,707 P44832 INFO Preprocess feature columns...
2022-11-28 21:17:41,741 P44832 INFO Transform feature columns...
2022-11-28 21:17:42,258 P44832 INFO Saving data to h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:17:42,425 P44832 INFO Transform csv data to h5 done.
2022-11-28 21:17:42,425 P44832 INFO Loading data...
2022-11-28 21:17:42,430 P44832 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:17:42,729 P44832 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:17:42,817 P44832 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:17:42,817 P44832 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:17:42,817 P44832 INFO Loading train data done.
2022-11-28 21:17:45,486 P44832 INFO Total number of parameters: 15268036.
2022-11-28 21:17:45,486 P44832 INFO Start training: 666 batches/epoch
2022-11-28 21:17:45,486 P44832 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:17:45.773 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:44832 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:17:45.805 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:44832 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<11:55,  1.08s/it]  1%|          | 7/666 [00:01<01:27,  7.51it/s]  2%|▏         | 14/666 [00:01<00:41, 15.80it/s]  3%|▎         | 21/666 [00:01<00:26, 24.11it/s]  4%|▍         | 28/666 [00:01<00:19, 32.24it/s]  5%|▌         | 35/666 [00:01<00:15, 39.67it/s]  6%|▋         | 42/666 [00:01<00:13, 46.16it/s]  7%|▋         | 49/666 [00:01<00:11, 51.50it/s]  8%|▊         | 56/666 [00:01<00:10, 55.70it/s]  9%|▉         | 63/666 [00:02<00:10, 58.93it/s] 11%|█         | 70/666 [00:02<00:09, 61.34it/s] 12%|█▏        | 77/666 [00:02<00:09, 63.15it/s] 13%|█▎        | 84/666 [00:02<00:09, 64.46it/s] 14%|█▎        | 91/666 [00:02<00:08, 65.35it/s] 15%|█▍        | 98/666 [00:02<00:08, 66.03it/s] 16%|█▌        | 105/666 [00:02<00:08, 66.49it/s] 17%|█▋        | 112/666 [00:02<00:08, 66.85it/s] 18%|█▊        | 119/666 [00:02<00:08, 67.09it/s] 19%|█▉        | 126/666 [00:02<00:08, 67.27it/s] 20%|█▉        | 133/666 [00:03<00:07, 67.36it/s] 21%|██        | 140/666 [00:03<00:07, 67.48it/s] 22%|██▏       | 147/666 [00:03<00:07, 67.54it/s] 23%|██▎       | 154/666 [00:03<00:07, 67.57it/s] 24%|██▍       | 161/666 [00:03<00:07, 67.61it/s] 25%|██▌       | 168/666 [00:03<00:07, 67.61it/s] 26%|██▋       | 175/666 [00:03<00:07, 67.61it/s] 27%|██▋       | 182/666 [00:03<00:07, 67.66it/s] 28%|██▊       | 189/666 [00:03<00:07, 67.63it/s] 29%|██▉       | 196/666 [00:04<00:06, 67.59it/s] 30%|███       | 203/666 [00:04<00:06, 67.59it/s] 32%|███▏      | 210/666 [00:04<00:06, 67.62it/s] 33%|███▎      | 217/666 [00:04<00:06, 67.63it/s] 34%|███▎      | 224/666 [00:04<00:06, 67.66it/s] 35%|███▍      | 231/666 [00:04<00:06, 67.66it/s] 36%|███▌      | 238/666 [00:04<00:06, 67.65it/s] 37%|███▋      | 245/666 [00:04<00:06, 67.64it/s] 38%|███▊      | 252/666 [00:04<00:06, 67.67it/s] 39%|███▉      | 259/666 [00:04<00:06, 67.66it/s] 40%|███▉      | 266/666 [00:05<00:05, 67.67it/s] 41%|████      | 273/666 [00:05<00:05, 67.64it/s] 42%|████▏     | 280/666 [00:05<00:05, 67.63it/s] 43%|████▎     | 287/666 [00:05<00:05, 67.62it/s] 44%|████▍     | 294/666 [00:05<00:05, 67.64it/s] 45%|████▌     | 301/666 [00:05<00:05, 67.65it/s] 46%|████▌     | 308/666 [00:05<00:05, 67.67it/s] 47%|████▋     | 315/666 [00:05<00:05, 67.64it/s] 48%|████▊     | 322/666 [00:05<00:05, 67.63it/s] 49%|████▉     | 329/666 [00:05<00:04, 67.66it/s] 50%|█████     | 336/666 [00:06<00:04, 67.66it/s] 52%|█████▏    | 343/666 [00:06<00:04, 67.66it/s] 53%|█████▎    | 350/666 [00:06<00:04, 67.67it/s] 54%|█████▎    | 357/666 [00:06<00:04, 67.69it/s] 55%|█████▍    | 364/666 [00:06<00:04, 67.68it/s] 56%|█████▌    | 371/666 [00:06<00:04, 67.69it/s] 57%|█████▋    | 378/666 [00:06<00:04, 67.68it/s] 58%|█████▊    | 385/666 [00:06<00:04, 67.66it/s] 59%|█████▉    | 392/666 [00:06<00:04, 67.68it/s] 60%|█████▉    | 399/666 [00:07<00:03, 67.66it/s] 61%|██████    | 406/666 [00:07<00:03, 67.65it/s] 62%|██████▏   | 413/666 [00:07<00:03, 67.66it/s] 63%|██████▎   | 420/666 [00:07<00:03, 67.66it/s] 64%|██████▍   | 427/666 [00:07<00:03, 67.66it/s] 65%|██████▌   | 434/666 [00:07<00:03, 67.62it/s] 66%|██████▌   | 441/666 [00:07<00:03, 67.61it/s] 67%|██████▋   | 448/666 [00:07<00:03, 67.60it/s] 68%|██████▊   | 455/666 [00:07<00:03, 67.63it/s] 69%|██████▉   | 462/666 [00:07<00:03, 67.63it/s] 70%|███████   | 469/666 [00:08<00:02, 67.64it/s] 71%|███████▏  | 476/666 [00:08<00:02, 67.62it/s] 73%|███████▎  | 483/666 [00:08<00:02, 67.61it/s] 74%|███████▎  | 490/666 [00:08<00:02, 67.60it/s] 75%|███████▍  | 497/666 [00:08<00:02, 67.60it/s] 76%|███████▌  | 504/666 [00:08<00:02, 67.61it/s] 77%|███████▋  | 511/666 [00:08<00:02, 67.58it/s] 78%|███████▊  | 518/666 [00:08<00:02, 67.61it/s] 79%|███████▉  | 525/666 [00:08<00:02, 67.64it/s] 80%|███████▉  | 532/666 [00:09<00:02, 66.49it/s] 81%|████████  | 539/666 [00:09<00:01, 66.30it/s] 82%|████████▏ | 546/666 [00:09<00:01, 66.68it/s] 83%|████████▎ | 553/666 [00:09<00:01, 66.99it/s] 84%|████████▍ | 560/666 [00:09<00:01, 67.19it/s] 85%|████████▌ | 567/666 [00:09<00:01, 67.39it/s] 86%|████████▌ | 574/666 [00:09<00:01, 67.45it/s] 87%|████████▋ | 581/666 [00:09<00:01, 67.55it/s] 88%|████████▊ | 588/666 [00:09<00:01, 67.62it/s] 89%|████████▉ | 595/666 [00:09<00:01, 67.69it/s] 90%|█████████ | 602/666 [00:10<00:00, 67.73it/s] 91%|█████████▏| 609/666 [00:10<00:00, 67.77it/s] 92%|█████████▏| 616/666 [00:10<00:00, 67.79it/s] 94%|█████████▎| 623/666 [00:10<00:00, 67.79it/s] 95%|█████████▍| 630/666 [00:10<00:00, 67.85it/s] 96%|█████████▌| 637/666 [00:10<00:00, 67.81it/s] 97%|█████████▋| 644/666 [00:10<00:00, 67.82it/s] 98%|█████████▊| 651/666 [00:10<00:00, 67.87it/s] 99%|█████████▉| 658/666 [00:10<00:00, 67.87it/s]100%|█████████▉| 665/666 [00:10<00:00, 66.79it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.53it/s][A
  5%|▍         | 8/167 [00:00<00:05, 31.43it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 104.31it/s][A
 32%|███▏      | 54/167 [00:00<00:00, 147.43it/s][A
 46%|████▌     | 77/167 [00:00<00:00, 173.96it/s][A
 60%|█████▉    | 100/167 [00:00<00:00, 191.33it/s][A
 74%|███████▎  | 123/167 [00:00<00:00, 203.41it/s][A
 87%|████████▋ | 146/167 [00:00<00:00, 211.57it/s][A100%|██████████| 167/167 [00:01<00:00, 164.41it/s]
2022-11-28 21:17:57,609 P44832 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:17:57,609 P44832 INFO Save best model: monitor(max): -4.497089
2022-11-28 21:17:57,966 P44832 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:12<00:00, 53.22it/s]
2022-11-28 21:17:58,003 P44832 INFO Train loss: 30.976341
2022-11-28 21:17:58,003 P44832 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:52,  5.89it/s]  1%|          | 7/666 [00:00<00:24, 27.13it/s]  2%|▏         | 14/666 [00:00<00:15, 41.65it/s]  3%|▎         | 21/666 [00:00<00:12, 50.57it/s]  4%|▍         | 28/666 [00:00<00:11, 56.16it/s]  5%|▌         | 35/666 [00:00<00:10, 59.80it/s]  6%|▋         | 42/666 [00:00<00:10, 62.26it/s]  7%|▋         | 49/666 [00:00<00:09, 63.89it/s]  8%|▊         | 56/666 [00:01<00:09, 64.95it/s]  9%|▉         | 63/666 [00:01<00:09, 65.76it/s] 11%|█         | 70/666 [00:01<00:08, 66.32it/s] 12%|█▏        | 77/666 [00:01<00:08, 66.69it/s] 13%|█▎        | 84/666 [00:01<00:08, 66.92it/s] 14%|█▎        | 91/666 [00:01<00:08, 67.14it/s] 15%|█▍        | 98/666 [00:01<00:08, 67.27it/s] 16%|█▌        | 105/666 [00:01<00:08, 67.34it/s] 17%|█▋        | 112/666 [00:01<00:08, 67.41it/s] 18%|█▊        | 119/666 [00:01<00:08, 67.46it/s] 19%|█▉        | 126/666 [00:02<00:08, 67.50it/s] 20%|█▉        | 133/666 [00:02<00:07, 67.54it/s] 21%|██        | 140/666 [00:02<00:07, 67.52it/s] 22%|██▏       | 147/666 [00:02<00:07, 67.55it/s] 23%|██▎       | 154/666 [00:02<00:07, 67.56it/s] 24%|██▍       | 161/666 [00:02<00:07, 67.59it/s] 25%|██▌       | 168/666 [00:02<00:07, 67.61it/s] 26%|██▋       | 175/666 [00:02<00:07, 67.60it/s] 27%|██▋       | 182/666 [00:02<00:07, 67.59it/s] 28%|██▊       | 189/666 [00:02<00:07, 67.59it/s] 29%|██▉       | 196/666 [00:03<00:06, 67.45it/s] 30%|███       | 203/666 [00:03<00:06, 67.47it/s] 32%|███▏      | 210/666 [00:03<00:06, 67.52it/s] 33%|███▎      | 217/666 [00:03<00:06, 66.96it/s] 34%|███▎      | 224/666 [00:03<00:06, 66.89it/s] 35%|███▍      | 231/666 [00:03<00:06, 66.96it/s] 36%|███▌      | 238/666 [00:03<00:06, 66.98it/s] 37%|███▋      | 245/666 [00:03<00:06, 66.94it/s] 38%|███▊      | 252/666 [00:03<00:06, 67.01it/s] 39%|███▉      | 259/666 [00:04<00:06, 67.06it/s] 40%|███▉      | 266/666 [00:04<00:05, 67.02it/s] 41%|████      | 273/666 [00:04<00:05, 66.98it/s] 42%|████▏     | 280/666 [00:04<00:05, 67.01it/s] 43%|████▎     | 287/666 [00:04<00:05, 67.02it/s] 44%|████▍     | 294/666 [00:04<00:05, 67.06it/s] 45%|████▌     | 301/666 [00:04<00:05, 67.08it/s] 46%|████▌     | 308/666 [00:04<00:05, 67.11it/s] 47%|████▋     | 315/666 [00:04<00:05, 67.12it/s] 48%|████▊     | 322/666 [00:04<00:05, 67.20it/s] 49%|████▉     | 329/666 [00:05<00:05, 67.19it/s] 50%|█████     | 336/666 [00:05<00:04, 67.26it/s] 52%|█████▏    | 343/666 [00:05<00:04, 67.31it/s] 53%|█████▎    | 350/666 [00:05<00:04, 67.30it/s] 54%|█████▎    | 357/666 [00:05<00:04, 67.34it/s] 55%|█████▍    | 364/666 [00:05<00:04, 67.37it/s] 56%|█████▌    | 371/666 [00:05<00:04, 67.37it/s] 57%|█████▋    | 378/666 [00:05<00:04, 67.37it/s] 58%|█████▊    | 385/666 [00:05<00:04, 67.36it/s] 59%|█████▉    | 392/666 [00:06<00:04, 67.33it/s] 60%|█████▉    | 399/666 [00:06<00:03, 67.35it/s] 61%|██████    | 406/666 [00:06<00:03, 67.37it/s] 62%|██████▏   | 413/666 [00:06<00:03, 67.34it/s] 63%|██████▎   | 420/666 [00:06<00:03, 67.36it/s] 64%|██████▍   | 427/666 [00:06<00:03, 67.38it/s] 65%|██████▌   | 434/666 [00:06<00:03, 67.36it/s] 66%|██████▌   | 441/666 [00:06<00:03, 67.39it/s] 67%|██████▋   | 448/666 [00:06<00:03, 67.40it/s] 68%|██████▊   | 455/666 [00:06<00:03, 67.37it/s] 69%|██████▉   | 462/666 [00:07<00:03, 67.38it/s] 70%|███████   | 469/666 [00:07<00:02, 67.39it/s] 71%|███████▏  | 476/666 [00:07<00:02, 67.32it/s] 73%|███████▎  | 483/666 [00:07<00:02, 67.33it/s] 74%|███████▎  | 490/666 [00:07<00:02, 67.35it/s] 75%|███████▍  | 497/666 [00:07<00:02, 67.31it/s] 76%|███████▌  | 504/666 [00:07<00:02, 67.37it/s] 77%|███████▋  | 511/666 [00:07<00:02, 67.39it/s] 78%|███████▊  | 518/666 [00:07<00:02, 67.35it/s] 79%|███████▉  | 525/666 [00:07<00:02, 67.36it/s] 80%|███████▉  | 532/666 [00:08<00:01, 67.36it/s] 81%|████████  | 539/666 [00:08<00:01, 67.31it/s] 82%|████████▏ | 546/666 [00:08<00:01, 67.29it/s] 83%|████████▎ | 553/666 [00:08<00:01, 67.34it/s] 84%|████████▍ | 560/666 [00:08<00:01, 67.32it/s] 85%|████████▌ | 567/666 [00:08<00:01, 67.38it/s] 86%|████████▌ | 574/666 [00:08<00:01, 67.41it/s] 87%|████████▋ | 581/666 [00:08<00:01, 67.36it/s] 88%|████████▊ | 588/666 [00:08<00:01, 67.33it/s] 89%|████████▉ | 595/666 [00:09<00:01, 67.34it/s] 90%|█████████ | 602/666 [00:09<00:00, 67.31it/s] 91%|█████████▏| 609/666 [00:09<00:00, 67.31it/s] 92%|█████████▏| 616/666 [00:09<00:00, 67.26it/s] 94%|█████████▎| 623/666 [00:09<00:00, 67.24it/s] 95%|█████████▍| 630/666 [00:09<00:00, 67.27it/s] 96%|█████████▌| 637/666 [00:09<00:00, 67.31it/s] 97%|█████████▋| 644/666 [00:09<00:00, 67.29it/s] 98%|█████████▊| 651/666 [00:09<00:00, 67.30it/s] 99%|█████████▉| 658/666 [00:09<00:00, 67.30it/s]100%|█████████▉| 665/666 [00:10<00:00, 66.18it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:16,  9.78it/s][A
  2%|▏         | 4/167 [00:00<00:07, 21.13it/s][A
  8%|▊         | 13/167 [00:00<00:03, 51.25it/s][A
 22%|██▏       | 37/167 [00:00<00:01, 123.35it/s][A
 37%|███▋      | 61/167 [00:00<00:00, 163.56it/s][A
 51%|█████     | 85/167 [00:00<00:00, 188.26it/s][A
 65%|██████▌   | 109/167 [00:00<00:00, 204.07it/s][A
 80%|███████▉  | 133/167 [00:00<00:00, 214.16it/s][A
 94%|█████████▍| 157/167 [00:00<00:00, 221.41it/s][A100%|██████████| 167/167 [00:00<00:00, 167.04it/s]
2022-11-28 21:18:09,210 P44832 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:18:09,211 P44832 INFO Monitor(max) STOP: -4.497089 !
2022-11-28 21:18:09,211 P44832 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:18:09,211 P44832 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:11<00:00, 59.23it/s]
2022-11-28 21:18:09,249 P44832 INFO Train loss: 30.976982
2022-11-28 21:18:09,249 P44832 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:46,  6.25it/s]  1%|          | 4/666 [00:00<00:39, 16.76it/s]  2%|▏         | 11/666 [00:00<00:17, 37.36it/s]  3%|▎         | 18/666 [00:00<00:13, 48.45it/s]  4%|▍         | 25/666 [00:00<00:11, 55.08it/s]  5%|▍         | 32/666 [00:00<00:10, 59.30it/s]  6%|▌         | 39/666 [00:00<00:10, 62.04it/s]  7%|▋         | 46/666 [00:00<00:09, 63.88it/s]  8%|▊         | 53/666 [00:00<00:09, 65.15it/s]  9%|▉         | 60/666 [00:01<00:09, 66.00it/s] 10%|█         | 67/666 [00:01<00:08, 66.58it/s] 11%|█         | 74/666 [00:01<00:08, 66.99it/s] 12%|█▏        | 81/666 [00:01<00:08, 67.24it/s] 13%|█▎        | 88/666 [00:01<00:08, 67.44it/s] 14%|█▍        | 95/666 [00:01<00:08, 67.61it/s] 15%|█▌        | 102/666 [00:01<00:08, 67.69it/s] 16%|█▋        | 109/666 [00:01<00:08, 67.81it/s] 17%|█▋        | 116/666 [00:01<00:08, 67.87it/s] 18%|█▊        | 123/666 [00:02<00:07, 67.90it/s] 20%|█▉        | 130/666 [00:02<00:07, 67.89it/s] 21%|██        | 137/666 [00:02<00:07, 67.93it/s] 22%|██▏       | 144/666 [00:02<00:07, 67.90it/s] 23%|██▎       | 151/666 [00:02<00:07, 67.90it/s] 24%|██▎       | 158/666 [00:02<00:07, 67.90it/s] 25%|██▍       | 165/666 [00:02<00:07, 67.95it/s] 26%|██▌       | 172/666 [00:02<00:07, 67.92it/s] 27%|██▋       | 179/666 [00:02<00:07, 67.93it/s] 28%|██▊       | 186/666 [00:02<00:07, 67.93it/s] 29%|██▉       | 193/666 [00:03<00:06, 67.92it/s] 30%|███       | 200/666 [00:03<00:06, 67.94it/s] 31%|███       | 207/666 [00:03<00:06, 67.84it/s] 32%|███▏      | 214/666 [00:03<00:06, 67.85it/s] 33%|███▎      | 221/666 [00:03<00:06, 67.91it/s] 34%|███▍      | 228/666 [00:03<00:06, 67.92it/s] 35%|███▌      | 235/666 [00:03<00:06, 67.90it/s] 36%|███▋      | 242/666 [00:03<00:06, 67.91it/s] 37%|███▋      | 249/666 [00:03<00:06, 67.93it/s] 38%|███▊      | 256/666 [00:03<00:06, 67.92it/s] 39%|███▉      | 263/666 [00:04<00:05, 67.95it/s] 41%|████      | 270/666 [00:04<00:05, 67.89it/s] 42%|████▏     | 277/666 [00:04<00:05, 67.91it/s] 43%|████▎     | 284/666 [00:04<00:05, 67.97it/s] 44%|████▎     | 291/666 [00:04<00:05, 67.96it/s] 45%|████▍     | 298/666 [00:04<00:05, 67.93it/s] 46%|████▌     | 305/666 [00:04<00:05, 67.96it/s] 47%|████▋     | 312/666 [00:04<00:05, 67.94it/s] 48%|████▊     | 319/666 [00:04<00:05, 67.93it/s] 49%|████▉     | 326/666 [00:05<00:05, 67.95it/s] 50%|█████     | 333/666 [00:05<00:04, 67.92it/s] 51%|█████     | 340/666 [00:05<00:04, 67.94it/s] 52%|█████▏    | 347/666 [00:05<00:04, 67.98it/s] 53%|█████▎    | 354/666 [00:05<00:04, 67.97it/s] 54%|█████▍    | 361/666 [00:05<00:04, 67.99it/s] 55%|█████▌    | 368/666 [00:05<00:04, 67.99it/s] 56%|█████▋    | 375/666 [00:05<00:04, 67.99it/s] 57%|█████▋    | 382/666 [00:05<00:04, 67.97it/s] 58%|█████▊    | 389/666 [00:05<00:04, 67.72it/s] 59%|█████▉    | 396/666 [00:06<00:03, 67.79it/s] 61%|██████    | 403/666 [00:06<00:03, 67.84it/s] 62%|██████▏   | 410/666 [00:06<00:03, 67.94it/s] 63%|██████▎   | 417/666 [00:06<00:03, 67.97it/s] 64%|██████▎   | 424/666 [00:06<00:03, 68.00it/s] 65%|██████▍   | 431/666 [00:06<00:03, 68.03it/s] 66%|██████▌   | 438/666 [00:06<00:03, 68.05it/s] 67%|██████▋   | 445/666 [00:06<00:03, 68.07it/s] 68%|██████▊   | 452/666 [00:06<00:03, 68.05it/s] 69%|██████▉   | 459/666 [00:06<00:03, 68.03it/s] 70%|██████▉   | 466/666 [00:07<00:02, 68.01it/s] 71%|███████   | 473/666 [00:07<00:02, 68.02it/s] 72%|███████▏  | 480/666 [00:07<00:02, 68.03it/s] 73%|███████▎  | 487/666 [00:07<00:02, 68.02it/s] 74%|███████▍  | 494/666 [00:07<00:02, 68.02it/s] 75%|███████▌  | 501/666 [00:07<00:02, 68.03it/s] 76%|███████▋  | 508/666 [00:07<00:02, 68.00it/s] 77%|███████▋  | 515/666 [00:07<00:02, 68.00it/s] 78%|███████▊  | 522/666 [00:07<00:02, 68.01it/s] 79%|███████▉  | 529/666 [00:08<00:02, 66.02it/s] 80%|████████  | 536/666 [00:08<00:01, 66.55it/s] 82%|████████▏ | 543/666 [00:08<00:01, 66.94it/s] 83%|████████▎ | 550/666 [00:08<00:01, 67.26it/s] 84%|████████▎ | 557/666 [00:08<00:01, 67.51it/s] 85%|████████▍ | 564/666 [00:08<00:01, 67.64it/s] 86%|████████▌ | 571/666 [00:08<00:01, 67.67it/s] 87%|████████▋ | 578/666 [00:08<00:01, 67.74it/s] 88%|████████▊ | 585/666 [00:08<00:01, 67.83it/s] 89%|████████▉ | 592/666 [00:08<00:01, 67.91it/s] 90%|████████▉ | 599/666 [00:09<00:00, 67.91it/s] 91%|█████████ | 606/666 [00:09<00:00, 67.95it/s] 92%|█████████▏| 613/666 [00:09<00:00, 67.98it/s] 93%|█████████▎| 620/666 [00:09<00:00, 68.01it/s] 94%|█████████▍| 627/666 [00:09<00:00, 68.02it/s] 95%|█████████▌| 634/666 [00:09<00:00, 68.02it/s] 96%|█████████▌| 641/666 [00:09<00:00, 68.00it/s] 97%|█████████▋| 648/666 [00:09<00:00, 68.00it/s] 98%|█████████▊| 655/666 [00:09<00:00, 68.02it/s] 99%|█████████▉| 662/666 [00:09<00:00, 66.74it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.47it/s][A
  4%|▎         | 6/167 [00:00<00:06, 24.29it/s][A
 17%|█▋        | 29/167 [00:00<00:01, 101.97it/s][A
 32%|███▏      | 53/167 [00:00<00:00, 148.87it/s][A
 46%|████▌     | 77/167 [00:00<00:00, 177.14it/s][A
 60%|██████    | 101/167 [00:00<00:00, 195.36it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 207.73it/s][A
 89%|████████▉ | 149/167 [00:00<00:00, 216.03it/s][A100%|██████████| 167/167 [00:00<00:00, 168.83it/s]
2022-11-28 21:18:20,377 P44832 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:18:20,378 P44832 INFO Monitor(max) STOP: -4.497089 !
2022-11-28 21:18:20,378 P44832 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:18:20,378 P44832 INFO Early stopping at epoch=3
2022-11-28 21:18:20,378 P44832 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:11<00:00, 59.52it/s]
2022-11-28 21:18:20,422 P44832 INFO Train loss: 30.974828
2022-11-28 21:18:20,422 P44832 INFO Training finished.
2022-11-28 21:18:20,423 P44832 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_001_e00588ac.model
2022-11-28 21:18:20,702 P44832 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:56,  5.70it/s]  1%|          | 7/666 [00:00<00:22, 29.90it/s]  5%|▍         | 30/666 [00:00<00:05, 107.32it/s]  8%|▊         | 53/666 [00:00<00:04, 149.51it/s] 11%|█▏        | 76/666 [00:00<00:03, 174.62it/s] 15%|█▍        | 99/666 [00:00<00:02, 190.69it/s] 18%|█▊        | 122/666 [00:00<00:02, 201.00it/s] 22%|██▏       | 145/666 [00:00<00:02, 207.15it/s] 25%|██▌       | 168/666 [00:00<00:02, 212.06it/s] 29%|██▊       | 191/666 [00:01<00:02, 215.40it/s] 32%|███▏      | 214/666 [00:01<00:02, 217.49it/s] 36%|███▌      | 237/666 [00:01<00:01, 218.93it/s] 39%|███▉      | 260/666 [00:01<00:01, 219.96it/s] 42%|████▏     | 283/666 [00:01<00:01, 220.58it/s] 46%|████▌     | 306/666 [00:01<00:01, 220.86it/s] 49%|████▉     | 329/666 [00:01<00:01, 221.27it/s] 53%|█████▎    | 352/666 [00:01<00:01, 221.39it/s] 56%|█████▋    | 375/666 [00:01<00:01, 221.48it/s] 60%|█████▉    | 398/666 [00:02<00:01, 221.63it/s] 63%|██████▎   | 421/666 [00:02<00:01, 218.52it/s] 67%|██████▋   | 444/666 [00:02<00:01, 219.45it/s] 70%|██████▉   | 466/666 [00:02<00:00, 219.01it/s] 73%|███████▎  | 489/666 [00:02<00:00, 219.61it/s] 77%|███████▋  | 511/666 [00:02<00:00, 218.10it/s] 80%|████████  | 533/666 [00:02<00:00, 195.00it/s] 83%|████████▎ | 556/666 [00:02<00:00, 203.32it/s] 87%|████████▋ | 578/666 [00:02<00:00, 207.24it/s] 90%|█████████ | 601/666 [00:03<00:00, 211.56it/s] 94%|█████████▎| 624/666 [00:03<00:00, 214.65it/s] 97%|█████████▋| 646/666 [00:03<00:00, 214.35it/s]100%|██████████| 666/666 [00:03<00:00, 198.69it/s]
2022-11-28 21:18:24,512 P44832 INFO [Metrics] logloss: 4.992712 - AUC: 0.500001
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 2/167 [00:00<00:08, 19.47it/s]  4%|▎         | 6/167 [00:00<00:06, 23.22it/s] 17%|█▋        | 28/167 [00:00<00:01, 97.47it/s] 30%|██▉       | 50/167 [00:00<00:00, 139.98it/s] 43%|████▎     | 72/167 [00:00<00:00, 166.48it/s] 57%|█████▋    | 95/167 [00:00<00:00, 184.44it/s] 71%|███████   | 118/167 [00:00<00:00, 196.06it/s] 84%|████████▍ | 140/167 [00:00<00:00, 202.31it/s] 97%|█████████▋| 162/167 [00:00<00:00, 207.49it/s]100%|██████████| 167/167 [00:01<00:00, 161.79it/s]
2022-11-28 21:18:25,660 P44832 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:18:30,813 P46611 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "128",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_002_f409ce08",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:18:30,815 P46611 INFO Set up feature encoder...
2022-11-28 21:18:30,816 P46611 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:18:30,817 P46611 INFO Loading data...
2022-11-28 21:18:30,820 P46611 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:18:31,126 P46611 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:18:31,233 P46611 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:18:31,233 P46611 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:18:31,233 P46611 INFO Loading train data done.
2022-11-28 21:18:34,233 P46611 INFO Total number of parameters: 29989252.
2022-11-28 21:18:34,233 P46611 INFO Start training: 666 batches/epoch
2022-11-28 21:18:34,233 P46611 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:18:34.558 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:46611 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:18:34.589 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:46611 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:13,  1.10s/it]  1%|          | 6/666 [00:01<01:43,  6.41it/s]  2%|▏         | 11/666 [00:01<00:53, 12.25it/s]  2%|▏         | 15/666 [00:01<00:39, 16.60it/s]  3%|▎         | 20/666 [00:01<00:28, 22.59it/s]  4%|▍         | 25/666 [00:01<00:22, 27.99it/s]  5%|▍         | 30/666 [00:01<00:19, 32.60it/s]  5%|▌         | 35/666 [00:01<00:17, 36.33it/s]  6%|▌         | 40/666 [00:01<00:15, 39.25it/s]  7%|▋         | 45/666 [00:02<00:14, 41.47it/s]  8%|▊         | 50/666 [00:02<00:14, 43.12it/s]  8%|▊         | 55/666 [00:02<00:13, 44.29it/s]  9%|▉         | 60/666 [00:02<00:13, 45.17it/s] 10%|▉         | 65/666 [00:02<00:13, 44.53it/s] 11%|█         | 70/666 [00:02<00:13, 45.33it/s] 11%|█▏        | 75/666 [00:02<00:12, 45.91it/s] 12%|█▏        | 80/666 [00:02<00:12, 46.31it/s] 13%|█▎        | 85/666 [00:02<00:12, 46.62it/s] 14%|█▎        | 90/666 [00:03<00:12, 46.80it/s] 14%|█▍        | 95/666 [00:03<00:12, 46.96it/s] 15%|█▌        | 100/666 [00:03<00:12, 47.03it/s] 16%|█▌        | 105/666 [00:03<00:11, 47.13it/s] 17%|█▋        | 110/666 [00:03<00:11, 47.16it/s] 17%|█▋        | 115/666 [00:03<00:11, 47.21it/s] 18%|█▊        | 120/666 [00:03<00:11, 47.23it/s] 19%|█▉        | 125/666 [00:03<00:11, 47.22it/s] 20%|█▉        | 130/666 [00:03<00:11, 47.23it/s] 20%|██        | 135/666 [00:03<00:11, 47.25it/s] 21%|██        | 140/666 [00:04<00:11, 47.26it/s] 22%|██▏       | 145/666 [00:04<00:11, 47.26it/s] 23%|██▎       | 150/666 [00:04<00:10, 47.30it/s] 23%|██▎       | 155/666 [00:04<00:10, 47.28it/s] 24%|██▍       | 160/666 [00:04<00:10, 47.28it/s] 25%|██▍       | 165/666 [00:04<00:10, 47.28it/s] 26%|██▌       | 170/666 [00:04<00:10, 47.26it/s] 26%|██▋       | 175/666 [00:04<00:10, 47.28it/s] 27%|██▋       | 180/666 [00:04<00:10, 47.27it/s] 28%|██▊       | 185/666 [00:05<00:10, 47.26it/s] 29%|██▊       | 190/666 [00:05<00:10, 47.24it/s] 29%|██▉       | 195/666 [00:05<00:09, 47.24it/s] 30%|███       | 200/666 [00:05<00:09, 47.22it/s] 31%|███       | 205/666 [00:05<00:09, 47.25it/s] 32%|███▏      | 210/666 [00:05<00:09, 47.27it/s] 32%|███▏      | 215/666 [00:05<00:09, 47.26it/s] 33%|███▎      | 220/666 [00:05<00:09, 47.26it/s] 34%|███▍      | 225/666 [00:05<00:09, 47.26it/s] 35%|███▍      | 230/666 [00:05<00:09, 47.29it/s] 35%|███▌      | 235/666 [00:06<00:09, 47.27it/s] 36%|███▌      | 240/666 [00:06<00:09, 47.28it/s] 37%|███▋      | 245/666 [00:06<00:08, 47.25it/s] 38%|███▊      | 250/666 [00:06<00:08, 47.26it/s] 38%|███▊      | 255/666 [00:06<00:08, 47.27it/s] 39%|███▉      | 260/666 [00:06<00:08, 47.26it/s] 40%|███▉      | 265/666 [00:06<00:08, 47.27it/s] 41%|████      | 270/666 [00:06<00:08, 47.26it/s] 41%|████▏     | 275/666 [00:06<00:08, 47.26it/s] 42%|████▏     | 280/666 [00:07<00:08, 47.26it/s] 43%|████▎     | 285/666 [00:07<00:08, 47.28it/s] 44%|████▎     | 290/666 [00:07<00:07, 47.24it/s] 44%|████▍     | 295/666 [00:07<00:07, 47.23it/s] 45%|████▌     | 300/666 [00:07<00:07, 47.25it/s] 46%|████▌     | 305/666 [00:07<00:07, 47.25it/s] 47%|████▋     | 310/666 [00:07<00:07, 47.25it/s] 47%|████▋     | 315/666 [00:07<00:07, 47.25it/s] 48%|████▊     | 320/666 [00:07<00:07, 47.24it/s] 49%|████▉     | 325/666 [00:08<00:07, 47.23it/s] 50%|████▉     | 330/666 [00:08<00:07, 47.26it/s] 50%|█████     | 335/666 [00:08<00:07, 47.26it/s] 51%|█████     | 340/666 [00:08<00:06, 47.27it/s] 52%|█████▏    | 345/666 [00:08<00:06, 47.25it/s] 53%|█████▎    | 350/666 [00:08<00:06, 47.24it/s] 53%|█████▎    | 355/666 [00:08<00:06, 47.19it/s] 54%|█████▍    | 360/666 [00:08<00:06, 47.22it/s] 55%|█████▍    | 365/666 [00:08<00:06, 47.22it/s] 56%|█████▌    | 370/666 [00:08<00:06, 47.23it/s] 56%|█████▋    | 375/666 [00:09<00:06, 47.24it/s] 57%|█████▋    | 380/666 [00:09<00:06, 47.21it/s] 58%|█████▊    | 385/666 [00:09<00:05, 47.22it/s] 59%|█████▊    | 390/666 [00:09<00:05, 47.23it/s] 59%|█████▉    | 395/666 [00:09<00:05, 47.22it/s] 60%|██████    | 400/666 [00:09<00:05, 47.21it/s] 61%|██████    | 405/666 [00:09<00:05, 47.20it/s] 62%|██████▏   | 410/666 [00:09<00:05, 47.20it/s] 62%|██████▏   | 415/666 [00:09<00:05, 47.22it/s] 63%|██████▎   | 420/666 [00:10<00:05, 47.20it/s] 64%|██████▍   | 425/666 [00:10<00:05, 47.20it/s] 65%|██████▍   | 430/666 [00:10<00:05, 47.19it/s] 65%|██████▌   | 435/666 [00:10<00:04, 47.20it/s] 66%|██████▌   | 440/666 [00:10<00:04, 47.18it/s] 67%|██████▋   | 445/666 [00:10<00:04, 47.18it/s] 68%|██████▊   | 450/666 [00:10<00:04, 47.18it/s] 68%|██████▊   | 455/666 [00:10<00:04, 47.17it/s] 69%|██████▉   | 460/666 [00:10<00:04, 47.17it/s] 70%|██████▉   | 465/666 [00:10<00:04, 47.21it/s] 71%|███████   | 470/666 [00:11<00:04, 47.22it/s] 71%|███████▏  | 475/666 [00:11<00:04, 47.24it/s] 72%|███████▏  | 480/666 [00:11<00:03, 47.23it/s] 73%|███████▎  | 485/666 [00:11<00:03, 47.22it/s] 74%|███████▎  | 490/666 [00:11<00:03, 47.23it/s] 74%|███████▍  | 495/666 [00:11<00:03, 47.26it/s] 75%|███████▌  | 500/666 [00:11<00:03, 47.26it/s] 76%|███████▌  | 505/666 [00:11<00:03, 47.24it/s] 77%|███████▋  | 510/666 [00:11<00:03, 47.25it/s] 77%|███████▋  | 515/666 [00:12<00:03, 47.24it/s] 78%|███████▊  | 520/666 [00:12<00:03, 47.28it/s] 79%|███████▉  | 525/666 [00:12<00:02, 47.27it/s] 80%|███████▉  | 530/666 [00:12<00:02, 47.25it/s] 80%|████████  | 535/666 [00:12<00:02, 47.21it/s] 81%|████████  | 540/666 [00:12<00:02, 47.25it/s] 82%|████████▏ | 545/666 [00:12<00:02, 47.25it/s] 83%|████████▎ | 550/666 [00:12<00:02, 47.27it/s] 83%|████████▎ | 555/666 [00:12<00:02, 47.29it/s] 84%|████████▍ | 560/666 [00:12<00:02, 47.27it/s] 85%|████████▍ | 565/666 [00:13<00:02, 47.29it/s] 86%|████████▌ | 570/666 [00:13<00:02, 47.27it/s] 86%|████████▋ | 575/666 [00:13<00:01, 47.28it/s] 87%|████████▋ | 580/666 [00:13<00:01, 47.23it/s] 88%|████████▊ | 585/666 [00:13<00:01, 47.25it/s] 89%|████████▊ | 590/666 [00:13<00:01, 47.25it/s] 89%|████████▉ | 595/666 [00:13<00:01, 47.24it/s] 90%|█████████ | 600/666 [00:13<00:01, 47.26it/s] 91%|█████████ | 605/666 [00:13<00:01, 47.24it/s] 92%|█████████▏| 610/666 [00:14<00:01, 47.26it/s] 92%|█████████▏| 615/666 [00:14<00:01, 47.28it/s] 93%|█████████▎| 620/666 [00:14<00:00, 47.29it/s] 94%|█████████▍| 625/666 [00:14<00:00, 47.25it/s] 95%|█████████▍| 630/666 [00:14<00:00, 47.24it/s] 95%|█████████▌| 635/666 [00:14<00:00, 47.22it/s] 96%|█████████▌| 640/666 [00:14<00:00, 47.24it/s] 97%|█████████▋| 645/666 [00:14<00:00, 47.26it/s] 98%|█████████▊| 650/666 [00:14<00:00, 47.27it/s] 98%|█████████▊| 655/666 [00:14<00:00, 47.28it/s] 99%|█████████▉| 660/666 [00:15<00:00, 46.36it/s]100%|█████████▉| 665/666 [00:15<00:00, 46.81it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.04it/s][A
  6%|▌         | 10/167 [00:00<00:02, 52.68it/s][A
 17%|█▋        | 29/167 [00:00<00:01, 111.07it/s][A
 30%|██▉       | 50/167 [00:00<00:00, 148.42it/s][A
 43%|████▎     | 71/167 [00:00<00:00, 169.02it/s][A
 55%|█████▌    | 92/167 [00:00<00:00, 181.43it/s][A
 68%|██████▊   | 113/167 [00:00<00:00, 189.56it/s][A
 80%|████████  | 134/167 [00:00<00:00, 195.32it/s][A
 93%|█████████▎| 155/167 [00:00<00:00, 199.11it/s][A100%|██████████| 167/167 [00:01<00:00, 161.40it/s]
2022-11-28 21:18:50,612 P46611 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:18:50,613 P46611 INFO Save best model: monitor(max): -4.497234
2022-11-28 21:18:51,594 P46611 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:17<00:00, 38.29it/s]
2022-11-28 21:18:51,630 P46611 INFO Train loss: 30.972238
2022-11-28 21:18:51,630 P46611 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:59,  5.58it/s]  1%|          | 5/666 [00:00<00:31, 20.81it/s]  2%|▏         | 10/666 [00:00<00:22, 29.14it/s]  2%|▏         | 15/666 [00:00<00:18, 34.44it/s]  3%|▎         | 20/666 [00:00<00:16, 38.68it/s]  4%|▍         | 25/666 [00:00<00:15, 41.37it/s]  5%|▍         | 30/666 [00:00<00:14, 43.12it/s]  5%|▌         | 35/666 [00:00<00:14, 44.31it/s]  6%|▌         | 40/666 [00:01<00:13, 45.16it/s]  7%|▋         | 45/666 [00:01<00:13, 45.70it/s]  8%|▊         | 50/666 [00:01<00:13, 46.09it/s]  8%|▊         | 55/666 [00:01<00:13, 46.38it/s]  9%|▉         | 60/666 [00:01<00:13, 46.60it/s] 10%|▉         | 65/666 [00:01<00:12, 46.72it/s] 11%|█         | 70/666 [00:01<00:12, 46.85it/s] 11%|█▏        | 75/666 [00:01<00:12, 46.91it/s] 12%|█▏        | 80/666 [00:01<00:12, 46.93it/s] 13%|█▎        | 85/666 [00:02<00:12, 46.97it/s] 14%|█▎        | 90/666 [00:02<00:12, 46.98it/s] 14%|█▍        | 95/666 [00:02<00:12, 47.02it/s] 15%|█▌        | 100/666 [00:02<00:12, 47.03it/s] 16%|█▌        | 105/666 [00:02<00:11, 47.02it/s] 17%|█▋        | 110/666 [00:02<00:11, 46.98it/s] 17%|█▋        | 115/666 [00:02<00:11, 46.99it/s] 18%|█▊        | 120/666 [00:02<00:11, 47.01it/s] 19%|█▉        | 125/666 [00:02<00:11, 47.02it/s] 20%|█▉        | 130/666 [00:02<00:11, 47.05it/s] 20%|██        | 135/666 [00:03<00:11, 47.03it/s] 21%|██        | 140/666 [00:03<00:11, 46.99it/s] 22%|██▏       | 145/666 [00:03<00:11, 47.02it/s] 23%|██▎       | 150/666 [00:03<00:10, 47.03it/s] 23%|██▎       | 155/666 [00:03<00:10, 47.01it/s] 24%|██▍       | 160/666 [00:03<00:10, 47.06it/s] 25%|██▍       | 165/666 [00:03<00:10, 47.06it/s] 26%|██▌       | 170/666 [00:03<00:10, 47.05it/s] 26%|██▋       | 175/666 [00:03<00:10, 47.04it/s] 27%|██▋       | 180/666 [00:04<00:10, 47.04it/s] 28%|██▊       | 185/666 [00:04<00:10, 47.03it/s] 29%|██▊       | 190/666 [00:04<00:10, 47.05it/s] 29%|██▉       | 195/666 [00:04<00:10, 47.01it/s] 30%|███       | 200/666 [00:04<00:09, 47.01it/s] 31%|███       | 205/666 [00:04<00:09, 47.04it/s] 32%|███▏      | 210/666 [00:04<00:09, 47.08it/s] 32%|███▏      | 215/666 [00:04<00:09, 47.07it/s] 33%|███▎      | 220/666 [00:04<00:09, 47.10it/s] 34%|███▍      | 225/666 [00:04<00:09, 47.09it/s] 35%|███▍      | 230/666 [00:05<00:09, 47.08it/s] 35%|███▌      | 235/666 [00:05<00:09, 47.08it/s] 36%|███▌      | 240/666 [00:05<00:09, 47.05it/s] 37%|███▋      | 245/666 [00:05<00:08, 47.03it/s] 38%|███▊      | 250/666 [00:05<00:08, 47.05it/s] 38%|███▊      | 255/666 [00:05<00:08, 47.06it/s] 39%|███▉      | 260/666 [00:05<00:08, 47.01it/s] 40%|███▉      | 265/666 [00:05<00:08, 46.94it/s] 41%|████      | 270/666 [00:05<00:08, 46.94it/s] 41%|████▏     | 275/666 [00:06<00:08, 46.90it/s] 42%|████▏     | 280/666 [00:06<00:08, 46.92it/s] 43%|████▎     | 285/666 [00:06<00:08, 46.92it/s] 44%|████▎     | 290/666 [00:06<00:08, 46.95it/s] 44%|████▍     | 295/666 [00:06<00:07, 46.92it/s] 45%|████▌     | 300/666 [00:06<00:07, 46.93it/s] 46%|████▌     | 305/666 [00:06<00:07, 46.97it/s] 47%|████▋     | 310/666 [00:06<00:07, 47.00it/s] 47%|████▋     | 315/666 [00:06<00:07, 47.00it/s] 48%|████▊     | 320/666 [00:07<00:07, 47.02it/s] 49%|████▉     | 325/666 [00:07<00:07, 47.05it/s] 50%|████▉     | 330/666 [00:07<00:07, 47.02it/s] 50%|█████     | 335/666 [00:07<00:07, 47.03it/s] 51%|█████     | 340/666 [00:07<00:06, 47.05it/s] 52%|█████▏    | 345/666 [00:07<00:06, 47.05it/s] 53%|█████▎    | 350/666 [00:07<00:06, 47.03it/s] 53%|█████▎    | 355/666 [00:07<00:06, 47.07it/s] 54%|█████▍    | 360/666 [00:07<00:06, 47.05it/s] 55%|█████▍    | 365/666 [00:07<00:06, 47.03it/s] 56%|█████▌    | 370/666 [00:08<00:06, 47.06it/s] 56%|█████▋    | 375/666 [00:08<00:06, 47.04it/s] 57%|█████▋    | 380/666 [00:08<00:06, 47.05it/s] 58%|█████▊    | 385/666 [00:08<00:05, 47.05it/s] 59%|█████▊    | 390/666 [00:08<00:05, 47.07it/s] 59%|█████▉    | 395/666 [00:08<00:05, 47.08it/s] 60%|██████    | 400/666 [00:08<00:05, 47.10it/s] 61%|██████    | 405/666 [00:08<00:05, 47.10it/s] 62%|██████▏   | 410/666 [00:08<00:05, 47.05it/s] 62%|██████▏   | 415/666 [00:09<00:05, 47.10it/s] 63%|██████▎   | 420/666 [00:09<00:05, 47.06it/s] 64%|██████▍   | 425/666 [00:09<00:05, 47.04it/s] 65%|██████▍   | 430/666 [00:09<00:05, 47.07it/s] 65%|██████▌   | 435/666 [00:09<00:04, 47.10it/s] 66%|██████▌   | 440/666 [00:09<00:04, 47.08it/s] 67%|██████▋   | 445/666 [00:09<00:04, 47.10it/s] 68%|██████▊   | 450/666 [00:09<00:04, 47.10it/s] 68%|██████▊   | 455/666 [00:09<00:04, 47.07it/s] 69%|██████▉   | 460/666 [00:09<00:04, 47.10it/s] 70%|██████▉   | 465/666 [00:10<00:04, 47.07it/s] 71%|███████   | 470/666 [00:10<00:04, 47.07it/s] 71%|███████▏  | 475/666 [00:10<00:04, 47.08it/s] 72%|███████▏  | 480/666 [00:10<00:03, 47.07it/s] 73%|███████▎  | 485/666 [00:10<00:03, 47.04it/s] 74%|███████▎  | 490/666 [00:10<00:03, 47.04it/s] 74%|███████▍  | 495/666 [00:10<00:03, 47.07it/s] 75%|███████▌  | 500/666 [00:10<00:03, 47.05it/s] 76%|███████▌  | 505/666 [00:10<00:03, 47.09it/s] 77%|███████▋  | 510/666 [00:11<00:03, 47.07it/s] 77%|███████▋  | 515/666 [00:11<00:03, 47.05it/s] 78%|███████▊  | 520/666 [00:11<00:03, 47.06it/s] 79%|███████▉  | 525/666 [00:11<00:02, 47.08it/s] 80%|███████▉  | 530/666 [00:11<00:02, 47.05it/s] 80%|████████  | 535/666 [00:11<00:02, 46.93it/s] 81%|████████  | 540/666 [00:11<00:02, 46.83it/s] 82%|████████▏ | 545/666 [00:11<00:02, 47.03it/s] 83%|████████▎ | 550/666 [00:11<00:02, 47.07it/s] 83%|████████▎ | 555/666 [00:11<00:02, 47.07it/s] 84%|████████▍ | 560/666 [00:12<00:02, 47.09it/s] 85%|████████▍ | 565/666 [00:12<00:02, 47.11it/s] 86%|████████▌ | 570/666 [00:12<00:02, 47.08it/s] 86%|████████▋ | 575/666 [00:12<00:01, 47.10it/s] 87%|████████▋ | 580/666 [00:12<00:01, 47.09it/s] 88%|████████▊ | 585/666 [00:12<00:01, 47.10it/s] 89%|████████▊ | 590/666 [00:12<00:01, 47.07it/s] 89%|████████▉ | 595/666 [00:12<00:01, 47.07it/s] 90%|█████████ | 600/666 [00:12<00:01, 47.06it/s] 91%|█████████ | 605/666 [00:13<00:01, 47.05it/s] 92%|█████████▏| 610/666 [00:13<00:01, 47.07it/s] 92%|█████████▏| 615/666 [00:13<00:01, 47.05it/s] 93%|█████████▎| 620/666 [00:13<00:00, 47.07it/s] 94%|█████████▍| 625/666 [00:13<00:00, 47.06it/s] 95%|█████████▍| 630/666 [00:13<00:00, 47.09it/s] 95%|█████████▌| 635/666 [00:13<00:00, 47.08it/s] 96%|█████████▌| 640/666 [00:13<00:00, 47.10it/s] 97%|█████████▋| 645/666 [00:13<00:00, 47.09it/s] 98%|█████████▊| 650/666 [00:14<00:00, 47.07it/s] 98%|█████████▊| 655/666 [00:14<00:00, 47.09it/s] 99%|█████████▉| 660/666 [00:14<00:00, 46.33it/s]100%|█████████▉| 665/666 [00:14<00:00, 46.76it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.81it/s][A
  6%|▌         | 10/167 [00:00<00:03, 46.27it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 118.71it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 160.65it/s][A
 49%|████▊     | 81/167 [00:00<00:00, 186.07it/s][A
 63%|██████▎   | 105/167 [00:00<00:00, 202.15it/s][A
 77%|███████▋  | 129/167 [00:00<00:00, 212.61it/s][A
 92%|█████████▏| 153/167 [00:00<00:00, 219.86it/s][A100%|██████████| 167/167 [00:00<00:00, 172.72it/s]
2022-11-28 21:19:07,071 P46611 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:19:07,071 P46611 INFO Monitor(max) STOP: -4.497234 !
2022-11-28 21:19:07,071 P46611 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:19:07,072 P46611 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:15<00:00, 42.99it/s]
2022-11-28 21:19:07,122 P46611 INFO Train loss: 30.969909
2022-11-28 21:19:07,123 P46611 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:00,  5.50it/s]  1%|          | 6/666 [00:00<00:27, 24.35it/s]  2%|▏         | 10/666 [00:00<00:22, 29.62it/s]  2%|▏         | 15/666 [00:00<00:18, 35.66it/s]  3%|▎         | 20/666 [00:00<00:16, 39.68it/s]  4%|▍         | 25/666 [00:00<00:15, 42.11it/s]  5%|▍         | 30/666 [00:00<00:14, 43.75it/s]  5%|▌         | 35/666 [00:00<00:14, 44.82it/s]  6%|▌         | 40/666 [00:01<00:13, 45.57it/s]  7%|▋         | 45/666 [00:01<00:13, 46.07it/s]  8%|▊         | 50/666 [00:01<00:13, 46.43it/s]  8%|▊         | 55/666 [00:01<00:13, 46.66it/s]  9%|▉         | 60/666 [00:01<00:12, 46.83it/s] 10%|▉         | 65/666 [00:01<00:12, 46.93it/s] 11%|█         | 70/666 [00:01<00:12, 46.99it/s] 11%|█▏        | 75/666 [00:01<00:12, 47.06it/s] 12%|█▏        | 80/666 [00:01<00:12, 47.07it/s] 13%|█▎        | 85/666 [00:01<00:12, 47.13it/s] 14%|█▎        | 90/666 [00:02<00:12, 47.16it/s] 14%|█▍        | 95/666 [00:02<00:12, 47.17it/s] 15%|█▌        | 100/666 [00:02<00:11, 47.18it/s] 16%|█▌        | 105/666 [00:02<00:11, 47.21it/s] 17%|█▋        | 110/666 [00:02<00:11, 47.21it/s] 17%|█▋        | 115/666 [00:02<00:11, 47.20it/s] 18%|█▊        | 120/666 [00:02<00:11, 47.20it/s] 19%|█▉        | 125/666 [00:02<00:11, 47.21it/s] 20%|█▉        | 130/666 [00:02<00:11, 47.19it/s] 20%|██        | 135/666 [00:03<00:11, 47.20it/s] 21%|██        | 140/666 [00:03<00:11, 47.19it/s] 22%|██▏       | 145/666 [00:03<00:11, 47.18it/s] 23%|██▎       | 150/666 [00:03<00:10, 47.17it/s] 23%|██▎       | 155/666 [00:03<00:10, 47.20it/s] 24%|██▍       | 160/666 [00:03<00:10, 47.18it/s] 25%|██▍       | 165/666 [00:03<00:10, 47.19it/s] 26%|██▌       | 170/666 [00:03<00:10, 47.18it/s] 26%|██▋       | 175/666 [00:03<00:10, 47.19it/s] 27%|██▋       | 180/666 [00:03<00:10, 47.17it/s] 28%|██▊       | 185/666 [00:04<00:10, 47.20it/s] 29%|██▊       | 190/666 [00:04<00:10, 47.19it/s] 29%|██▉       | 195/666 [00:04<00:09, 47.21it/s] 30%|███       | 200/666 [00:04<00:09, 47.22it/s] 31%|███       | 205/666 [00:04<00:09, 47.19it/s] 32%|███▏      | 210/666 [00:04<00:09, 47.20it/s] 32%|███▏      | 215/666 [00:04<00:09, 47.21it/s] 33%|███▎      | 220/666 [00:04<00:09, 47.21it/s] 34%|███▍      | 225/666 [00:04<00:09, 47.20it/s] 35%|███▍      | 230/666 [00:05<00:09, 47.21it/s] 35%|███▌      | 235/666 [00:05<00:09, 47.21it/s] 36%|███▌      | 240/666 [00:05<00:09, 47.21it/s] 37%|███▋      | 245/666 [00:05<00:08, 47.20it/s] 38%|███▊      | 250/666 [00:05<00:08, 47.21it/s] 38%|███▊      | 255/666 [00:05<00:08, 47.20it/s] 39%|███▉      | 260/666 [00:05<00:08, 47.20it/s] 40%|███▉      | 265/666 [00:05<00:08, 47.17it/s] 41%|████      | 270/666 [00:05<00:08, 47.17it/s] 41%|████▏     | 275/666 [00:06<00:08, 47.16it/s] 42%|████▏     | 280/666 [00:06<00:08, 47.19it/s] 43%|████▎     | 285/666 [00:06<00:08, 47.18it/s] 44%|████▎     | 290/666 [00:06<00:07, 47.20it/s] 44%|████▍     | 295/666 [00:06<00:07, 47.20it/s] 45%|████▌     | 300/666 [00:06<00:07, 47.21it/s] 46%|████▌     | 305/666 [00:06<00:07, 47.20it/s] 47%|████▋     | 310/666 [00:06<00:07, 47.21it/s] 47%|████▋     | 315/666 [00:06<00:07, 47.19it/s] 48%|████▊     | 320/666 [00:06<00:07, 47.21it/s] 49%|████▉     | 325/666 [00:07<00:07, 47.17it/s] 50%|████▉     | 330/666 [00:07<00:07, 47.18it/s] 50%|█████     | 335/666 [00:07<00:07, 47.17it/s] 51%|█████     | 340/666 [00:07<00:06, 47.19it/s] 52%|█████▏    | 345/666 [00:07<00:06, 47.18it/s] 53%|█████▎    | 350/666 [00:07<00:06, 47.21it/s] 53%|█████▎    | 355/666 [00:07<00:06, 47.21it/s] 54%|█████▍    | 360/666 [00:07<00:06, 47.22it/s] 55%|█████▍    | 365/666 [00:07<00:06, 47.22it/s] 56%|█████▌    | 370/666 [00:08<00:06, 47.21it/s] 56%|█████▋    | 375/666 [00:08<00:06, 47.20it/s] 57%|█████▋    | 380/666 [00:08<00:06, 47.21it/s] 58%|█████▊    | 385/666 [00:08<00:05, 47.21it/s] 59%|█████▊    | 390/666 [00:08<00:05, 47.18it/s] 59%|█████▉    | 395/666 [00:08<00:05, 47.19it/s] 60%|██████    | 400/666 [00:08<00:05, 47.19it/s] 61%|██████    | 405/666 [00:08<00:05, 47.20it/s] 62%|██████▏   | 410/666 [00:08<00:05, 47.20it/s] 62%|██████▏   | 415/666 [00:08<00:05, 47.19it/s] 63%|██████▎   | 420/666 [00:09<00:05, 47.19it/s] 64%|██████▍   | 425/666 [00:09<00:05, 47.21it/s] 65%|██████▍   | 430/666 [00:09<00:05, 47.20it/s] 65%|██████▌   | 435/666 [00:09<00:04, 47.21it/s] 66%|██████▌   | 440/666 [00:09<00:04, 47.19it/s] 67%|██████▋   | 445/666 [00:09<00:04, 47.19it/s] 68%|██████▊   | 450/666 [00:09<00:04, 47.20it/s] 68%|██████▊   | 455/666 [00:09<00:04, 47.22it/s] 69%|██████▉   | 460/666 [00:09<00:04, 47.20it/s] 70%|██████▉   | 465/666 [00:10<00:04, 47.21it/s] 71%|███████   | 470/666 [00:10<00:04, 47.20it/s] 71%|███████▏  | 475/666 [00:10<00:04, 47.21it/s] 72%|███████▏  | 480/666 [00:10<00:03, 47.20it/s] 73%|███████▎  | 485/666 [00:10<00:03, 47.21it/s] 74%|███████▎  | 490/666 [00:10<00:03, 47.19it/s] 74%|███████▍  | 495/666 [00:10<00:03, 47.19it/s] 75%|███████▌  | 500/666 [00:10<00:03, 47.17it/s] 76%|███████▌  | 505/666 [00:10<00:03, 47.18it/s] 77%|███████▋  | 510/666 [00:10<00:03, 47.18it/s] 77%|███████▋  | 515/666 [00:11<00:03, 47.18it/s] 78%|███████▊  | 520/666 [00:11<00:03, 47.17it/s] 79%|███████▉  | 525/666 [00:11<00:02, 47.19it/s] 80%|███████▉  | 530/666 [00:11<00:02, 47.20it/s] 80%|████████  | 535/666 [00:11<00:02, 47.20it/s] 81%|████████  | 540/666 [00:11<00:02, 47.19it/s] 82%|████████▏ | 545/666 [00:11<00:02, 47.20it/s] 83%|████████▎ | 550/666 [00:11<00:02, 47.19it/s] 83%|████████▎ | 555/666 [00:11<00:02, 47.19it/s] 84%|████████▍ | 560/666 [00:12<00:02, 47.18it/s] 85%|████████▍ | 565/666 [00:12<00:02, 47.18it/s] 86%|████████▌ | 570/666 [00:12<00:02, 47.17it/s] 86%|████████▋ | 575/666 [00:12<00:01, 47.19it/s] 87%|████████▋ | 580/666 [00:12<00:01, 47.18it/s] 88%|████████▊ | 585/666 [00:12<00:01, 47.19it/s] 89%|████████▊ | 590/666 [00:12<00:01, 47.22it/s] 89%|████████▉ | 595/666 [00:12<00:01, 47.21it/s] 90%|█████████ | 600/666 [00:12<00:01, 47.22it/s] 91%|█████████ | 605/666 [00:13<00:01, 47.21it/s] 92%|█████████▏| 610/666 [00:13<00:01, 47.22it/s] 92%|█████████▏| 615/666 [00:13<00:01, 47.21it/s] 93%|█████████▎| 620/666 [00:13<00:00, 47.24it/s] 94%|█████████▍| 625/666 [00:13<00:00, 47.21it/s] 95%|█████████▍| 630/666 [00:13<00:00, 47.22it/s] 95%|█████████▌| 635/666 [00:13<00:00, 47.19it/s] 96%|█████████▌| 640/666 [00:13<00:00, 47.18it/s] 97%|█████████▋| 645/666 [00:13<00:00, 47.17it/s] 98%|█████████▊| 650/666 [00:13<00:00, 47.19it/s] 98%|█████████▊| 655/666 [00:14<00:00, 47.18it/s] 99%|█████████▉| 660/666 [00:14<00:00, 46.22it/s]100%|█████████▉| 665/666 [00:14<00:00, 46.70it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.11it/s][A
  6%|▌         | 10/167 [00:00<00:02, 52.77it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 128.89it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 168.89it/s][A
 49%|████▊     | 81/167 [00:00<00:00, 191.42it/s][A
 63%|██████▎   | 105/167 [00:00<00:00, 204.77it/s][A
 77%|███████▋  | 129/167 [00:00<00:00, 213.78it/s][A
 92%|█████████▏| 153/167 [00:00<00:00, 219.64it/s][A100%|██████████| 167/167 [00:00<00:00, 178.37it/s]
2022-11-28 21:19:22,471 P46611 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:19:22,472 P46611 INFO Monitor(max) STOP: -4.497234 !
2022-11-28 21:19:22,472 P46611 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:19:22,472 P46611 INFO Early stopping at epoch=3
2022-11-28 21:19:22,472 P46611 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:15<00:00, 43.20it/s]
2022-11-28 21:19:22,518 P46611 INFO Train loss: 30.972063
2022-11-28 21:19:22,518 P46611 INFO Training finished.
2022-11-28 21:19:22,518 P46611 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_002_f409ce08.model
2022-11-28 21:19:22,621 P46611 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:45,  6.29it/s]  2%|▏         | 10/666 [00:00<00:15, 43.47it/s]  5%|▍         | 31/666 [00:00<00:05, 107.69it/s]  8%|▊         | 53/666 [00:00<00:04, 147.66it/s] 12%|█▏        | 77/666 [00:00<00:03, 176.30it/s] 15%|█▌        | 100/666 [00:00<00:02, 191.91it/s] 18%|█▊        | 120/666 [00:00<00:02, 193.98it/s] 21%|██        | 141/666 [00:00<00:02, 196.37it/s] 24%|██▍       | 162/666 [00:00<00:02, 197.96it/s] 27%|██▋       | 183/666 [00:01<00:02, 198.21it/s] 30%|███       | 203/666 [00:01<00:02, 198.57it/s] 34%|███▎      | 224/666 [00:01<00:02, 199.12it/s] 37%|███▋      | 244/666 [00:01<00:02, 199.17it/s] 40%|███▉      | 264/666 [00:01<00:02, 199.28it/s] 43%|████▎     | 284/666 [00:01<00:01, 199.06it/s] 46%|████▌     | 304/666 [00:01<00:01, 198.28it/s] 49%|████▊     | 324/666 [00:01<00:01, 198.15it/s] 52%|█████▏    | 344/666 [00:01<00:01, 198.03it/s] 55%|█████▍    | 364/666 [00:02<00:01, 197.88it/s] 58%|█████▊    | 385/666 [00:02<00:01, 199.87it/s] 61%|██████    | 407/666 [00:02<00:01, 205.66it/s] 64%|██████▍   | 429/666 [00:02<00:01, 209.57it/s] 68%|██████▊   | 451/666 [00:02<00:01, 212.22it/s] 71%|███████   | 473/666 [00:02<00:00, 211.06it/s] 74%|███████▍  | 495/666 [00:02<00:00, 213.15it/s] 78%|███████▊  | 517/666 [00:02<00:00, 213.67it/s] 81%|████████  | 539/666 [00:02<00:00, 214.75it/s] 84%|████████▍ | 561/666 [00:02<00:00, 215.57it/s] 88%|████████▊ | 583/666 [00:03<00:00, 214.21it/s] 91%|█████████ | 605/666 [00:03<00:00, 214.85it/s] 94%|█████████▍| 627/666 [00:03<00:00, 215.39it/s] 97%|█████████▋| 649/666 [00:03<00:00, 213.94it/s]100%|██████████| 666/666 [00:03<00:00, 191.88it/s]
2022-11-28 21:19:26,546 P46611 INFO [Metrics] logloss: 4.992098 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:16,  9.88it/s]  6%|▌         | 10/167 [00:00<00:03, 49.53it/s] 17%|█▋        | 29/167 [00:00<00:01, 107.12it/s] 30%|██▉       | 50/167 [00:00<00:00, 145.17it/s] 43%|████▎     | 71/167 [00:00<00:00, 166.63it/s] 55%|█████▌    | 92/167 [00:00<00:00, 180.65it/s] 68%|██████▊   | 113/167 [00:00<00:00, 189.30it/s] 80%|████████  | 134/167 [00:00<00:00, 195.21it/s] 93%|█████████▎| 155/167 [00:00<00:00, 199.51it/s]100%|██████████| 167/167 [00:01<00:00, 162.10it/s]
2022-11-28 21:19:27,691 P46611 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:19:30,881 P48396 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "256",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_003_8e129777",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:19:30,883 P48396 INFO Set up feature encoder...
2022-11-28 21:19:30,884 P48396 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:19:30,885 P48396 INFO Loading data...
2022-11-28 21:19:30,888 P48396 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:19:31,127 P48396 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:19:31,244 P48396 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:19:31,244 P48396 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:19:31,244 P48396 INFO Loading train data done.
2022-11-28 21:19:34,876 P48396 INFO Total number of parameters: 59431684.
2022-11-28 21:19:34,877 P48396 INFO Start training: 666 batches/epoch
2022-11-28 21:19:34,877 P48396 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:19:35.205 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:48396 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:19:35.236 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:48396 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:41,  1.14s/it]  1%|          | 4/666 [00:01<02:43,  4.04it/s]  1%|          | 7/666 [00:01<01:28,  7.44it/s]  2%|▏         | 10/666 [00:01<01:00, 10.89it/s]  2%|▏         | 13/666 [00:01<00:45, 14.24it/s]  2%|▏         | 16/666 [00:01<00:37, 17.32it/s]  3%|▎         | 19/666 [00:01<00:32, 19.96it/s]  3%|▎         | 22/666 [00:01<00:29, 22.18it/s]  4%|▍         | 25/666 [00:02<00:26, 23.91it/s]  4%|▍         | 28/666 [00:02<00:25, 25.25it/s]  5%|▍         | 31/666 [00:02<00:24, 26.24it/s]  5%|▌         | 34/666 [00:02<00:23, 26.98it/s]  6%|▌         | 37/666 [00:02<00:22, 27.49it/s]  6%|▌         | 40/666 [00:02<00:22, 27.87it/s]  6%|▋         | 43/666 [00:02<00:22, 28.12it/s]  7%|▋         | 46/666 [00:02<00:21, 28.31it/s]  7%|▋         | 49/666 [00:02<00:21, 28.45it/s]  8%|▊         | 52/666 [00:02<00:21, 28.54it/s]  8%|▊         | 55/666 [00:03<00:21, 28.62it/s]  9%|▊         | 58/666 [00:03<00:21, 28.68it/s]  9%|▉         | 61/666 [00:03<00:21, 28.72it/s] 10%|▉         | 64/666 [00:03<00:20, 28.74it/s] 10%|█         | 67/666 [00:03<00:20, 28.75it/s] 11%|█         | 70/666 [00:03<00:20, 28.77it/s] 11%|█         | 73/666 [00:03<00:20, 28.78it/s] 11%|█▏        | 76/666 [00:03<00:20, 28.79it/s] 12%|█▏        | 79/666 [00:03<00:20, 28.79it/s] 12%|█▏        | 82/666 [00:03<00:20, 28.79it/s] 13%|█▎        | 85/666 [00:04<00:20, 28.78it/s] 13%|█▎        | 88/666 [00:04<00:20, 28.78it/s] 14%|█▎        | 91/666 [00:04<00:19, 28.78it/s] 14%|█▍        | 94/666 [00:04<00:19, 28.78it/s] 15%|█▍        | 97/666 [00:04<00:19, 28.78it/s] 15%|█▌        | 100/666 [00:04<00:19, 28.80it/s] 15%|█▌        | 103/666 [00:04<00:19, 28.81it/s] 16%|█▌        | 106/666 [00:04<00:19, 28.79it/s] 16%|█▋        | 109/666 [00:04<00:19, 28.79it/s] 17%|█▋        | 112/666 [00:05<00:19, 28.78it/s] 17%|█▋        | 115/666 [00:05<00:19, 28.79it/s] 18%|█▊        | 118/666 [00:05<00:19, 28.78it/s] 18%|█▊        | 121/666 [00:05<00:18, 28.79it/s] 19%|█▊        | 124/666 [00:05<00:19, 28.39it/s] 19%|█▉        | 127/666 [00:05<00:18, 28.50it/s] 20%|█▉        | 130/666 [00:05<00:18, 28.57it/s] 20%|█▉        | 133/666 [00:05<00:18, 28.63it/s] 20%|██        | 136/666 [00:05<00:18, 28.68it/s] 21%|██        | 139/666 [00:05<00:18, 28.72it/s] 21%|██▏       | 142/666 [00:06<00:18, 28.73it/s] 22%|██▏       | 145/666 [00:06<00:18, 28.75it/s] 22%|██▏       | 148/666 [00:06<00:18, 28.77it/s] 23%|██▎       | 151/666 [00:06<00:17, 28.76it/s] 23%|██▎       | 154/666 [00:06<00:17, 28.77it/s] 24%|██▎       | 157/666 [00:06<00:17, 28.78it/s] 24%|██▍       | 160/666 [00:06<00:17, 28.80it/s] 24%|██▍       | 163/666 [00:06<00:17, 28.81it/s] 25%|██▍       | 166/666 [00:06<00:17, 28.82it/s] 25%|██▌       | 169/666 [00:07<00:17, 28.83it/s] 26%|██▌       | 172/666 [00:07<00:17, 28.82it/s] 26%|██▋       | 175/666 [00:07<00:17, 28.82it/s] 27%|██▋       | 178/666 [00:07<00:16, 28.82it/s] 27%|██▋       | 181/666 [00:07<00:16, 28.80it/s] 28%|██▊       | 184/666 [00:07<00:16, 28.81it/s] 28%|██▊       | 187/666 [00:07<00:16, 28.80it/s] 29%|██▊       | 190/666 [00:07<00:16, 28.79it/s] 29%|██▉       | 193/666 [00:07<00:16, 28.78it/s] 29%|██▉       | 196/666 [00:07<00:16, 28.79it/s] 30%|██▉       | 199/666 [00:08<00:16, 28.79it/s] 30%|███       | 202/666 [00:08<00:16, 28.79it/s] 31%|███       | 205/666 [00:08<00:16, 28.79it/s] 31%|███       | 208/666 [00:08<00:15, 28.78it/s] 32%|███▏      | 211/666 [00:08<00:15, 28.78it/s] 32%|███▏      | 214/666 [00:08<00:15, 28.78it/s] 33%|███▎      | 217/666 [00:08<00:15, 28.77it/s] 33%|███▎      | 220/666 [00:08<00:15, 28.76it/s] 33%|███▎      | 223/666 [00:08<00:15, 28.78it/s] 34%|███▍      | 226/666 [00:08<00:15, 28.79it/s] 34%|███▍      | 229/666 [00:09<00:15, 28.81it/s] 35%|███▍      | 232/666 [00:09<00:15, 28.80it/s] 35%|███▌      | 235/666 [00:09<00:14, 28.79it/s] 36%|███▌      | 238/666 [00:09<00:14, 28.75it/s] 36%|███▌      | 241/666 [00:09<00:14, 28.76it/s] 37%|███▋      | 244/666 [00:09<00:14, 28.75it/s] 37%|███▋      | 247/666 [00:09<00:14, 28.75it/s] 38%|███▊      | 250/666 [00:09<00:14, 28.75it/s] 38%|███▊      | 253/666 [00:09<00:14, 28.76it/s] 38%|███▊      | 256/666 [00:10<00:14, 28.75it/s] 39%|███▉      | 259/666 [00:10<00:14, 28.75it/s] 39%|███▉      | 262/666 [00:10<00:14, 28.76it/s] 40%|███▉      | 265/666 [00:10<00:13, 28.77it/s] 40%|████      | 268/666 [00:10<00:13, 28.77it/s] 41%|████      | 271/666 [00:10<00:13, 28.76it/s] 41%|████      | 274/666 [00:10<00:13, 28.75it/s] 42%|████▏     | 277/666 [00:10<00:13, 28.76it/s] 42%|████▏     | 280/666 [00:10<00:13, 28.76it/s] 42%|████▏     | 283/666 [00:10<00:13, 28.77it/s] 43%|████▎     | 286/666 [00:11<00:13, 28.76it/s] 43%|████▎     | 289/666 [00:11<00:13, 28.77it/s] 44%|████▍     | 292/666 [00:11<00:13, 28.77it/s] 44%|████▍     | 295/666 [00:11<00:12, 28.77it/s] 45%|████▍     | 298/666 [00:11<00:12, 28.77it/s] 45%|████▌     | 301/666 [00:11<00:12, 28.77it/s] 46%|████▌     | 304/666 [00:11<00:12, 28.76it/s] 46%|████▌     | 307/666 [00:11<00:12, 28.76it/s] 47%|████▋     | 310/666 [00:11<00:12, 28.75it/s] 47%|████▋     | 313/666 [00:12<00:12, 28.75it/s] 47%|████▋     | 316/666 [00:12<00:12, 28.77it/s] 48%|████▊     | 319/666 [00:12<00:12, 28.75it/s] 48%|████▊     | 322/666 [00:12<00:11, 28.76it/s] 49%|████▉     | 325/666 [00:12<00:11, 28.75it/s] 49%|████▉     | 328/666 [00:12<00:11, 28.73it/s] 50%|████▉     | 331/666 [00:12<00:11, 28.73it/s] 50%|█████     | 334/666 [00:12<00:11, 28.73it/s] 51%|█████     | 337/666 [00:12<00:11, 28.75it/s] 51%|█████     | 340/666 [00:12<00:11, 28.78it/s] 52%|█████▏    | 343/666 [00:13<00:11, 28.77it/s] 52%|█████▏    | 346/666 [00:13<00:11, 28.78it/s] 52%|█████▏    | 349/666 [00:13<00:11, 28.74it/s] 53%|█████▎    | 352/666 [00:13<00:10, 28.75it/s] 53%|█████▎    | 355/666 [00:13<00:10, 28.77it/s] 54%|█████▍    | 358/666 [00:13<00:10, 28.76it/s] 54%|█████▍    | 361/666 [00:13<00:10, 28.76it/s] 55%|█████▍    | 364/666 [00:13<00:10, 28.74it/s] 55%|█████▌    | 367/666 [00:13<00:10, 28.76it/s] 56%|█████▌    | 370/666 [00:13<00:10, 28.77it/s] 56%|█████▌    | 373/666 [00:14<00:10, 28.76it/s] 56%|█████▋    | 376/666 [00:14<00:10, 28.76it/s] 57%|█████▋    | 379/666 [00:14<00:09, 28.77it/s] 57%|█████▋    | 382/666 [00:14<00:09, 28.76it/s] 58%|█████▊    | 385/666 [00:14<00:09, 28.76it/s] 58%|█████▊    | 388/666 [00:14<00:09, 28.75it/s] 59%|█████▊    | 391/666 [00:14<00:09, 28.76it/s] 59%|█████▉    | 394/666 [00:14<00:09, 28.77it/s] 60%|█████▉    | 397/666 [00:14<00:09, 28.77it/s] 60%|██████    | 400/666 [00:15<00:09, 28.76it/s] 61%|██████    | 403/666 [00:15<00:09, 28.77it/s] 61%|██████    | 406/666 [00:15<00:09, 28.78it/s] 61%|██████▏   | 409/666 [00:15<00:08, 28.78it/s] 62%|██████▏   | 412/666 [00:15<00:08, 28.78it/s] 62%|██████▏   | 415/666 [00:15<00:08, 28.77it/s] 63%|██████▎   | 418/666 [00:15<00:08, 28.77it/s] 63%|██████▎   | 421/666 [00:15<00:08, 28.78it/s] 64%|██████▎   | 424/666 [00:15<00:08, 28.78it/s] 64%|██████▍   | 427/666 [00:15<00:08, 28.77it/s] 65%|██████▍   | 430/666 [00:16<00:08, 28.76it/s] 65%|██████▌   | 433/666 [00:16<00:08, 28.75it/s] 65%|██████▌   | 436/666 [00:16<00:07, 28.77it/s] 66%|██████▌   | 439/666 [00:16<00:07, 28.78it/s] 66%|██████▋   | 442/666 [00:16<00:07, 28.77it/s] 67%|██████▋   | 445/666 [00:16<00:07, 28.75it/s] 67%|██████▋   | 448/666 [00:16<00:07, 28.77it/s] 68%|██████▊   | 451/666 [00:16<00:07, 28.77it/s] 68%|██████▊   | 454/666 [00:16<00:07, 28.77it/s] 69%|██████▊   | 457/666 [00:17<00:07, 28.77it/s] 69%|██████▉   | 460/666 [00:17<00:07, 28.76it/s] 70%|██████▉   | 463/666 [00:17<00:07, 28.77it/s] 70%|██████▉   | 466/666 [00:17<00:06, 28.78it/s] 70%|███████   | 469/666 [00:17<00:06, 28.79it/s] 71%|███████   | 472/666 [00:17<00:06, 28.79it/s] 71%|███████▏  | 475/666 [00:17<00:06, 28.79it/s] 72%|███████▏  | 478/666 [00:17<00:06, 28.77it/s] 72%|███████▏  | 481/666 [00:17<00:06, 28.78it/s] 73%|███████▎  | 484/666 [00:17<00:06, 28.78it/s] 73%|███████▎  | 487/666 [00:18<00:06, 28.78it/s] 74%|███████▎  | 490/666 [00:18<00:06, 28.78it/s] 74%|███████▍  | 493/666 [00:18<00:06, 28.77it/s] 74%|███████▍  | 496/666 [00:18<00:05, 28.78it/s] 75%|███████▍  | 499/666 [00:18<00:05, 28.79it/s] 75%|███████▌  | 502/666 [00:18<00:05, 28.79it/s] 76%|███████▌  | 505/666 [00:18<00:05, 28.80it/s] 76%|███████▋  | 508/666 [00:18<00:05, 28.79it/s] 77%|███████▋  | 511/666 [00:18<00:05, 28.77it/s] 77%|███████▋  | 514/666 [00:19<00:05, 28.77it/s] 78%|███████▊  | 517/666 [00:19<00:05, 28.76it/s] 78%|███████▊  | 520/666 [00:19<00:05, 28.75it/s] 79%|███████▊  | 523/666 [00:19<00:04, 28.77it/s] 79%|███████▉  | 526/666 [00:19<00:04, 28.77it/s] 79%|███████▉  | 529/666 [00:19<00:04, 28.78it/s] 80%|███████▉  | 532/666 [00:19<00:04, 28.79it/s] 80%|████████  | 535/666 [00:19<00:04, 28.79it/s] 81%|████████  | 538/666 [00:19<00:04, 28.74it/s] 81%|████████  | 541/666 [00:19<00:04, 28.71it/s] 82%|████████▏ | 544/666 [00:20<00:04, 28.78it/s] 82%|████████▏ | 547/666 [00:20<00:04, 28.78it/s] 83%|████████▎ | 550/666 [00:20<00:04, 28.78it/s] 83%|████████▎ | 553/666 [00:20<00:03, 28.77it/s] 83%|████████▎ | 556/666 [00:20<00:03, 28.78it/s] 84%|████████▍ | 559/666 [00:20<00:03, 28.79it/s] 84%|████████▍ | 562/666 [00:20<00:03, 28.79it/s] 85%|████████▍ | 565/666 [00:20<00:03, 28.79it/s] 85%|████████▌ | 568/666 [00:20<00:03, 28.80it/s] 86%|████████▌ | 571/666 [00:20<00:03, 28.79it/s] 86%|████████▌ | 574/666 [00:21<00:03, 28.78it/s] 87%|████████▋ | 577/666 [00:21<00:03, 28.78it/s] 87%|████████▋ | 580/666 [00:21<00:02, 28.78it/s] 88%|████████▊ | 583/666 [00:21<00:02, 28.78it/s] 88%|████████▊ | 586/666 [00:21<00:02, 28.78it/s] 88%|████████▊ | 589/666 [00:21<00:02, 28.77it/s] 89%|████████▉ | 592/666 [00:21<00:02, 28.78it/s] 89%|████████▉ | 595/666 [00:21<00:02, 28.79it/s] 90%|████████▉ | 598/666 [00:21<00:02, 28.79it/s] 90%|█████████ | 601/666 [00:22<00:02, 28.77it/s] 91%|█████████ | 604/666 [00:22<00:02, 28.76it/s] 91%|█████████ | 607/666 [00:22<00:02, 28.77it/s] 92%|█████████▏| 610/666 [00:22<00:01, 28.78it/s] 92%|█████████▏| 613/666 [00:22<00:01, 28.78it/s] 92%|█████████▏| 616/666 [00:22<00:01, 28.79it/s] 93%|█████████▎| 619/666 [00:22<00:01, 28.77it/s] 93%|█████████▎| 622/666 [00:22<00:01, 28.77it/s] 94%|█████████▍| 625/666 [00:22<00:01, 28.77it/s] 94%|█████████▍| 628/666 [00:22<00:01, 28.78it/s] 95%|█████████▍| 631/666 [00:23<00:01, 28.78it/s] 95%|█████████▌| 634/666 [00:23<00:01, 28.78it/s] 96%|█████████▌| 637/666 [00:23<00:01, 28.78it/s] 96%|█████████▌| 640/666 [00:23<00:00, 28.78it/s] 97%|█████████▋| 643/666 [00:23<00:00, 28.78it/s] 97%|█████████▋| 646/666 [00:23<00:00, 28.78it/s] 97%|█████████▋| 649/666 [00:23<00:00, 28.78it/s] 98%|█████████▊| 652/666 [00:23<00:00, 28.77it/s] 98%|█████████▊| 655/666 [00:23<00:00, 28.78it/s] 99%|█████████▉| 658/666 [00:24<00:00, 28.78it/s] 99%|█████████▉| 661/666 [00:24<00:00, 28.29it/s]100%|█████████▉| 664/666 [00:24<00:00, 28.50it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  2%|▏         | 3/167 [00:00<00:05, 28.98it/s][A
  6%|▌         | 10/167 [00:00<00:03, 51.65it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 129.39it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 166.47it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 187.68it/s][A
 61%|██████    | 102/167 [00:00<00:00, 200.46it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 208.31it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 213.72it/s][A100%|██████████| 167/167 [00:00<00:00, 174.56it/s]
2022-11-28 21:20:00,235 P48396 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:20:00,236 P48396 INFO Save best model: monitor(max): -10.617075
2022-11-28 21:20:02,983 P48396 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:28<00:00, 23.66it/s]
2022-11-28 21:20:03,022 P48396 INFO Train loss: 69.009578
2022-11-28 21:20:03,022 P48396 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:59,  5.57it/s]  1%|          | 4/666 [00:00<00:43, 15.09it/s]  1%|          | 7/666 [00:00<00:32, 19.98it/s]  2%|▏         | 10/666 [00:00<00:28, 22.73it/s]  2%|▏         | 13/666 [00:00<00:26, 24.63it/s]  2%|▏         | 16/666 [00:00<00:25, 25.90it/s]  3%|▎         | 19/666 [00:00<00:24, 26.83it/s]  3%|▎         | 22/666 [00:00<00:23, 27.43it/s]  4%|▍         | 25/666 [00:01<00:23, 27.84it/s]  4%|▍         | 28/666 [00:01<00:22, 28.13it/s]  5%|▍         | 31/666 [00:01<00:22, 28.33it/s]  5%|▌         | 34/666 [00:01<00:22, 28.46it/s]  6%|▌         | 37/666 [00:01<00:22, 28.56it/s]  6%|▌         | 40/666 [00:01<00:21, 28.64it/s]  6%|▋         | 43/666 [00:01<00:21, 28.69it/s]  7%|▋         | 46/666 [00:01<00:21, 28.71it/s]  7%|▋         | 49/666 [00:01<00:21, 28.73it/s]  8%|▊         | 52/666 [00:01<00:21, 28.73it/s]  8%|▊         | 55/666 [00:02<00:21, 28.74it/s]  9%|▊         | 58/666 [00:02<00:21, 28.75it/s]  9%|▉         | 61/666 [00:02<00:21, 28.77it/s] 10%|▉         | 64/666 [00:02<00:20, 28.78it/s] 10%|█         | 67/666 [00:02<00:20, 28.79it/s] 11%|█         | 70/666 [00:02<00:20, 28.79it/s] 11%|█         | 73/666 [00:02<00:20, 28.78it/s] 11%|█▏        | 76/666 [00:02<00:20, 28.78it/s] 12%|█▏        | 79/666 [00:02<00:20, 28.79it/s] 12%|█▏        | 82/666 [00:03<00:20, 28.79it/s] 13%|█▎        | 85/666 [00:03<00:20, 28.80it/s] 13%|█▎        | 88/666 [00:03<00:20, 28.80it/s] 14%|█▎        | 91/666 [00:03<00:19, 28.80it/s] 14%|█▍        | 94/666 [00:03<00:19, 28.80it/s] 15%|█▍        | 97/666 [00:03<00:19, 28.79it/s] 15%|█▌        | 100/666 [00:03<00:19, 28.79it/s] 15%|█▌        | 103/666 [00:03<00:19, 28.80it/s] 16%|█▌        | 106/666 [00:03<00:19, 28.81it/s] 16%|█▋        | 109/666 [00:03<00:19, 28.82it/s] 17%|█▋        | 112/666 [00:04<00:19, 28.80it/s] 17%|█▋        | 115/666 [00:04<00:19, 28.80it/s] 18%|█▊        | 118/666 [00:04<00:19, 28.80it/s] 18%|█▊        | 121/666 [00:04<00:18, 28.79it/s] 19%|█▊        | 124/666 [00:04<00:18, 28.80it/s] 19%|█▉        | 127/666 [00:04<00:18, 28.80it/s] 20%|█▉        | 130/666 [00:04<00:18, 28.80it/s] 20%|█▉        | 133/666 [00:04<00:18, 28.81it/s] 20%|██        | 136/666 [00:04<00:18, 28.81it/s] 21%|██        | 139/666 [00:04<00:18, 28.79it/s] 21%|██▏       | 142/666 [00:05<00:18, 28.78it/s] 22%|██▏       | 145/666 [00:05<00:18, 28.78it/s] 22%|██▏       | 148/666 [00:05<00:17, 28.78it/s] 23%|██▎       | 151/666 [00:05<00:17, 28.80it/s] 23%|██▎       | 154/666 [00:05<00:17, 28.79it/s] 24%|██▎       | 157/666 [00:05<00:17, 28.78it/s] 24%|██▍       | 160/666 [00:05<00:17, 28.79it/s] 24%|██▍       | 163/666 [00:05<00:17, 28.79it/s] 25%|██▍       | 166/666 [00:05<00:17, 28.79it/s] 25%|██▌       | 169/666 [00:06<00:17, 28.80it/s] 26%|██▌       | 172/666 [00:06<00:17, 28.79it/s] 26%|██▋       | 175/666 [00:06<00:17, 28.79it/s] 27%|██▋       | 178/666 [00:06<00:16, 28.80it/s] 27%|██▋       | 181/666 [00:06<00:16, 28.80it/s] 28%|██▊       | 184/666 [00:06<00:16, 28.80it/s] 28%|██▊       | 187/666 [00:06<00:16, 28.80it/s] 29%|██▊       | 190/666 [00:06<00:16, 28.80it/s] 29%|██▉       | 193/666 [00:06<00:16, 28.81it/s] 29%|██▉       | 196/666 [00:06<00:16, 28.81it/s] 30%|██▉       | 199/666 [00:07<00:16, 28.80it/s] 30%|███       | 202/666 [00:07<00:16, 28.79it/s] 31%|███       | 205/666 [00:07<00:16, 28.78it/s] 31%|███       | 208/666 [00:07<00:15, 28.79it/s] 32%|███▏      | 211/666 [00:07<00:15, 28.79it/s] 32%|███▏      | 214/666 [00:07<00:15, 28.80it/s] 33%|███▎      | 217/666 [00:07<00:15, 28.80it/s] 33%|███▎      | 220/666 [00:07<00:15, 28.81it/s] 33%|███▎      | 223/666 [00:07<00:15, 28.81it/s] 34%|███▍      | 226/666 [00:08<00:15, 28.81it/s] 34%|███▍      | 229/666 [00:08<00:15, 28.80it/s] 35%|███▍      | 232/666 [00:08<00:15, 28.80it/s] 35%|███▌      | 235/666 [00:08<00:14, 28.79it/s] 36%|███▌      | 238/666 [00:08<00:14, 28.80it/s] 36%|███▌      | 241/666 [00:08<00:14, 28.81it/s] 37%|███▋      | 244/666 [00:08<00:14, 28.81it/s] 37%|███▋      | 247/666 [00:08<00:14, 28.81it/s] 38%|███▊      | 250/666 [00:08<00:14, 28.80it/s] 38%|███▊      | 253/666 [00:08<00:14, 28.80it/s] 38%|███▊      | 256/666 [00:09<00:14, 28.80it/s] 39%|███▉      | 259/666 [00:09<00:14, 28.79it/s] 39%|███▉      | 262/666 [00:09<00:14, 28.78it/s] 40%|███▉      | 265/666 [00:09<00:13, 28.79it/s] 40%|████      | 268/666 [00:09<00:13, 28.79it/s] 41%|████      | 271/666 [00:09<00:13, 28.80it/s] 41%|████      | 274/666 [00:09<00:13, 28.79it/s] 42%|████▏     | 277/666 [00:09<00:13, 28.78it/s] 42%|████▏     | 280/666 [00:09<00:13, 28.78it/s] 42%|████▏     | 283/666 [00:09<00:13, 28.80it/s] 43%|████▎     | 286/666 [00:10<00:13, 28.80it/s] 43%|████▎     | 289/666 [00:10<00:13, 28.80it/s] 44%|████▍     | 292/666 [00:10<00:12, 28.79it/s] 44%|████▍     | 295/666 [00:10<00:12, 28.79it/s] 45%|████▍     | 298/666 [00:10<00:12, 28.77it/s] 45%|████▌     | 301/666 [00:10<00:12, 28.79it/s] 46%|████▌     | 304/666 [00:10<00:12, 28.81it/s] 46%|████▌     | 307/666 [00:10<00:12, 28.81it/s] 47%|████▋     | 310/666 [00:10<00:12, 28.81it/s] 47%|████▋     | 313/666 [00:11<00:12, 28.81it/s] 47%|████▋     | 316/666 [00:11<00:12, 28.80it/s] 48%|████▊     | 319/666 [00:11<00:12, 28.79it/s] 48%|████▊     | 322/666 [00:11<00:11, 28.79it/s] 49%|████▉     | 325/666 [00:11<00:11, 28.79it/s] 49%|████▉     | 328/666 [00:11<00:11, 28.80it/s] 50%|████▉     | 331/666 [00:11<00:11, 28.81it/s] 50%|█████     | 334/666 [00:11<00:11, 28.80it/s] 51%|█████     | 337/666 [00:11<00:11, 28.79it/s] 51%|█████     | 340/666 [00:11<00:11, 28.79it/s] 52%|█████▏    | 343/666 [00:12<00:11, 28.80it/s] 52%|█████▏    | 346/666 [00:12<00:11, 28.78it/s] 52%|█████▏    | 349/666 [00:12<00:11, 28.79it/s] 53%|█████▎    | 352/666 [00:12<00:10, 28.79it/s] 53%|█████▎    | 355/666 [00:12<00:10, 28.79it/s] 54%|█████▍    | 358/666 [00:12<00:10, 28.78it/s] 54%|█████▍    | 361/666 [00:12<00:10, 28.78it/s] 55%|█████▍    | 364/666 [00:12<00:10, 28.79it/s] 55%|█████▌    | 367/666 [00:12<00:10, 28.78it/s] 56%|█████▌    | 370/666 [00:13<00:10, 28.80it/s] 56%|█████▌    | 373/666 [00:13<00:10, 28.80it/s] 56%|█████▋    | 376/666 [00:13<00:10, 28.79it/s] 57%|█████▋    | 379/666 [00:13<00:09, 28.79it/s] 57%|█████▋    | 382/666 [00:13<00:09, 28.79it/s] 58%|█████▊    | 385/666 [00:13<00:09, 28.79it/s] 58%|█████▊    | 388/666 [00:13<00:09, 28.80it/s] 59%|█████▊    | 391/666 [00:13<00:09, 28.81it/s] 59%|█████▉    | 394/666 [00:13<00:09, 28.81it/s] 60%|█████▉    | 397/666 [00:13<00:09, 28.81it/s] 60%|██████    | 400/666 [00:14<00:09, 28.81it/s] 61%|██████    | 403/666 [00:14<00:09, 28.81it/s] 61%|██████    | 406/666 [00:14<00:09, 28.80it/s] 61%|██████▏   | 409/666 [00:14<00:08, 28.79it/s] 62%|██████▏   | 412/666 [00:14<00:08, 28.79it/s] 62%|██████▏   | 415/666 [00:14<00:08, 28.79it/s] 63%|██████▎   | 418/666 [00:14<00:08, 28.79it/s] 63%|██████▎   | 421/666 [00:14<00:08, 28.78it/s] 64%|██████▎   | 424/666 [00:14<00:08, 28.77it/s] 64%|██████▍   | 427/666 [00:14<00:08, 28.78it/s] 65%|██████▍   | 430/666 [00:15<00:08, 28.78it/s] 65%|██████▌   | 433/666 [00:15<00:08, 28.79it/s] 65%|██████▌   | 436/666 [00:15<00:07, 28.78it/s] 66%|██████▌   | 439/666 [00:15<00:07, 28.79it/s] 66%|██████▋   | 442/666 [00:15<00:07, 28.78it/s] 67%|██████▋   | 445/666 [00:15<00:07, 28.78it/s] 67%|██████▋   | 448/666 [00:15<00:07, 28.79it/s] 68%|██████▊   | 451/666 [00:15<00:07, 28.78it/s] 68%|██████▊   | 454/666 [00:15<00:07, 28.78it/s] 69%|██████▊   | 457/666 [00:16<00:07, 28.78it/s] 69%|██████▉   | 460/666 [00:16<00:07, 28.77it/s] 70%|██████▉   | 463/666 [00:16<00:07, 28.78it/s] 70%|██████▉   | 466/666 [00:16<00:06, 28.79it/s] 70%|███████   | 469/666 [00:16<00:06, 28.79it/s] 71%|███████   | 472/666 [00:16<00:06, 28.79it/s] 71%|███████▏  | 475/666 [00:16<00:06, 28.79it/s] 72%|███████▏  | 478/666 [00:16<00:06, 28.79it/s] 72%|███████▏  | 481/666 [00:16<00:06, 28.79it/s] 73%|███████▎  | 484/666 [00:16<00:06, 28.79it/s] 73%|███████▎  | 487/666 [00:17<00:06, 28.81it/s] 74%|███████▎  | 490/666 [00:17<00:06, 28.81it/s] 74%|███████▍  | 493/666 [00:17<00:06, 28.81it/s] 74%|███████▍  | 496/666 [00:17<00:05, 28.80it/s] 75%|███████▍  | 499/666 [00:17<00:05, 28.80it/s] 75%|███████▌  | 502/666 [00:17<00:05, 28.78it/s] 76%|███████▌  | 505/666 [00:17<00:05, 28.79it/s] 76%|███████▋  | 508/666 [00:17<00:05, 28.80it/s] 77%|███████▋  | 511/666 [00:17<00:05, 28.80it/s] 77%|███████▋  | 514/666 [00:18<00:05, 28.81it/s] 78%|███████▊  | 517/666 [00:18<00:05, 28.80it/s] 78%|███████▊  | 520/666 [00:18<00:05, 28.80it/s] 79%|███████▊  | 523/666 [00:18<00:04, 28.78it/s] 79%|███████▉  | 526/666 [00:18<00:04, 28.79it/s] 79%|███████▉  | 529/666 [00:18<00:04, 28.79it/s] 80%|███████▉  | 532/666 [00:18<00:04, 28.79it/s] 80%|████████  | 535/666 [00:18<00:04, 28.74it/s] 81%|████████  | 538/666 [00:18<00:04, 28.73it/s] 81%|████████  | 541/666 [00:18<00:04, 28.74it/s] 82%|████████▏ | 544/666 [00:19<00:04, 28.75it/s] 82%|████████▏ | 547/666 [00:19<00:04, 28.76it/s] 83%|████████▎ | 550/666 [00:19<00:04, 28.76it/s] 83%|████████▎ | 553/666 [00:19<00:03, 28.77it/s] 83%|████████▎ | 556/666 [00:19<00:03, 28.78it/s] 84%|████████▍ | 559/666 [00:19<00:03, 28.78it/s] 84%|████████▍ | 562/666 [00:19<00:03, 28.78it/s] 85%|████████▍ | 565/666 [00:19<00:03, 28.78it/s] 85%|████████▌ | 568/666 [00:19<00:03, 28.79it/s] 86%|████████▌ | 571/666 [00:20<00:03, 28.78it/s] 86%|████████▌ | 574/666 [00:20<00:03, 28.78it/s] 87%|████████▋ | 577/666 [00:20<00:03, 28.77it/s] 87%|████████▋ | 580/666 [00:20<00:02, 28.76it/s] 88%|████████▊ | 583/666 [00:20<00:02, 28.77it/s] 88%|████████▊ | 586/666 [00:20<00:02, 28.79it/s] 88%|████████▊ | 589/666 [00:20<00:02, 28.79it/s] 89%|████████▉ | 592/666 [00:20<00:02, 28.80it/s] 89%|████████▉ | 595/666 [00:20<00:02, 28.80it/s] 90%|████████▉ | 598/666 [00:20<00:02, 28.79it/s] 90%|█████████ | 601/666 [00:21<00:02, 28.79it/s] 91%|█████████ | 604/666 [00:21<00:02, 28.79it/s] 91%|█████████ | 607/666 [00:21<00:02, 28.79it/s] 92%|█████████▏| 610/666 [00:21<00:01, 28.74it/s] 92%|█████████▏| 613/666 [00:21<00:01, 28.74it/s] 92%|█████████▏| 616/666 [00:21<00:01, 28.76it/s] 93%|█████████▎| 619/666 [00:21<00:01, 28.77it/s] 93%|█████████▎| 622/666 [00:21<00:01, 28.78it/s] 94%|█████████▍| 625/666 [00:21<00:01, 28.78it/s] 94%|█████████▍| 628/666 [00:21<00:01, 28.79it/s] 95%|█████████▍| 631/666 [00:22<00:01, 28.79it/s] 95%|█████████▌| 634/666 [00:22<00:01, 28.79it/s] 96%|█████████▌| 637/666 [00:22<00:01, 28.79it/s] 96%|█████████▌| 640/666 [00:22<00:00, 28.80it/s] 97%|█████████▋| 643/666 [00:22<00:00, 28.80it/s] 97%|█████████▋| 646/666 [00:22<00:00, 28.80it/s] 97%|█████████▋| 649/666 [00:22<00:00, 28.79it/s] 98%|█████████▊| 652/666 [00:22<00:00, 28.79it/s] 98%|█████████▊| 655/666 [00:22<00:00, 28.79it/s] 99%|█████████▉| 658/666 [00:23<00:00, 28.79it/s] 99%|█████████▉| 661/666 [00:23<00:00, 28.23it/s]100%|█████████▉| 664/666 [00:23<00:00, 28.40it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:16,  9.92it/s][A
  6%|▌         | 10/167 [00:00<00:03, 40.99it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 103.50it/s][A
 32%|███▏      | 54/167 [00:00<00:00, 146.00it/s][A
 46%|████▌     | 77/167 [00:00<00:00, 172.16it/s][A
 60%|█████▉    | 100/167 [00:00<00:00, 188.70it/s][A
 74%|███████▎  | 123/167 [00:00<00:00, 199.64it/s][A
 87%|████████▋ | 146/167 [00:00<00:00, 207.09it/s][A100%|██████████| 167/167 [00:01<00:00, 163.95it/s]
2022-11-28 21:20:27,462 P48396 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:20:27,462 P48396 INFO Monitor(max) STOP: -10.617075 !
2022-11-28 21:20:27,462 P48396 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:20:27,462 P48396 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:24<00:00, 27.19it/s]
2022-11-28 21:20:27,513 P48396 INFO Train loss: 69.009519
2022-11-28 21:20:27,513 P48396 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:03,  5.40it/s]  1%|          | 4/666 [00:00<00:42, 15.65it/s]  1%|          | 7/666 [00:00<00:31, 20.80it/s]  2%|▏         | 10/666 [00:00<00:28, 23.32it/s]  2%|▏         | 13/666 [00:00<00:26, 24.98it/s]  2%|▏         | 16/666 [00:00<00:24, 26.13it/s]  3%|▎         | 19/666 [00:00<00:23, 26.97it/s]  3%|▎         | 22/666 [00:00<00:23, 27.46it/s]  4%|▍         | 25/666 [00:01<00:23, 27.84it/s]  4%|▍         | 28/666 [00:01<00:22, 28.10it/s]  5%|▍         | 31/666 [00:01<00:22, 28.28it/s]  5%|▌         | 34/666 [00:01<00:22, 28.38it/s]  6%|▌         | 37/666 [00:01<00:22, 28.48it/s]  6%|▌         | 40/666 [00:01<00:21, 28.56it/s]  6%|▋         | 43/666 [00:01<00:21, 28.60it/s]  7%|▋         | 46/666 [00:01<00:21, 28.63it/s]  7%|▋         | 49/666 [00:01<00:21, 28.63it/s]  8%|▊         | 52/666 [00:01<00:21, 28.62it/s]  8%|▊         | 55/666 [00:02<00:21, 28.63it/s]  9%|▊         | 58/666 [00:02<00:21, 28.64it/s]  9%|▉         | 61/666 [00:02<00:21, 28.66it/s] 10%|▉         | 64/666 [00:02<00:21, 28.65it/s] 10%|█         | 67/666 [00:02<00:20, 28.66it/s] 11%|█         | 70/666 [00:02<00:20, 28.68it/s] 11%|█         | 73/666 [00:02<00:20, 28.65it/s] 11%|█▏        | 76/666 [00:02<00:20, 28.67it/s] 12%|█▏        | 79/666 [00:02<00:20, 28.67it/s] 12%|█▏        | 82/666 [00:03<00:20, 28.67it/s] 13%|█▎        | 85/666 [00:03<00:20, 28.65it/s] 13%|█▎        | 88/666 [00:03<00:20, 28.69it/s] 14%|█▎        | 91/666 [00:03<00:20, 28.69it/s] 14%|█▍        | 94/666 [00:03<00:19, 28.68it/s] 15%|█▍        | 97/666 [00:03<00:19, 28.69it/s] 15%|█▌        | 100/666 [00:03<00:19, 28.69it/s] 15%|█▌        | 103/666 [00:03<00:19, 28.70it/s] 16%|█▌        | 106/666 [00:03<00:19, 28.66it/s] 16%|█▋        | 109/666 [00:03<00:19, 28.65it/s] 17%|█▋        | 112/666 [00:04<00:19, 28.66it/s] 17%|█▋        | 115/666 [00:04<00:19, 28.65it/s] 18%|█▊        | 118/666 [00:04<00:19, 28.67it/s] 18%|█▊        | 121/666 [00:04<00:19, 28.67it/s] 19%|█▊        | 124/666 [00:04<00:18, 28.67it/s] 19%|█▉        | 127/666 [00:04<00:18, 28.67it/s] 20%|█▉        | 130/666 [00:04<00:18, 28.66it/s] 20%|█▉        | 133/666 [00:04<00:18, 28.68it/s] 20%|██        | 136/666 [00:04<00:18, 28.70it/s] 21%|██        | 139/666 [00:05<00:18, 28.72it/s] 21%|██▏       | 142/666 [00:05<00:18, 28.72it/s] 22%|██▏       | 145/666 [00:05<00:18, 28.74it/s] 22%|██▏       | 148/666 [00:05<00:18, 28.75it/s] 23%|██▎       | 151/666 [00:05<00:17, 28.75it/s] 23%|██▎       | 154/666 [00:05<00:17, 28.76it/s] 24%|██▎       | 157/666 [00:05<00:17, 28.76it/s] 24%|██▍       | 160/666 [00:05<00:17, 28.77it/s] 24%|██▍       | 163/666 [00:05<00:17, 28.75it/s] 25%|██▍       | 166/666 [00:05<00:17, 28.75it/s] 25%|██▌       | 169/666 [00:06<00:17, 28.75it/s] 26%|██▌       | 172/666 [00:06<00:17, 28.75it/s] 26%|██▋       | 175/666 [00:06<00:17, 28.74it/s] 27%|██▋       | 178/666 [00:06<00:16, 28.75it/s] 27%|██▋       | 181/666 [00:06<00:16, 28.76it/s] 28%|██▊       | 184/666 [00:06<00:16, 28.75it/s] 28%|██▊       | 187/666 [00:06<00:16, 28.74it/s] 29%|██▊       | 190/666 [00:06<00:16, 28.74it/s] 29%|██▉       | 193/666 [00:06<00:16, 28.72it/s] 29%|██▉       | 196/666 [00:06<00:16, 28.71it/s] 30%|██▉       | 199/666 [00:07<00:16, 28.70it/s] 30%|███       | 202/666 [00:07<00:16, 28.72it/s] 31%|███       | 205/666 [00:07<00:16, 28.73it/s] 31%|███       | 208/666 [00:07<00:15, 28.75it/s] 32%|███▏      | 211/666 [00:07<00:15, 28.76it/s] 32%|███▏      | 214/666 [00:07<00:15, 28.74it/s] 33%|███▎      | 217/666 [00:07<00:15, 28.74it/s] 33%|███▎      | 220/666 [00:07<00:15, 28.75it/s] 33%|███▎      | 223/666 [00:07<00:15, 28.76it/s] 34%|███▍      | 226/666 [00:08<00:15, 28.74it/s] 34%|███▍      | 229/666 [00:08<00:15, 28.74it/s] 35%|███▍      | 232/666 [00:08<00:15, 28.74it/s] 35%|███▌      | 235/666 [00:08<00:14, 28.74it/s] 36%|███▌      | 238/666 [00:08<00:14, 28.73it/s] 36%|███▌      | 241/666 [00:08<00:14, 28.73it/s] 37%|███▋      | 244/666 [00:08<00:14, 28.73it/s] 37%|███▋      | 247/666 [00:08<00:14, 28.75it/s] 38%|███▊      | 250/666 [00:08<00:14, 28.75it/s] 38%|███▊      | 253/666 [00:08<00:14, 28.73it/s] 38%|███▊      | 256/666 [00:09<00:14, 28.72it/s] 39%|███▉      | 259/666 [00:09<00:14, 28.73it/s] 39%|███▉      | 262/666 [00:09<00:14, 28.74it/s] 40%|███▉      | 265/666 [00:09<00:13, 28.73it/s] 40%|████      | 268/666 [00:09<00:13, 28.74it/s] 41%|████      | 271/666 [00:09<00:13, 28.75it/s] 41%|████      | 274/666 [00:09<00:13, 28.74it/s] 42%|████▏     | 277/666 [00:09<00:13, 28.74it/s] 42%|████▏     | 280/666 [00:09<00:13, 28.74it/s] 42%|████▏     | 283/666 [00:10<00:13, 28.75it/s] 43%|████▎     | 286/666 [00:10<00:13, 28.75it/s] 43%|████▎     | 289/666 [00:10<00:13, 28.75it/s] 44%|████▍     | 292/666 [00:10<00:13, 28.76it/s] 44%|████▍     | 295/666 [00:10<00:12, 28.77it/s] 45%|████▍     | 298/666 [00:10<00:12, 28.76it/s] 45%|████▌     | 301/666 [00:10<00:12, 28.76it/s] 46%|████▌     | 304/666 [00:10<00:12, 28.76it/s] 46%|████▌     | 307/666 [00:10<00:12, 28.77it/s] 47%|████▋     | 310/666 [00:10<00:12, 28.76it/s] 47%|████▋     | 313/666 [00:11<00:12, 28.75it/s] 47%|████▋     | 316/666 [00:11<00:12, 28.74it/s] 48%|████▊     | 319/666 [00:11<00:12, 28.75it/s] 48%|████▊     | 322/666 [00:11<00:11, 28.77it/s] 49%|████▉     | 325/666 [00:11<00:11, 28.76it/s] 49%|████▉     | 328/666 [00:11<00:11, 28.74it/s] 50%|████▉     | 331/666 [00:11<00:11, 28.75it/s] 50%|█████     | 334/666 [00:11<00:11, 28.77it/s] 51%|█████     | 337/666 [00:11<00:11, 28.76it/s] 51%|█████     | 340/666 [00:11<00:11, 28.76it/s] 52%|█████▏    | 343/666 [00:12<00:11, 28.75it/s] 52%|█████▏    | 346/666 [00:12<00:11, 28.75it/s] 52%|█████▏    | 349/666 [00:12<00:11, 28.75it/s] 53%|█████▎    | 352/666 [00:12<00:10, 28.76it/s] 53%|█████▎    | 355/666 [00:12<00:10, 28.77it/s] 54%|█████▍    | 358/666 [00:12<00:10, 28.78it/s] 54%|█████▍    | 361/666 [00:12<00:10, 28.76it/s] 55%|█████▍    | 364/666 [00:12<00:10, 28.76it/s] 55%|█████▌    | 367/666 [00:12<00:10, 28.77it/s] 56%|█████▌    | 370/666 [00:13<00:10, 28.75it/s] 56%|█████▌    | 373/666 [00:13<00:10, 28.75it/s] 56%|█████▋    | 376/666 [00:13<00:10, 28.75it/s] 57%|█████▋    | 379/666 [00:13<00:09, 28.77it/s] 57%|█████▋    | 382/666 [00:13<00:09, 28.75it/s] 58%|█████▊    | 385/666 [00:13<00:09, 28.73it/s] 58%|█████▊    | 388/666 [00:13<00:09, 28.73it/s] 59%|█████▊    | 391/666 [00:13<00:09, 28.71it/s] 59%|█████▉    | 394/666 [00:13<00:09, 28.71it/s] 60%|█████▉    | 397/666 [00:13<00:09, 28.72it/s] 60%|██████    | 400/666 [00:14<00:09, 28.73it/s] 61%|██████    | 403/666 [00:14<00:09, 28.74it/s] 61%|██████    | 406/666 [00:14<00:09, 28.75it/s] 61%|██████▏   | 409/666 [00:14<00:08, 28.76it/s] 62%|██████▏   | 412/666 [00:14<00:08, 28.74it/s] 62%|██████▏   | 415/666 [00:14<00:08, 28.74it/s] 63%|██████▎   | 418/666 [00:14<00:08, 28.76it/s] 63%|██████▎   | 421/666 [00:14<00:08, 28.75it/s] 64%|██████▎   | 424/666 [00:14<00:08, 28.74it/s] 64%|██████▍   | 427/666 [00:15<00:08, 28.75it/s] 65%|██████▍   | 430/666 [00:15<00:08, 28.75it/s] 65%|██████▌   | 433/666 [00:15<00:08, 28.75it/s] 65%|██████▌   | 436/666 [00:15<00:07, 28.75it/s] 66%|██████▌   | 439/666 [00:15<00:07, 28.74it/s] 66%|██████▋   | 442/666 [00:15<00:07, 28.74it/s] 67%|██████▋   | 445/666 [00:15<00:07, 28.72it/s] 67%|██████▋   | 448/666 [00:15<00:07, 28.73it/s] 68%|██████▊   | 451/666 [00:15<00:07, 28.73it/s] 68%|██████▊   | 454/666 [00:15<00:07, 28.71it/s] 69%|██████▊   | 457/666 [00:16<00:07, 28.73it/s] 69%|██████▉   | 460/666 [00:16<00:07, 28.72it/s] 70%|██████▉   | 463/666 [00:16<00:07, 28.73it/s] 70%|██████▉   | 466/666 [00:16<00:06, 28.74it/s] 70%|███████   | 469/666 [00:16<00:06, 28.74it/s] 71%|███████   | 472/666 [00:16<00:06, 28.75it/s] 71%|███████▏  | 475/666 [00:16<00:06, 28.75it/s] 72%|███████▏  | 478/666 [00:16<00:06, 28.74it/s] 72%|███████▏  | 481/666 [00:16<00:06, 28.75it/s] 73%|███████▎  | 484/666 [00:17<00:06, 28.74it/s] 73%|███████▎  | 487/666 [00:17<00:06, 28.73it/s] 74%|███████▎  | 490/666 [00:17<00:06, 28.73it/s] 74%|███████▍  | 493/666 [00:17<00:06, 28.74it/s] 74%|███████▍  | 496/666 [00:17<00:05, 28.73it/s] 75%|███████▍  | 499/666 [00:17<00:05, 28.73it/s] 75%|███████▌  | 502/666 [00:17<00:05, 28.73it/s] 76%|███████▌  | 505/666 [00:17<00:05, 28.73it/s] 76%|███████▋  | 508/666 [00:17<00:05, 28.73it/s] 77%|███████▋  | 511/666 [00:17<00:05, 28.71it/s] 77%|███████▋  | 514/666 [00:18<00:05, 28.70it/s] 78%|███████▊  | 517/666 [00:18<00:05, 28.72it/s] 78%|███████▊  | 520/666 [00:18<00:05, 28.72it/s] 79%|███████▊  | 523/666 [00:18<00:04, 28.71it/s] 79%|███████▉  | 526/666 [00:18<00:04, 28.73it/s] 79%|███████▉  | 529/666 [00:18<00:04, 28.70it/s] 80%|███████▉  | 532/666 [00:18<00:04, 28.71it/s] 80%|████████  | 535/666 [00:18<00:04, 28.68it/s] 81%|████████  | 538/666 [00:18<00:04, 28.70it/s] 81%|████████  | 541/666 [00:18<00:04, 28.70it/s] 82%|████████▏ | 544/666 [00:19<00:04, 28.70it/s] 82%|████████▏ | 547/666 [00:19<00:04, 28.71it/s] 83%|████████▎ | 550/666 [00:19<00:04, 28.70it/s] 83%|████████▎ | 553/666 [00:19<00:03, 28.72it/s] 83%|████████▎ | 556/666 [00:19<00:03, 28.70it/s] 84%|████████▍ | 559/666 [00:19<00:03, 28.69it/s] 84%|████████▍ | 562/666 [00:19<00:03, 28.69it/s] 85%|████████▍ | 565/666 [00:19<00:03, 28.69it/s] 85%|████████▌ | 568/666 [00:19<00:03, 28.67it/s] 86%|████████▌ | 571/666 [00:20<00:03, 28.67it/s] 86%|████████▌ | 574/666 [00:20<00:03, 28.67it/s] 87%|████████▋ | 577/666 [00:20<00:03, 28.66it/s] 87%|████████▋ | 580/666 [00:20<00:02, 28.67it/s] 88%|████████▊ | 583/666 [00:20<00:02, 28.69it/s] 88%|████████▊ | 586/666 [00:20<00:02, 28.69it/s] 88%|████████▊ | 589/666 [00:20<00:02, 28.70it/s] 89%|████████▉ | 592/666 [00:20<00:02, 28.69it/s] 89%|████████▉ | 595/666 [00:20<00:02, 28.72it/s] 90%|████████▉ | 598/666 [00:20<00:02, 28.73it/s] 90%|█████████ | 601/666 [00:21<00:02, 28.72it/s] 91%|█████████ | 604/666 [00:21<00:02, 28.73it/s] 91%|█████████ | 607/666 [00:21<00:02, 28.74it/s] 92%|█████████▏| 610/666 [00:21<00:01, 28.72it/s] 92%|█████████▏| 613/666 [00:21<00:01, 28.72it/s] 92%|█████████▏| 616/666 [00:21<00:01, 28.73it/s] 93%|█████████▎| 619/666 [00:21<00:01, 28.71it/s] 93%|█████████▎| 622/666 [00:21<00:01, 28.73it/s] 94%|█████████▍| 625/666 [00:21<00:01, 28.71it/s] 94%|█████████▍| 628/666 [00:22<00:01, 28.69it/s] 95%|█████████▍| 631/666 [00:22<00:01, 28.69it/s] 95%|█████████▌| 634/666 [00:22<00:01, 28.70it/s] 96%|█████████▌| 637/666 [00:22<00:01, 28.71it/s] 96%|█████████▌| 640/666 [00:22<00:00, 28.70it/s] 97%|█████████▋| 643/666 [00:22<00:00, 28.71it/s] 97%|█████████▋| 646/666 [00:22<00:00, 28.74it/s] 97%|█████████▋| 649/666 [00:22<00:00, 28.75it/s] 98%|█████████▊| 652/666 [00:22<00:00, 28.73it/s] 98%|█████████▊| 655/666 [00:22<00:00, 28.72it/s] 99%|█████████▉| 658/666 [00:23<00:00, 28.74it/s] 99%|█████████▉| 661/666 [00:23<00:00, 28.27it/s]100%|█████████▉| 664/666 [00:23<00:00, 28.47it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  2%|▏         | 3/167 [00:00<00:05, 28.78it/s][A
  6%|▌         | 10/167 [00:00<00:03, 48.20it/s][A
 19%|█▉        | 32/167 [00:00<00:01, 121.71it/s][A
 32%|███▏      | 54/167 [00:00<00:00, 158.96it/s][A
 46%|████▌     | 76/167 [00:00<00:00, 180.36it/s][A
 59%|█████▊    | 98/167 [00:00<00:00, 193.37it/s][A
 72%|███████▏  | 121/167 [00:00<00:00, 202.74it/s][A
 86%|████████▌ | 144/167 [00:00<00:00, 208.61it/s][A
100%|██████████| 167/167 [00:00<00:00, 213.04it/s][A100%|██████████| 167/167 [00:00<00:00, 171.38it/s]
2022-11-28 21:20:51,951 P48396 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:20:51,951 P48396 INFO Monitor(max) STOP: -10.617075 !
2022-11-28 21:20:51,951 P48396 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:20:51,951 P48396 INFO Early stopping at epoch=3
2022-11-28 21:20:51,952 P48396 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:24<00:00, 27.16it/s]
2022-11-28 21:20:51,996 P48396 INFO Train loss: 69.009461
2022-11-28 21:20:51,996 P48396 INFO Training finished.
2022-11-28 21:20:51,996 P48396 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_003_8e129777.model
2022-11-28 21:20:52,850 P48396 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:50,  6.00it/s]  2%|▏         | 10/666 [00:00<00:15, 41.47it/s]  4%|▍         | 29/666 [00:00<00:06, 97.50it/s]  7%|▋         | 48/666 [00:00<00:04, 129.32it/s] 10%|█         | 68/666 [00:00<00:03, 150.51it/s] 13%|█▎        | 88/666 [00:00<00:03, 164.41it/s] 16%|█▌        | 108/666 [00:00<00:03, 173.74it/s] 19%|█▉        | 128/666 [00:00<00:02, 180.52it/s] 22%|██▏       | 148/666 [00:01<00:02, 185.58it/s] 25%|██▌       | 168/666 [00:01<00:02, 188.95it/s] 28%|██▊       | 188/666 [00:01<00:02, 190.59it/s] 31%|███       | 208/666 [00:01<00:02, 192.02it/s] 34%|███▍      | 228/666 [00:01<00:02, 193.33it/s] 37%|███▋      | 248/666 [00:01<00:02, 194.48it/s] 40%|████      | 268/666 [00:01<00:02, 195.47it/s] 43%|████▎     | 288/666 [00:01<00:01, 195.73it/s] 46%|████▌     | 308/666 [00:01<00:01, 195.81it/s] 49%|████▉     | 328/666 [00:01<00:01, 196.56it/s] 52%|█████▏    | 348/666 [00:02<00:01, 196.68it/s] 55%|█████▌    | 368/666 [00:02<00:01, 197.14it/s] 58%|█████▊    | 388/666 [00:02<00:01, 197.03it/s] 61%|██████▏   | 408/666 [00:02<00:01, 197.20it/s] 64%|██████▍   | 428/666 [00:02<00:01, 197.19it/s] 67%|██████▋   | 448/666 [00:02<00:01, 197.57it/s] 70%|███████   | 468/666 [00:02<00:01, 197.55it/s] 73%|███████▎  | 488/666 [00:02<00:00, 197.59it/s] 76%|███████▋  | 508/666 [00:02<00:00, 197.81it/s] 79%|███████▉  | 528/666 [00:02<00:00, 194.12it/s] 82%|████████▏ | 548/666 [00:03<00:00, 195.10it/s] 85%|████████▌ | 568/666 [00:03<00:00, 195.88it/s] 88%|████████▊ | 588/666 [00:03<00:00, 195.80it/s] 91%|█████████▏| 608/666 [00:03<00:00, 196.17it/s] 94%|█████████▍| 628/666 [00:03<00:00, 196.72it/s] 97%|█████████▋| 648/666 [00:03<00:00, 197.05it/s]100%|██████████| 666/666 [00:03<00:00, 180.58it/s]
2022-11-28 21:20:56,996 P48396 INFO [Metrics] logloss: 11.123019 - AUC: 0.499893
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:18,  8.92it/s]  6%|▌         | 10/167 [00:00<00:03, 52.02it/s] 17%|█▋        | 28/167 [00:00<00:01, 106.00it/s] 28%|██▊       | 47/167 [00:00<00:00, 135.81it/s] 40%|███▉      | 66/167 [00:00<00:00, 152.92it/s] 51%|█████     | 85/167 [00:00<00:00, 164.91it/s] 63%|██████▎   | 105/167 [00:00<00:00, 173.48it/s] 75%|███████▍  | 125/167 [00:00<00:00, 179.91it/s] 87%|████████▋ | 145/167 [00:00<00:00, 185.01it/s] 99%|█████████▉| 165/167 [00:01<00:00, 189.09it/s]100%|██████████| 167/167 [00:01<00:00, 152.48it/s]
2022-11-28 21:20:58,206 P48396 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:21:00,956 P50181 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "64",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_004_7764bf1e",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:21:00,958 P50181 INFO Set up feature encoder...
2022-11-28 21:21:00,959 P50181 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:21:00,960 P50181 INFO Loading data...
2022-11-28 21:21:00,962 P50181 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:21:01,207 P50181 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:21:01,305 P50181 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:21:01,305 P50181 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:21:01,305 P50181 INFO Loading train data done.
2022-11-28 21:21:03,577 P50181 INFO Total number of parameters: 15268036.
2022-11-28 21:21:03,577 P50181 INFO Start training: 666 batches/epoch
2022-11-28 21:21:03,577 P50181 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:21:03.914 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:50181 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:21:03.946 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:50181 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:32,  1.13s/it]  1%|          | 7/666 [00:01<01:27,  7.50it/s]  2%|▏         | 13/666 [00:01<00:46, 14.10it/s]  3%|▎         | 20/666 [00:01<00:28, 22.68it/s]  4%|▍         | 27/666 [00:01<00:20, 30.98it/s]  5%|▌         | 34/666 [00:01<00:16, 38.60it/s]  6%|▌         | 41/666 [00:01<00:13, 45.22it/s]  7%|▋         | 48/666 [00:01<00:12, 50.68it/s]  8%|▊         | 55/666 [00:01<00:11, 54.99it/s]  9%|▉         | 62/666 [00:02<00:10, 58.26it/s] 10%|█         | 69/666 [00:02<00:10, 59.65it/s] 11%|█▏        | 76/666 [00:02<00:09, 61.76it/s] 12%|█▏        | 83/666 [00:02<00:09, 63.28it/s] 14%|█▎        | 90/666 [00:02<00:08, 64.38it/s] 15%|█▍        | 97/666 [00:02<00:08, 65.17it/s] 16%|█▌        | 104/666 [00:02<00:08, 65.66it/s] 17%|█▋        | 111/666 [00:02<00:08, 66.04it/s] 18%|█▊        | 118/666 [00:02<00:08, 66.32it/s] 19%|█▉        | 125/666 [00:03<00:08, 66.50it/s] 20%|█▉        | 132/666 [00:03<00:08, 66.63it/s] 21%|██        | 139/666 [00:03<00:07, 66.75it/s] 22%|██▏       | 146/666 [00:03<00:07, 66.84it/s] 23%|██▎       | 153/666 [00:03<00:07, 66.88it/s] 24%|██▍       | 160/666 [00:03<00:07, 66.93it/s] 25%|██▌       | 167/666 [00:03<00:07, 66.96it/s] 26%|██▌       | 174/666 [00:03<00:07, 66.94it/s] 27%|██▋       | 181/666 [00:03<00:07, 66.94it/s] 28%|██▊       | 188/666 [00:03<00:07, 66.95it/s] 29%|██▉       | 195/666 [00:04<00:07, 66.93it/s] 30%|███       | 202/666 [00:04<00:06, 66.97it/s] 31%|███▏      | 209/666 [00:04<00:06, 66.98it/s] 32%|███▏      | 216/666 [00:04<00:06, 67.00it/s] 33%|███▎      | 223/666 [00:04<00:06, 67.03it/s] 35%|███▍      | 230/666 [00:04<00:06, 67.01it/s] 36%|███▌      | 237/666 [00:04<00:06, 67.01it/s] 37%|███▋      | 244/666 [00:04<00:06, 66.98it/s] 38%|███▊      | 251/666 [00:04<00:06, 66.96it/s] 39%|███▊      | 258/666 [00:05<00:06, 66.94it/s] 40%|███▉      | 265/666 [00:05<00:05, 66.94it/s] 41%|████      | 272/666 [00:05<00:05, 66.94it/s] 42%|████▏     | 279/666 [00:05<00:05, 66.96it/s] 43%|████▎     | 286/666 [00:05<00:05, 66.98it/s] 44%|████▍     | 293/666 [00:05<00:05, 67.00it/s] 45%|████▌     | 300/666 [00:05<00:05, 67.00it/s] 46%|████▌     | 307/666 [00:05<00:05, 67.03it/s] 47%|████▋     | 314/666 [00:05<00:05, 67.02it/s] 48%|████▊     | 321/666 [00:05<00:05, 67.00it/s] 49%|████▉     | 328/666 [00:06<00:05, 67.04it/s] 50%|█████     | 335/666 [00:06<00:04, 67.01it/s] 51%|█████▏    | 342/666 [00:06<00:04, 67.03it/s] 52%|█████▏    | 349/666 [00:06<00:04, 67.04it/s] 53%|█████▎    | 356/666 [00:06<00:04, 67.04it/s] 55%|█████▍    | 363/666 [00:06<00:04, 67.01it/s] 56%|█████▌    | 370/666 [00:06<00:04, 66.95it/s] 57%|█████▋    | 377/666 [00:06<00:04, 66.95it/s] 58%|█████▊    | 384/666 [00:06<00:04, 66.96it/s] 59%|█████▊    | 391/666 [00:07<00:04, 66.98it/s] 60%|█████▉    | 398/666 [00:07<00:04, 66.99it/s] 61%|██████    | 405/666 [00:07<00:03, 67.03it/s] 62%|██████▏   | 412/666 [00:07<00:03, 67.02it/s] 63%|██████▎   | 419/666 [00:07<00:03, 67.03it/s] 64%|██████▍   | 426/666 [00:07<00:03, 67.02it/s] 65%|██████▌   | 433/666 [00:07<00:03, 66.99it/s] 66%|██████▌   | 440/666 [00:07<00:03, 66.97it/s] 67%|██████▋   | 447/666 [00:07<00:03, 66.97it/s] 68%|██████▊   | 454/666 [00:07<00:03, 67.00it/s] 69%|██████▉   | 461/666 [00:08<00:03, 66.99it/s] 70%|███████   | 468/666 [00:08<00:02, 67.00it/s] 71%|███████▏  | 475/666 [00:08<00:02, 67.00it/s] 72%|███████▏  | 482/666 [00:08<00:02, 67.00it/s] 73%|███████▎  | 489/666 [00:08<00:02, 67.00it/s] 74%|███████▍  | 496/666 [00:08<00:02, 67.00it/s] 76%|███████▌  | 503/666 [00:08<00:02, 66.99it/s] 77%|███████▋  | 510/666 [00:08<00:02, 66.98it/s] 78%|███████▊  | 517/666 [00:08<00:02, 66.99it/s] 79%|███████▊  | 524/666 [00:09<00:02, 66.99it/s] 80%|███████▉  | 531/666 [00:09<00:02, 67.00it/s] 81%|████████  | 538/666 [00:09<00:01, 66.98it/s] 82%|████████▏ | 545/666 [00:09<00:01, 66.97it/s] 83%|████████▎ | 552/666 [00:09<00:01, 66.98it/s] 84%|████████▍ | 559/666 [00:09<00:01, 66.97it/s] 85%|████████▍ | 566/666 [00:09<00:01, 66.94it/s] 86%|████████▌ | 573/666 [00:09<00:01, 66.92it/s] 87%|████████▋ | 580/666 [00:09<00:01, 66.95it/s] 88%|████████▊ | 587/666 [00:09<00:01, 66.95it/s] 89%|████████▉ | 594/666 [00:10<00:01, 66.93it/s] 90%|█████████ | 601/666 [00:10<00:00, 66.95it/s] 91%|█████████▏| 608/666 [00:10<00:00, 66.98it/s] 92%|█████████▏| 615/666 [00:10<00:00, 67.00it/s] 93%|█████████▎| 622/666 [00:10<00:00, 67.00it/s] 94%|█████████▍| 629/666 [00:10<00:00, 66.99it/s] 95%|█████████▌| 636/666 [00:10<00:00, 66.93it/s] 97%|█████████▋| 643/666 [00:10<00:00, 67.00it/s] 98%|█████████▊| 650/666 [00:10<00:00, 67.02it/s] 99%|█████████▊| 657/666 [00:10<00:00, 67.02it/s]100%|█████████▉| 664/666 [00:11<00:00, 65.88it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:19,  8.65it/s][A
  6%|▌         | 10/167 [00:00<00:03, 49.64it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 124.52it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 162.95it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 184.92it/s][A
 61%|██████    | 102/167 [00:00<00:00, 198.77it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 207.84it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 213.72it/s][A100%|██████████| 167/167 [00:00<00:00, 170.22it/s]
2022-11-28 21:21:15,803 P50181 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:21:15,803 P50181 INFO Save best model: monitor(max): -4.497089
2022-11-28 21:21:16,173 P50181 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:12<00:00, 52.70it/s]
2022-11-28 21:21:16,217 P50181 INFO Train loss: 30.976341
2022-11-28 21:21:16,217 P50181 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:54,  5.81it/s]  1%|          | 7/666 [00:00<00:22, 29.93it/s]  2%|▏         | 11/666 [00:00<00:19, 33.26it/s]  3%|▎         | 18/666 [00:00<00:14, 44.59it/s]  4%|▍         | 25/666 [00:00<00:12, 51.25it/s]  5%|▍         | 32/666 [00:00<00:11, 55.39it/s]  6%|▌         | 39/666 [00:00<00:10, 58.03it/s]  7%|▋         | 46/666 [00:00<00:10, 59.82it/s]  8%|▊         | 53/666 [00:01<00:10, 60.98it/s]  9%|▉         | 60/666 [00:01<00:09, 61.80it/s] 10%|█         | 67/666 [00:01<00:09, 62.39it/s] 11%|█         | 74/666 [00:01<00:09, 62.83it/s] 12%|█▏        | 81/666 [00:01<00:09, 63.09it/s] 13%|█▎        | 88/666 [00:01<00:09, 63.29it/s] 14%|█▍        | 95/666 [00:01<00:09, 63.35it/s] 15%|█▌        | 102/666 [00:01<00:08, 63.46it/s] 16%|█▋        | 109/666 [00:01<00:08, 63.52it/s] 17%|█▋        | 116/666 [00:02<00:08, 63.58it/s] 18%|█▊        | 123/666 [00:02<00:08, 63.62it/s] 20%|█▉        | 130/666 [00:02<00:08, 63.69it/s] 21%|██        | 137/666 [00:02<00:08, 63.71it/s] 22%|██▏       | 144/666 [00:02<00:08, 63.69it/s] 23%|██▎       | 151/666 [00:02<00:08, 63.69it/s] 24%|██▎       | 158/666 [00:02<00:07, 63.68it/s] 25%|██▍       | 165/666 [00:02<00:07, 63.69it/s] 26%|██▌       | 172/666 [00:02<00:07, 63.60it/s] 27%|██▋       | 179/666 [00:03<00:07, 63.65it/s] 28%|██▊       | 186/666 [00:03<00:07, 63.69it/s] 29%|██▉       | 193/666 [00:03<00:07, 63.74it/s] 30%|███       | 200/666 [00:03<00:07, 63.73it/s] 31%|███       | 207/666 [00:03<00:07, 63.77it/s] 32%|███▏      | 214/666 [00:03<00:07, 63.75it/s] 33%|███▎      | 221/666 [00:03<00:06, 63.76it/s] 34%|███▍      | 228/666 [00:03<00:06, 63.76it/s] 35%|███▌      | 235/666 [00:03<00:06, 63.73it/s] 36%|███▋      | 242/666 [00:04<00:06, 63.74it/s] 37%|███▋      | 249/666 [00:04<00:06, 63.75it/s] 38%|███▊      | 256/666 [00:04<00:06, 63.76it/s] 39%|███▉      | 263/666 [00:04<00:06, 63.76it/s] 41%|████      | 270/666 [00:04<00:06, 63.77it/s] 42%|████▏     | 277/666 [00:04<00:06, 63.75it/s] 43%|████▎     | 284/666 [00:04<00:05, 63.76it/s] 44%|████▎     | 291/666 [00:04<00:05, 63.74it/s] 45%|████▍     | 298/666 [00:04<00:05, 63.75it/s] 46%|████▌     | 305/666 [00:04<00:05, 63.75it/s] 47%|████▋     | 312/666 [00:05<00:05, 63.77it/s] 48%|████▊     | 319/666 [00:05<00:05, 63.72it/s] 49%|████▉     | 326/666 [00:05<00:05, 63.71it/s] 50%|█████     | 333/666 [00:05<00:05, 63.69it/s] 51%|█████     | 340/666 [00:05<00:05, 63.66it/s] 52%|█████▏    | 347/666 [00:05<00:05, 63.65it/s] 53%|█████▎    | 354/666 [00:05<00:04, 63.60it/s] 54%|█████▍    | 361/666 [00:05<00:04, 63.61it/s] 55%|█████▌    | 368/666 [00:05<00:04, 63.60it/s] 56%|█████▋    | 375/666 [00:06<00:04, 63.57it/s] 57%|█████▋    | 382/666 [00:06<00:04, 63.61it/s] 58%|█████▊    | 389/666 [00:06<00:04, 63.58it/s] 59%|█████▉    | 396/666 [00:06<00:04, 63.64it/s] 61%|██████    | 403/666 [00:06<00:04, 63.62it/s] 62%|██████▏   | 410/666 [00:06<00:04, 63.62it/s] 63%|██████▎   | 417/666 [00:06<00:03, 63.57it/s] 64%|██████▎   | 424/666 [00:06<00:03, 63.61it/s] 65%|██████▍   | 431/666 [00:06<00:03, 63.61it/s] 66%|██████▌   | 438/666 [00:07<00:03, 63.67it/s] 67%|██████▋   | 445/666 [00:07<00:03, 63.64it/s] 68%|██████▊   | 452/666 [00:07<00:03, 63.67it/s] 69%|██████▉   | 459/666 [00:07<00:03, 63.66it/s] 70%|██████▉   | 466/666 [00:07<00:03, 63.66it/s] 71%|███████   | 473/666 [00:07<00:03, 63.62it/s] 72%|███████▏  | 480/666 [00:07<00:02, 63.64it/s] 73%|███████▎  | 487/666 [00:07<00:02, 63.63it/s] 74%|███████▍  | 494/666 [00:07<00:02, 63.64it/s] 75%|███████▌  | 501/666 [00:08<00:02, 63.63it/s] 76%|███████▋  | 508/666 [00:08<00:02, 63.63it/s] 77%|███████▋  | 515/666 [00:08<00:02, 63.61it/s] 78%|███████▊  | 522/666 [00:08<00:02, 63.62it/s] 79%|███████▉  | 529/666 [00:08<00:02, 63.61it/s] 80%|████████  | 536/666 [00:08<00:02, 62.85it/s] 82%|████████▏ | 543/666 [00:08<00:01, 62.89it/s] 83%|████████▎ | 550/666 [00:08<00:01, 63.04it/s] 84%|████████▎ | 557/666 [00:08<00:01, 63.24it/s] 85%|████████▍ | 564/666 [00:09<00:01, 63.31it/s] 86%|████████▌ | 571/666 [00:09<00:01, 63.46it/s] 87%|████████▋ | 578/666 [00:09<00:01, 63.50it/s] 88%|████████▊ | 585/666 [00:09<00:01, 63.57it/s] 89%|████████▉ | 592/666 [00:09<00:01, 63.57it/s] 90%|████████▉ | 599/666 [00:09<00:01, 63.62it/s] 91%|█████████ | 606/666 [00:09<00:00, 63.56it/s] 92%|█████████▏| 613/666 [00:09<00:00, 63.63it/s] 93%|█████████▎| 620/666 [00:09<00:00, 63.58it/s] 94%|█████████▍| 627/666 [00:10<00:00, 63.62it/s] 95%|█████████▌| 634/666 [00:10<00:00, 63.63it/s] 96%|█████████▌| 641/666 [00:10<00:00, 63.67it/s] 97%|█████████▋| 648/666 [00:10<00:00, 63.68it/s] 98%|█████████▊| 655/666 [00:10<00:00, 63.66it/s] 99%|█████████▉| 662/666 [00:10<00:00, 62.61it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.10it/s][A
  6%|▌         | 10/167 [00:00<00:03, 42.75it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 105.46it/s][A
 31%|███       | 52/167 [00:00<00:00, 140.44it/s][A
 44%|████▎     | 73/167 [00:00<00:00, 161.22it/s][A
 56%|█████▋    | 94/167 [00:00<00:00, 174.93it/s][A
 69%|██████▉   | 115/167 [00:00<00:00, 183.98it/s][A
 81%|████████▏ | 136/167 [00:00<00:00, 189.92it/s][A
 94%|█████████▍| 157/167 [00:00<00:00, 194.30it/s][A100%|██████████| 167/167 [00:01<00:00, 153.95it/s]
2022-11-28 21:21:28,094 P50181 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:21:28,095 P50181 INFO Monitor(max) STOP: -4.497089 !
2022-11-28 21:21:28,095 P50181 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:21:28,095 P50181 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:11<00:00, 55.83it/s]
2022-11-28 21:21:28,147 P50181 INFO Train loss: 30.976982
2022-11-28 21:21:28,147 P50181 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:53,  5.86it/s]  1%|          | 8/666 [00:00<00:19, 34.54it/s]  2%|▏         | 13/666 [00:00<00:17, 38.26it/s]  3%|▎         | 20/666 [00:00<00:13, 48.76it/s]  4%|▍         | 27/666 [00:00<00:11, 55.29it/s]  5%|▌         | 34/666 [00:00<00:10, 59.52it/s]  6%|▌         | 41/666 [00:00<00:10, 62.33it/s]  7%|▋         | 48/666 [00:00<00:09, 64.19it/s]  8%|▊         | 55/666 [00:01<00:09, 65.48it/s]  9%|▉         | 62/666 [00:01<00:09, 66.38it/s] 10%|█         | 69/666 [00:01<00:08, 66.97it/s] 11%|█▏        | 76/666 [00:01<00:08, 67.40it/s] 12%|█▏        | 83/666 [00:01<00:08, 67.65it/s] 14%|█▎        | 90/666 [00:01<00:08, 67.87it/s] 15%|█▍        | 97/666 [00:01<00:08, 68.05it/s] 16%|█▌        | 104/666 [00:01<00:08, 68.17it/s] 17%|█▋        | 111/666 [00:01<00:08, 68.25it/s] 18%|█▊        | 118/666 [00:01<00:08, 68.31it/s] 19%|█▉        | 125/666 [00:02<00:07, 68.34it/s] 20%|█▉        | 132/666 [00:02<00:07, 68.35it/s] 21%|██        | 139/666 [00:02<00:07, 68.36it/s] 22%|██▏       | 146/666 [00:02<00:07, 68.37it/s] 23%|██▎       | 153/666 [00:02<00:07, 68.39it/s] 24%|██▍       | 160/666 [00:02<00:07, 68.43it/s] 25%|██▌       | 167/666 [00:02<00:07, 68.42it/s] 26%|██▌       | 174/666 [00:02<00:07, 68.41it/s] 27%|██▋       | 181/666 [00:02<00:07, 68.40it/s] 28%|██▊       | 188/666 [00:02<00:06, 68.39it/s] 29%|██▉       | 195/666 [00:03<00:06, 68.40it/s] 30%|███       | 202/666 [00:03<00:06, 68.41it/s] 31%|███▏      | 209/666 [00:03<00:06, 68.39it/s] 32%|███▏      | 216/666 [00:03<00:06, 68.39it/s] 33%|███▎      | 223/666 [00:03<00:06, 68.41it/s] 35%|███▍      | 230/666 [00:03<00:06, 68.41it/s] 36%|███▌      | 237/666 [00:03<00:06, 68.44it/s] 37%|███▋      | 244/666 [00:03<00:06, 68.38it/s] 38%|███▊      | 251/666 [00:03<00:06, 68.39it/s] 39%|███▊      | 258/666 [00:03<00:05, 68.40it/s] 40%|███▉      | 265/666 [00:04<00:05, 68.38it/s] 41%|████      | 272/666 [00:04<00:05, 68.39it/s] 42%|████▏     | 279/666 [00:04<00:05, 68.42it/s] 43%|████▎     | 286/666 [00:04<00:05, 68.43it/s] 44%|████▍     | 293/666 [00:04<00:05, 68.46it/s] 45%|████▌     | 300/666 [00:04<00:05, 68.44it/s] 46%|████▌     | 307/666 [00:04<00:05, 68.42it/s] 47%|████▋     | 314/666 [00:04<00:05, 68.41it/s] 48%|████▊     | 321/666 [00:04<00:05, 68.39it/s] 49%|████▉     | 328/666 [00:04<00:04, 68.36it/s] 50%|█████     | 335/666 [00:05<00:04, 68.38it/s] 51%|█████▏    | 342/666 [00:05<00:04, 68.40it/s] 52%|█████▏    | 349/666 [00:05<00:04, 68.42it/s] 53%|█████▎    | 356/666 [00:05<00:04, 68.37it/s] 55%|█████▍    | 363/666 [00:05<00:04, 68.39it/s] 56%|█████▌    | 370/666 [00:05<00:04, 68.40it/s] 57%|█████▋    | 377/666 [00:05<00:04, 68.41it/s] 58%|█████▊    | 384/666 [00:05<00:04, 68.34it/s] 59%|█████▊    | 391/666 [00:05<00:04, 68.33it/s] 60%|█████▉    | 398/666 [00:06<00:03, 68.36it/s] 61%|██████    | 405/666 [00:06<00:03, 68.35it/s] 62%|██████▏   | 412/666 [00:06<00:03, 68.40it/s] 63%|██████▎   | 419/666 [00:06<00:03, 68.42it/s] 64%|██████▍   | 426/666 [00:06<00:03, 68.42it/s] 65%|██████▌   | 433/666 [00:06<00:03, 68.42it/s] 66%|██████▌   | 440/666 [00:06<00:03, 68.42it/s] 67%|██████▋   | 447/666 [00:06<00:03, 68.38it/s] 68%|██████▊   | 454/666 [00:06<00:03, 68.37it/s] 69%|██████▉   | 461/666 [00:06<00:02, 68.39it/s] 70%|███████   | 468/666 [00:07<00:02, 68.41it/s] 71%|███████▏  | 475/666 [00:07<00:02, 68.41it/s] 72%|███████▏  | 482/666 [00:07<00:02, 68.40it/s] 73%|███████▎  | 489/666 [00:07<00:02, 68.40it/s] 74%|███████▍  | 496/666 [00:07<00:02, 68.40it/s] 76%|███████▌  | 503/666 [00:07<00:02, 68.39it/s] 77%|███████▋  | 510/666 [00:07<00:02, 68.38it/s] 78%|███████▊  | 517/666 [00:07<00:02, 68.35it/s] 79%|███████▊  | 524/666 [00:07<00:02, 68.38it/s] 80%|███████▉  | 531/666 [00:07<00:01, 68.41it/s] 81%|████████  | 538/666 [00:08<00:01, 68.44it/s] 82%|████████▏ | 545/666 [00:08<00:01, 68.43it/s] 83%|████████▎ | 552/666 [00:08<00:01, 68.41it/s] 84%|████████▍ | 559/666 [00:08<00:01, 68.40it/s] 85%|████████▍ | 566/666 [00:08<00:01, 68.38it/s] 86%|████████▌ | 573/666 [00:08<00:01, 68.36it/s] 87%|████████▋ | 580/666 [00:08<00:01, 68.31it/s] 88%|████████▊ | 587/666 [00:08<00:01, 68.37it/s] 89%|████████▉ | 594/666 [00:08<00:01, 68.39it/s] 90%|█████████ | 601/666 [00:08<00:00, 68.40it/s] 91%|█████████▏| 608/666 [00:09<00:00, 68.39it/s] 92%|█████████▏| 615/666 [00:09<00:00, 68.40it/s] 93%|█████████▎| 622/666 [00:09<00:00, 68.40it/s] 94%|█████████▍| 629/666 [00:09<00:00, 68.40it/s] 95%|█████████▌| 636/666 [00:09<00:00, 68.38it/s] 97%|█████████▋| 643/666 [00:09<00:00, 68.36it/s] 98%|█████████▊| 650/666 [00:09<00:00, 68.39it/s] 99%|█████████▊| 657/666 [00:09<00:00, 68.37it/s]100%|█████████▉| 664/666 [00:09<00:00, 67.23it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.20it/s][A
  6%|▌         | 10/167 [00:00<00:03, 52.09it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 128.65it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 168.44it/s][A
 48%|████▊     | 80/167 [00:00<00:00, 189.68it/s][A
 62%|██████▏   | 104/167 [00:00<00:00, 203.57it/s][A
 77%|███████▋  | 128/167 [00:00<00:00, 212.80it/s][A
 91%|█████████ | 152/167 [00:00<00:00, 218.51it/s][A100%|██████████| 167/167 [00:00<00:00, 174.95it/s]
2022-11-28 21:21:39,158 P50181 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:21:39,158 P50181 INFO Monitor(max) STOP: -4.497089 !
2022-11-28 21:21:39,158 P50181 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:21:39,158 P50181 INFO Early stopping at epoch=3
2022-11-28 21:21:39,158 P50181 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:11<00:00, 60.11it/s]
2022-11-28 21:21:39,212 P50181 INFO Train loss: 30.974828
2022-11-28 21:21:39,212 P50181 INFO Training finished.
2022-11-28 21:21:39,212 P50181 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_004_7764bf1e.model
2022-11-28 21:21:39,469 P50181 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:50,  6.01it/s]  2%|▏         | 10/666 [00:00<00:15, 41.35it/s]  5%|▍         | 33/666 [00:00<00:05, 111.78it/s]  8%|▊         | 55/666 [00:00<00:04, 149.49it/s] 12%|█▏        | 78/666 [00:00<00:03, 173.78it/s] 15%|█▌        | 100/666 [00:00<00:03, 188.49it/s] 18%|█▊        | 121/666 [00:00<00:02, 194.37it/s] 21%|██▏       | 142/666 [00:00<00:02, 195.31it/s] 24%|██▍       | 162/666 [00:01<00:02, 195.98it/s] 27%|██▋       | 182/666 [00:01<00:02, 195.99it/s] 30%|███       | 202/666 [00:01<00:02, 195.49it/s] 33%|███▎      | 222/666 [00:01<00:02, 195.84it/s] 36%|███▋      | 242/666 [00:01<00:02, 196.10it/s] 39%|███▉      | 262/666 [00:01<00:02, 196.51it/s] 42%|████▏     | 282/666 [00:01<00:01, 196.67it/s] 45%|████▌     | 302/666 [00:01<00:01, 196.81it/s] 48%|████▊     | 322/666 [00:01<00:01, 196.99it/s] 51%|█████▏    | 342/666 [00:01<00:01, 197.14it/s] 54%|█████▍    | 362/666 [00:02<00:01, 195.56it/s] 57%|█████▋    | 382/666 [00:02<00:01, 196.11it/s] 60%|██████    | 402/666 [00:02<00:01, 196.39it/s] 63%|██████▎   | 422/666 [00:02<00:01, 196.56it/s] 66%|██████▋   | 442/666 [00:02<00:01, 196.65it/s] 69%|██████▉   | 462/666 [00:02<00:01, 196.80it/s] 72%|███████▏  | 482/666 [00:02<00:00, 196.85it/s] 75%|███████▌  | 502/666 [00:02<00:00, 196.82it/s] 78%|███████▊  | 522/666 [00:02<00:00, 196.99it/s] 81%|████████▏ | 542/666 [00:02<00:00, 196.96it/s] 84%|████████▍ | 562/666 [00:03<00:00, 197.01it/s] 87%|████████▋ | 582/666 [00:03<00:00, 196.91it/s] 90%|█████████ | 602/666 [00:03<00:00, 196.94it/s] 93%|█████████▎| 622/666 [00:03<00:00, 196.82it/s] 96%|█████████▋| 642/666 [00:03<00:00, 196.83it/s] 99%|█████████▉| 662/666 [00:03<00:00, 193.90it/s]100%|██████████| 666/666 [00:03<00:00, 184.11it/s]
2022-11-28 21:21:43,541 P50181 INFO [Metrics] logloss: 4.992712 - AUC: 0.500001
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:18,  8.85it/s]  6%|▌         | 10/167 [00:00<00:02, 52.37it/s] 19%|█▊        | 31/167 [00:00<00:01, 120.73it/s] 32%|███▏      | 54/167 [00:00<00:00, 160.26it/s] 46%|████▌     | 76/167 [00:00<00:00, 179.25it/s] 59%|█████▉    | 99/167 [00:00<00:00, 193.82it/s] 73%|███████▎  | 122/167 [00:00<00:00, 202.83it/s] 87%|████████▋ | 145/167 [00:00<00:00, 208.93it/s]100%|██████████| 167/167 [00:00<00:00, 170.41it/s]
2022-11-28 21:21:44,633 P50181 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:21:51,034 P51966 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "128",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_005_9462a6b6",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:21:51,035 P51966 INFO Set up feature encoder...
2022-11-28 21:21:51,036 P51966 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:21:51,036 P51966 INFO Loading data...
2022-11-28 21:21:51,039 P51966 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:21:51,290 P51966 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:21:51,384 P51966 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:21:51,385 P51966 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:21:51,385 P51966 INFO Loading train data done.
2022-11-28 21:21:54,406 P51966 INFO Total number of parameters: 29989252.
2022-11-28 21:21:54,406 P51966 INFO Start training: 666 batches/epoch
2022-11-28 21:21:54,406 P51966 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:21:54.734 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:51966 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:21:54.765 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:51966 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:23,  1.12s/it]  1%|          | 6/666 [00:01<01:44,  6.31it/s]  2%|▏         | 11/666 [00:01<00:54, 12.03it/s]  2%|▏         | 15/666 [00:01<00:39, 16.43it/s]  3%|▎         | 20/666 [00:01<00:28, 22.30it/s]  4%|▍         | 25/666 [00:01<00:23, 27.54it/s]  5%|▍         | 30/666 [00:01<00:19, 32.03it/s]  5%|▌         | 35/666 [00:01<00:17, 35.66it/s]  6%|▌         | 40/666 [00:01<00:16, 38.48it/s]  7%|▋         | 45/666 [00:02<00:15, 40.65it/s]  8%|▊         | 50/666 [00:02<00:14, 42.26it/s]  8%|▊         | 55/666 [00:02<00:14, 43.42it/s]  9%|▉         | 60/666 [00:02<00:13, 44.27it/s] 10%|▉         | 65/666 [00:02<00:13, 43.71it/s] 11%|█         | 70/666 [00:02<00:13, 44.45it/s] 11%|█▏        | 75/666 [00:02<00:13, 45.01it/s] 12%|█▏        | 80/666 [00:02<00:12, 45.40it/s] 13%|█▎        | 85/666 [00:02<00:12, 45.66it/s] 14%|█▎        | 90/666 [00:03<00:12, 45.85it/s] 14%|█▍        | 95/666 [00:03<00:12, 45.99it/s] 15%|█▌        | 100/666 [00:03<00:12, 46.07it/s] 16%|█▌        | 105/666 [00:03<00:12, 46.15it/s] 17%|█▋        | 110/666 [00:03<00:12, 46.18it/s] 17%|█▋        | 115/666 [00:03<00:11, 46.18it/s] 18%|█▊        | 120/666 [00:03<00:11, 46.24it/s] 19%|█▉        | 125/666 [00:03<00:11, 46.27it/s] 20%|█▉        | 130/666 [00:03<00:11, 46.25it/s] 20%|██        | 135/666 [00:04<00:11, 46.28it/s] 21%|██        | 140/666 [00:04<00:11, 46.28it/s] 22%|██▏       | 145/666 [00:04<00:11, 46.32it/s] 23%|██▎       | 150/666 [00:04<00:11, 46.34it/s] 23%|██▎       | 155/666 [00:04<00:11, 46.33it/s] 24%|██▍       | 160/666 [00:04<00:10, 46.32it/s] 25%|██▍       | 165/666 [00:04<00:10, 46.33it/s] 26%|██▌       | 170/666 [00:04<00:10, 46.34it/s] 26%|██▋       | 175/666 [00:04<00:10, 46.34it/s] 27%|██▋       | 180/666 [00:05<00:10, 46.33it/s] 28%|██▊       | 185/666 [00:05<00:10, 46.32it/s] 29%|██▊       | 190/666 [00:05<00:10, 46.30it/s] 29%|██▉       | 195/666 [00:05<00:10, 46.30it/s] 30%|███       | 200/666 [00:05<00:10, 46.31it/s] 31%|███       | 205/666 [00:05<00:09, 46.24it/s] 32%|███▏      | 210/666 [00:05<00:09, 46.22it/s] 32%|███▏      | 215/666 [00:05<00:09, 46.25it/s] 33%|███▎      | 220/666 [00:05<00:09, 46.26it/s] 34%|███▍      | 225/666 [00:06<00:09, 46.28it/s] 35%|███▍      | 230/666 [00:06<00:09, 46.29it/s] 35%|███▌      | 235/666 [00:06<00:09, 46.28it/s] 36%|███▌      | 240/666 [00:06<00:09, 46.29it/s] 37%|███▋      | 245/666 [00:06<00:09, 46.32it/s] 38%|███▊      | 250/666 [00:06<00:08, 46.27it/s] 38%|███▊      | 255/666 [00:06<00:08, 46.27it/s] 39%|███▉      | 260/666 [00:06<00:08, 46.29it/s] 40%|███▉      | 265/666 [00:06<00:08, 46.30it/s] 41%|████      | 270/666 [00:06<00:08, 46.32it/s] 41%|████▏     | 275/666 [00:07<00:08, 45.53it/s] 42%|████▏     | 280/666 [00:07<00:08, 45.77it/s] 43%|████▎     | 285/666 [00:07<00:08, 45.92it/s] 44%|████▎     | 290/666 [00:07<00:08, 46.06it/s] 44%|████▍     | 295/666 [00:07<00:08, 46.11it/s] 45%|████▌     | 300/666 [00:07<00:07, 46.17it/s] 46%|████▌     | 305/666 [00:07<00:07, 46.22it/s] 47%|████▋     | 310/666 [00:07<00:07, 46.24it/s] 47%|████▋     | 315/666 [00:07<00:07, 46.26it/s] 48%|████▊     | 320/666 [00:08<00:07, 46.25it/s] 49%|████▉     | 325/666 [00:08<00:07, 46.27it/s] 50%|████▉     | 330/666 [00:08<00:07, 46.27it/s] 50%|█████     | 335/666 [00:08<00:07, 46.31it/s] 51%|█████     | 340/666 [00:08<00:07, 46.31it/s] 52%|█████▏    | 345/666 [00:08<00:06, 46.30it/s] 53%|█████▎    | 350/666 [00:08<00:06, 46.29it/s] 53%|█████▎    | 355/666 [00:08<00:06, 46.29it/s] 54%|█████▍    | 360/666 [00:08<00:06, 46.31it/s] 55%|█████▍    | 365/666 [00:09<00:06, 46.32it/s] 56%|█████▌    | 370/666 [00:09<00:06, 46.31it/s] 56%|█████▋    | 375/666 [00:09<00:06, 46.27it/s] 57%|█████▋    | 380/666 [00:09<00:06, 46.25it/s] 58%|█████▊    | 385/666 [00:09<00:06, 46.22it/s] 59%|█████▊    | 390/666 [00:09<00:05, 46.21it/s] 59%|█████▉    | 395/666 [00:09<00:05, 46.17it/s] 60%|██████    | 400/666 [00:09<00:05, 46.20it/s] 61%|██████    | 405/666 [00:09<00:05, 46.25it/s] 62%|██████▏   | 410/666 [00:10<00:05, 46.27it/s] 62%|██████▏   | 415/666 [00:10<00:05, 46.26it/s] 63%|██████▎   | 420/666 [00:10<00:05, 46.27it/s] 64%|██████▍   | 425/666 [00:10<00:05, 46.28it/s] 65%|██████▍   | 430/666 [00:10<00:05, 46.27it/s] 65%|██████▌   | 435/666 [00:10<00:04, 46.29it/s] 66%|██████▌   | 440/666 [00:10<00:04, 46.24it/s] 67%|██████▋   | 445/666 [00:10<00:04, 46.20it/s] 68%|██████▊   | 450/666 [00:10<00:04, 46.26it/s] 68%|██████▊   | 455/666 [00:10<00:04, 46.27it/s] 69%|██████▉   | 460/666 [00:11<00:04, 46.28it/s] 70%|██████▉   | 465/666 [00:11<00:04, 46.29it/s] 71%|███████   | 470/666 [00:11<00:04, 46.28it/s] 71%|███████▏  | 475/666 [00:11<00:04, 46.27it/s] 72%|███████▏  | 480/666 [00:11<00:04, 46.29it/s] 73%|███████▎  | 485/666 [00:11<00:03, 46.30it/s] 74%|███████▎  | 490/666 [00:11<00:03, 46.29it/s] 74%|███████▍  | 495/666 [00:11<00:03, 46.29it/s] 75%|███████▌  | 500/666 [00:11<00:03, 46.27it/s] 76%|███████▌  | 505/666 [00:12<00:03, 46.28it/s] 77%|███████▋  | 510/666 [00:12<00:03, 46.28it/s] 77%|███████▋  | 515/666 [00:12<00:03, 46.30it/s] 78%|███████▊  | 520/666 [00:12<00:03, 46.30it/s] 79%|███████▉  | 525/666 [00:12<00:03, 46.31it/s] 80%|███████▉  | 530/666 [00:12<00:02, 46.31it/s] 80%|████████  | 535/666 [00:12<00:02, 46.28it/s] 81%|████████  | 540/666 [00:12<00:02, 46.27it/s] 82%|████████▏ | 545/666 [00:12<00:02, 46.28it/s] 83%|████████▎ | 550/666 [00:13<00:02, 46.28it/s] 83%|████████▎ | 555/666 [00:13<00:02, 46.30it/s] 84%|████████▍ | 560/666 [00:13<00:02, 46.30it/s] 85%|████████▍ | 565/666 [00:13<00:02, 46.29it/s] 86%|████████▌ | 570/666 [00:13<00:02, 46.29it/s] 86%|████████▋ | 575/666 [00:13<00:01, 46.30it/s] 87%|████████▋ | 580/666 [00:13<00:01, 46.25it/s] 88%|████████▊ | 585/666 [00:13<00:01, 46.25it/s] 89%|████████▊ | 590/666 [00:13<00:01, 46.27it/s] 89%|████████▉ | 595/666 [00:14<00:01, 46.26it/s] 90%|█████████ | 600/666 [00:14<00:01, 46.28it/s] 91%|█████████ | 605/666 [00:14<00:01, 46.29it/s] 92%|█████████▏| 610/666 [00:14<00:01, 46.28it/s] 92%|█████████▏| 615/666 [00:14<00:01, 46.28it/s] 93%|█████████▎| 620/666 [00:14<00:00, 46.28it/s] 94%|█████████▍| 625/666 [00:14<00:00, 46.27it/s] 95%|█████████▍| 630/666 [00:14<00:00, 46.27it/s] 95%|█████████▌| 635/666 [00:14<00:00, 46.28it/s] 96%|█████████▌| 640/666 [00:14<00:00, 46.28it/s] 97%|█████████▋| 645/666 [00:15<00:00, 46.29it/s] 98%|█████████▊| 650/666 [00:15<00:00, 46.31it/s] 98%|█████████▊| 655/666 [00:15<00:00, 46.29it/s] 99%|█████████▉| 660/666 [00:15<00:00, 45.38it/s]100%|█████████▉| 665/666 [00:15<00:00, 45.86it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.29it/s][A
  5%|▌         | 9/167 [00:00<00:03, 45.63it/s][A
 10%|█         | 17/167 [00:00<00:02, 59.91it/s][A
 24%|██▍       | 40/167 [00:00<00:01, 123.51it/s][A
 38%|███▊      | 63/167 [00:00<00:00, 159.74it/s][A
 51%|█████▏    | 86/167 [00:00<00:00, 182.01it/s][A
 65%|██████▌   | 109/167 [00:00<00:00, 196.68it/s][A
 79%|███████▉  | 132/167 [00:00<00:00, 206.64it/s][A
 93%|█████████▎| 155/167 [00:00<00:00, 213.18it/s][A100%|██████████| 167/167 [00:01<00:00, 162.18it/s]
2022-11-28 21:22:11,094 P51966 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:22:11,094 P51966 INFO Save best model: monitor(max): -4.497234
2022-11-28 21:22:12,119 P51966 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:17<00:00, 37.52it/s]
2022-11-28 21:22:12,158 P51966 INFO Train loss: 30.972238
2022-11-28 21:22:12,158 P51966 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:57,  5.65it/s]  1%|          | 5/666 [00:00<00:31, 20.98it/s]  2%|▏         | 10/666 [00:00<00:22, 29.47it/s]  2%|▏         | 15/666 [00:00<00:19, 34.15it/s]  3%|▎         | 20/666 [00:00<00:16, 38.27it/s]  4%|▍         | 25/666 [00:00<00:15, 40.88it/s]  5%|▍         | 30/666 [00:00<00:14, 42.65it/s]  5%|▌         | 35/666 [00:00<00:14, 43.85it/s]  6%|▌         | 40/666 [00:01<00:14, 44.66it/s]  7%|▋         | 45/666 [00:01<00:13, 45.24it/s]  8%|▊         | 50/666 [00:01<00:13, 45.62it/s]  8%|▊         | 55/666 [00:01<00:13, 45.90it/s]  9%|▉         | 60/666 [00:01<00:13, 46.11it/s] 10%|▉         | 65/666 [00:01<00:12, 46.25it/s] 11%|█         | 70/666 [00:01<00:12, 46.34it/s] 11%|█▏        | 75/666 [00:01<00:12, 46.42it/s] 12%|█▏        | 80/666 [00:01<00:12, 46.48it/s] 13%|█▎        | 85/666 [00:02<00:12, 46.49it/s] 14%|█▎        | 90/666 [00:02<00:12, 46.51it/s] 14%|█▍        | 95/666 [00:02<00:12, 46.50it/s] 15%|█▌        | 100/666 [00:02<00:12, 46.43it/s] 16%|█▌        | 105/666 [00:02<00:12, 46.47it/s] 17%|█▋        | 110/666 [00:02<00:11, 46.48it/s] 17%|█▋        | 115/666 [00:02<00:11, 46.52it/s] 18%|█▊        | 120/666 [00:02<00:11, 46.55it/s] 19%|█▉        | 125/666 [00:02<00:11, 46.56it/s] 20%|█▉        | 130/666 [00:02<00:11, 46.57it/s] 20%|██        | 135/666 [00:03<00:11, 46.58it/s] 21%|██        | 140/666 [00:03<00:11, 46.58it/s] 22%|██▏       | 145/666 [00:03<00:11, 46.56it/s] 23%|██▎       | 150/666 [00:03<00:11, 46.59it/s] 23%|██▎       | 155/666 [00:03<00:10, 46.59it/s] 24%|██▍       | 160/666 [00:03<00:10, 46.59it/s] 25%|██▍       | 165/666 [00:03<00:10, 46.59it/s] 26%|██▌       | 170/666 [00:03<00:10, 46.59it/s] 26%|██▋       | 175/666 [00:03<00:10, 46.56it/s] 27%|██▋       | 180/666 [00:04<00:10, 46.58it/s] 28%|██▊       | 185/666 [00:04<00:10, 46.59it/s] 29%|██▊       | 190/666 [00:04<00:10, 46.56it/s] 29%|██▉       | 195/666 [00:04<00:10, 46.56it/s] 30%|███       | 200/666 [00:04<00:10, 46.58it/s] 31%|███       | 205/666 [00:04<00:09, 46.56it/s] 32%|███▏      | 210/666 [00:04<00:09, 46.58it/s] 32%|███▏      | 215/666 [00:04<00:09, 46.57it/s] 33%|███▎      | 220/666 [00:04<00:09, 46.57it/s] 34%|███▍      | 225/666 [00:05<00:09, 46.55it/s] 35%|███▍      | 230/666 [00:05<00:09, 46.56it/s] 35%|███▌      | 235/666 [00:05<00:09, 46.54it/s] 36%|███▌      | 240/666 [00:05<00:09, 46.55it/s] 37%|███▋      | 245/666 [00:05<00:09, 46.56it/s] 38%|███▊      | 250/666 [00:05<00:08, 46.58it/s] 38%|███▊      | 255/666 [00:05<00:08, 46.57it/s] 39%|███▉      | 260/666 [00:05<00:08, 46.56it/s] 40%|███▉      | 265/666 [00:05<00:08, 46.56it/s] 41%|████      | 270/666 [00:05<00:08, 46.56it/s] 41%|████▏     | 275/666 [00:06<00:08, 46.58it/s] 42%|████▏     | 280/666 [00:06<00:08, 46.57it/s] 43%|████▎     | 285/666 [00:06<00:08, 46.58it/s] 44%|████▎     | 290/666 [00:06<00:08, 46.56it/s] 44%|████▍     | 295/666 [00:06<00:07, 46.55it/s] 45%|████▌     | 300/666 [00:06<00:07, 46.55it/s] 46%|████▌     | 305/666 [00:06<00:07, 46.58it/s] 47%|████▋     | 310/666 [00:06<00:07, 46.58it/s] 47%|████▋     | 315/666 [00:06<00:07, 46.56it/s] 48%|████▊     | 320/666 [00:07<00:07, 46.55it/s] 49%|████▉     | 325/666 [00:07<00:07, 46.55it/s] 50%|████▉     | 330/666 [00:07<00:07, 46.57it/s] 50%|█████     | 335/666 [00:07<00:07, 46.56it/s] 51%|█████     | 340/666 [00:07<00:06, 46.58it/s] 52%|█████▏    | 345/666 [00:07<00:06, 46.58it/s] 53%|█████▎    | 350/666 [00:07<00:06, 46.57it/s] 53%|█████▎    | 355/666 [00:07<00:06, 46.55it/s] 54%|█████▍    | 360/666 [00:07<00:06, 46.55it/s] 55%|█████▍    | 365/666 [00:08<00:06, 46.54it/s] 56%|█████▌    | 370/666 [00:08<00:06, 46.55it/s] 56%|█████▋    | 375/666 [00:08<00:06, 46.56it/s] 57%|█████▋    | 380/666 [00:08<00:06, 46.55it/s] 58%|█████▊    | 385/666 [00:08<00:06, 46.56it/s] 59%|█████▊    | 390/666 [00:08<00:05, 46.56it/s] 59%|█████▉    | 395/666 [00:08<00:05, 46.57it/s] 60%|██████    | 400/666 [00:08<00:05, 46.58it/s] 61%|██████    | 405/666 [00:08<00:05, 46.58it/s] 62%|██████▏   | 410/666 [00:09<00:05, 46.57it/s] 62%|██████▏   | 415/666 [00:09<00:05, 46.58it/s] 63%|██████▎   | 420/666 [00:09<00:05, 46.56it/s] 64%|██████▍   | 425/666 [00:09<00:05, 46.55it/s] 65%|██████▍   | 430/666 [00:09<00:05, 46.56it/s] 65%|██████▌   | 435/666 [00:09<00:04, 46.57it/s] 66%|██████▌   | 440/666 [00:09<00:04, 46.57it/s] 67%|██████▋   | 445/666 [00:09<00:04, 46.57it/s] 68%|██████▊   | 450/666 [00:09<00:04, 46.57it/s] 68%|██████▊   | 455/666 [00:09<00:04, 46.58it/s] 69%|██████▉   | 460/666 [00:10<00:04, 46.57it/s] 70%|██████▉   | 465/666 [00:10<00:04, 46.60it/s] 71%|███████   | 470/666 [00:10<00:04, 46.60it/s] 71%|███████▏  | 475/666 [00:10<00:04, 46.60it/s] 72%|███████▏  | 480/666 [00:10<00:03, 46.59it/s] 73%|███████▎  | 485/666 [00:10<00:03, 46.59it/s] 74%|███████▎  | 490/666 [00:10<00:03, 46.57it/s] 74%|███████▍  | 495/666 [00:10<00:03, 46.56it/s] 75%|███████▌  | 500/666 [00:10<00:03, 46.57it/s] 76%|███████▌  | 505/666 [00:11<00:03, 46.57it/s] 77%|███████▋  | 510/666 [00:11<00:03, 46.56it/s] 77%|███████▋  | 515/666 [00:11<00:03, 46.56it/s] 78%|███████▊  | 520/666 [00:11<00:03, 46.56it/s] 79%|███████▉  | 525/666 [00:11<00:03, 46.57it/s] 80%|███████▉  | 530/666 [00:11<00:02, 46.59it/s] 80%|████████  | 535/666 [00:11<00:02, 46.15it/s] 81%|████████  | 540/666 [00:11<00:02, 46.12it/s] 82%|████████▏ | 545/666 [00:11<00:02, 46.41it/s] 83%|████████▎ | 550/666 [00:12<00:02, 46.43it/s] 83%|████████▎ | 555/666 [00:12<00:02, 46.51it/s] 84%|████████▍ | 560/666 [00:12<00:02, 46.54it/s] 85%|████████▍ | 565/666 [00:12<00:02, 46.52it/s] 86%|████████▌ | 570/666 [00:12<00:02, 46.51it/s] 86%|████████▋ | 575/666 [00:12<00:01, 46.53it/s] 87%|████████▋ | 580/666 [00:12<00:01, 46.54it/s] 88%|████████▊ | 585/666 [00:12<00:01, 46.56it/s] 89%|████████▊ | 590/666 [00:12<00:01, 46.57it/s] 89%|████████▉ | 595/666 [00:12<00:01, 46.57it/s] 90%|█████████ | 600/666 [00:13<00:01, 46.57it/s] 91%|█████████ | 605/666 [00:13<00:01, 46.57it/s] 92%|█████████▏| 610/666 [00:13<00:01, 46.57it/s] 92%|█████████▏| 615/666 [00:13<00:01, 46.59it/s] 93%|█████████▎| 620/666 [00:13<00:00, 46.60it/s] 94%|█████████▍| 625/666 [00:13<00:00, 46.59it/s] 95%|█████████▍| 630/666 [00:13<00:00, 46.58it/s] 95%|█████████▌| 635/666 [00:13<00:00, 46.59it/s] 96%|█████████▌| 640/666 [00:13<00:00, 46.57it/s] 97%|█████████▋| 645/666 [00:14<00:00, 46.59it/s] 98%|█████████▊| 650/666 [00:14<00:00, 46.58it/s] 98%|█████████▊| 655/666 [00:14<00:00, 46.58it/s] 99%|█████████▉| 660/666 [00:14<00:00, 45.78it/s]100%|█████████▉| 665/666 [00:14<00:00, 46.17it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.87it/s][A
  6%|▌         | 10/167 [00:00<00:03, 43.86it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 115.95it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 155.20it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 179.13it/s][A
 61%|██████    | 102/167 [00:00<00:00, 194.63it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 204.75it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 211.56it/s][A100%|██████████| 167/167 [00:01<00:00, 166.20it/s]
2022-11-28 21:22:27,784 P51966 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:22:27,784 P51966 INFO Monitor(max) STOP: -4.497234 !
2022-11-28 21:22:27,785 P51966 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:22:27,785 P51966 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:15<00:00, 42.48it/s]
2022-11-28 21:22:27,835 P51966 INFO Train loss: 30.969909
2022-11-28 21:22:27,836 P51966 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:54,  5.82it/s]  1%|          | 6/666 [00:00<00:26, 24.67it/s]  2%|▏         | 10/666 [00:00<00:21, 30.01it/s]  2%|▏         | 15/666 [00:00<00:18, 35.53it/s]  3%|▎         | 20/666 [00:00<00:16, 39.11it/s]  4%|▍         | 25/666 [00:00<00:15, 41.21it/s]  5%|▍         | 30/666 [00:00<00:14, 42.58it/s]  5%|▌         | 35/666 [00:00<00:14, 43.49it/s]  6%|▌         | 40/666 [00:01<00:14, 44.11it/s]  7%|▋         | 45/666 [00:01<00:13, 44.50it/s]  8%|▊         | 50/666 [00:01<00:13, 44.80it/s]  8%|▊         | 55/666 [00:01<00:13, 44.99it/s]  9%|▉         | 60/666 [00:01<00:13, 45.12it/s] 10%|▉         | 65/666 [00:01<00:13, 45.23it/s] 11%|█         | 70/666 [00:01<00:13, 45.31it/s] 11%|█▏        | 75/666 [00:01<00:13, 45.36it/s] 12%|█▏        | 80/666 [00:01<00:12, 45.37it/s] 13%|█▎        | 85/666 [00:02<00:12, 45.40it/s] 14%|█▎        | 90/666 [00:02<00:12, 45.43it/s] 14%|█▍        | 95/666 [00:02<00:12, 45.43it/s] 15%|█▌        | 100/666 [00:02<00:12, 45.45it/s] 16%|█▌        | 105/666 [00:02<00:12, 45.45it/s] 17%|█▋        | 110/666 [00:02<00:12, 45.45it/s] 17%|█▋        | 115/666 [00:02<00:12, 45.46it/s] 18%|█▊        | 120/666 [00:02<00:12, 45.44it/s] 19%|█▉        | 125/666 [00:02<00:11, 45.44it/s] 20%|█▉        | 130/666 [00:03<00:11, 45.45it/s] 20%|██        | 135/666 [00:03<00:11, 45.45it/s] 21%|██        | 140/666 [00:03<00:11, 45.46it/s] 22%|██▏       | 145/666 [00:03<00:11, 45.44it/s] 23%|██▎       | 150/666 [00:03<00:11, 45.46it/s] 23%|██▎       | 155/666 [00:03<00:11, 45.45it/s] 24%|██▍       | 160/666 [00:03<00:11, 45.46it/s] 25%|██▍       | 165/666 [00:03<00:11, 45.43it/s] 26%|██▌       | 170/666 [00:03<00:10, 45.45it/s] 26%|██▋       | 175/666 [00:04<00:10, 45.45it/s] 27%|██▋       | 180/666 [00:04<00:10, 45.46it/s] 28%|██▊       | 185/666 [00:04<00:10, 45.46it/s] 29%|██▊       | 190/666 [00:04<00:10, 45.44it/s] 29%|██▉       | 195/666 [00:04<00:10, 45.44it/s] 30%|███       | 200/666 [00:04<00:10, 45.46it/s] 31%|███       | 205/666 [00:04<00:10, 45.45it/s] 32%|███▏      | 210/666 [00:04<00:10, 45.46it/s] 32%|███▏      | 215/666 [00:04<00:09, 45.46it/s] 33%|███▎      | 220/666 [00:05<00:09, 45.46it/s] 34%|███▍      | 225/666 [00:05<00:09, 45.45it/s] 35%|███▍      | 230/666 [00:05<00:09, 45.46it/s] 35%|███▌      | 235/666 [00:05<00:09, 45.45it/s] 36%|███▌      | 240/666 [00:05<00:09, 45.46it/s] 37%|███▋      | 245/666 [00:05<00:09, 45.45it/s] 38%|███▊      | 250/666 [00:05<00:09, 45.48it/s] 38%|███▊      | 255/666 [00:05<00:09, 45.46it/s] 39%|███▉      | 260/666 [00:05<00:08, 45.46it/s] 40%|███▉      | 265/666 [00:05<00:08, 45.45it/s] 41%|████      | 270/666 [00:06<00:08, 45.46it/s] 41%|████▏     | 275/666 [00:06<00:08, 45.46it/s] 42%|████▏     | 280/666 [00:06<00:08, 45.47it/s] 43%|████▎     | 285/666 [00:06<00:08, 45.45it/s] 44%|████▎     | 290/666 [00:06<00:08, 45.46it/s] 44%|████▍     | 295/666 [00:06<00:08, 45.43it/s] 45%|████▌     | 300/666 [00:06<00:08, 45.45it/s] 46%|████▌     | 305/666 [00:06<00:07, 45.45it/s] 47%|████▋     | 310/666 [00:06<00:07, 45.47it/s] 47%|████▋     | 315/666 [00:07<00:07, 45.45it/s] 48%|████▊     | 320/666 [00:07<00:07, 45.45it/s] 49%|████▉     | 325/666 [00:07<00:07, 45.45it/s] 50%|████▉     | 330/666 [00:07<00:07, 45.43it/s] 50%|█████     | 335/666 [00:07<00:07, 45.46it/s] 51%|█████     | 340/666 [00:07<00:07, 45.48it/s] 52%|█████▏    | 345/666 [00:07<00:07, 45.45it/s] 53%|█████▎    | 350/666 [00:07<00:06, 45.47it/s] 53%|█████▎    | 355/666 [00:07<00:06, 45.45it/s] 54%|█████▍    | 360/666 [00:08<00:06, 45.44it/s] 55%|█████▍    | 365/666 [00:08<00:06, 45.45it/s] 56%|█████▌    | 370/666 [00:08<00:06, 45.47it/s] 56%|█████▋    | 375/666 [00:08<00:06, 45.46it/s] 57%|█████▋    | 380/666 [00:08<00:06, 45.47it/s] 58%|█████▊    | 385/666 [00:08<00:06, 45.45it/s] 59%|█████▊    | 390/666 [00:08<00:06, 45.45it/s] 59%|█████▉    | 395/666 [00:08<00:05, 45.45it/s] 60%|██████    | 400/666 [00:08<00:05, 45.45it/s] 61%|██████    | 405/666 [00:09<00:05, 45.45it/s] 62%|██████▏   | 410/666 [00:09<00:05, 45.46it/s] 62%|██████▏   | 415/666 [00:09<00:05, 45.45it/s] 63%|██████▎   | 420/666 [00:09<00:05, 45.45it/s] 64%|██████▍   | 425/666 [00:09<00:05, 45.44it/s] 65%|██████▍   | 430/666 [00:09<00:05, 45.46it/s] 65%|██████▌   | 435/666 [00:09<00:05, 45.47it/s] 66%|██████▌   | 440/666 [00:09<00:04, 45.46it/s] 67%|██████▋   | 445/666 [00:09<00:04, 45.45it/s] 68%|██████▊   | 450/666 [00:10<00:04, 45.45it/s] 68%|██████▊   | 455/666 [00:10<00:04, 45.44it/s] 69%|██████▉   | 460/666 [00:10<00:04, 45.46it/s] 70%|██████▉   | 465/666 [00:10<00:04, 45.44it/s] 71%|███████   | 470/666 [00:10<00:04, 45.47it/s] 71%|███████▏  | 475/666 [00:10<00:04, 45.46it/s] 72%|███████▏  | 480/666 [00:10<00:04, 45.47it/s] 73%|███████▎  | 485/666 [00:10<00:03, 45.45it/s] 74%|███████▎  | 490/666 [00:10<00:03, 45.45it/s] 74%|███████▍  | 495/666 [00:11<00:03, 45.45it/s] 75%|███████▌  | 500/666 [00:11<00:03, 45.46it/s] 76%|███████▌  | 505/666 [00:11<00:03, 45.44it/s] 77%|███████▋  | 510/666 [00:11<00:03, 45.45it/s] 77%|███████▋  | 515/666 [00:11<00:03, 45.44it/s] 78%|███████▊  | 520/666 [00:11<00:03, 45.45it/s] 79%|███████▉  | 525/666 [00:11<00:03, 45.47it/s] 80%|███████▉  | 530/666 [00:11<00:02, 45.47it/s] 80%|████████  | 535/666 [00:11<00:02, 45.46it/s] 81%|████████  | 540/666 [00:12<00:02, 45.43it/s] 82%|████████▏ | 545/666 [00:12<00:02, 45.44it/s] 83%|████████▎ | 550/666 [00:12<00:02, 45.46it/s] 83%|████████▎ | 555/666 [00:12<00:02, 45.46it/s] 84%|████████▍ | 560/666 [00:12<00:02, 45.46it/s] 85%|████████▍ | 565/666 [00:12<00:02, 45.45it/s] 86%|████████▌ | 570/666 [00:12<00:02, 45.45it/s] 86%|████████▋ | 575/666 [00:12<00:02, 45.46it/s] 87%|████████▋ | 580/666 [00:12<00:01, 45.46it/s] 88%|████████▊ | 585/666 [00:13<00:01, 45.45it/s] 89%|████████▊ | 590/666 [00:13<00:01, 45.45it/s] 89%|████████▉ | 595/666 [00:13<00:01, 45.47it/s] 90%|█████████ | 600/666 [00:13<00:01, 45.46it/s] 91%|█████████ | 605/666 [00:13<00:01, 45.46it/s] 92%|█████████▏| 610/666 [00:13<00:01, 45.46it/s] 92%|█████████▏| 615/666 [00:13<00:01, 45.47it/s] 93%|█████████▎| 620/666 [00:13<00:01, 45.46it/s] 94%|█████████▍| 625/666 [00:13<00:00, 45.44it/s] 95%|█████████▍| 630/666 [00:14<00:00, 45.44it/s] 95%|█████████▌| 635/666 [00:14<00:00, 45.44it/s] 96%|█████████▌| 640/666 [00:14<00:00, 45.45it/s] 97%|█████████▋| 645/666 [00:14<00:00, 45.45it/s] 98%|█████████▊| 650/666 [00:14<00:00, 45.47it/s] 98%|█████████▊| 655/666 [00:14<00:00, 45.44it/s] 99%|█████████▉| 660/666 [00:14<00:00, 44.72it/s]100%|█████████▉| 665/666 [00:14<00:00, 45.13it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.59it/s][A
  6%|▌         | 10/167 [00:00<00:02, 53.89it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 122.64it/s][A
 32%|███▏      | 54/167 [00:00<00:00, 162.83it/s][A
 46%|████▌     | 77/167 [00:00<00:00, 184.89it/s][A
 60%|█████▉    | 100/167 [00:00<00:00, 198.59it/s][A
 74%|███████▎  | 123/167 [00:00<00:00, 207.84it/s][A
 87%|████████▋ | 146/167 [00:00<00:00, 213.52it/s][A100%|██████████| 167/167 [00:00<00:00, 173.14it/s]
2022-11-28 21:22:43,736 P51966 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:22:43,736 P51966 INFO Monitor(max) STOP: -4.497234 !
2022-11-28 21:22:43,737 P51966 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:22:43,737 P51966 INFO Early stopping at epoch=3
2022-11-28 21:22:43,737 P51966 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:15<00:00, 41.66it/s]
2022-11-28 21:22:43,799 P51966 INFO Train loss: 30.972063
2022-11-28 21:22:43,800 P51966 INFO Training finished.
2022-11-28 21:22:43,800 P51966 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_005_9462a6b6.model
2022-11-28 21:22:43,902 P51966 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:54,  5.83it/s]  2%|▏         | 10/666 [00:00<00:15, 42.25it/s]  5%|▍         | 33/666 [00:00<00:05, 113.05it/s]  8%|▊         | 56/666 [00:00<00:03, 152.84it/s] 12%|█▏        | 79/666 [00:00<00:03, 176.53it/s] 15%|█▌        | 102/666 [00:00<00:02, 191.19it/s] 19%|█▉        | 125/666 [00:00<00:02, 200.72it/s] 22%|██▏       | 148/666 [00:00<00:02, 207.04it/s] 26%|██▌       | 171/666 [00:01<00:02, 211.12it/s] 29%|██▉       | 194/666 [00:01<00:02, 213.93it/s] 32%|███▏      | 216/666 [00:01<00:02, 214.05it/s] 36%|███▌      | 238/666 [00:01<00:01, 215.30it/s] 39%|███▉      | 260/666 [00:01<00:01, 216.19it/s] 42%|████▏     | 282/666 [00:01<00:01, 216.92it/s] 46%|████▌     | 304/666 [00:01<00:01, 217.42it/s] 49%|████▉     | 326/666 [00:01<00:01, 217.77it/s] 52%|█████▏    | 348/666 [00:01<00:01, 217.63it/s] 56%|█████▌    | 370/666 [00:01<00:01, 216.27it/s] 59%|█████▉    | 392/666 [00:02<00:01, 216.58it/s] 62%|██████▏   | 414/666 [00:02<00:01, 216.16it/s] 65%|██████▌   | 436/666 [00:02<00:01, 216.15it/s] 69%|██████▉   | 458/666 [00:02<00:00, 216.02it/s] 72%|███████▏  | 480/666 [00:02<00:00, 215.86it/s] 75%|███████▌  | 502/666 [00:02<00:00, 215.89it/s] 79%|███████▊  | 524/666 [00:02<00:00, 215.58it/s] 82%|████████▏ | 546/666 [00:02<00:00, 215.16it/s] 85%|████████▌ | 568/666 [00:02<00:00, 215.27it/s] 89%|████████▊ | 590/666 [00:02<00:00, 215.27it/s] 92%|█████████▏| 612/666 [00:03<00:00, 214.67it/s] 95%|█████████▌| 634/666 [00:03<00:00, 214.12it/s] 98%|█████████▊| 656/666 [00:03<00:00, 210.37it/s]100%|██████████| 666/666 [00:03<00:00, 198.05it/s]
2022-11-28 21:22:47,720 P51966 INFO [Metrics] logloss: 4.992098 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:17,  9.44it/s]  6%|▌         | 10/167 [00:00<00:02, 52.95it/s] 17%|█▋        | 29/167 [00:00<00:01, 111.75it/s] 30%|██▉       | 50/167 [00:00<00:00, 146.80it/s] 42%|████▏     | 70/167 [00:00<00:00, 165.13it/s] 54%|█████▍    | 91/167 [00:00<00:00, 177.47it/s] 67%|██████▋   | 112/167 [00:00<00:00, 185.33it/s] 80%|███████▉  | 133/167 [00:00<00:00, 190.26it/s] 92%|█████████▏| 154/167 [00:00<00:00, 193.60it/s]100%|██████████| 167/167 [00:01<00:00, 158.46it/s]
2022-11-28 21:22:48,889 P51966 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:22:51,060 P53751 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "256",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_006_88b6e656",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:22:51,062 P53751 INFO Set up feature encoder...
2022-11-28 21:22:51,069 P53751 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:22:51,075 P53751 INFO Loading data...
2022-11-28 21:22:51,078 P53751 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:22:51,293 P53751 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:22:51,407 P53751 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:22:51,407 P53751 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:22:51,407 P53751 INFO Loading train data done.
2022-11-28 21:22:55,020 P53751 INFO Total number of parameters: 59431684.
2022-11-28 21:22:55,020 P53751 INFO Start training: 666 batches/epoch
2022-11-28 21:22:55,021 P53751 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:22:55.359 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:53751 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:22:55.391 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:53751 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:42,  1.15s/it]  1%|          | 4/666 [00:01<02:44,  4.02it/s]  1%|          | 7/666 [00:01<01:28,  7.43it/s]  2%|▏         | 10/666 [00:01<01:00, 10.88it/s]  2%|▏         | 13/666 [00:01<00:46, 14.18it/s]  2%|▏         | 16/666 [00:01<00:37, 17.19it/s]  3%|▎         | 19/666 [00:01<00:32, 19.76it/s]  3%|▎         | 22/666 [00:01<00:29, 21.94it/s]  4%|▍         | 25/666 [00:02<00:27, 23.61it/s]  4%|▍         | 28/666 [00:02<00:25, 24.90it/s]  5%|▍         | 31/666 [00:02<00:24, 25.85it/s]  5%|▌         | 34/666 [00:02<00:23, 26.56it/s]  6%|▌         | 37/666 [00:02<00:23, 27.05it/s]  6%|▌         | 40/666 [00:02<00:22, 27.41it/s]  6%|▋         | 43/666 [00:02<00:22, 27.66it/s]  7%|▋         | 46/666 [00:02<00:22, 27.85it/s]  7%|▋         | 49/666 [00:02<00:22, 27.98it/s]  8%|▊         | 52/666 [00:02<00:21, 28.08it/s]  8%|▊         | 55/666 [00:03<00:21, 28.12it/s]  9%|▊         | 58/666 [00:03<00:21, 28.18it/s]  9%|▉         | 61/666 [00:03<00:21, 28.19it/s] 10%|▉         | 64/666 [00:03<00:21, 28.21it/s] 10%|█         | 67/666 [00:03<00:21, 28.22it/s] 11%|█         | 70/666 [00:03<00:21, 28.21it/s] 11%|█         | 73/666 [00:03<00:20, 28.25it/s] 11%|█▏        | 76/666 [00:03<00:20, 28.25it/s] 12%|█▏        | 79/666 [00:03<00:20, 28.27it/s] 12%|█▏        | 82/666 [00:04<00:20, 28.27it/s] 13%|█▎        | 85/666 [00:04<00:20, 28.27it/s] 13%|█▎        | 88/666 [00:04<00:20, 28.27it/s] 14%|█▎        | 91/666 [00:04<00:20, 28.28it/s] 14%|█▍        | 94/666 [00:04<00:20, 28.26it/s] 15%|█▍        | 97/666 [00:04<00:20, 28.28it/s] 15%|█▌        | 100/666 [00:04<00:20, 28.27it/s] 15%|█▌        | 103/666 [00:04<00:19, 28.29it/s] 16%|█▌        | 106/666 [00:04<00:19, 28.28it/s] 16%|█▋        | 109/666 [00:04<00:19, 28.30it/s] 17%|█▋        | 112/666 [00:05<00:19, 28.27it/s] 17%|█▋        | 115/666 [00:05<00:19, 28.26it/s] 18%|█▊        | 118/666 [00:05<00:19, 28.26it/s] 18%|█▊        | 121/666 [00:05<00:19, 28.27it/s] 19%|█▊        | 124/666 [00:05<00:19, 27.71it/s] 19%|█▉        | 127/666 [00:05<00:19, 27.87it/s] 20%|█▉        | 130/666 [00:05<00:19, 27.98it/s] 20%|█▉        | 133/666 [00:05<00:18, 28.08it/s] 20%|██        | 136/666 [00:05<00:18, 28.13it/s] 21%|██        | 139/666 [00:06<00:18, 28.16it/s] 21%|██▏       | 142/666 [00:06<00:18, 28.20it/s] 22%|██▏       | 145/666 [00:06<00:18, 28.22it/s] 22%|██▏       | 148/666 [00:06<00:18, 28.24it/s] 23%|██▎       | 151/666 [00:06<00:18, 28.23it/s] 23%|██▎       | 154/666 [00:06<00:18, 28.26it/s] 24%|██▎       | 157/666 [00:06<00:18, 28.25it/s] 24%|██▍       | 160/666 [00:06<00:17, 28.25it/s] 24%|██▍       | 163/666 [00:06<00:17, 28.25it/s] 25%|██▍       | 166/666 [00:07<00:17, 28.26it/s] 25%|██▌       | 169/666 [00:07<00:17, 28.26it/s] 26%|██▌       | 172/666 [00:07<00:17, 28.24it/s] 26%|██▋       | 175/666 [00:07<00:17, 28.26it/s] 27%|██▋       | 178/666 [00:07<00:17, 28.25it/s] 27%|██▋       | 181/666 [00:07<00:17, 28.26it/s] 28%|██▊       | 184/666 [00:07<00:17, 28.26it/s] 28%|██▊       | 187/666 [00:07<00:16, 28.27it/s] 29%|██▊       | 190/666 [00:07<00:16, 28.26it/s] 29%|██▉       | 193/666 [00:07<00:16, 28.27it/s] 29%|██▉       | 196/666 [00:08<00:16, 28.27it/s] 30%|██▉       | 199/666 [00:08<00:16, 28.27it/s] 30%|███       | 202/666 [00:08<00:16, 28.26it/s] 31%|███       | 205/666 [00:08<00:16, 28.27it/s] 31%|███       | 208/666 [00:08<00:16, 28.25it/s] 32%|███▏      | 211/666 [00:08<00:16, 28.28it/s] 32%|███▏      | 214/666 [00:08<00:15, 28.26it/s] 33%|███▎      | 217/666 [00:08<00:15, 28.26it/s] 33%|███▎      | 220/666 [00:08<00:15, 28.27it/s] 33%|███▎      | 223/666 [00:09<00:15, 28.26it/s] 34%|███▍      | 226/666 [00:09<00:15, 28.27it/s] 34%|███▍      | 229/666 [00:09<00:15, 28.27it/s] 35%|███▍      | 232/666 [00:09<00:15, 28.27it/s] 35%|███▌      | 235/666 [00:09<00:15, 28.26it/s] 36%|███▌      | 238/666 [00:09<00:15, 28.27it/s] 36%|███▌      | 241/666 [00:09<00:15, 28.27it/s] 37%|███▋      | 244/666 [00:09<00:14, 28.26it/s] 37%|███▋      | 247/666 [00:09<00:14, 28.27it/s] 38%|███▊      | 250/666 [00:09<00:14, 28.28it/s] 38%|███▊      | 253/666 [00:10<00:14, 28.26it/s] 38%|███▊      | 256/666 [00:10<00:14, 28.25it/s] 39%|███▉      | 259/666 [00:10<00:14, 28.25it/s] 39%|███▉      | 262/666 [00:10<00:14, 28.23it/s] 40%|███▉      | 265/666 [00:10<00:14, 28.24it/s] 40%|████      | 268/666 [00:10<00:14, 28.21it/s] 41%|████      | 271/666 [00:10<00:14, 28.21it/s] 41%|████      | 274/666 [00:10<00:13, 28.22it/s] 42%|████▏     | 277/666 [00:10<00:13, 28.23it/s] 42%|████▏     | 280/666 [00:11<00:13, 28.24it/s] 42%|████▏     | 283/666 [00:11<00:13, 28.24it/s] 43%|████▎     | 286/666 [00:11<00:13, 28.25it/s] 43%|████▎     | 289/666 [00:11<00:13, 28.23it/s] 44%|████▍     | 292/666 [00:11<00:13, 28.24it/s] 44%|████▍     | 295/666 [00:11<00:13, 28.24it/s] 45%|████▍     | 298/666 [00:11<00:13, 28.25it/s] 45%|████▌     | 301/666 [00:11<00:12, 28.25it/s] 46%|████▌     | 304/666 [00:11<00:12, 28.27it/s] 46%|████▌     | 307/666 [00:11<00:12, 28.26it/s] 47%|████▋     | 310/666 [00:12<00:12, 28.25it/s] 47%|████▋     | 313/666 [00:12<00:12, 28.26it/s] 47%|████▋     | 316/666 [00:12<00:12, 28.25it/s] 48%|████▊     | 319/666 [00:12<00:12, 28.25it/s] 48%|████▊     | 322/666 [00:12<00:12, 28.25it/s] 49%|████▉     | 325/666 [00:12<00:12, 28.27it/s] 49%|████▉     | 328/666 [00:12<00:11, 28.24it/s] 50%|████▉     | 331/666 [00:12<00:11, 28.26it/s] 50%|█████     | 334/666 [00:12<00:11, 28.26it/s] 51%|█████     | 337/666 [00:13<00:11, 28.26it/s] 51%|█████     | 340/666 [00:13<00:11, 28.26it/s] 52%|█████▏    | 343/666 [00:13<00:11, 28.27it/s] 52%|█████▏    | 346/666 [00:13<00:11, 28.25it/s] 52%|█████▏    | 349/666 [00:13<00:11, 28.26it/s] 53%|█████▎    | 352/666 [00:13<00:11, 28.27it/s] 53%|█████▎    | 355/666 [00:13<00:11, 28.27it/s] 54%|█████▍    | 358/666 [00:13<00:10, 28.28it/s] 54%|█████▍    | 361/666 [00:13<00:10, 28.27it/s] 55%|█████▍    | 364/666 [00:14<00:10, 28.28it/s] 55%|█████▌    | 367/666 [00:14<00:10, 28.26it/s] 56%|█████▌    | 370/666 [00:14<00:10, 28.26it/s] 56%|█████▌    | 373/666 [00:14<00:10, 28.25it/s] 56%|█████▋    | 376/666 [00:14<00:10, 28.26it/s] 57%|█████▋    | 379/666 [00:14<00:10, 28.25it/s] 57%|█████▋    | 382/666 [00:14<00:10, 28.24it/s] 58%|█████▊    | 385/666 [00:14<00:09, 28.23it/s] 58%|█████▊    | 388/666 [00:14<00:09, 28.23it/s] 59%|█████▊    | 391/666 [00:14<00:09, 28.26it/s] 59%|█████▉    | 394/666 [00:15<00:09, 28.24it/s] 60%|█████▉    | 397/666 [00:15<00:09, 28.26it/s] 60%|██████    | 400/666 [00:15<00:09, 28.24it/s] 61%|██████    | 403/666 [00:15<00:09, 28.26it/s] 61%|██████    | 406/666 [00:15<00:09, 28.26it/s] 61%|██████▏   | 409/666 [00:15<00:09, 28.27it/s] 62%|██████▏   | 412/666 [00:15<00:08, 28.26it/s] 62%|██████▏   | 415/666 [00:15<00:08, 28.26it/s] 63%|██████▎   | 418/666 [00:15<00:08, 28.26it/s] 63%|██████▎   | 421/666 [00:16<00:08, 28.26it/s] 64%|██████▎   | 424/666 [00:16<00:08, 28.25it/s] 64%|██████▍   | 427/666 [00:16<00:08, 28.24it/s] 65%|██████▍   | 430/666 [00:16<00:08, 28.26it/s] 65%|██████▌   | 433/666 [00:16<00:08, 28.24it/s] 65%|██████▌   | 436/666 [00:16<00:08, 28.26it/s] 66%|██████▌   | 439/666 [00:16<00:08, 28.25it/s] 66%|██████▋   | 442/666 [00:16<00:07, 28.22it/s] 67%|██████▋   | 445/666 [00:16<00:07, 28.23it/s] 67%|██████▋   | 448/666 [00:16<00:07, 28.23it/s] 68%|██████▊   | 451/666 [00:17<00:07, 28.25it/s] 68%|██████▊   | 454/666 [00:17<00:07, 28.25it/s] 69%|██████▊   | 457/666 [00:17<00:07, 28.27it/s] 69%|██████▉   | 460/666 [00:17<00:07, 28.26it/s] 70%|██████▉   | 463/666 [00:17<00:07, 28.27it/s] 70%|██████▉   | 466/666 [00:17<00:07, 28.25it/s] 70%|███████   | 469/666 [00:17<00:06, 28.27it/s] 71%|███████   | 472/666 [00:17<00:06, 28.26it/s] 71%|███████▏  | 475/666 [00:17<00:06, 28.27it/s] 72%|███████▏  | 478/666 [00:18<00:06, 28.24it/s] 72%|███████▏  | 481/666 [00:18<00:06, 28.25it/s] 73%|███████▎  | 484/666 [00:18<00:06, 28.26it/s] 73%|███████▎  | 487/666 [00:18<00:06, 28.25it/s] 74%|███████▎  | 490/666 [00:18<00:06, 28.25it/s] 74%|███████▍  | 493/666 [00:18<00:06, 28.25it/s] 74%|███████▍  | 496/666 [00:18<00:06, 28.27it/s] 75%|███████▍  | 499/666 [00:18<00:05, 28.25it/s] 75%|███████▌  | 502/666 [00:18<00:05, 28.27it/s] 76%|███████▌  | 505/666 [00:19<00:05, 28.26it/s] 76%|███████▋  | 508/666 [00:19<00:05, 28.23it/s] 77%|███████▋  | 511/666 [00:19<00:05, 28.24it/s] 77%|███████▋  | 514/666 [00:19<00:05, 28.25it/s] 78%|███████▊  | 517/666 [00:19<00:05, 28.25it/s] 78%|███████▊  | 520/666 [00:19<00:05, 28.24it/s] 79%|███████▊  | 523/666 [00:19<00:05, 28.26it/s] 79%|███████▉  | 526/666 [00:19<00:04, 28.26it/s] 79%|███████▉  | 529/666 [00:19<00:04, 28.26it/s] 80%|███████▉  | 532/666 [00:19<00:04, 28.26it/s] 80%|████████  | 535/666 [00:20<00:04, 28.25it/s] 81%|████████  | 538/666 [00:20<00:04, 28.20it/s] 81%|████████  | 541/666 [00:20<00:04, 28.16it/s] 82%|████████▏ | 544/666 [00:20<00:04, 28.25it/s] 82%|████████▏ | 547/666 [00:20<00:04, 28.25it/s] 83%|████████▎ | 550/666 [00:20<00:04, 28.27it/s] 83%|████████▎ | 553/666 [00:20<00:03, 28.26it/s] 83%|████████▎ | 556/666 [00:20<00:03, 28.29it/s] 84%|████████▍ | 559/666 [00:20<00:03, 28.29it/s] 84%|████████▍ | 562/666 [00:21<00:03, 28.30it/s] 85%|████████▍ | 565/666 [00:21<00:03, 28.28it/s] 85%|████████▌ | 568/666 [00:21<00:03, 28.26it/s] 86%|████████▌ | 571/666 [00:21<00:03, 28.25it/s] 86%|████████▌ | 574/666 [00:21<00:03, 28.28it/s] 87%|████████▋ | 577/666 [00:21<00:03, 28.28it/s] 87%|████████▋ | 580/666 [00:21<00:03, 28.30it/s] 88%|████████▊ | 583/666 [00:21<00:02, 28.29it/s] 88%|████████▊ | 586/666 [00:21<00:02, 28.30it/s] 88%|████████▊ | 589/666 [00:21<00:02, 28.29it/s] 89%|████████▉ | 592/666 [00:22<00:02, 28.30it/s] 89%|████████▉ | 595/666 [00:22<00:02, 28.30it/s] 90%|████████▉ | 598/666 [00:22<00:02, 28.27it/s] 90%|█████████ | 601/666 [00:22<00:02, 28.26it/s] 91%|█████████ | 604/666 [00:22<00:02, 28.27it/s] 91%|█████████ | 607/666 [00:22<00:02, 28.28it/s] 92%|█████████▏| 610/666 [00:22<00:01, 28.29it/s] 92%|█████████▏| 613/666 [00:22<00:01, 28.29it/s] 92%|█████████▏| 616/666 [00:22<00:01, 28.29it/s] 93%|█████████▎| 619/666 [00:23<00:01, 28.29it/s] 93%|█████████▎| 622/666 [00:23<00:01, 28.29it/s] 94%|█████████▍| 625/666 [00:23<00:01, 28.30it/s] 94%|█████████▍| 628/666 [00:23<00:01, 28.28it/s] 95%|█████████▍| 631/666 [00:23<00:01, 28.27it/s] 95%|█████████▌| 634/666 [00:23<00:01, 28.26it/s] 96%|█████████▌| 637/666 [00:23<00:01, 28.28it/s] 96%|█████████▌| 640/666 [00:23<00:00, 28.28it/s] 97%|█████████▋| 643/666 [00:23<00:00, 28.29it/s] 97%|█████████▋| 646/666 [00:23<00:00, 28.29it/s] 97%|█████████▋| 649/666 [00:24<00:00, 28.28it/s] 98%|█████████▊| 652/666 [00:24<00:00, 28.27it/s] 98%|█████████▊| 655/666 [00:24<00:00, 28.26it/s] 99%|█████████▉| 658/666 [00:24<00:00, 28.26it/s] 99%|█████████▉| 661/666 [00:24<00:00, 27.69it/s]100%|█████████▉| 664/666 [00:24<00:00, 27.92it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.41it/s][A
  6%|▌         | 10/167 [00:00<00:03, 48.79it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 114.65it/s][A
 32%|███▏      | 54/167 [00:00<00:00, 155.84it/s][A
 45%|████▍     | 75/167 [00:00<00:00, 172.40it/s][A
 57%|█████▋    | 96/167 [00:00<00:00, 182.68it/s][A
 70%|███████   | 117/167 [00:00<00:00, 189.43it/s][A
 82%|████████▏ | 137/167 [00:00<00:00, 192.42it/s][A
 95%|█████████▍| 158/167 [00:00<00:00, 195.92it/s][A100%|██████████| 167/167 [00:01<00:00, 162.50it/s]
2022-11-28 21:23:20,870 P53751 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:23:20,870 P53751 INFO Save best model: monitor(max): -10.617075
2022-11-28 21:23:23,303 P53751 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:28<00:00, 23.52it/s]
2022-11-28 21:23:23,342 P53751 INFO Train loss: 69.009578
2022-11-28 21:23:23,342 P53751 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:06,  5.28it/s]  1%|          | 4/666 [00:00<00:44, 14.73it/s]  1%|          | 7/666 [00:00<00:33, 19.74it/s]  2%|▏         | 10/666 [00:00<00:28, 22.68it/s]  2%|▏         | 13/666 [00:00<00:26, 24.57it/s]  2%|▏         | 16/666 [00:00<00:25, 25.73it/s]  3%|▎         | 19/666 [00:00<00:24, 26.67it/s]  3%|▎         | 22/666 [00:00<00:23, 27.25it/s]  4%|▍         | 25/666 [00:01<00:23, 27.67it/s]  4%|▍         | 28/666 [00:01<00:22, 27.91it/s]  5%|▍         | 31/666 [00:01<00:22, 28.09it/s]  5%|▌         | 34/666 [00:01<00:22, 28.24it/s]  6%|▌         | 37/666 [00:01<00:22, 28.34it/s]  6%|▌         | 40/666 [00:01<00:22, 28.40it/s]  6%|▋         | 43/666 [00:01<00:21, 28.46it/s]  7%|▋         | 46/666 [00:01<00:21, 28.48it/s]  7%|▋         | 49/666 [00:01<00:21, 28.49it/s]  8%|▊         | 52/666 [00:01<00:21, 28.52it/s]  8%|▊         | 55/666 [00:02<00:21, 28.54it/s]  9%|▊         | 58/666 [00:02<00:21, 28.57it/s]  9%|▉         | 61/666 [00:02<00:21, 28.56it/s] 10%|▉         | 64/666 [00:02<00:21, 28.56it/s] 10%|█         | 67/666 [00:02<00:20, 28.57it/s] 11%|█         | 70/666 [00:02<00:20, 28.58it/s] 11%|█         | 73/666 [00:02<00:20, 28.58it/s] 11%|█▏        | 76/666 [00:02<00:20, 28.57it/s] 12%|█▏        | 79/666 [00:02<00:20, 28.58it/s] 12%|█▏        | 82/666 [00:03<00:20, 28.59it/s] 13%|█▎        | 85/666 [00:03<00:20, 28.60it/s] 13%|█▎        | 88/666 [00:03<00:20, 28.59it/s] 14%|█▎        | 91/666 [00:03<00:20, 28.59it/s] 14%|█▍        | 94/666 [00:03<00:20, 28.59it/s] 15%|█▍        | 97/666 [00:03<00:19, 28.59it/s] 15%|█▌        | 100/666 [00:03<00:19, 28.59it/s] 15%|█▌        | 103/666 [00:03<00:19, 28.58it/s] 16%|█▌        | 106/666 [00:03<00:19, 28.59it/s] 16%|█▋        | 109/666 [00:03<00:19, 28.60it/s] 17%|█▋        | 112/666 [00:04<00:19, 28.57it/s] 17%|█▋        | 115/666 [00:04<00:19, 28.57it/s] 18%|█▊        | 118/666 [00:04<00:19, 28.57it/s] 18%|█▊        | 121/666 [00:04<00:19, 28.59it/s] 19%|█▊        | 124/666 [00:04<00:18, 28.56it/s] 19%|█▉        | 127/666 [00:04<00:18, 28.57it/s] 20%|█▉        | 130/666 [00:04<00:18, 28.57it/s] 20%|█▉        | 133/666 [00:04<00:18, 28.59it/s] 20%|██        | 136/666 [00:04<00:18, 28.58it/s] 21%|██        | 139/666 [00:05<00:18, 28.55it/s] 21%|██▏       | 142/666 [00:05<00:18, 28.56it/s] 22%|██▏       | 145/666 [00:05<00:18, 28.58it/s] 22%|██▏       | 148/666 [00:05<00:18, 28.58it/s] 23%|██▎       | 151/666 [00:05<00:18, 28.57it/s] 23%|██▎       | 154/666 [00:05<00:17, 28.59it/s] 24%|██▎       | 157/666 [00:05<00:17, 28.59it/s] 24%|██▍       | 160/666 [00:05<00:17, 28.58it/s] 24%|██▍       | 163/666 [00:05<00:17, 28.57it/s] 25%|██▍       | 166/666 [00:05<00:17, 28.58it/s] 25%|██▌       | 169/666 [00:06<00:17, 28.59it/s] 26%|██▌       | 172/666 [00:06<00:17, 28.58it/s] 26%|██▋       | 175/666 [00:06<00:17, 28.58it/s] 27%|██▋       | 178/666 [00:06<00:17, 28.58it/s] 27%|██▋       | 181/666 [00:06<00:16, 28.58it/s] 28%|██▊       | 184/666 [00:06<00:16, 28.58it/s] 28%|██▊       | 187/666 [00:06<00:16, 28.58it/s] 29%|██▊       | 190/666 [00:06<00:16, 28.57it/s] 29%|██▉       | 193/666 [00:06<00:16, 28.58it/s] 29%|██▉       | 196/666 [00:07<00:16, 28.58it/s] 30%|██▉       | 199/666 [00:07<00:16, 28.59it/s] 30%|███       | 202/666 [00:07<00:16, 28.59it/s] 31%|███       | 205/666 [00:07<00:16, 28.59it/s] 31%|███       | 208/666 [00:07<00:16, 28.59it/s] 32%|███▏      | 211/666 [00:07<00:15, 28.59it/s] 32%|███▏      | 214/666 [00:07<00:15, 28.58it/s] 33%|███▎      | 217/666 [00:07<00:15, 28.57it/s] 33%|███▎      | 220/666 [00:07<00:15, 28.59it/s] 33%|███▎      | 223/666 [00:07<00:15, 28.59it/s] 34%|███▍      | 226/666 [00:08<00:15, 28.58it/s] 34%|███▍      | 229/666 [00:08<00:15, 28.58it/s] 35%|███▍      | 232/666 [00:08<00:15, 28.59it/s] 35%|███▌      | 235/666 [00:08<00:15, 28.57it/s] 36%|███▌      | 238/666 [00:08<00:14, 28.57it/s] 36%|███▌      | 241/666 [00:08<00:14, 28.59it/s] 37%|███▋      | 244/666 [00:08<00:14, 28.61it/s] 37%|███▋      | 247/666 [00:08<00:14, 28.59it/s] 38%|███▊      | 250/666 [00:08<00:14, 28.60it/s] 38%|███▊      | 253/666 [00:09<00:14, 28.58it/s] 38%|███▊      | 256/666 [00:09<00:14, 28.59it/s] 39%|███▉      | 259/666 [00:09<00:14, 28.61it/s] 39%|███▉      | 262/666 [00:09<00:14, 28.60it/s] 40%|███▉      | 265/666 [00:09<00:14, 28.59it/s] 40%|████      | 268/666 [00:09<00:13, 28.59it/s] 41%|████      | 271/666 [00:09<00:13, 28.59it/s] 41%|████      | 274/666 [00:09<00:13, 28.59it/s] 42%|████▏     | 277/666 [00:09<00:13, 28.59it/s] 42%|████▏     | 280/666 [00:09<00:13, 28.59it/s] 42%|████▏     | 283/666 [00:10<00:13, 28.60it/s] 43%|████▎     | 286/666 [00:10<00:13, 28.60it/s] 43%|████▎     | 289/666 [00:10<00:13, 28.60it/s] 44%|████▍     | 292/666 [00:10<00:13, 28.59it/s] 44%|████▍     | 295/666 [00:10<00:12, 28.59it/s] 45%|████▍     | 298/666 [00:10<00:12, 28.59it/s] 45%|████▌     | 301/666 [00:10<00:12, 28.55it/s] 46%|████▌     | 304/666 [00:10<00:12, 28.57it/s] 46%|████▌     | 307/666 [00:10<00:12, 28.58it/s] 47%|████▋     | 310/666 [00:11<00:12, 28.59it/s] 47%|████▋     | 313/666 [00:11<00:12, 28.59it/s] 47%|████▋     | 316/666 [00:11<00:12, 28.59it/s] 48%|████▊     | 319/666 [00:11<00:12, 28.60it/s] 48%|████▊     | 322/666 [00:11<00:12, 28.60it/s] 49%|████▉     | 325/666 [00:11<00:11, 28.60it/s] 49%|████▉     | 328/666 [00:11<00:11, 28.60it/s] 50%|████▉     | 331/666 [00:11<00:11, 28.59it/s] 50%|█████     | 334/666 [00:11<00:11, 28.59it/s] 51%|█████     | 337/666 [00:11<00:11, 28.60it/s] 51%|█████     | 340/666 [00:12<00:11, 28.59it/s] 52%|█████▏    | 343/666 [00:12<00:11, 28.59it/s] 52%|█████▏    | 346/666 [00:12<00:11, 28.59it/s] 52%|█████▏    | 349/666 [00:12<00:11, 28.60it/s] 53%|█████▎    | 352/666 [00:12<00:10, 28.59it/s] 53%|█████▎    | 355/666 [00:12<00:10, 28.58it/s] 54%|█████▍    | 358/666 [00:12<00:10, 28.51it/s] 54%|█████▍    | 361/666 [00:12<00:10, 28.53it/s] 55%|█████▍    | 364/666 [00:12<00:10, 28.55it/s] 55%|█████▌    | 367/666 [00:13<00:10, 28.55it/s] 56%|█████▌    | 370/666 [00:13<00:10, 28.56it/s] 56%|█████▌    | 373/666 [00:13<00:10, 28.57it/s] 56%|█████▋    | 376/666 [00:13<00:10, 28.58it/s] 57%|█████▋    | 379/666 [00:13<00:10, 28.57it/s] 57%|█████▋    | 382/666 [00:13<00:09, 28.58it/s] 58%|█████▊    | 385/666 [00:13<00:09, 28.59it/s] 58%|█████▊    | 388/666 [00:13<00:09, 28.59it/s] 59%|█████▊    | 391/666 [00:13<00:09, 28.58it/s] 59%|█████▉    | 394/666 [00:13<00:09, 28.59it/s] 60%|█████▉    | 397/666 [00:14<00:09, 28.60it/s] 60%|██████    | 400/666 [00:14<00:09, 28.60it/s] 61%|██████    | 403/666 [00:14<00:09, 28.59it/s] 61%|██████    | 406/666 [00:14<00:09, 28.59it/s] 61%|██████▏   | 409/666 [00:14<00:08, 28.59it/s] 62%|██████▏   | 412/666 [00:14<00:08, 28.58it/s] 62%|██████▏   | 415/666 [00:14<00:08, 28.59it/s] 63%|██████▎   | 418/666 [00:14<00:08, 28.58it/s] 63%|██████▎   | 421/666 [00:14<00:08, 28.58it/s] 64%|██████▎   | 424/666 [00:15<00:08, 28.58it/s] 64%|██████▍   | 427/666 [00:15<00:08, 28.59it/s] 65%|██████▍   | 430/666 [00:15<00:08, 28.59it/s] 65%|██████▌   | 433/666 [00:15<00:08, 28.59it/s] 65%|██████▌   | 436/666 [00:15<00:08, 28.59it/s] 66%|██████▌   | 439/666 [00:15<00:07, 28.59it/s] 66%|██████▋   | 442/666 [00:15<00:07, 28.59it/s] 67%|██████▋   | 445/666 [00:15<00:07, 28.58it/s] 67%|██████▋   | 448/666 [00:15<00:07, 28.60it/s] 68%|██████▊   | 451/666 [00:15<00:07, 28.60it/s] 68%|██████▊   | 454/666 [00:16<00:07, 28.59it/s] 69%|██████▊   | 457/666 [00:16<00:07, 28.59it/s] 69%|██████▉   | 460/666 [00:16<00:07, 28.59it/s] 70%|██████▉   | 463/666 [00:16<00:07, 28.59it/s] 70%|██████▉   | 466/666 [00:16<00:07, 28.53it/s] 70%|███████   | 469/666 [00:16<00:06, 28.54it/s] 71%|███████   | 472/666 [00:16<00:06, 28.55it/s] 71%|███████▏  | 475/666 [00:16<00:06, 28.55it/s] 72%|███████▏  | 478/666 [00:16<00:06, 28.56it/s] 72%|███████▏  | 481/666 [00:17<00:06, 28.57it/s] 73%|███████▎  | 484/666 [00:17<00:06, 28.57it/s] 73%|███████▎  | 487/666 [00:17<00:06, 28.57it/s] 74%|███████▎  | 490/666 [00:17<00:06, 28.56it/s] 74%|███████▍  | 493/666 [00:17<00:06, 28.57it/s] 74%|███████▍  | 496/666 [00:17<00:05, 28.58it/s] 75%|███████▍  | 499/666 [00:17<00:05, 28.58it/s] 75%|███████▌  | 502/666 [00:17<00:05, 28.57it/s] 76%|███████▌  | 505/666 [00:17<00:05, 28.58it/s] 76%|███████▋  | 508/666 [00:17<00:05, 28.59it/s] 77%|███████▋  | 511/666 [00:18<00:05, 28.58it/s] 77%|███████▋  | 514/666 [00:18<00:05, 28.57it/s] 78%|███████▊  | 517/666 [00:18<00:05, 28.58it/s] 78%|███████▊  | 520/666 [00:18<00:05, 28.59it/s] 79%|███████▊  | 523/666 [00:18<00:05, 28.59it/s] 79%|███████▉  | 526/666 [00:18<00:04, 28.58it/s] 79%|███████▉  | 529/666 [00:18<00:04, 28.58it/s] 80%|███████▉  | 532/666 [00:18<00:04, 28.59it/s] 80%|████████  | 535/666 [00:18<00:04, 28.50it/s] 81%|████████  | 538/666 [00:18<00:04, 28.51it/s] 81%|████████  | 541/666 [00:19<00:04, 28.57it/s] 82%|████████▏ | 544/666 [00:19<00:04, 28.56it/s] 82%|████████▏ | 547/666 [00:19<00:04, 28.57it/s] 83%|████████▎ | 550/666 [00:19<00:04, 28.57it/s] 83%|████████▎ | 553/666 [00:19<00:03, 28.57it/s] 83%|████████▎ | 556/666 [00:19<00:03, 28.58it/s] 84%|████████▍ | 559/666 [00:19<00:03, 28.58it/s] 84%|████████▍ | 562/666 [00:19<00:03, 28.57it/s] 85%|████████▍ | 565/666 [00:19<00:03, 28.57it/s] 85%|████████▌ | 568/666 [00:20<00:03, 28.59it/s] 86%|████████▌ | 571/666 [00:20<00:03, 28.60it/s] 86%|████████▌ | 574/666 [00:20<00:03, 28.60it/s] 87%|████████▋ | 577/666 [00:20<00:03, 28.60it/s] 87%|████████▋ | 580/666 [00:20<00:03, 28.61it/s] 88%|████████▊ | 583/666 [00:20<00:02, 28.60it/s] 88%|████████▊ | 586/666 [00:20<00:02, 28.59it/s] 88%|████████▊ | 589/666 [00:20<00:02, 28.57it/s] 89%|████████▉ | 592/666 [00:20<00:02, 28.57it/s] 89%|████████▉ | 595/666 [00:20<00:02, 28.56it/s] 90%|████████▉ | 598/666 [00:21<00:02, 28.57it/s] 90%|█████████ | 601/666 [00:21<00:02, 28.57it/s] 91%|█████████ | 604/666 [00:21<00:02, 28.58it/s] 91%|█████████ | 607/666 [00:21<00:02, 28.57it/s] 92%|█████████▏| 610/666 [00:21<00:01, 28.58it/s] 92%|█████████▏| 613/666 [00:21<00:01, 28.56it/s] 92%|█████████▏| 616/666 [00:21<00:01, 28.57it/s] 93%|█████████▎| 619/666 [00:21<00:01, 28.56it/s] 93%|█████████▎| 622/666 [00:21<00:01, 28.56it/s] 94%|█████████▍| 625/666 [00:22<00:01, 28.57it/s] 94%|█████████▍| 628/666 [00:22<00:01, 28.58it/s] 95%|█████████▍| 631/666 [00:22<00:01, 28.58it/s] 95%|█████████▌| 634/666 [00:22<00:01, 28.59it/s] 96%|█████████▌| 637/666 [00:22<00:01, 28.58it/s] 96%|█████████▌| 640/666 [00:22<00:00, 28.60it/s] 97%|█████████▋| 643/666 [00:22<00:00, 28.60it/s] 97%|█████████▋| 646/666 [00:22<00:00, 28.60it/s] 97%|█████████▋| 649/666 [00:22<00:00, 28.59it/s] 98%|█████████▊| 652/666 [00:22<00:00, 28.58it/s] 98%|█████████▊| 655/666 [00:23<00:00, 28.59it/s] 99%|█████████▉| 658/666 [00:23<00:00, 28.59it/s] 99%|█████████▉| 661/666 [00:23<00:00, 28.15it/s]100%|█████████▉| 664/666 [00:23<00:00, 28.36it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.20it/s][A
  6%|▌         | 10/167 [00:00<00:03, 44.62it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 116.43it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 154.58it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 177.78it/s][A
 61%|██████    | 102/167 [00:00<00:00, 192.60it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 201.49it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 207.64it/s][A100%|██████████| 167/167 [00:01<00:00, 164.57it/s]
2022-11-28 21:23:47,949 P53751 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:23:47,949 P53751 INFO Monitor(max) STOP: -10.617075 !
2022-11-28 21:23:47,949 P53751 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:23:47,950 P53751 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:24<00:00, 27.01it/s]
2022-11-28 21:23:47,999 P53751 INFO Train loss: 69.009519
2022-11-28 21:23:47,999 P53751 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:03,  5.40it/s]  1%|          | 4/666 [00:00<00:42, 15.51it/s]  1%|          | 7/666 [00:00<00:32, 20.55it/s]  2%|▏         | 10/666 [00:00<00:28, 23.15it/s]  2%|▏         | 13/666 [00:00<00:26, 24.79it/s]  2%|▏         | 16/666 [00:00<00:25, 25.83it/s]  3%|▎         | 19/666 [00:00<00:24, 26.61it/s]  3%|▎         | 22/666 [00:00<00:23, 27.09it/s]  4%|▍         | 25/666 [00:01<00:23, 27.43it/s]  4%|▍         | 28/666 [00:01<00:23, 27.67it/s]  5%|▍         | 31/666 [00:01<00:22, 27.82it/s]  5%|▌         | 34/666 [00:01<00:22, 27.92it/s]  6%|▌         | 37/666 [00:01<00:22, 27.97it/s]  6%|▌         | 40/666 [00:01<00:22, 28.02it/s]  6%|▋         | 43/666 [00:01<00:22, 28.07it/s]  7%|▋         | 46/666 [00:01<00:22, 28.08it/s]  7%|▋         | 49/666 [00:01<00:21, 28.10it/s]  8%|▊         | 52/666 [00:01<00:21, 28.13it/s]  8%|▊         | 55/666 [00:02<00:21, 28.13it/s]  9%|▊         | 58/666 [00:02<00:21, 28.15it/s]  9%|▉         | 61/666 [00:02<00:21, 28.16it/s] 10%|▉         | 64/666 [00:02<00:21, 28.15it/s] 10%|█         | 67/666 [00:02<00:21, 28.16it/s] 11%|█         | 70/666 [00:02<00:21, 28.16it/s] 11%|█         | 73/666 [00:02<00:21, 28.15it/s] 11%|█▏        | 76/666 [00:02<00:20, 28.17it/s] 12%|█▏        | 79/666 [00:02<00:20, 28.16it/s] 12%|█▏        | 82/666 [00:03<00:20, 28.15it/s] 13%|█▎        | 85/666 [00:03<00:20, 28.16it/s] 13%|█▎        | 88/666 [00:03<00:20, 28.15it/s] 14%|█▎        | 91/666 [00:03<00:20, 28.16it/s] 14%|█▍        | 94/666 [00:03<00:20, 28.16it/s] 15%|█▍        | 97/666 [00:03<00:20, 28.15it/s] 15%|█▌        | 100/666 [00:03<00:20, 28.17it/s] 15%|█▌        | 103/666 [00:03<00:19, 28.16it/s] 16%|█▌        | 106/666 [00:03<00:19, 28.14it/s] 16%|█▋        | 109/666 [00:04<00:19, 28.16it/s] 17%|█▋        | 112/666 [00:04<00:19, 28.15it/s] 17%|█▋        | 115/666 [00:04<00:19, 28.16it/s] 18%|█▊        | 118/666 [00:04<00:19, 28.17it/s] 18%|█▊        | 121/666 [00:04<00:19, 28.16it/s] 19%|█▊        | 124/666 [00:04<00:19, 28.17it/s] 19%|█▉        | 127/666 [00:04<00:19, 28.16it/s] 20%|█▉        | 130/666 [00:04<00:19, 28.16it/s] 20%|█▉        | 133/666 [00:04<00:18, 28.17it/s] 20%|██        | 136/666 [00:04<00:18, 28.17it/s] 21%|██        | 139/666 [00:05<00:18, 28.18it/s] 21%|██▏       | 142/666 [00:05<00:18, 28.18it/s] 22%|██▏       | 145/666 [00:05<00:18, 28.17it/s] 22%|██▏       | 148/666 [00:05<00:18, 28.17it/s] 23%|██▎       | 151/666 [00:05<00:18, 28.16it/s] 23%|██▎       | 154/666 [00:05<00:18, 28.17it/s] 24%|██▎       | 157/666 [00:05<00:18, 28.18it/s] 24%|██▍       | 160/666 [00:05<00:17, 28.17it/s] 24%|██▍       | 163/666 [00:05<00:17, 28.17it/s] 25%|██▍       | 166/666 [00:06<00:17, 28.17it/s] 25%|██▌       | 169/666 [00:06<00:17, 28.15it/s] 26%|██▌       | 172/666 [00:06<00:17, 28.17it/s] 26%|██▋       | 175/666 [00:06<00:17, 28.17it/s] 27%|██▋       | 178/666 [00:06<00:17, 28.16it/s] 27%|██▋       | 181/666 [00:06<00:17, 28.16it/s] 28%|██▊       | 184/666 [00:06<00:17, 28.16it/s] 28%|██▊       | 187/666 [00:06<00:17, 28.15it/s] 29%|██▊       | 190/666 [00:06<00:16, 28.17it/s] 29%|██▉       | 193/666 [00:07<00:16, 28.16it/s] 29%|██▉       | 196/666 [00:07<00:16, 28.13it/s] 30%|██▉       | 199/666 [00:07<00:16, 28.13it/s] 30%|███       | 202/666 [00:07<00:16, 28.12it/s] 31%|███       | 205/666 [00:07<00:16, 28.12it/s] 31%|███       | 208/666 [00:07<00:16, 28.15it/s] 32%|███▏      | 211/666 [00:07<00:16, 28.14it/s] 32%|███▏      | 214/666 [00:07<00:16, 28.15it/s] 33%|███▎      | 217/666 [00:07<00:15, 28.16it/s] 33%|███▎      | 220/666 [00:07<00:15, 28.16it/s] 33%|███▎      | 223/666 [00:08<00:15, 28.17it/s] 34%|███▍      | 226/666 [00:08<00:15, 28.17it/s] 34%|███▍      | 229/666 [00:08<00:15, 28.16it/s] 35%|███▍      | 232/666 [00:08<00:15, 28.17it/s] 35%|███▌      | 235/666 [00:08<00:15, 28.16it/s] 36%|███▌      | 238/666 [00:08<00:15, 28.15it/s] 36%|███▌      | 241/666 [00:08<00:15, 28.16it/s] 37%|███▋      | 244/666 [00:08<00:14, 28.15it/s] 37%|███▋      | 247/666 [00:08<00:14, 28.16it/s] 38%|███▊      | 250/666 [00:09<00:14, 28.16it/s] 38%|███▊      | 253/666 [00:09<00:14, 28.16it/s] 38%|███▊      | 256/666 [00:09<00:14, 28.18it/s] 39%|███▉      | 259/666 [00:09<00:14, 28.17it/s] 39%|███▉      | 262/666 [00:09<00:14, 28.18it/s] 40%|███▉      | 265/666 [00:09<00:14, 28.18it/s] 40%|████      | 268/666 [00:09<00:14, 28.16it/s] 41%|████      | 271/666 [00:09<00:14, 28.17it/s] 41%|████      | 274/666 [00:09<00:13, 28.17it/s] 42%|████▏     | 277/666 [00:09<00:13, 28.17it/s] 42%|████▏     | 280/666 [00:10<00:13, 28.19it/s] 42%|████▏     | 283/666 [00:10<00:13, 28.18it/s] 43%|████▎     | 286/666 [00:10<00:13, 28.17it/s] 43%|████▎     | 289/666 [00:10<00:13, 28.19it/s] 44%|████▍     | 292/666 [00:10<00:13, 28.17it/s] 44%|████▍     | 295/666 [00:10<00:13, 28.17it/s] 45%|████▍     | 298/666 [00:10<00:13, 28.17it/s] 45%|████▌     | 301/666 [00:10<00:12, 28.16it/s] 46%|████▌     | 304/666 [00:10<00:12, 28.16it/s] 46%|████▌     | 307/666 [00:11<00:12, 28.15it/s] 47%|████▋     | 310/666 [00:11<00:12, 28.16it/s] 47%|████▋     | 313/666 [00:11<00:12, 28.17it/s] 47%|████▋     | 316/666 [00:11<00:12, 28.15it/s] 48%|████▊     | 319/666 [00:11<00:12, 28.16it/s] 48%|████▊     | 322/666 [00:11<00:12, 28.15it/s] 49%|████▉     | 325/666 [00:11<00:12, 28.16it/s] 49%|████▉     | 328/666 [00:11<00:12, 28.15it/s] 50%|████▉     | 331/666 [00:11<00:11, 28.15it/s] 50%|█████     | 334/666 [00:12<00:11, 28.15it/s] 51%|█████     | 337/666 [00:12<00:11, 28.16it/s] 51%|█████     | 340/666 [00:12<00:11, 28.15it/s] 52%|█████▏    | 343/666 [00:12<00:11, 28.17it/s] 52%|█████▏    | 346/666 [00:12<00:11, 28.18it/s] 52%|█████▏    | 349/666 [00:12<00:11, 28.18it/s] 53%|█████▎    | 352/666 [00:12<00:11, 28.19it/s] 53%|█████▎    | 355/666 [00:12<00:11, 28.17it/s] 54%|█████▍    | 358/666 [00:12<00:10, 28.17it/s] 54%|█████▍    | 361/666 [00:12<00:10, 28.18it/s] 55%|█████▍    | 364/666 [00:13<00:10, 28.17it/s] 55%|█████▌    | 367/666 [00:13<00:10, 28.17it/s] 56%|█████▌    | 370/666 [00:13<00:10, 28.17it/s] 56%|█████▌    | 373/666 [00:13<00:10, 28.12it/s] 56%|█████▋    | 376/666 [00:13<00:10, 28.14it/s] 57%|█████▋    | 379/666 [00:13<00:10, 28.16it/s] 57%|█████▋    | 382/666 [00:13<00:10, 28.16it/s] 58%|█████▊    | 385/666 [00:13<00:09, 28.16it/s] 58%|█████▊    | 388/666 [00:13<00:09, 28.16it/s] 59%|█████▊    | 391/666 [00:14<00:09, 28.14it/s] 59%|█████▉    | 394/666 [00:14<00:09, 28.12it/s] 60%|█████▉    | 397/666 [00:14<00:09, 28.07it/s] 60%|██████    | 400/666 [00:14<00:09, 28.06it/s] 61%|██████    | 403/666 [00:14<00:09, 28.08it/s] 61%|██████    | 406/666 [00:14<00:09, 28.11it/s] 61%|██████▏   | 409/666 [00:14<00:09, 28.12it/s] 62%|██████▏   | 412/666 [00:14<00:09, 28.14it/s] 62%|██████▏   | 415/666 [00:14<00:08, 28.14it/s] 63%|██████▎   | 418/666 [00:14<00:08, 28.13it/s] 63%|██████▎   | 421/666 [00:15<00:08, 28.14it/s] 64%|██████▎   | 424/666 [00:15<00:08, 28.14it/s] 64%|██████▍   | 427/666 [00:15<00:08, 28.13it/s] 65%|██████▍   | 430/666 [00:15<00:08, 28.15it/s] 65%|██████▌   | 433/666 [00:15<00:08, 28.14it/s] 65%|██████▌   | 436/666 [00:15<00:08, 28.15it/s] 66%|██████▌   | 439/666 [00:15<00:08, 28.16it/s] 66%|██████▋   | 442/666 [00:15<00:07, 28.15it/s] 67%|██████▋   | 445/666 [00:15<00:07, 28.14it/s] 67%|██████▋   | 448/666 [00:16<00:07, 28.14it/s] 68%|██████▊   | 451/666 [00:16<00:07, 28.14it/s] 68%|██████▊   | 454/666 [00:16<00:07, 28.13it/s] 69%|██████▊   | 457/666 [00:16<00:07, 28.15it/s] 69%|██████▉   | 460/666 [00:16<00:07, 28.14it/s] 70%|██████▉   | 463/666 [00:16<00:07, 28.16it/s] 70%|██████▉   | 466/666 [00:16<00:07, 28.17it/s] 70%|███████   | 469/666 [00:16<00:06, 28.16it/s] 71%|███████   | 472/666 [00:16<00:06, 28.17it/s] 71%|███████▏  | 475/666 [00:17<00:06, 28.15it/s] 72%|███████▏  | 478/666 [00:17<00:06, 28.12it/s] 72%|███████▏  | 481/666 [00:17<00:06, 28.13it/s] 73%|███████▎  | 484/666 [00:17<00:06, 28.14it/s] 73%|███████▎  | 487/666 [00:17<00:06, 28.14it/s] 74%|███████▎  | 490/666 [00:17<00:06, 28.15it/s] 74%|███████▍  | 493/666 [00:17<00:06, 28.14it/s] 74%|███████▍  | 496/666 [00:17<00:06, 28.14it/s] 75%|███████▍  | 499/666 [00:17<00:05, 28.16it/s] 75%|███████▌  | 502/666 [00:17<00:05, 28.15it/s] 76%|███████▌  | 505/666 [00:18<00:05, 28.16it/s] 76%|███████▋  | 508/666 [00:18<00:05, 28.16it/s] 77%|███████▋  | 511/666 [00:18<00:05, 28.14it/s] 77%|███████▋  | 514/666 [00:18<00:05, 28.15it/s] 78%|███████▊  | 517/666 [00:18<00:05, 28.17it/s] 78%|███████▊  | 520/666 [00:18<00:05, 28.17it/s] 79%|███████▊  | 523/666 [00:18<00:05, 28.17it/s] 79%|███████▉  | 526/666 [00:18<00:04, 28.17it/s] 79%|███████▉  | 529/666 [00:18<00:04, 28.15it/s] 80%|███████▉  | 532/666 [00:19<00:04, 28.15it/s] 80%|████████  | 535/666 [00:19<00:04, 28.15it/s] 81%|████████  | 538/666 [00:19<00:04, 28.08it/s] 81%|████████  | 541/666 [00:19<00:04, 28.04it/s] 82%|████████▏ | 544/666 [00:19<00:04, 28.07it/s] 82%|████████▏ | 547/666 [00:19<00:04, 28.09it/s] 83%|████████▎ | 550/666 [00:19<00:04, 28.11it/s] 83%|████████▎ | 553/666 [00:19<00:04, 28.12it/s] 83%|████████▎ | 556/666 [00:19<00:03, 28.12it/s] 84%|████████▍ | 559/666 [00:20<00:03, 28.14it/s] 84%|████████▍ | 562/666 [00:20<00:03, 28.15it/s] 85%|████████▍ | 565/666 [00:20<00:03, 28.14it/s] 85%|████████▌ | 568/666 [00:20<00:03, 28.16it/s] 86%|████████▌ | 571/666 [00:20<00:03, 28.15it/s] 86%|████████▌ | 574/666 [00:20<00:03, 28.14it/s] 87%|████████▋ | 577/666 [00:20<00:03, 28.15it/s] 87%|████████▋ | 580/666 [00:20<00:03, 28.15it/s] 88%|████████▊ | 583/666 [00:20<00:02, 28.16it/s] 88%|████████▊ | 586/666 [00:20<00:02, 28.17it/s] 88%|████████▊ | 589/666 [00:21<00:02, 28.15it/s] 89%|████████▉ | 592/666 [00:21<00:02, 28.16it/s] 89%|████████▉ | 595/666 [00:21<00:02, 28.17it/s] 90%|████████▉ | 598/666 [00:21<00:02, 28.15it/s] 90%|█████████ | 601/666 [00:21<00:02, 28.15it/s] 91%|█████████ | 604/666 [00:21<00:02, 28.16it/s] 91%|█████████ | 607/666 [00:21<00:02, 28.15it/s] 92%|█████████▏| 610/666 [00:21<00:01, 28.16it/s] 92%|█████████▏| 613/666 [00:21<00:01, 28.14it/s] 92%|█████████▏| 616/666 [00:22<00:01, 28.13it/s] 93%|█████████▎| 619/666 [00:22<00:01, 28.14it/s] 93%|█████████▎| 622/666 [00:22<00:01, 28.15it/s] 94%|█████████▍| 625/666 [00:22<00:01, 28.14it/s] 94%|█████████▍| 628/666 [00:22<00:01, 28.15it/s] 95%|█████████▍| 631/666 [00:22<00:01, 28.13it/s] 95%|█████████▌| 634/666 [00:22<00:01, 28.13it/s] 96%|█████████▌| 637/666 [00:22<00:01, 28.15it/s] 96%|█████████▌| 640/666 [00:22<00:00, 28.13it/s] 97%|█████████▋| 643/666 [00:22<00:00, 28.13it/s] 97%|█████████▋| 646/666 [00:23<00:00, 28.15it/s] 97%|█████████▋| 649/666 [00:23<00:00, 28.14it/s] 98%|█████████▊| 652/666 [00:23<00:00, 28.16it/s] 98%|█████████▊| 655/666 [00:23<00:00, 28.17it/s] 99%|█████████▉| 658/666 [00:23<00:00, 28.14it/s] 99%|█████████▉| 661/666 [00:23<00:00, 27.68it/s]100%|█████████▉| 664/666 [00:23<00:00, 27.89it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.88it/s][A
  6%|▌         | 10/167 [00:00<00:03, 51.54it/s][A
 18%|█▊        | 30/167 [00:00<00:01, 113.71it/s][A
 31%|███       | 51/167 [00:00<00:00, 147.45it/s][A
 43%|████▎     | 72/167 [00:00<00:00, 167.02it/s][A
 56%|█████▌    | 93/167 [00:00<00:00, 178.87it/s][A
 68%|██████▊   | 114/167 [00:00<00:00, 186.43it/s][A
 81%|████████  | 135/167 [00:00<00:00, 191.07it/s][A
 93%|█████████▎| 155/167 [00:00<00:00, 193.78it/s][A100%|██████████| 167/167 [00:01<00:00, 158.15it/s]
2022-11-28 21:24:12,982 P53751 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:24:12,983 P53751 INFO Monitor(max) STOP: -10.617075 !
2022-11-28 21:24:12,983 P53751 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:24:12,983 P53751 INFO Early stopping at epoch=3
2022-11-28 21:24:12,983 P53751 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:25<00:00, 26.56it/s]
2022-11-28 21:24:13,038 P53751 INFO Train loss: 69.009461
2022-11-28 21:24:13,038 P53751 INFO Training finished.
2022-11-28 21:24:13,038 P53751 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_006_88b6e656.model
2022-11-28 21:24:13,237 P53751 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:51,  5.99it/s]  2%|▏         | 10/666 [00:00<00:16, 40.71it/s]  5%|▍         | 30/666 [00:00<00:06, 98.68it/s]  8%|▊         | 51/666 [00:00<00:04, 135.10it/s] 11%|█         | 72/666 [00:00<00:03, 158.31it/s] 14%|█▍        | 93/666 [00:00<00:03, 173.71it/s] 17%|█▋        | 114/666 [00:00<00:03, 183.86it/s] 20%|██        | 135/666 [00:00<00:02, 190.41it/s] 23%|██▎       | 156/666 [00:01<00:02, 194.30it/s] 27%|██▋       | 177/666 [00:01<00:02, 197.27it/s] 30%|██▉       | 198/666 [00:01<00:02, 199.78it/s] 33%|███▎      | 219/666 [00:01<00:02, 201.84it/s] 36%|███▌      | 240/666 [00:01<00:02, 203.25it/s] 39%|███▉      | 261/666 [00:01<00:01, 204.19it/s] 42%|████▏     | 282/666 [00:01<00:01, 204.58it/s] 45%|████▌     | 303/666 [00:01<00:01, 205.07it/s] 49%|████▊     | 324/666 [00:01<00:01, 205.49it/s] 52%|█████▏    | 345/666 [00:01<00:01, 205.83it/s] 55%|█████▍    | 366/666 [00:02<00:01, 203.75it/s] 58%|█████▊    | 387/666 [00:02<00:01, 203.49it/s] 61%|██████▏   | 408/666 [00:02<00:01, 203.28it/s] 64%|██████▍   | 429/666 [00:02<00:01, 203.45it/s] 68%|██████▊   | 450/666 [00:02<00:01, 204.09it/s] 71%|███████   | 471/666 [00:02<00:00, 204.22it/s] 74%|███████▍  | 492/666 [00:02<00:00, 204.42it/s] 77%|███████▋  | 513/666 [00:02<00:00, 204.59it/s] 80%|████████  | 534/666 [00:02<00:00, 204.81it/s] 83%|████████▎ | 555/666 [00:02<00:00, 204.45it/s] 86%|████████▋ | 576/666 [00:03<00:00, 204.74it/s] 90%|████████▉ | 597/666 [00:03<00:00, 204.63it/s] 93%|█████████▎| 618/666 [00:03<00:00, 204.48it/s] 96%|█████████▌| 639/666 [00:03<00:00, 204.89it/s] 99%|█████████▉| 660/666 [00:03<00:00, 198.51it/s]100%|██████████| 666/666 [00:03<00:00, 187.12it/s]
2022-11-28 21:24:17,253 P53751 INFO [Metrics] logloss: 11.123019 - AUC: 0.499893
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:19,  8.48it/s]  6%|▌         | 10/167 [00:00<00:03, 50.70it/s] 17%|█▋        | 29/167 [00:00<00:01, 108.05it/s] 29%|██▉       | 49/167 [00:00<00:00, 139.93it/s] 41%|████▏     | 69/167 [00:00<00:00, 158.10it/s] 53%|█████▎    | 89/167 [00:00<00:00, 170.52it/s] 65%|██████▌   | 109/167 [00:00<00:00, 179.12it/s] 77%|███████▋  | 129/167 [00:00<00:00, 184.90it/s] 89%|████████▉ | 149/167 [00:00<00:00, 189.36it/s]100%|██████████| 167/167 [00:01<00:00, 154.60it/s]
2022-11-28 21:24:18,444 P53751 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:24:21,219 P55542 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "64",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_007_a22209ce",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:24:21,221 P55542 INFO Set up feature encoder...
2022-11-28 21:24:21,222 P55542 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:24:21,223 P55542 INFO Loading data...
2022-11-28 21:24:21,226 P55542 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:24:21,449 P55542 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:24:21,546 P55542 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:24:21,546 P55542 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:24:21,546 P55542 INFO Loading train data done.
2022-11-28 21:24:24,249 P55542 INFO Total number of parameters: 15268036.
2022-11-28 21:24:24,249 P55542 INFO Start training: 666 batches/epoch
2022-11-28 21:24:24,249 P55542 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:24:24.586 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:55542 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:24:24.618 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:55542 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:25,  1.12s/it]  1%|          | 7/666 [00:01<01:27,  7.57it/s]  2%|▏         | 13/666 [00:01<00:45, 14.22it/s]  3%|▎         | 20/666 [00:01<00:28, 22.79it/s]  4%|▍         | 27/666 [00:01<00:20, 31.13it/s]  5%|▌         | 34/666 [00:01<00:16, 39.05it/s]  6%|▌         | 41/666 [00:01<00:13, 45.96it/s]  7%|▋         | 48/666 [00:01<00:11, 51.71it/s]  8%|▊         | 55/666 [00:01<00:10, 56.29it/s]  9%|▉         | 62/666 [00:02<00:10, 59.83it/s] 10%|█         | 69/666 [00:02<00:09, 62.41it/s] 11%|█▏        | 76/666 [00:02<00:09, 64.40it/s] 12%|█▏        | 83/666 [00:02<00:08, 65.81it/s] 14%|█▎        | 90/666 [00:02<00:08, 66.85it/s] 15%|█▍        | 97/666 [00:02<00:08, 67.63it/s] 16%|█▌        | 104/666 [00:02<00:08, 68.02it/s] 17%|█▋        | 111/666 [00:02<00:08, 68.39it/s] 18%|█▊        | 118/666 [00:02<00:07, 68.63it/s] 19%|█▉        | 125/666 [00:02<00:08, 67.01it/s] 20%|█▉        | 132/666 [00:03<00:07, 67.54it/s] 21%|██        | 139/666 [00:03<00:07, 68.00it/s] 22%|██▏       | 146/666 [00:03<00:07, 68.37it/s] 23%|██▎       | 153/666 [00:03<00:07, 68.67it/s] 24%|██▍       | 160/666 [00:03<00:07, 68.86it/s] 25%|██▌       | 167/666 [00:03<00:07, 69.00it/s] 26%|██▌       | 174/666 [00:03<00:07, 69.12it/s] 27%|██▋       | 181/666 [00:03<00:07, 69.17it/s] 28%|██▊       | 188/666 [00:03<00:06, 69.17it/s] 29%|██▉       | 195/666 [00:04<00:06, 69.12it/s] 30%|███       | 202/666 [00:04<00:06, 69.20it/s] 31%|███▏      | 209/666 [00:04<00:06, 69.25it/s] 32%|███▏      | 216/666 [00:04<00:06, 69.32it/s] 33%|███▎      | 223/666 [00:04<00:06, 69.34it/s] 35%|███▍      | 230/666 [00:04<00:06, 69.27it/s] 36%|███▌      | 237/666 [00:04<00:06, 69.31it/s] 37%|███▋      | 244/666 [00:04<00:06, 69.34it/s] 38%|███▊      | 251/666 [00:04<00:05, 69.33it/s] 39%|███▊      | 258/666 [00:04<00:05, 69.33it/s] 40%|███▉      | 265/666 [00:05<00:05, 69.32it/s] 41%|████      | 272/666 [00:05<00:05, 69.26it/s] 42%|████▏     | 279/666 [00:05<00:05, 69.29it/s] 43%|████▎     | 286/666 [00:05<00:05, 69.31it/s] 44%|████▍     | 293/666 [00:05<00:05, 69.28it/s] 45%|████▌     | 300/666 [00:05<00:05, 69.29it/s] 46%|████▌     | 307/666 [00:05<00:05, 69.28it/s] 47%|████▋     | 314/666 [00:05<00:05, 69.26it/s] 48%|████▊     | 321/666 [00:05<00:04, 69.28it/s] 49%|████▉     | 328/666 [00:05<00:04, 69.22it/s] 50%|█████     | 335/666 [00:06<00:04, 69.26it/s] 51%|█████▏    | 342/666 [00:06<00:04, 69.32it/s] 52%|█████▏    | 349/666 [00:06<00:04, 69.31it/s] 53%|█████▎    | 356/666 [00:06<00:04, 69.25it/s] 55%|█████▍    | 363/666 [00:06<00:04, 69.33it/s] 56%|█████▌    | 370/666 [00:06<00:04, 69.32it/s] 57%|█████▋    | 377/666 [00:06<00:04, 69.27it/s] 58%|█████▊    | 384/666 [00:06<00:04, 69.25it/s] 59%|█████▊    | 391/666 [00:06<00:03, 69.25it/s] 60%|█████▉    | 398/666 [00:06<00:03, 69.22it/s] 61%|██████    | 405/666 [00:07<00:03, 69.19it/s] 62%|██████▏   | 412/666 [00:07<00:03, 69.22it/s] 63%|██████▎   | 419/666 [00:07<00:03, 69.19it/s] 64%|██████▍   | 426/666 [00:07<00:03, 69.25it/s] 65%|██████▌   | 433/666 [00:07<00:03, 69.25it/s] 66%|██████▌   | 440/666 [00:07<00:03, 69.26it/s] 67%|██████▋   | 447/666 [00:07<00:03, 69.24it/s] 68%|██████▊   | 454/666 [00:07<00:03, 69.25it/s] 69%|██████▉   | 461/666 [00:07<00:02, 69.23it/s] 70%|███████   | 468/666 [00:07<00:02, 69.21it/s] 71%|███████▏  | 475/666 [00:08<00:02, 69.19it/s] 72%|███████▏  | 482/666 [00:08<00:02, 69.17it/s] 73%|███████▎  | 489/666 [00:08<00:02, 69.25it/s] 74%|███████▍  | 496/666 [00:08<00:02, 69.26it/s] 76%|███████▌  | 503/666 [00:08<00:02, 69.25it/s] 77%|███████▋  | 510/666 [00:08<00:02, 69.23it/s] 78%|███████▊  | 517/666 [00:08<00:02, 69.25it/s] 79%|███████▊  | 524/666 [00:08<00:02, 69.23it/s] 80%|███████▉  | 531/666 [00:08<00:01, 69.27it/s] 81%|████████  | 538/666 [00:08<00:01, 68.64it/s] 82%|████████▏ | 545/666 [00:09<00:01, 68.72it/s] 83%|████████▎ | 552/666 [00:09<00:01, 68.80it/s] 84%|████████▍ | 559/666 [00:09<00:01, 68.92it/s] 85%|████████▍ | 566/666 [00:09<00:01, 68.99it/s] 86%|████████▌ | 573/666 [00:09<00:01, 69.04it/s] 87%|████████▋ | 580/666 [00:09<00:01, 69.10it/s] 88%|████████▊ | 587/666 [00:09<00:01, 69.09it/s] 89%|████████▉ | 594/666 [00:09<00:01, 69.15it/s] 90%|█████████ | 601/666 [00:09<00:00, 69.20it/s] 91%|█████████▏| 608/666 [00:09<00:00, 69.16it/s] 92%|█████████▏| 615/666 [00:10<00:00, 69.15it/s] 93%|█████████▎| 622/666 [00:10<00:00, 69.13it/s] 94%|█████████▍| 629/666 [00:10<00:00, 69.13it/s] 95%|█████████▌| 636/666 [00:10<00:00, 69.15it/s] 97%|█████████▋| 643/666 [00:10<00:00, 69.16it/s] 98%|█████████▊| 650/666 [00:10<00:00, 69.17it/s] 99%|█████████▊| 657/666 [00:10<00:00, 69.19it/s]100%|█████████▉| 664/666 [00:10<00:00, 68.25it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.13it/s][A
  6%|▌         | 10/167 [00:00<00:03, 52.20it/s][A
 20%|██        | 34/167 [00:00<00:01, 131.96it/s][A
 35%|███▍      | 58/167 [00:00<00:00, 172.01it/s][A
 49%|████▉     | 82/167 [00:00<00:00, 194.41it/s][A
 63%|██████▎   | 106/167 [00:00<00:00, 208.53it/s][A
 78%|███████▊  | 130/167 [00:00<00:00, 217.60it/s][A
 92%|█████████▏| 154/167 [00:00<00:00, 223.54it/s][A100%|██████████| 167/167 [00:00<00:00, 180.27it/s]
2022-11-28 21:24:36,104 P55542 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:24:36,105 P55542 INFO Save best model: monitor(max): -4.497089
2022-11-28 21:24:36,469 P55542 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:12<00:00, 54.34it/s]
2022-11-28 21:24:36,507 P55542 INFO Train loss: 30.976341
2022-11-28 21:24:36,507 P55542 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:51,  5.96it/s]  1%|          | 8/666 [00:00<00:19, 33.97it/s]  2%|▏         | 13/666 [00:00<00:17, 38.07it/s]  3%|▎         | 20/666 [00:00<00:13, 48.99it/s]  4%|▍         | 27/666 [00:00<00:11, 55.84it/s]  5%|▌         | 34/666 [00:00<00:10, 60.32it/s]  6%|▌         | 41/666 [00:00<00:09, 63.31it/s]  7%|▋         | 48/666 [00:00<00:09, 65.28it/s]  8%|▊         | 55/666 [00:00<00:09, 66.68it/s]  9%|▉         | 62/666 [00:01<00:08, 67.66it/s] 10%|█         | 69/666 [00:01<00:08, 68.31it/s] 11%|█▏        | 76/666 [00:01<00:08, 68.78it/s] 12%|█▏        | 83/666 [00:01<00:08, 69.11it/s] 14%|█▎        | 90/666 [00:01<00:08, 69.33it/s] 15%|█▍        | 97/666 [00:01<00:08, 69.45it/s] 16%|█▌        | 104/666 [00:01<00:08, 69.55it/s] 17%|█▋        | 111/666 [00:01<00:07, 69.59it/s] 18%|█▊        | 118/666 [00:01<00:07, 69.66it/s] 19%|█▉        | 125/666 [00:01<00:07, 69.75it/s] 20%|█▉        | 132/666 [00:02<00:07, 69.77it/s] 21%|██        | 139/666 [00:02<00:07, 69.80it/s] 22%|██▏       | 146/666 [00:02<00:07, 69.77it/s] 23%|██▎       | 153/666 [00:02<00:07, 69.78it/s] 24%|██▍       | 160/666 [00:02<00:07, 69.81it/s] 25%|██▌       | 167/666 [00:02<00:07, 69.80it/s] 26%|██▌       | 174/666 [00:02<00:07, 69.78it/s] 27%|██▋       | 181/666 [00:02<00:06, 69.81it/s] 28%|██▊       | 188/666 [00:02<00:06, 69.82it/s] 29%|██▉       | 195/666 [00:02<00:06, 69.82it/s] 30%|███       | 202/666 [00:03<00:06, 69.84it/s] 31%|███▏      | 209/666 [00:03<00:06, 69.82it/s] 32%|███▏      | 216/666 [00:03<00:06, 69.83it/s] 33%|███▎      | 223/666 [00:03<00:06, 69.84it/s] 35%|███▍      | 230/666 [00:03<00:06, 69.85it/s] 36%|███▌      | 237/666 [00:03<00:06, 69.81it/s] 37%|███▋      | 244/666 [00:03<00:06, 69.85it/s] 38%|███▊      | 251/666 [00:03<00:05, 69.88it/s] 39%|███▊      | 258/666 [00:03<00:05, 69.89it/s] 40%|███▉      | 265/666 [00:04<00:05, 69.91it/s] 41%|████      | 272/666 [00:04<00:05, 69.91it/s] 42%|████▏     | 279/666 [00:04<00:05, 69.87it/s] 43%|████▎     | 286/666 [00:04<00:05, 69.87it/s] 44%|████▍     | 293/666 [00:04<00:05, 69.82it/s] 45%|████▌     | 300/666 [00:04<00:05, 69.78it/s] 46%|████▌     | 307/666 [00:04<00:05, 69.83it/s] 47%|████▋     | 315/666 [00:04<00:05, 69.89it/s] 48%|████▊     | 322/666 [00:04<00:04, 69.87it/s] 49%|████▉     | 329/666 [00:04<00:04, 69.89it/s] 50%|█████     | 336/666 [00:05<00:04, 69.87it/s] 52%|█████▏    | 343/666 [00:05<00:04, 69.86it/s] 53%|█████▎    | 350/666 [00:05<00:04, 69.86it/s] 54%|█████▎    | 357/666 [00:05<00:04, 69.85it/s] 55%|█████▍    | 364/666 [00:05<00:04, 69.83it/s] 56%|█████▌    | 371/666 [00:05<00:04, 69.84it/s] 57%|█████▋    | 378/666 [00:05<00:04, 69.85it/s] 58%|█████▊    | 385/666 [00:05<00:04, 69.85it/s] 59%|█████▉    | 392/666 [00:05<00:03, 69.86it/s] 60%|█████▉    | 399/666 [00:05<00:03, 69.85it/s] 61%|██████    | 406/666 [00:06<00:03, 69.87it/s] 62%|██████▏   | 413/666 [00:06<00:03, 69.90it/s] 63%|██████▎   | 420/666 [00:06<00:03, 69.87it/s] 64%|██████▍   | 427/666 [00:06<00:03, 69.88it/s] 65%|██████▌   | 434/666 [00:06<00:03, 69.86it/s] 66%|██████▌   | 441/666 [00:06<00:03, 69.83it/s] 67%|██████▋   | 448/666 [00:06<00:03, 69.84it/s] 68%|██████▊   | 455/666 [00:06<00:03, 69.86it/s] 69%|██████▉   | 462/666 [00:06<00:02, 69.85it/s] 70%|███████   | 469/666 [00:06<00:02, 69.86it/s] 71%|███████▏  | 476/666 [00:07<00:02, 69.89it/s] 73%|███████▎  | 483/666 [00:07<00:02, 69.87it/s] 74%|███████▎  | 490/666 [00:07<00:02, 69.88it/s] 75%|███████▍  | 497/666 [00:07<00:02, 69.85it/s] 76%|███████▌  | 504/666 [00:07<00:02, 69.87it/s] 77%|███████▋  | 511/666 [00:07<00:02, 69.86it/s] 78%|███████▊  | 518/666 [00:07<00:02, 69.82it/s] 79%|███████▉  | 525/666 [00:07<00:02, 69.77it/s] 80%|███████▉  | 532/666 [00:07<00:01, 69.78it/s] 81%|████████  | 539/666 [00:07<00:01, 67.11it/s] 82%|████████▏ | 546/666 [00:08<00:01, 67.88it/s] 83%|████████▎ | 553/666 [00:08<00:01, 68.37it/s] 84%|████████▍ | 560/666 [00:08<00:01, 68.67it/s] 85%|████████▌ | 567/666 [00:08<00:01, 68.91it/s] 86%|████████▌ | 574/666 [00:08<00:01, 69.08it/s] 87%|████████▋ | 581/666 [00:08<00:01, 69.15it/s] 88%|████████▊ | 588/666 [00:08<00:01, 69.28it/s] 89%|████████▉ | 595/666 [00:08<00:01, 69.35it/s] 90%|█████████ | 602/666 [00:08<00:00, 69.34it/s] 91%|█████████▏| 609/666 [00:08<00:00, 69.35it/s] 92%|█████████▏| 616/666 [00:09<00:00, 69.33it/s] 94%|█████████▎| 623/666 [00:09<00:00, 69.36it/s] 95%|█████████▍| 630/666 [00:09<00:00, 69.40it/s] 96%|█████████▌| 637/666 [00:09<00:00, 69.42it/s] 97%|█████████▋| 644/666 [00:09<00:00, 69.38it/s] 98%|█████████▊| 651/666 [00:09<00:00, 69.39it/s] 99%|█████████▉| 658/666 [00:09<00:00, 69.38it/s]100%|█████████▉| 665/666 [00:09<00:00, 68.28it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.46it/s][A
  6%|▌         | 10/167 [00:00<00:03, 46.30it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 120.39it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 161.84it/s][A
 49%|████▊     | 81/167 [00:00<00:00, 186.41it/s][A
 63%|██████▎   | 105/167 [00:00<00:00, 201.86it/s][A
 77%|███████▋  | 129/167 [00:00<00:00, 211.18it/s][A
 92%|█████████▏| 153/167 [00:00<00:00, 217.32it/s][A100%|██████████| 167/167 [00:00<00:00, 171.89it/s]
2022-11-28 21:24:47,362 P55542 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:24:47,362 P55542 INFO Monitor(max) STOP: -4.497089 !
2022-11-28 21:24:47,362 P55542 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:24:47,363 P55542 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:10<00:00, 61.06it/s]
2022-11-28 21:24:47,415 P55542 INFO Train loss: 30.976982
2022-11-28 21:24:47,415 P55542 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:51,  5.96it/s]  1%|          | 8/666 [00:00<00:18, 34.84it/s]  2%|▏         | 13/666 [00:00<00:17, 38.40it/s]  3%|▎         | 20/666 [00:00<00:13, 48.69it/s]  4%|▍         | 27/666 [00:00<00:11, 55.06it/s]  5%|▌         | 34/666 [00:00<00:10, 59.09it/s]  6%|▌         | 41/666 [00:00<00:10, 61.83it/s]  7%|▋         | 48/666 [00:00<00:09, 63.67it/s]  8%|▊         | 55/666 [00:01<00:09, 64.93it/s]  9%|▉         | 62/666 [00:01<00:09, 65.77it/s] 10%|█         | 69/666 [00:01<00:08, 66.39it/s] 11%|█▏        | 76/666 [00:01<00:08, 66.80it/s] 12%|█▏        | 83/666 [00:01<00:08, 67.07it/s] 14%|█▎        | 90/666 [00:01<00:08, 67.30it/s] 15%|█▍        | 97/666 [00:01<00:08, 67.48it/s] 16%|█▌        | 104/666 [00:01<00:08, 67.52it/s] 17%|█▋        | 111/666 [00:01<00:08, 67.59it/s] 18%|█▊        | 118/666 [00:01<00:08, 67.62it/s] 19%|█▉        | 125/666 [00:02<00:07, 67.65it/s] 20%|█▉        | 132/666 [00:02<00:07, 67.68it/s] 21%|██        | 139/666 [00:02<00:07, 67.71it/s] 22%|██▏       | 146/666 [00:02<00:07, 67.65it/s] 23%|██▎       | 153/666 [00:02<00:07, 67.69it/s] 24%|██▍       | 160/666 [00:02<00:07, 67.71it/s] 25%|██▌       | 167/666 [00:02<00:07, 67.70it/s] 26%|██▌       | 174/666 [00:02<00:07, 67.74it/s] 27%|██▋       | 181/666 [00:02<00:07, 67.78it/s] 28%|██▊       | 188/666 [00:02<00:07, 67.75it/s] 29%|██▉       | 195/666 [00:03<00:06, 67.76it/s] 30%|███       | 202/666 [00:03<00:06, 67.75it/s] 31%|███▏      | 209/666 [00:03<00:06, 67.76it/s] 32%|███▏      | 216/666 [00:03<00:06, 67.76it/s] 33%|███▎      | 223/666 [00:03<00:06, 67.82it/s] 35%|███▍      | 230/666 [00:03<00:06, 67.79it/s] 36%|███▌      | 237/666 [00:03<00:06, 67.75it/s] 37%|███▋      | 244/666 [00:03<00:06, 67.74it/s] 38%|███▊      | 251/666 [00:03<00:06, 67.74it/s] 39%|███▊      | 258/666 [00:04<00:06, 67.75it/s] 40%|███▉      | 265/666 [00:04<00:05, 67.78it/s] 41%|████      | 272/666 [00:04<00:05, 67.75it/s] 42%|████▏     | 279/666 [00:04<00:05, 67.79it/s] 43%|████▎     | 286/666 [00:04<00:05, 67.81it/s] 44%|████▍     | 293/666 [00:04<00:05, 67.80it/s] 45%|████▌     | 300/666 [00:04<00:05, 67.80it/s] 46%|████▌     | 307/666 [00:04<00:05, 67.81it/s] 47%|████▋     | 314/666 [00:04<00:05, 67.80it/s] 48%|████▊     | 321/666 [00:04<00:05, 67.78it/s] 49%|████▉     | 328/666 [00:05<00:04, 67.73it/s] 50%|█████     | 335/666 [00:05<00:04, 67.71it/s] 51%|█████▏    | 342/666 [00:05<00:04, 67.72it/s] 52%|█████▏    | 349/666 [00:05<00:04, 67.73it/s] 53%|█████▎    | 356/666 [00:05<00:04, 67.72it/s] 55%|█████▍    | 363/666 [00:05<00:04, 67.73it/s] 56%|█████▌    | 370/666 [00:05<00:04, 67.75it/s] 57%|█████▋    | 377/666 [00:05<00:04, 67.71it/s] 58%|█████▊    | 384/666 [00:05<00:04, 67.73it/s] 59%|█████▊    | 391/666 [00:05<00:04, 67.72it/s] 60%|█████▉    | 398/666 [00:06<00:03, 67.69it/s] 61%|██████    | 405/666 [00:06<00:03, 67.72it/s] 62%|██████▏   | 412/666 [00:06<00:03, 67.80it/s] 63%|██████▎   | 419/666 [00:06<00:03, 67.86it/s] 64%|██████▍   | 426/666 [00:06<00:03, 67.90it/s] 65%|██████▌   | 433/666 [00:06<00:03, 67.95it/s] 66%|██████▌   | 440/666 [00:06<00:03, 68.00it/s] 67%|██████▋   | 447/666 [00:06<00:03, 67.94it/s] 68%|██████▊   | 454/666 [00:06<00:03, 67.91it/s] 69%|██████▉   | 461/666 [00:06<00:03, 67.95it/s] 70%|███████   | 468/666 [00:07<00:02, 68.01it/s] 71%|███████▏  | 475/666 [00:07<00:02, 68.04it/s] 72%|███████▏  | 482/666 [00:07<00:02, 68.09it/s] 73%|███████▎  | 489/666 [00:07<00:02, 68.11it/s] 74%|███████▍  | 496/666 [00:07<00:02, 68.11it/s] 76%|███████▌  | 503/666 [00:07<00:02, 68.10it/s] 77%|███████▋  | 510/666 [00:07<00:02, 68.04it/s] 78%|███████▊  | 517/666 [00:07<00:02, 68.00it/s] 79%|███████▊  | 524/666 [00:07<00:02, 68.01it/s] 80%|███████▉  | 531/666 [00:08<00:01, 68.03it/s] 81%|████████  | 538/666 [00:08<00:01, 68.00it/s] 82%|████████▏ | 545/666 [00:08<00:01, 68.02it/s] 83%|████████▎ | 552/666 [00:08<00:01, 68.02it/s] 84%|████████▍ | 559/666 [00:08<00:01, 68.02it/s] 85%|████████▍ | 566/666 [00:08<00:01, 68.02it/s] 86%|████████▌ | 573/666 [00:08<00:01, 68.04it/s] 87%|████████▋ | 580/666 [00:08<00:01, 68.00it/s] 88%|████████▊ | 587/666 [00:08<00:01, 67.96it/s] 89%|████████▉ | 594/666 [00:08<00:01, 67.98it/s] 90%|█████████ | 601/666 [00:09<00:00, 68.00it/s] 91%|█████████▏| 608/666 [00:09<00:00, 68.02it/s] 92%|█████████▏| 615/666 [00:09<00:00, 68.02it/s] 93%|█████████▎| 622/666 [00:09<00:00, 68.02it/s] 94%|█████████▍| 629/666 [00:09<00:00, 68.03it/s] 95%|█████████▌| 636/666 [00:09<00:00, 68.04it/s] 97%|█████████▋| 643/666 [00:09<00:00, 68.00it/s] 98%|█████████▊| 650/666 [00:09<00:00, 68.01it/s] 99%|█████████▊| 657/666 [00:09<00:00, 67.98it/s]100%|█████████▉| 664/666 [00:09<00:00, 66.80it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.16it/s][A
  6%|▌         | 10/167 [00:00<00:03, 50.85it/s][A
 20%|██        | 34/167 [00:00<00:01, 130.21it/s][A
 35%|███▍      | 58/167 [00:00<00:00, 170.88it/s][A
 49%|████▉     | 82/167 [00:00<00:00, 193.60it/s][A
 63%|██████▎   | 106/167 [00:00<00:00, 207.28it/s][A
 78%|███████▊  | 130/167 [00:00<00:00, 216.36it/s][A
 92%|█████████▏| 154/167 [00:00<00:00, 222.78it/s][A100%|██████████| 167/167 [00:00<00:00, 177.87it/s]
2022-11-28 21:24:58,485 P55542 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:24:58,485 P55542 INFO Monitor(max) STOP: -4.497089 !
2022-11-28 21:24:58,486 P55542 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:24:58,486 P55542 INFO Early stopping at epoch=3
2022-11-28 21:24:58,486 P55542 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:11<00:00, 59.82it/s]
2022-11-28 21:24:58,533 P55542 INFO Train loss: 30.974828
2022-11-28 21:24:58,533 P55542 INFO Training finished.
2022-11-28 21:24:58,533 P55542 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_007_a22209ce.model
2022-11-28 21:24:58,825 P55542 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:01,  5.48it/s]  2%|▏         | 10/666 [00:00<00:15, 41.18it/s]  5%|▍         | 33/666 [00:00<00:05, 111.15it/s]  8%|▊         | 56/666 [00:00<00:04, 150.87it/s] 12%|█▏        | 79/666 [00:00<00:03, 174.75it/s] 15%|█▌        | 102/666 [00:00<00:02, 190.79it/s] 19%|█▉        | 125/666 [00:00<00:02, 201.23it/s] 22%|██▏       | 147/666 [00:00<00:02, 205.57it/s] 25%|██▌       | 168/666 [00:01<00:02, 203.38it/s] 28%|██▊       | 189/666 [00:01<00:02, 202.31it/s] 32%|███▏      | 210/666 [00:01<00:02, 201.48it/s] 35%|███▍      | 231/666 [00:01<00:02, 201.01it/s] 38%|███▊      | 252/666 [00:01<00:02, 200.14it/s] 41%|████      | 273/666 [00:01<00:01, 199.87it/s] 44%|████▍     | 294/666 [00:01<00:01, 199.51it/s] 47%|████▋     | 314/666 [00:01<00:01, 199.30it/s] 50%|█████     | 334/666 [00:01<00:01, 199.24it/s] 53%|█████▎    | 354/666 [00:01<00:01, 199.09it/s] 56%|█████▌    | 374/666 [00:02<00:01, 198.90it/s] 59%|█████▉    | 394/666 [00:02<00:01, 198.36it/s] 62%|██████▏   | 414/666 [00:02<00:01, 197.10it/s] 65%|██████▌   | 436/666 [00:02<00:01, 202.85it/s] 69%|██████▉   | 458/666 [00:02<00:01, 205.41it/s] 72%|███████▏  | 481/666 [00:02<00:00, 210.49it/s] 76%|███████▌  | 504/666 [00:02<00:00, 213.93it/s] 79%|███████▉  | 526/666 [00:02<00:00, 215.04it/s] 82%|████████▏ | 549/666 [00:02<00:00, 217.49it/s] 86%|████████▌ | 572/666 [00:02<00:00, 219.25it/s] 89%|████████▉ | 594/666 [00:03<00:00, 218.00it/s] 93%|█████████▎| 617/666 [00:03<00:00, 219.19it/s] 96%|█████████▌| 640/666 [00:03<00:00, 220.13it/s]100%|█████████▉| 663/666 [00:03<00:00, 216.12it/s]100%|██████████| 666/666 [00:03<00:00, 192.94it/s]
2022-11-28 21:25:02,725 P55542 INFO [Metrics] logloss: 4.992712 - AUC: 0.500001
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:17,  9.50it/s]  6%|▌         | 10/167 [00:00<00:03, 50.98it/s] 19%|█▉        | 32/167 [00:00<00:01, 123.19it/s] 33%|███▎      | 55/167 [00:00<00:00, 161.11it/s] 46%|████▌     | 77/167 [00:00<00:00, 181.12it/s] 59%|█████▉    | 99/167 [00:00<00:00, 193.21it/s] 72%|███████▏  | 121/167 [00:00<00:00, 201.64it/s] 86%|████████▌ | 144/167 [00:00<00:00, 207.84it/s]100%|██████████| 167/167 [00:00<00:00, 213.31it/s]100%|██████████| 167/167 [00:00<00:00, 169.89it/s]
2022-11-28 21:25:03,822 P55542 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:25:06,202 P57321 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "128",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_008_58c74eee",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:25:06,204 P57321 INFO Set up feature encoder...
2022-11-28 21:25:06,204 P57321 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:25:06,205 P57321 INFO Loading data...
2022-11-28 21:25:06,208 P57321 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:25:06,452 P57321 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:25:06,549 P57321 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:25:06,550 P57321 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:25:06,550 P57321 INFO Loading train data done.
2022-11-28 21:25:09,567 P57321 INFO Total number of parameters: 29989252.
2022-11-28 21:25:09,567 P57321 INFO Start training: 666 batches/epoch
2022-11-28 21:25:09,567 P57321 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:25:09.893 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:57321 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:25:09.925 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:57321 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:36,  1.14s/it]  1%|          | 6/666 [00:01<01:45,  6.23it/s]  2%|▏         | 11/666 [00:01<00:55, 11.90it/s]  2%|▏         | 15/666 [00:01<00:39, 16.31it/s]  3%|▎         | 20/666 [00:01<00:29, 22.22it/s]  4%|▍         | 25/666 [00:01<00:23, 27.56it/s]  5%|▍         | 30/666 [00:01<00:19, 32.18it/s]  5%|▌         | 35/666 [00:01<00:17, 35.95it/s]  6%|▌         | 40/666 [00:02<00:16, 38.92it/s]  7%|▋         | 45/666 [00:02<00:15, 41.17it/s]  8%|▊         | 50/666 [00:02<00:14, 42.87it/s]  8%|▊         | 55/666 [00:02<00:13, 44.12it/s]  9%|▉         | 60/666 [00:02<00:13, 45.02it/s] 10%|▉         | 65/666 [00:02<00:13, 45.64it/s] 11%|█         | 70/666 [00:02<00:12, 46.12it/s] 11%|█▏        | 75/666 [00:02<00:12, 46.41it/s] 12%|█▏        | 80/666 [00:02<00:12, 46.67it/s] 13%|█▎        | 85/666 [00:02<00:12, 46.81it/s] 14%|█▎        | 90/666 [00:03<00:12, 46.94it/s] 14%|█▍        | 95/666 [00:03<00:12, 47.00it/s] 15%|█▌        | 100/666 [00:03<00:12, 47.08it/s] 16%|█▌        | 105/666 [00:03<00:11, 47.12it/s] 17%|█▋        | 110/666 [00:03<00:11, 47.14it/s] 17%|█▋        | 115/666 [00:03<00:11, 47.17it/s] 18%|█▊        | 120/666 [00:03<00:11, 47.16it/s] 19%|█▉        | 125/666 [00:03<00:11, 46.30it/s] 20%|█▉        | 130/666 [00:03<00:11, 46.52it/s] 20%|██        | 135/666 [00:04<00:11, 46.73it/s] 21%|██        | 140/666 [00:04<00:11, 46.85it/s] 22%|██▏       | 145/666 [00:04<00:11, 46.97it/s] 23%|██▎       | 150/666 [00:04<00:10, 47.04it/s] 23%|██▎       | 155/666 [00:04<00:10, 47.09it/s] 24%|██▍       | 160/666 [00:04<00:10, 47.12it/s] 25%|██▍       | 165/666 [00:04<00:10, 47.16it/s] 26%|██▌       | 170/666 [00:04<00:10, 47.17it/s] 26%|██▋       | 175/666 [00:04<00:10, 47.18it/s] 27%|██▋       | 180/666 [00:04<00:10, 47.18it/s] 28%|██▊       | 185/666 [00:05<00:10, 47.18it/s] 29%|██▊       | 190/666 [00:05<00:10, 47.19it/s] 29%|██▉       | 195/666 [00:05<00:09, 47.17it/s] 30%|███       | 200/666 [00:05<00:09, 47.14it/s] 31%|███       | 205/666 [00:05<00:09, 47.18it/s] 32%|███▏      | 210/666 [00:05<00:09, 47.20it/s] 32%|███▏      | 215/666 [00:05<00:09, 47.19it/s] 33%|███▎      | 220/666 [00:05<00:09, 47.21it/s] 34%|███▍      | 225/666 [00:05<00:09, 47.20it/s] 35%|███▍      | 230/666 [00:06<00:09, 47.20it/s] 35%|███▌      | 235/666 [00:06<00:09, 47.20it/s] 36%|███▌      | 240/666 [00:06<00:09, 47.22it/s] 37%|███▋      | 245/666 [00:06<00:08, 47.22it/s] 38%|███▊      | 250/666 [00:06<00:08, 47.24it/s] 38%|███▊      | 255/666 [00:06<00:08, 47.20it/s] 39%|███▉      | 260/666 [00:06<00:08, 47.22it/s] 40%|███▉      | 265/666 [00:06<00:08, 47.22it/s] 41%|████      | 270/666 [00:06<00:08, 47.22it/s] 41%|████▏     | 275/666 [00:06<00:08, 47.19it/s] 42%|████▏     | 280/666 [00:07<00:08, 47.21it/s] 43%|████▎     | 285/666 [00:07<00:08, 47.19it/s] 44%|████▎     | 290/666 [00:07<00:07, 47.21it/s] 44%|████▍     | 295/666 [00:07<00:07, 47.19it/s] 45%|████▌     | 300/666 [00:07<00:07, 47.20it/s] 46%|████▌     | 305/666 [00:07<00:07, 47.18it/s] 47%|████▋     | 310/666 [00:07<00:07, 47.20it/s] 47%|████▋     | 315/666 [00:07<00:07, 47.18it/s] 48%|████▊     | 320/666 [00:07<00:07, 47.16it/s] 49%|████▉     | 325/666 [00:08<00:07, 47.17it/s] 50%|████▉     | 330/666 [00:08<00:07, 47.18it/s] 50%|█████     | 335/666 [00:08<00:07, 47.18it/s] 51%|█████     | 340/666 [00:08<00:06, 47.18it/s] 52%|█████▏    | 345/666 [00:08<00:06, 47.17it/s] 53%|█████▎    | 350/666 [00:08<00:06, 47.17it/s] 53%|█████▎    | 355/666 [00:08<00:06, 47.18it/s] 54%|█████▍    | 360/666 [00:08<00:06, 47.16it/s] 55%|█████▍    | 365/666 [00:08<00:06, 47.18it/s] 56%|█████▌    | 370/666 [00:09<00:06, 47.20it/s] 56%|█████▋    | 375/666 [00:09<00:06, 47.19it/s] 57%|█████▋    | 380/666 [00:09<00:06, 47.17it/s] 58%|█████▊    | 385/666 [00:09<00:05, 47.20it/s] 59%|█████▊    | 390/666 [00:09<00:05, 47.17it/s] 59%|█████▉    | 395/666 [00:09<00:05, 47.19it/s] 60%|██████    | 400/666 [00:09<00:05, 47.19it/s] 61%|██████    | 405/666 [00:09<00:05, 47.20it/s] 62%|██████▏   | 410/666 [00:09<00:05, 47.19it/s] 62%|██████▏   | 415/666 [00:09<00:05, 47.21it/s] 63%|██████▎   | 420/666 [00:10<00:05, 47.19it/s] 64%|██████▍   | 425/666 [00:10<00:05, 47.20it/s] 65%|██████▍   | 430/666 [00:10<00:05, 47.19it/s] 65%|██████▌   | 435/666 [00:10<00:04, 47.21it/s] 66%|██████▌   | 440/666 [00:10<00:04, 47.20it/s] 67%|██████▋   | 445/666 [00:10<00:04, 47.21it/s] 68%|██████▊   | 450/666 [00:10<00:04, 47.21it/s] 68%|██████▊   | 455/666 [00:10<00:04, 47.21it/s] 69%|██████▉   | 460/666 [00:10<00:04, 47.20it/s] 70%|██████▉   | 465/666 [00:11<00:04, 47.21it/s] 71%|███████   | 470/666 [00:11<00:04, 47.18it/s] 71%|███████▏  | 475/666 [00:11<00:04, 47.21it/s] 72%|███████▏  | 480/666 [00:11<00:03, 47.18it/s] 73%|███████▎  | 485/666 [00:11<00:03, 47.19it/s] 74%|███████▎  | 490/666 [00:11<00:03, 47.19it/s] 74%|███████▍  | 495/666 [00:11<00:03, 47.17it/s] 75%|███████▌  | 500/666 [00:11<00:03, 47.17it/s] 76%|███████▌  | 505/666 [00:11<00:03, 47.18it/s] 77%|███████▋  | 510/666 [00:11<00:03, 47.16it/s] 77%|███████▋  | 515/666 [00:12<00:03, 47.19it/s] 78%|███████▊  | 520/666 [00:12<00:03, 47.18it/s] 79%|███████▉  | 525/666 [00:12<00:02, 47.20it/s] 80%|███████▉  | 530/666 [00:12<00:02, 47.20it/s] 80%|████████  | 535/666 [00:12<00:02, 47.18it/s] 81%|████████  | 540/666 [00:12<00:02, 47.15it/s] 82%|████████▏ | 545/666 [00:12<00:02, 47.20it/s] 83%|████████▎ | 550/666 [00:12<00:02, 47.17it/s] 83%|████████▎ | 555/666 [00:12<00:02, 47.17it/s] 84%|████████▍ | 560/666 [00:13<00:02, 47.15it/s] 85%|████████▍ | 565/666 [00:13<00:02, 47.15it/s] 86%|████████▌ | 570/666 [00:13<00:02, 47.12it/s] 86%|████████▋ | 575/666 [00:13<00:01, 47.13it/s] 87%|████████▋ | 580/666 [00:13<00:01, 47.12it/s] 88%|████████▊ | 585/666 [00:13<00:01, 47.12it/s] 89%|████████▊ | 590/666 [00:13<00:01, 47.11it/s] 89%|████████▉ | 595/666 [00:13<00:01, 47.13it/s] 90%|█████████ | 600/666 [00:13<00:01, 47.13it/s] 91%|█████████ | 605/666 [00:13<00:01, 47.14it/s] 92%|█████████▏| 610/666 [00:14<00:01, 47.15it/s] 92%|█████████▏| 615/666 [00:14<00:01, 47.16it/s] 93%|█████████▎| 620/666 [00:14<00:00, 47.16it/s] 94%|█████████▍| 625/666 [00:14<00:00, 47.17it/s] 95%|█████████▍| 630/666 [00:14<00:00, 47.14it/s] 95%|█████████▌| 635/666 [00:14<00:00, 47.14it/s] 96%|█████████▌| 640/666 [00:14<00:00, 47.14it/s] 97%|█████████▋| 645/666 [00:14<00:00, 47.11it/s] 98%|█████████▊| 650/666 [00:14<00:00, 47.12it/s] 98%|█████████▊| 655/666 [00:15<00:00, 47.12it/s] 99%|█████████▉| 660/666 [00:15<00:00, 46.33it/s]100%|█████████▉| 665/666 [00:15<00:00, 46.71it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  2%|▏         | 3/167 [00:00<00:05, 28.79it/s][A
  6%|▌         | 10/167 [00:00<00:03, 51.60it/s][A
 20%|██        | 34/167 [00:00<00:00, 134.50it/s][A
 35%|███▍      | 58/167 [00:00<00:00, 174.91it/s][A
 49%|████▉     | 82/167 [00:00<00:00, 197.69it/s][A
 63%|██████▎   | 106/167 [00:00<00:00, 210.21it/s][A
 78%|███████▊  | 130/167 [00:00<00:00, 219.28it/s][A
 92%|█████████▏| 154/167 [00:00<00:00, 224.01it/s][A100%|██████████| 167/167 [00:00<00:00, 183.19it/s]
2022-11-28 21:25:25,876 P57321 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:25:25,877 P57321 INFO Save best model: monitor(max): -4.497234
2022-11-28 21:25:26,892 P57321 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:17<00:00, 38.35it/s]
2022-11-28 21:25:26,934 P57321 INFO Train loss: 30.972238
2022-11-28 21:25:26,934 P57321 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:54,  5.83it/s]  1%|          | 6/666 [00:00<00:28, 23.54it/s]  2%|▏         | 11/666 [00:00<00:21, 30.55it/s]  2%|▏         | 16/666 [00:00<00:18, 34.93it/s]  3%|▎         | 21/666 [00:00<00:16, 38.89it/s]  4%|▍         | 26/666 [00:00<00:15, 41.48it/s]  5%|▍         | 31/666 [00:00<00:14, 43.20it/s]  5%|▌         | 36/666 [00:00<00:14, 44.41it/s]  6%|▌         | 41/666 [00:01<00:13, 45.26it/s]  7%|▋         | 46/666 [00:01<00:13, 45.85it/s]  8%|▊         | 51/666 [00:01<00:13, 46.22it/s]  8%|▊         | 56/666 [00:01<00:13, 46.51it/s]  9%|▉         | 61/666 [00:01<00:12, 46.73it/s] 10%|▉         | 66/666 [00:01<00:12, 46.88it/s] 11%|█         | 71/666 [00:01<00:12, 46.97it/s] 11%|█▏        | 76/666 [00:01<00:12, 47.05it/s] 12%|█▏        | 81/666 [00:01<00:12, 47.09it/s] 13%|█▎        | 86/666 [00:02<00:12, 47.12it/s] 14%|█▎        | 91/666 [00:02<00:12, 47.18it/s] 14%|█▍        | 96/666 [00:02<00:12, 47.18it/s] 15%|█▌        | 101/666 [00:02<00:11, 47.17it/s] 16%|█▌        | 106/666 [00:02<00:11, 47.18it/s] 17%|█▋        | 111/666 [00:02<00:11, 47.18it/s] 17%|█▋        | 116/666 [00:02<00:11, 47.17it/s] 18%|█▊        | 121/666 [00:02<00:11, 47.17it/s] 19%|█▉        | 126/666 [00:02<00:11, 47.19it/s] 20%|█▉        | 131/666 [00:02<00:11, 47.18it/s] 20%|██        | 136/666 [00:03<00:11, 47.19it/s] 21%|██        | 141/666 [00:03<00:11, 47.21it/s] 22%|██▏       | 146/666 [00:03<00:11, 47.19it/s] 23%|██▎       | 151/666 [00:03<00:10, 47.19it/s] 23%|██▎       | 156/666 [00:03<00:10, 47.18it/s] 24%|██▍       | 161/666 [00:03<00:10, 47.20it/s] 25%|██▍       | 166/666 [00:03<00:10, 47.18it/s] 26%|██▌       | 171/666 [00:03<00:10, 47.19it/s] 26%|██▋       | 176/666 [00:03<00:10, 47.15it/s] 27%|██▋       | 181/666 [00:04<00:10, 47.16it/s] 28%|██▊       | 186/666 [00:04<00:10, 47.16it/s] 29%|██▊       | 191/666 [00:04<00:10, 47.19it/s] 29%|██▉       | 196/666 [00:04<00:09, 47.19it/s] 30%|███       | 201/666 [00:04<00:09, 47.18it/s] 31%|███       | 206/666 [00:04<00:09, 47.15it/s] 32%|███▏      | 211/666 [00:04<00:09, 47.19it/s] 32%|███▏      | 216/666 [00:04<00:09, 47.16it/s] 33%|███▎      | 221/666 [00:04<00:09, 47.17it/s] 34%|███▍      | 226/666 [00:04<00:09, 47.18it/s] 35%|███▍      | 231/666 [00:05<00:09, 47.17it/s] 35%|███▌      | 236/666 [00:05<00:09, 47.17it/s] 36%|███▌      | 241/666 [00:05<00:09, 47.19it/s] 37%|███▋      | 246/666 [00:05<00:08, 47.18it/s] 38%|███▊      | 251/666 [00:05<00:08, 47.19it/s] 38%|███▊      | 256/666 [00:05<00:08, 47.20it/s] 39%|███▉      | 261/666 [00:05<00:08, 47.21it/s] 40%|███▉      | 266/666 [00:05<00:08, 47.15it/s] 41%|████      | 271/666 [00:05<00:08, 47.17it/s] 41%|████▏     | 276/666 [00:06<00:08, 47.17it/s] 42%|████▏     | 281/666 [00:06<00:08, 47.17it/s] 43%|████▎     | 286/666 [00:06<00:08, 47.18it/s] 44%|████▎     | 291/666 [00:06<00:07, 47.17it/s] 44%|████▍     | 296/666 [00:06<00:07, 47.14it/s] 45%|████▌     | 301/666 [00:06<00:07, 47.16it/s] 46%|████▌     | 306/666 [00:06<00:07, 47.16it/s] 47%|████▋     | 311/666 [00:06<00:07, 47.19it/s] 47%|████▋     | 316/666 [00:06<00:07, 47.19it/s] 48%|████▊     | 321/666 [00:07<00:07, 47.17it/s] 49%|████▉     | 326/666 [00:07<00:07, 47.18it/s] 50%|████▉     | 331/666 [00:07<00:07, 47.21it/s] 50%|█████     | 336/666 [00:07<00:06, 47.18it/s] 51%|█████     | 341/666 [00:07<00:06, 47.18it/s] 52%|█████▏    | 346/666 [00:07<00:06, 47.20it/s] 53%|█████▎    | 351/666 [00:07<00:06, 47.18it/s] 53%|█████▎    | 356/666 [00:07<00:06, 47.18it/s] 54%|█████▍    | 361/666 [00:07<00:06, 47.18it/s] 55%|█████▍    | 366/666 [00:07<00:06, 47.18it/s] 56%|█████▌    | 371/666 [00:08<00:06, 47.17it/s] 56%|█████▋    | 376/666 [00:08<00:06, 47.20it/s] 57%|█████▋    | 381/666 [00:08<00:06, 47.20it/s] 58%|█████▊    | 386/666 [00:08<00:05, 47.22it/s] 59%|█████▊    | 391/666 [00:08<00:05, 47.20it/s] 59%|█████▉    | 396/666 [00:08<00:05, 47.21it/s] 60%|██████    | 401/666 [00:08<00:05, 47.19it/s] 61%|██████    | 406/666 [00:08<00:05, 47.20it/s] 62%|██████▏   | 411/666 [00:08<00:05, 47.19it/s] 62%|██████▏   | 416/666 [00:09<00:05, 47.18it/s] 63%|██████▎   | 421/666 [00:09<00:05, 47.15it/s] 64%|██████▍   | 426/666 [00:09<00:05, 47.16it/s] 65%|██████▍   | 431/666 [00:09<00:04, 47.17it/s] 65%|██████▌   | 436/666 [00:09<00:04, 47.21it/s] 66%|██████▌   | 441/666 [00:09<00:04, 47.20it/s] 67%|██████▋   | 446/666 [00:09<00:04, 47.23it/s] 68%|██████▊   | 451/666 [00:09<00:04, 47.22it/s] 68%|██████▊   | 456/666 [00:09<00:04, 47.23it/s] 69%|██████▉   | 461/666 [00:09<00:04, 47.24it/s] 70%|██████▉   | 466/666 [00:10<00:04, 47.22it/s] 71%|███████   | 471/666 [00:10<00:04, 47.19it/s] 71%|███████▏  | 476/666 [00:10<00:04, 47.22it/s] 72%|███████▏  | 481/666 [00:10<00:03, 47.20it/s] 73%|███████▎  | 486/666 [00:10<00:03, 47.21it/s] 74%|███████▎  | 491/666 [00:10<00:03, 47.21it/s] 74%|███████▍  | 496/666 [00:10<00:03, 47.24it/s] 75%|███████▌  | 501/666 [00:10<00:03, 47.21it/s] 76%|███████▌  | 506/666 [00:10<00:03, 47.19it/s] 77%|███████▋  | 511/666 [00:11<00:03, 47.20it/s] 77%|███████▋  | 516/666 [00:11<00:03, 47.18it/s] 78%|███████▊  | 521/666 [00:11<00:03, 47.22it/s] 79%|███████▉  | 526/666 [00:11<00:02, 47.21it/s] 80%|███████▉  | 531/666 [00:11<00:02, 47.23it/s] 80%|████████  | 536/666 [00:11<00:02, 47.18it/s] 81%|████████  | 541/666 [00:11<00:02, 47.14it/s] 82%|████████▏ | 546/666 [00:11<00:02, 47.21it/s] 83%|████████▎ | 551/666 [00:11<00:02, 47.22it/s] 83%|████████▎ | 556/666 [00:11<00:02, 47.24it/s] 84%|████████▍ | 561/666 [00:12<00:02, 47.26it/s] 85%|████████▍ | 566/666 [00:12<00:02, 47.25it/s] 86%|████████▌ | 571/666 [00:12<00:02, 47.28it/s] 86%|████████▋ | 576/666 [00:12<00:01, 47.27it/s] 87%|████████▋ | 581/666 [00:12<00:01, 47.28it/s] 88%|████████▊ | 586/666 [00:12<00:01, 47.29it/s] 89%|████████▊ | 591/666 [00:12<00:01, 47.29it/s] 89%|████████▉ | 596/666 [00:12<00:01, 47.30it/s] 90%|█████████ | 601/666 [00:12<00:01, 47.30it/s] 91%|█████████ | 606/666 [00:13<00:01, 47.28it/s] 92%|█████████▏| 611/666 [00:13<00:01, 47.27it/s] 92%|█████████▏| 616/666 [00:13<00:01, 47.29it/s] 93%|█████████▎| 621/666 [00:13<00:00, 47.26it/s] 94%|█████████▍| 626/666 [00:13<00:00, 47.22it/s] 95%|█████████▍| 631/666 [00:13<00:00, 47.19it/s] 95%|█████████▌| 636/666 [00:13<00:00, 47.17it/s] 96%|█████████▌| 641/666 [00:13<00:00, 47.17it/s] 97%|█████████▋| 646/666 [00:13<00:00, 47.17it/s] 98%|█████████▊| 651/666 [00:13<00:00, 47.15it/s] 98%|█████████▊| 656/666 [00:14<00:00, 47.16it/s] 99%|█████████▉| 661/666 [00:14<00:00, 46.37it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:16,  9.84it/s][A
  6%|▌         | 10/167 [00:00<00:03, 47.01it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 121.69it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 163.04it/s][A
 48%|████▊     | 80/167 [00:00<00:00, 185.88it/s][A
 62%|██████▏   | 104/167 [00:00<00:00, 201.59it/s][A
 77%|███████▋  | 128/167 [00:00<00:00, 211.59it/s][A
 90%|█████████ | 151/167 [00:00<00:00, 216.88it/s][A100%|██████████| 167/167 [00:00<00:00, 173.85it/s]
2022-11-28 21:25:42,317 P57321 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:25:42,318 P57321 INFO Monitor(max) STOP: -4.497234 !
2022-11-28 21:25:42,318 P57321 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:25:42,318 P57321 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:15<00:00, 11.68it/s]100%|██████████| 666/666 [00:15<00:00, 43.15it/s]
2022-11-28 21:25:42,369 P57321 INFO Train loss: 30.969909
2022-11-28 21:25:42,369 P57321 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:59,  5.58it/s]  1%|          | 6/666 [00:00<00:26, 24.53it/s]  2%|▏         | 11/666 [00:00<00:20, 31.67it/s]  2%|▏         | 16/666 [00:00<00:17, 36.66it/s]  3%|▎         | 21/666 [00:00<00:16, 40.16it/s]  4%|▍         | 26/666 [00:00<00:15, 42.38it/s]  5%|▍         | 31/666 [00:00<00:14, 43.86it/s]  5%|▌         | 36/666 [00:00<00:14, 44.87it/s]  6%|▌         | 41/666 [00:01<00:13, 45.57it/s]  7%|▋         | 46/666 [00:01<00:13, 46.05it/s]  8%|▊         | 51/666 [00:01<00:13, 46.36it/s]  8%|▊         | 56/666 [00:01<00:13, 46.60it/s]  9%|▉         | 61/666 [00:01<00:12, 46.74it/s] 10%|▉         | 66/666 [00:01<00:12, 46.87it/s] 11%|█         | 71/666 [00:01<00:12, 46.94it/s] 11%|█▏        | 76/666 [00:01<00:12, 47.00it/s] 12%|█▏        | 81/666 [00:01<00:12, 47.01it/s] 13%|█▎        | 86/666 [00:02<00:12, 47.07it/s] 14%|█▎        | 91/666 [00:02<00:12, 47.07it/s] 14%|█▍        | 96/666 [00:02<00:12, 47.08it/s] 15%|█▌        | 101/666 [00:02<00:11, 47.10it/s] 16%|█▌        | 106/666 [00:02<00:11, 47.12it/s] 17%|█▋        | 111/666 [00:02<00:11, 47.13it/s] 17%|█▋        | 116/666 [00:02<00:11, 47.15it/s] 18%|█▊        | 121/666 [00:02<00:11, 47.13it/s] 19%|█▉        | 126/666 [00:02<00:11, 47.16it/s] 20%|█▉        | 131/666 [00:02<00:11, 47.14it/s] 20%|██        | 136/666 [00:03<00:11, 47.14it/s] 21%|██        | 141/666 [00:03<00:11, 47.13it/s] 22%|██▏       | 146/666 [00:03<00:11, 47.09it/s] 23%|██▎       | 151/666 [00:03<00:10, 47.12it/s] 23%|██▎       | 156/666 [00:03<00:10, 47.10it/s] 24%|██▍       | 161/666 [00:03<00:10, 47.13it/s] 25%|██▍       | 166/666 [00:03<00:10, 47.12it/s] 26%|██▌       | 171/666 [00:03<00:10, 47.15it/s] 26%|██▋       | 176/666 [00:03<00:10, 47.11it/s] 27%|██▋       | 181/666 [00:04<00:10, 47.11it/s] 28%|██▊       | 186/666 [00:04<00:10, 47.10it/s] 29%|██▊       | 191/666 [00:04<00:10, 47.10it/s] 29%|██▉       | 196/666 [00:04<00:09, 47.07it/s] 30%|███       | 201/666 [00:04<00:09, 47.08it/s] 31%|███       | 206/666 [00:04<00:09, 47.08it/s] 32%|███▏      | 211/666 [00:04<00:09, 47.09it/s] 32%|███▏      | 216/666 [00:04<00:09, 47.10it/s] 33%|███▎      | 221/666 [00:04<00:09, 47.08it/s] 34%|███▍      | 226/666 [00:04<00:09, 47.05it/s] 35%|███▍      | 231/666 [00:05<00:09, 47.02it/s] 35%|███▌      | 236/666 [00:05<00:09, 47.05it/s] 36%|███▌      | 241/666 [00:05<00:09, 47.04it/s] 37%|███▋      | 246/666 [00:05<00:08, 47.04it/s] 38%|███▊      | 251/666 [00:05<00:08, 47.08it/s] 38%|███▊      | 256/666 [00:05<00:08, 47.08it/s] 39%|███▉      | 261/666 [00:05<00:08, 47.11it/s] 40%|███▉      | 266/666 [00:05<00:08, 47.04it/s] 41%|████      | 271/666 [00:05<00:08, 47.03it/s] 41%|████▏     | 276/666 [00:06<00:08, 47.02it/s] 42%|████▏     | 281/666 [00:06<00:08, 47.03it/s] 43%|████▎     | 286/666 [00:06<00:08, 47.07it/s] 44%|████▎     | 291/666 [00:06<00:07, 47.08it/s] 44%|████▍     | 296/666 [00:06<00:07, 47.11it/s] 45%|████▌     | 301/666 [00:06<00:07, 47.09it/s] 46%|████▌     | 306/666 [00:06<00:07, 47.08it/s] 47%|████▋     | 311/666 [00:06<00:07, 47.07it/s] 47%|████▋     | 316/666 [00:06<00:07, 47.08it/s] 48%|████▊     | 321/666 [00:06<00:07, 47.07it/s] 49%|████▉     | 326/666 [00:07<00:07, 47.07it/s] 50%|████▉     | 331/666 [00:07<00:07, 47.04it/s] 50%|█████     | 336/666 [00:07<00:07, 47.02it/s] 51%|█████     | 341/666 [00:07<00:06, 47.05it/s] 52%|█████▏    | 346/666 [00:07<00:06, 47.05it/s] 53%|█████▎    | 351/666 [00:07<00:06, 47.09it/s] 53%|█████▎    | 356/666 [00:07<00:06, 47.09it/s] 54%|█████▍    | 361/666 [00:07<00:06, 47.07it/s] 55%|█████▍    | 366/666 [00:07<00:06, 47.08it/s] 56%|█████▌    | 371/666 [00:08<00:06, 47.10it/s] 56%|█████▋    | 376/666 [00:08<00:06, 47.09it/s] 57%|█████▋    | 381/666 [00:08<00:06, 47.09it/s] 58%|█████▊    | 386/666 [00:08<00:05, 47.12it/s] 59%|█████▊    | 391/666 [00:08<00:05, 47.09it/s] 59%|█████▉    | 396/666 [00:08<00:05, 47.12it/s] 60%|██████    | 401/666 [00:08<00:05, 47.13it/s] 61%|██████    | 406/666 [00:08<00:05, 47.14it/s] 62%|██████▏   | 411/666 [00:08<00:05, 47.11it/s] 62%|██████▏   | 416/666 [00:09<00:05, 47.12it/s] 63%|██████▎   | 421/666 [00:09<00:05, 47.09it/s] 64%|██████▍   | 426/666 [00:09<00:05, 47.09it/s] 65%|██████▍   | 431/666 [00:09<00:04, 47.11it/s] 65%|██████▌   | 436/666 [00:09<00:04, 47.11it/s] 66%|██████▌   | 441/666 [00:09<00:04, 47.11it/s] 67%|██████▋   | 446/666 [00:09<00:04, 47.13it/s] 68%|██████▊   | 451/666 [00:09<00:04, 47.12it/s] 68%|██████▊   | 456/666 [00:09<00:04, 47.05it/s] 69%|██████▉   | 461/666 [00:09<00:04, 47.10it/s] 70%|██████▉   | 466/666 [00:10<00:04, 47.09it/s] 71%|███████   | 471/666 [00:10<00:04, 47.11it/s] 71%|███████▏  | 476/666 [00:10<00:04, 47.10it/s] 72%|███████▏  | 481/666 [00:10<00:03, 47.12it/s] 73%|███████▎  | 486/666 [00:10<00:03, 47.13it/s] 74%|███████▎  | 491/666 [00:10<00:03, 47.15it/s] 74%|███████▍  | 496/666 [00:10<00:03, 47.13it/s] 75%|███████▌  | 501/666 [00:10<00:03, 47.14it/s] 76%|███████▌  | 506/666 [00:10<00:03, 47.12it/s] 77%|███████▋  | 511/666 [00:11<00:03, 47.13it/s] 77%|███████▋  | 516/666 [00:11<00:03, 47.10it/s] 78%|███████▊  | 521/666 [00:11<00:03, 47.12it/s] 79%|███████▉  | 526/666 [00:11<00:02, 47.11it/s] 80%|███████▉  | 531/666 [00:11<00:02, 47.11it/s] 80%|████████  | 536/666 [00:11<00:02, 47.13it/s] 81%|████████  | 541/666 [00:11<00:02, 47.14it/s] 82%|████████▏ | 546/666 [00:11<00:02, 47.14it/s] 83%|████████▎ | 551/666 [00:11<00:02, 47.12it/s] 83%|████████▎ | 556/666 [00:11<00:02, 47.13it/s] 84%|████████▍ | 561/666 [00:12<00:02, 47.12it/s] 85%|████████▍ | 566/666 [00:12<00:02, 47.14it/s] 86%|████████▌ | 571/666 [00:12<00:02, 47.11it/s] 86%|████████▋ | 576/666 [00:12<00:01, 47.12it/s] 87%|████████▋ | 581/666 [00:12<00:01, 47.11it/s] 88%|████████▊ | 586/666 [00:12<00:01, 47.13it/s] 89%|████████▊ | 591/666 [00:12<00:01, 47.12it/s] 89%|████████▉ | 596/666 [00:12<00:01, 47.12it/s] 90%|█████████ | 601/666 [00:12<00:01, 47.11it/s] 91%|█████████ | 606/666 [00:13<00:01, 47.13it/s] 92%|█████████▏| 611/666 [00:13<00:01, 47.12it/s] 92%|█████████▏| 616/666 [00:13<00:01, 47.12it/s] 93%|█████████▎| 621/666 [00:13<00:00, 47.11it/s] 94%|█████████▍| 626/666 [00:13<00:00, 47.11it/s] 95%|█████████▍| 631/666 [00:13<00:00, 47.09it/s] 95%|█████████▌| 636/666 [00:13<00:00, 47.08it/s] 96%|█████████▌| 641/666 [00:13<00:00, 47.09it/s] 97%|█████████▋| 646/666 [00:13<00:00, 47.08it/s] 98%|█████████▊| 651/666 [00:13<00:00, 47.10it/s] 98%|█████████▊| 656/666 [00:14<00:00, 47.11it/s] 99%|█████████▉| 661/666 [00:14<00:00, 46.16it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  2%|▏         | 3/167 [00:00<00:06, 27.05it/s][A
  6%|▌         | 10/167 [00:00<00:03, 51.04it/s][A
 20%|██        | 34/167 [00:00<00:01, 132.67it/s][A
 35%|███▍      | 58/167 [00:00<00:00, 171.92it/s][A
 49%|████▉     | 82/167 [00:00<00:00, 193.87it/s][A
 63%|██████▎   | 105/167 [00:00<00:00, 203.44it/s][A
 77%|███████▋  | 129/167 [00:00<00:00, 214.60it/s][A
 91%|█████████ | 152/167 [00:00<00:00, 216.75it/s][A100%|██████████| 167/167 [00:00<00:00, 176.62it/s]
2022-11-28 21:25:57,748 P57321 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:25:57,749 P57321 INFO Monitor(max) STOP: -4.497234 !
2022-11-28 21:25:57,749 P57321 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:25:57,749 P57321 INFO Early stopping at epoch=3
2022-11-28 21:25:57,749 P57321 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:15<00:00, 43.12it/s]
2022-11-28 21:25:57,792 P57321 INFO Train loss: 30.972063
2022-11-28 21:25:57,792 P57321 INFO Training finished.
2022-11-28 21:25:57,792 P57321 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_008_58c74eee.model
2022-11-28 21:25:57,893 P57321 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:37,  6.81it/s]  2%|▏         | 10/666 [00:00<00:14, 46.02it/s]  5%|▍         | 33/666 [00:00<00:05, 119.85it/s]  9%|▊         | 57/666 [00:00<00:03, 161.57it/s] 12%|█▏        | 81/666 [00:00<00:03, 186.38it/s] 16%|█▌        | 105/666 [00:00<00:02, 201.70it/s] 19%|█▉        | 128/666 [00:00<00:02, 209.59it/s] 23%|██▎       | 151/666 [00:00<00:02, 214.03it/s] 26%|██▌       | 174/666 [00:00<00:02, 216.35it/s] 30%|██▉       | 197/666 [00:01<00:02, 218.54it/s] 33%|███▎      | 220/666 [00:01<00:02, 219.67it/s] 36%|███▋      | 243/666 [00:01<00:01, 220.39it/s] 40%|███▉      | 266/666 [00:01<00:01, 220.68it/s] 43%|████▎     | 289/666 [00:01<00:01, 220.85it/s] 47%|████▋     | 312/666 [00:01<00:01, 220.48it/s] 50%|█████     | 335/666 [00:01<00:01, 220.45it/s] 54%|█████▍    | 358/666 [00:01<00:01, 220.19it/s] 57%|█████▋    | 381/666 [00:01<00:01, 219.97it/s] 61%|██████    | 404/666 [00:02<00:01, 217.84it/s] 64%|██████▍   | 426/666 [00:02<00:01, 217.63it/s] 67%|██████▋   | 448/666 [00:02<00:01, 217.87it/s] 71%|███████   | 470/666 [00:02<00:00, 218.02it/s] 74%|███████▍  | 492/666 [00:02<00:00, 217.79it/s] 77%|███████▋  | 514/666 [00:02<00:00, 217.89it/s] 80%|████████  | 536/666 [00:02<00:00, 217.77it/s] 84%|████████▍ | 558/666 [00:02<00:00, 217.70it/s] 87%|████████▋ | 580/666 [00:02<00:00, 217.42it/s] 90%|█████████ | 602/666 [00:02<00:00, 216.78it/s] 94%|█████████▎| 624/666 [00:03<00:00, 216.60it/s] 97%|█████████▋| 646/666 [00:03<00:00, 216.52it/s]100%|██████████| 666/666 [00:03<00:00, 202.60it/s]
2022-11-28 21:26:01,634 P57321 INFO [Metrics] logloss: 4.992098 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:17,  9.70it/s]  6%|▌         | 10/167 [00:00<00:03, 50.24it/s] 19%|█▊        | 31/167 [00:00<00:01, 117.40it/s] 31%|███       | 52/167 [00:00<00:00, 150.74it/s] 44%|████▎     | 73/167 [00:00<00:00, 170.47it/s] 56%|█████▋    | 94/167 [00:00<00:00, 182.49it/s] 69%|██████▉   | 115/167 [00:00<00:00, 190.13it/s] 81%|████████▏ | 136/167 [00:00<00:00, 194.32it/s] 94%|█████████▍| 157/167 [00:00<00:00, 197.70it/s]100%|██████████| 167/167 [00:01<00:00, 162.96it/s]
2022-11-28 21:26:02,770 P57321 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:26:06,284 P59106 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "256",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_009_58acfdaf",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:26:06,286 P59106 INFO Set up feature encoder...
2022-11-28 21:26:06,287 P59106 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:26:06,288 P59106 INFO Loading data...
2022-11-28 21:26:06,291 P59106 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:26:06,532 P59106 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:26:06,637 P59106 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:26:06,637 P59106 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:26:06,637 P59106 INFO Loading train data done.
2022-11-28 21:26:10,258 P59106 INFO Total number of parameters: 59431684.
2022-11-28 21:26:10,258 P59106 INFO Start training: 666 batches/epoch
2022-11-28 21:26:10,258 P59106 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:26:10.596 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:59106 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:26:10.628 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:59106 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:32,  1.13s/it]  1%|          | 4/666 [00:01<02:42,  4.08it/s]  1%|          | 7/666 [00:01<01:27,  7.54it/s]  2%|▏         | 10/666 [00:01<00:59, 11.05it/s]  2%|▏         | 13/666 [00:01<00:45, 14.41it/s]  2%|▏         | 16/666 [00:01<00:37, 17.49it/s]  3%|▎         | 19/666 [00:01<00:32, 20.13it/s]  3%|▎         | 22/666 [00:01<00:28, 22.35it/s]  4%|▍         | 25/666 [00:01<00:26, 24.07it/s]  4%|▍         | 28/666 [00:02<00:25, 25.37it/s]  5%|▍         | 31/666 [00:02<00:24, 26.35it/s]  5%|▌         | 34/666 [00:02<00:23, 27.08it/s]  6%|▌         | 37/666 [00:02<00:22, 27.59it/s]  6%|▌         | 40/666 [00:02<00:22, 27.97it/s]  6%|▋         | 43/666 [00:02<00:22, 28.25it/s]  7%|▋         | 46/666 [00:02<00:21, 28.41it/s]  7%|▋         | 49/666 [00:02<00:21, 28.55it/s]  8%|▊         | 52/666 [00:02<00:21, 28.63it/s]  8%|▊         | 55/666 [00:03<00:21, 28.69it/s]  9%|▊         | 58/666 [00:03<00:21, 28.76it/s]  9%|▉         | 61/666 [00:03<00:21, 28.79it/s] 10%|▉         | 64/666 [00:03<00:20, 28.81it/s] 10%|█         | 67/666 [00:03<00:21, 27.96it/s] 11%|█         | 70/666 [00:03<00:21, 28.22it/s] 11%|█         | 73/666 [00:03<00:20, 28.41it/s] 11%|█▏        | 76/666 [00:03<00:20, 28.55it/s] 12%|█▏        | 79/666 [00:03<00:20, 28.64it/s] 12%|█▏        | 82/666 [00:03<00:20, 28.71it/s] 13%|█▎        | 85/666 [00:04<00:20, 28.76it/s] 13%|█▎        | 88/666 [00:04<00:20, 28.79it/s] 14%|█▎        | 91/666 [00:04<00:19, 28.82it/s] 14%|█▍        | 94/666 [00:04<00:19, 28.83it/s] 15%|█▍        | 97/666 [00:04<00:19, 28.84it/s] 15%|█▌        | 100/666 [00:04<00:19, 28.84it/s] 15%|█▌        | 103/666 [00:04<00:19, 28.83it/s] 16%|█▌        | 106/666 [00:04<00:19, 28.81it/s] 16%|█▋        | 109/666 [00:04<00:19, 28.82it/s] 17%|█▋        | 112/666 [00:05<00:19, 28.81it/s] 17%|█▋        | 115/666 [00:05<00:19, 28.82it/s] 18%|█▊        | 118/666 [00:05<00:19, 28.83it/s] 18%|█▊        | 121/666 [00:05<00:18, 28.84it/s] 19%|█▊        | 124/666 [00:05<00:18, 28.84it/s] 19%|█▉        | 127/666 [00:05<00:18, 28.83it/s] 20%|█▉        | 130/666 [00:05<00:18, 28.83it/s] 20%|█▉        | 133/666 [00:05<00:18, 28.83it/s] 20%|██        | 136/666 [00:05<00:18, 28.84it/s] 21%|██        | 139/666 [00:05<00:18, 28.84it/s] 21%|██▏       | 142/666 [00:06<00:18, 28.86it/s] 22%|██▏       | 145/666 [00:06<00:18, 28.86it/s] 22%|██▏       | 148/666 [00:06<00:17, 28.85it/s] 23%|██▎       | 151/666 [00:06<00:17, 28.85it/s] 23%|██▎       | 154/666 [00:06<00:17, 28.85it/s] 24%|██▎       | 157/666 [00:06<00:17, 28.84it/s] 24%|██▍       | 160/666 [00:06<00:17, 28.84it/s] 24%|██▍       | 163/666 [00:06<00:17, 28.84it/s] 25%|██▍       | 166/666 [00:06<00:17, 28.85it/s] 25%|██▌       | 169/666 [00:06<00:17, 28.85it/s] 26%|██▌       | 172/666 [00:07<00:17, 28.85it/s] 26%|██▋       | 175/666 [00:07<00:17, 28.84it/s] 27%|██▋       | 178/666 [00:07<00:16, 28.85it/s] 27%|██▋       | 181/666 [00:07<00:16, 28.84it/s] 28%|██▊       | 184/666 [00:07<00:16, 28.84it/s] 28%|██▊       | 187/666 [00:07<00:16, 28.84it/s] 29%|██▊       | 190/666 [00:07<00:16, 28.85it/s] 29%|██▉       | 193/666 [00:07<00:16, 28.84it/s] 29%|██▉       | 196/666 [00:07<00:16, 28.85it/s] 30%|██▉       | 199/666 [00:08<00:16, 28.85it/s] 30%|███       | 202/666 [00:08<00:16, 28.85it/s] 31%|███       | 205/666 [00:08<00:15, 28.85it/s] 31%|███       | 208/666 [00:08<00:15, 28.85it/s] 32%|███▏      | 211/666 [00:08<00:15, 28.85it/s] 32%|███▏      | 214/666 [00:08<00:15, 28.85it/s] 33%|███▎      | 217/666 [00:08<00:15, 28.85it/s] 33%|███▎      | 220/666 [00:08<00:15, 28.85it/s] 33%|███▎      | 223/666 [00:08<00:15, 28.85it/s] 34%|███▍      | 226/666 [00:08<00:15, 28.84it/s] 34%|███▍      | 229/666 [00:09<00:15, 28.85it/s] 35%|███▍      | 232/666 [00:09<00:15, 28.85it/s] 35%|███▌      | 235/666 [00:09<00:14, 28.84it/s] 36%|███▌      | 238/666 [00:09<00:14, 28.84it/s] 36%|███▌      | 241/666 [00:09<00:14, 28.84it/s] 37%|███▋      | 244/666 [00:09<00:14, 28.84it/s] 37%|███▋      | 247/666 [00:09<00:14, 28.85it/s] 38%|███▊      | 250/666 [00:09<00:14, 28.84it/s] 38%|███▊      | 253/666 [00:09<00:14, 28.84it/s] 38%|███▊      | 256/666 [00:09<00:14, 28.83it/s] 39%|███▉      | 259/666 [00:10<00:14, 28.83it/s] 39%|███▉      | 262/666 [00:10<00:14, 28.85it/s] 40%|███▉      | 265/666 [00:10<00:13, 28.85it/s] 40%|████      | 268/666 [00:10<00:13, 28.85it/s] 41%|████      | 271/666 [00:10<00:13, 28.85it/s] 41%|████      | 274/666 [00:10<00:13, 28.85it/s] 42%|████▏     | 277/666 [00:10<00:13, 28.85it/s] 42%|████▏     | 280/666 [00:10<00:13, 28.84it/s] 42%|████▏     | 283/666 [00:10<00:13, 28.85it/s] 43%|████▎     | 286/666 [00:11<00:13, 28.85it/s] 43%|████▎     | 289/666 [00:11<00:13, 28.84it/s] 44%|████▍     | 292/666 [00:11<00:12, 28.84it/s] 44%|████▍     | 295/666 [00:11<00:12, 28.84it/s] 45%|████▍     | 298/666 [00:11<00:12, 28.85it/s] 45%|████▌     | 301/666 [00:11<00:12, 28.84it/s] 46%|████▌     | 304/666 [00:11<00:12, 28.85it/s] 46%|████▌     | 307/666 [00:11<00:12, 28.84it/s] 47%|████▋     | 310/666 [00:11<00:12, 28.85it/s] 47%|████▋     | 313/666 [00:11<00:12, 28.84it/s] 47%|████▋     | 316/666 [00:12<00:12, 28.82it/s] 48%|████▊     | 319/666 [00:12<00:12, 28.81it/s] 48%|████▊     | 322/666 [00:12<00:11, 28.83it/s] 49%|████▉     | 325/666 [00:12<00:11, 28.84it/s] 49%|████▉     | 328/666 [00:12<00:11, 28.83it/s] 50%|████▉     | 331/666 [00:12<00:11, 28.83it/s] 50%|█████     | 334/666 [00:12<00:11, 28.83it/s] 51%|█████     | 337/666 [00:12<00:11, 28.82it/s] 51%|█████     | 340/666 [00:12<00:11, 28.81it/s] 52%|█████▏    | 343/666 [00:13<00:11, 28.82it/s] 52%|█████▏    | 346/666 [00:13<00:11, 28.82it/s] 52%|█████▏    | 349/666 [00:13<00:10, 28.83it/s] 53%|█████▎    | 352/666 [00:13<00:10, 28.83it/s] 53%|█████▎    | 355/666 [00:13<00:10, 28.83it/s] 54%|█████▍    | 358/666 [00:13<00:10, 28.84it/s] 54%|█████▍    | 361/666 [00:13<00:10, 28.84it/s] 55%|█████▍    | 364/666 [00:13<00:10, 28.85it/s] 55%|█████▌    | 367/666 [00:13<00:10, 28.85it/s] 56%|█████▌    | 370/666 [00:13<00:10, 28.85it/s] 56%|█████▌    | 373/666 [00:14<00:10, 28.85it/s] 56%|█████▋    | 376/666 [00:14<00:10, 28.84it/s] 57%|█████▋    | 379/666 [00:14<00:09, 28.85it/s] 57%|█████▋    | 382/666 [00:14<00:09, 28.77it/s] 58%|█████▊    | 385/666 [00:14<00:09, 28.77it/s] 58%|█████▊    | 388/666 [00:14<00:09, 28.78it/s] 59%|█████▊    | 391/666 [00:14<00:09, 28.80it/s] 59%|█████▉    | 394/666 [00:14<00:09, 28.81it/s] 60%|█████▉    | 397/666 [00:14<00:09, 28.83it/s] 60%|██████    | 400/666 [00:14<00:09, 28.82it/s] 61%|██████    | 403/666 [00:15<00:09, 28.84it/s] 61%|██████    | 406/666 [00:15<00:09, 28.84it/s] 61%|██████▏   | 409/666 [00:15<00:08, 28.84it/s] 62%|██████▏   | 412/666 [00:15<00:08, 28.83it/s] 62%|██████▏   | 415/666 [00:15<00:08, 28.83it/s] 63%|██████▎   | 418/666 [00:15<00:08, 28.83it/s] 63%|██████▎   | 421/666 [00:15<00:08, 28.83it/s] 64%|██████▎   | 424/666 [00:15<00:08, 28.84it/s] 64%|██████▍   | 427/666 [00:15<00:08, 28.85it/s] 65%|██████▍   | 430/666 [00:16<00:08, 28.85it/s] 65%|██████▌   | 433/666 [00:16<00:08, 28.83it/s] 65%|██████▌   | 436/666 [00:16<00:07, 28.84it/s] 66%|██████▌   | 439/666 [00:16<00:07, 28.84it/s] 66%|██████▋   | 442/666 [00:16<00:07, 28.84it/s] 67%|██████▋   | 445/666 [00:16<00:07, 28.83it/s] 67%|██████▋   | 448/666 [00:16<00:07, 28.84it/s] 68%|██████▊   | 451/666 [00:16<00:07, 28.85it/s] 68%|██████▊   | 454/666 [00:16<00:07, 28.85it/s] 69%|██████▊   | 457/666 [00:16<00:07, 28.83it/s] 69%|██████▉   | 460/666 [00:17<00:07, 28.83it/s] 70%|██████▉   | 463/666 [00:17<00:07, 28.83it/s] 70%|██████▉   | 466/666 [00:17<00:06, 28.84it/s] 70%|███████   | 469/666 [00:17<00:06, 28.84it/s] 71%|███████   | 472/666 [00:17<00:06, 28.84it/s] 71%|███████▏  | 475/666 [00:17<00:06, 28.82it/s] 72%|███████▏  | 478/666 [00:17<00:06, 28.83it/s] 72%|███████▏  | 481/666 [00:17<00:06, 28.82it/s] 73%|███████▎  | 484/666 [00:17<00:06, 28.81it/s] 73%|███████▎  | 487/666 [00:18<00:06, 28.82it/s] 74%|███████▎  | 490/666 [00:18<00:06, 28.83it/s] 74%|███████▍  | 493/666 [00:18<00:06, 28.83it/s] 74%|███████▍  | 496/666 [00:18<00:05, 28.84it/s] 75%|███████▍  | 499/666 [00:18<00:05, 28.84it/s] 75%|███████▌  | 502/666 [00:18<00:05, 28.84it/s] 76%|███████▌  | 505/666 [00:18<00:05, 28.84it/s] 76%|███████▋  | 508/666 [00:18<00:05, 28.84it/s] 77%|███████▋  | 511/666 [00:18<00:05, 28.84it/s] 77%|███████▋  | 514/666 [00:18<00:05, 28.84it/s] 78%|███████▊  | 517/666 [00:19<00:05, 28.84it/s] 78%|███████▊  | 520/666 [00:19<00:05, 28.83it/s] 79%|███████▊  | 523/666 [00:19<00:04, 28.83it/s] 79%|███████▉  | 526/666 [00:19<00:04, 28.83it/s] 79%|███████▉  | 529/666 [00:19<00:04, 28.84it/s] 80%|███████▉  | 532/666 [00:19<00:04, 28.85it/s] 80%|████████  | 535/666 [00:19<00:04, 28.85it/s] 81%|████████  | 538/666 [00:19<00:04, 28.85it/s] 81%|████████  | 541/666 [00:19<00:04, 28.85it/s] 82%|████████▏ | 544/666 [00:19<00:04, 28.85it/s] 82%|████████▏ | 547/666 [00:20<00:04, 28.85it/s] 83%|████████▎ | 550/666 [00:20<00:04, 28.85it/s] 83%|████████▎ | 553/666 [00:20<00:03, 28.86it/s] 83%|████████▎ | 556/666 [00:20<00:03, 28.85it/s] 84%|████████▍ | 559/666 [00:20<00:03, 28.84it/s] 84%|████████▍ | 562/666 [00:20<00:03, 28.84it/s] 85%|████████▍ | 565/666 [00:20<00:03, 28.84it/s] 85%|████████▌ | 568/666 [00:20<00:03, 28.84it/s] 86%|████████▌ | 571/666 [00:20<00:03, 28.84it/s] 86%|████████▌ | 574/666 [00:21<00:03, 28.85it/s] 87%|████████▋ | 577/666 [00:21<00:03, 28.86it/s] 87%|████████▋ | 580/666 [00:21<00:02, 28.86it/s] 88%|████████▊ | 583/666 [00:21<00:02, 28.85it/s] 88%|████████▊ | 586/666 [00:21<00:02, 28.85it/s] 88%|████████▊ | 589/666 [00:21<00:02, 28.86it/s] 89%|████████▉ | 592/666 [00:21<00:02, 28.85it/s] 89%|████████▉ | 595/666 [00:21<00:02, 28.85it/s] 90%|████████▉ | 598/666 [00:21<00:02, 28.85it/s] 90%|█████████ | 601/666 [00:21<00:02, 28.85it/s] 91%|█████████ | 604/666 [00:22<00:02, 28.85it/s] 91%|█████████ | 607/666 [00:22<00:02, 28.84it/s] 92%|█████████▏| 610/666 [00:22<00:01, 28.84it/s] 92%|█████████▏| 613/666 [00:22<00:01, 28.84it/s] 92%|█████████▏| 616/666 [00:22<00:01, 28.84it/s] 93%|█████████▎| 619/666 [00:22<00:01, 28.84it/s] 93%|█████████▎| 622/666 [00:22<00:01, 28.83it/s] 94%|█████████▍| 625/666 [00:22<00:01, 28.83it/s] 94%|█████████▍| 628/666 [00:22<00:01, 28.83it/s] 95%|█████████▍| 631/666 [00:23<00:01, 28.83it/s] 95%|█████████▌| 634/666 [00:23<00:01, 28.83it/s] 96%|█████████▌| 637/666 [00:23<00:01, 28.83it/s] 96%|█████████▌| 640/666 [00:23<00:00, 28.85it/s] 97%|█████████▋| 643/666 [00:23<00:00, 28.85it/s] 97%|█████████▋| 646/666 [00:23<00:00, 28.85it/s] 97%|█████████▋| 649/666 [00:23<00:00, 28.86it/s] 98%|█████████▊| 652/666 [00:23<00:00, 28.86it/s] 98%|█████████▊| 655/666 [00:23<00:00, 28.86it/s] 99%|█████████▉| 658/666 [00:23<00:00, 28.86it/s] 99%|█████████▉| 661/666 [00:24<00:00, 28.24it/s]100%|█████████▉| 664/666 [00:24<00:00, 28.49it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:19,  8.62it/s][A
  6%|▌         | 10/167 [00:00<00:03, 51.98it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 120.48it/s][A
 32%|███▏      | 54/167 [00:00<00:00, 161.76it/s][A
 46%|████▌     | 77/167 [00:00<00:00, 184.67it/s][A
 60%|█████▉    | 100/167 [00:00<00:00, 197.86it/s][A
 74%|███████▎  | 123/167 [00:00<00:00, 206.93it/s][A
 87%|████████▋ | 146/167 [00:00<00:00, 212.85it/s][A100%|██████████| 167/167 [00:00<00:00, 172.55it/s]
2022-11-28 21:26:35,561 P59106 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:26:35,562 P59106 INFO Save best model: monitor(max): -10.617075
2022-11-28 21:26:37,799 P59106 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:27<00:00, 24.15it/s]
2022-11-28 21:26:37,836 P59106 INFO Train loss: 69.009578
2022-11-28 21:26:37,836 P59106 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:06,  5.24it/s]  1%|          | 4/666 [00:00<00:44, 14.73it/s]  1%|          | 7/666 [00:00<00:34, 19.32it/s]  2%|▏         | 10/666 [00:00<00:29, 22.30it/s]  2%|▏         | 13/666 [00:00<00:26, 24.38it/s]  2%|▏         | 16/666 [00:00<00:25, 25.70it/s]  3%|▎         | 19/666 [00:00<00:24, 26.72it/s]  3%|▎         | 22/666 [00:00<00:23, 27.36it/s]  4%|▍         | 25/666 [00:01<00:23, 27.80it/s]  4%|▍         | 28/666 [00:01<00:22, 28.10it/s]  5%|▍         | 31/666 [00:01<00:22, 28.29it/s]  5%|▌         | 34/666 [00:01<00:22, 28.46it/s]  6%|▌         | 37/666 [00:01<00:22, 28.56it/s]  6%|▌         | 40/666 [00:01<00:21, 28.64it/s]  6%|▋         | 43/666 [00:01<00:21, 28.69it/s]  7%|▋         | 46/666 [00:01<00:21, 28.70it/s]  7%|▋         | 49/666 [00:01<00:21, 28.73it/s]  8%|▊         | 52/666 [00:01<00:21, 28.75it/s]  8%|▊         | 55/666 [00:02<00:21, 28.77it/s]  9%|▊         | 58/666 [00:02<00:21, 28.79it/s]  9%|▉         | 61/666 [00:02<00:21, 28.80it/s] 10%|▉         | 64/666 [00:02<00:20, 28.80it/s] 10%|█         | 67/666 [00:02<00:20, 28.80it/s] 11%|█         | 70/666 [00:02<00:20, 28.81it/s] 11%|█         | 73/666 [00:02<00:20, 28.81it/s] 11%|█▏        | 76/666 [00:02<00:20, 28.80it/s] 12%|█▏        | 79/666 [00:02<00:20, 28.80it/s] 12%|█▏        | 82/666 [00:03<00:20, 28.80it/s] 13%|█▎        | 85/666 [00:03<00:20, 28.80it/s] 13%|█▎        | 88/666 [00:03<00:20, 28.82it/s] 14%|█▎        | 91/666 [00:03<00:19, 28.80it/s] 14%|█▍        | 94/666 [00:03<00:19, 28.80it/s] 15%|█▍        | 97/666 [00:03<00:19, 28.80it/s] 15%|█▌        | 100/666 [00:03<00:19, 28.79it/s] 15%|█▌        | 103/666 [00:03<00:19, 28.80it/s] 16%|█▌        | 106/666 [00:03<00:19, 28.80it/s] 16%|█▋        | 109/666 [00:03<00:19, 28.80it/s] 17%|█▋        | 112/666 [00:04<00:19, 28.79it/s] 17%|█▋        | 115/666 [00:04<00:19, 28.81it/s] 18%|█▊        | 118/666 [00:04<00:19, 28.82it/s] 18%|█▊        | 121/666 [00:04<00:18, 28.82it/s] 19%|█▊        | 124/666 [00:04<00:18, 28.80it/s] 19%|█▉        | 127/666 [00:04<00:18, 28.80it/s] 20%|█▉        | 130/666 [00:04<00:18, 28.80it/s] 20%|█▉        | 133/666 [00:04<00:18, 28.81it/s] 20%|██        | 136/666 [00:04<00:18, 28.81it/s] 21%|██        | 139/666 [00:05<00:18, 28.79it/s] 21%|██▏       | 142/666 [00:05<00:18, 28.80it/s] 22%|██▏       | 145/666 [00:05<00:18, 28.82it/s] 22%|██▏       | 148/666 [00:05<00:17, 28.82it/s] 23%|██▎       | 151/666 [00:05<00:17, 28.82it/s] 23%|██▎       | 154/666 [00:05<00:17, 28.82it/s] 24%|██▎       | 157/666 [00:05<00:17, 28.80it/s] 24%|██▍       | 160/666 [00:05<00:17, 28.80it/s] 24%|██▍       | 163/666 [00:05<00:17, 28.80it/s] 25%|██▍       | 166/666 [00:05<00:17, 28.80it/s] 25%|██▌       | 169/666 [00:06<00:17, 28.81it/s] 26%|██▌       | 172/666 [00:06<00:17, 28.79it/s] 26%|██▋       | 175/666 [00:06<00:17, 28.78it/s] 27%|██▋       | 178/666 [00:06<00:16, 28.78it/s] 27%|██▋       | 181/666 [00:06<00:16, 28.79it/s] 28%|██▊       | 184/666 [00:06<00:16, 28.79it/s] 28%|██▊       | 187/666 [00:06<00:16, 28.78it/s] 29%|██▊       | 190/666 [00:06<00:16, 28.79it/s] 29%|██▉       | 193/666 [00:06<00:16, 28.78it/s] 29%|██▉       | 196/666 [00:06<00:16, 28.79it/s] 30%|██▉       | 199/666 [00:07<00:16, 28.79it/s] 30%|███       | 202/666 [00:07<00:16, 28.80it/s] 31%|███       | 205/666 [00:07<00:16, 28.79it/s] 31%|███       | 208/666 [00:07<00:15, 28.80it/s] 32%|███▏      | 211/666 [00:07<00:15, 28.81it/s] 32%|███▏      | 214/666 [00:07<00:15, 28.81it/s] 33%|███▎      | 217/666 [00:07<00:15, 28.80it/s] 33%|███▎      | 220/666 [00:07<00:15, 28.79it/s] 33%|███▎      | 223/666 [00:07<00:15, 28.79it/s] 34%|███▍      | 226/666 [00:08<00:15, 28.80it/s] 34%|███▍      | 229/666 [00:08<00:15, 28.80it/s] 35%|███▍      | 232/666 [00:08<00:15, 28.80it/s] 35%|███▌      | 235/666 [00:08<00:14, 28.77it/s] 36%|███▌      | 238/666 [00:08<00:14, 28.77it/s] 36%|███▌      | 241/666 [00:08<00:14, 28.78it/s] 37%|███▋      | 244/666 [00:08<00:14, 28.80it/s] 37%|███▋      | 247/666 [00:08<00:14, 28.81it/s] 38%|███▊      | 250/666 [00:08<00:14, 28.81it/s] 38%|███▊      | 253/666 [00:08<00:14, 28.81it/s] 38%|███▊      | 256/666 [00:09<00:14, 28.81it/s] 39%|███▉      | 259/666 [00:09<00:14, 28.82it/s] 39%|███▉      | 262/666 [00:09<00:14, 28.82it/s] 40%|███▉      | 265/666 [00:09<00:13, 28.80it/s] 40%|████      | 268/666 [00:09<00:13, 28.79it/s] 41%|████      | 271/666 [00:09<00:13, 28.79it/s] 41%|████      | 274/666 [00:09<00:13, 28.81it/s] 42%|████▏     | 277/666 [00:09<00:13, 28.82it/s] 42%|████▏     | 280/666 [00:09<00:13, 28.80it/s] 42%|████▏     | 283/666 [00:10<00:13, 28.80it/s] 43%|████▎     | 286/666 [00:10<00:13, 28.80it/s] 43%|████▎     | 289/666 [00:10<00:13, 28.82it/s] 44%|████▍     | 292/666 [00:10<00:12, 28.82it/s] 44%|████▍     | 295/666 [00:10<00:12, 28.82it/s] 45%|████▍     | 298/666 [00:10<00:12, 28.79it/s] 45%|████▌     | 301/666 [00:10<00:12, 28.80it/s] 46%|████▌     | 304/666 [00:10<00:12, 28.82it/s] 46%|████▌     | 307/666 [00:10<00:12, 28.82it/s] 47%|████▋     | 310/666 [00:10<00:12, 28.83it/s] 47%|████▋     | 313/666 [00:11<00:12, 28.82it/s] 47%|████▋     | 316/666 [00:11<00:12, 28.81it/s] 48%|████▊     | 319/666 [00:11<00:12, 28.82it/s] 48%|████▊     | 322/666 [00:11<00:11, 28.81it/s] 49%|████▉     | 325/666 [00:11<00:11, 28.82it/s] 49%|████▉     | 328/666 [00:11<00:11, 28.81it/s] 50%|████▉     | 331/666 [00:11<00:11, 28.80it/s] 50%|█████     | 334/666 [00:11<00:11, 28.80it/s] 51%|█████     | 337/666 [00:11<00:11, 28.80it/s] 51%|█████     | 340/666 [00:11<00:11, 28.80it/s] 52%|█████▏    | 343/666 [00:12<00:11, 28.81it/s] 52%|█████▏    | 346/666 [00:12<00:11, 28.80it/s] 52%|█████▏    | 349/666 [00:12<00:11, 28.79it/s] 53%|█████▎    | 352/666 [00:12<00:10, 28.79it/s] 53%|█████▎    | 355/666 [00:12<00:10, 28.79it/s] 54%|█████▍    | 358/666 [00:12<00:10, 28.79it/s] 54%|█████▍    | 361/666 [00:12<00:10, 28.79it/s] 55%|█████▍    | 364/666 [00:12<00:10, 28.80it/s] 55%|█████▌    | 367/666 [00:12<00:10, 28.81it/s] 56%|█████▌    | 370/666 [00:13<00:10, 28.82it/s] 56%|█████▌    | 373/666 [00:13<00:10, 28.83it/s] 56%|█████▋    | 376/666 [00:13<00:10, 28.81it/s] 57%|█████▋    | 379/666 [00:13<00:09, 28.80it/s] 57%|█████▋    | 382/666 [00:13<00:09, 28.79it/s] 58%|█████▊    | 385/666 [00:13<00:09, 28.80it/s] 58%|█████▊    | 388/666 [00:13<00:09, 28.80it/s] 59%|█████▊    | 391/666 [00:13<00:09, 28.80it/s] 59%|█████▉    | 394/666 [00:13<00:09, 28.79it/s] 60%|█████▉    | 397/666 [00:13<00:09, 28.77it/s] 60%|██████    | 400/666 [00:14<00:09, 28.78it/s] 61%|██████    | 403/666 [00:14<00:09, 28.79it/s] 61%|██████    | 406/666 [00:14<00:09, 28.80it/s] 61%|██████▏   | 409/666 [00:14<00:08, 28.80it/s] 62%|██████▏   | 412/666 [00:14<00:08, 28.79it/s] 62%|██████▏   | 415/666 [00:14<00:08, 28.79it/s] 63%|██████▎   | 418/666 [00:14<00:08, 28.79it/s] 63%|██████▎   | 421/666 [00:14<00:08, 28.78it/s] 64%|██████▎   | 424/666 [00:14<00:08, 28.78it/s] 64%|██████▍   | 427/666 [00:15<00:08, 28.79it/s] 65%|██████▍   | 430/666 [00:15<00:08, 28.80it/s] 65%|██████▌   | 433/666 [00:15<00:08, 28.81it/s] 65%|██████▌   | 436/666 [00:15<00:07, 28.81it/s] 66%|██████▌   | 439/666 [00:15<00:07, 28.81it/s] 66%|██████▋   | 442/666 [00:15<00:07, 28.79it/s] 67%|██████▋   | 445/666 [00:15<00:07, 28.80it/s] 67%|██████▋   | 448/666 [00:15<00:07, 28.80it/s] 68%|██████▊   | 451/666 [00:15<00:07, 28.81it/s] 68%|██████▊   | 454/666 [00:15<00:07, 28.82it/s] 69%|██████▊   | 457/666 [00:16<00:07, 28.80it/s] 69%|██████▉   | 460/666 [00:16<00:07, 28.81it/s] 70%|██████▉   | 463/666 [00:16<00:07, 28.81it/s] 70%|██████▉   | 466/666 [00:16<00:06, 28.81it/s] 70%|███████   | 469/666 [00:16<00:06, 28.80it/s] 71%|███████   | 472/666 [00:16<00:06, 28.78it/s] 71%|███████▏  | 475/666 [00:16<00:06, 28.79it/s] 72%|███████▏  | 478/666 [00:16<00:06, 28.78it/s] 72%|███████▏  | 481/666 [00:16<00:06, 28.75it/s] 73%|███████▎  | 484/666 [00:16<00:06, 28.76it/s] 73%|███████▎  | 487/666 [00:17<00:06, 28.76it/s] 74%|███████▎  | 490/666 [00:17<00:06, 28.77it/s] 74%|███████▍  | 493/666 [00:17<00:06, 28.77it/s] 74%|███████▍  | 496/666 [00:17<00:05, 28.76it/s] 75%|███████▍  | 499/666 [00:17<00:05, 28.76it/s] 75%|███████▌  | 502/666 [00:17<00:05, 28.74it/s] 76%|███████▌  | 505/666 [00:17<00:05, 28.75it/s] 76%|███████▋  | 508/666 [00:17<00:05, 28.75it/s] 77%|███████▋  | 511/666 [00:17<00:05, 28.77it/s] 77%|███████▋  | 514/666 [00:18<00:05, 28.75it/s] 78%|███████▊  | 517/666 [00:18<00:05, 28.76it/s] 78%|███████▊  | 520/666 [00:18<00:05, 28.75it/s] 79%|███████▊  | 523/666 [00:18<00:04, 28.76it/s] 79%|███████▉  | 526/666 [00:18<00:04, 28.78it/s] 79%|███████▉  | 529/666 [00:18<00:04, 28.76it/s] 80%|███████▉  | 532/666 [00:18<00:04, 28.75it/s] 80%|████████  | 535/666 [00:18<00:04, 28.70it/s] 81%|████████  | 538/666 [00:18<00:04, 28.71it/s] 81%|████████  | 541/666 [00:18<00:04, 28.72it/s] 82%|████████▏ | 544/666 [00:19<00:04, 28.72it/s] 82%|████████▏ | 547/666 [00:19<00:04, 28.75it/s] 83%|████████▎ | 550/666 [00:19<00:04, 28.75it/s] 83%|████████▎ | 553/666 [00:19<00:03, 28.75it/s] 83%|████████▎ | 556/666 [00:19<00:03, 28.76it/s] 84%|████████▍ | 559/666 [00:19<00:03, 28.76it/s] 84%|████████▍ | 562/666 [00:19<00:03, 28.76it/s] 85%|████████▍ | 565/666 [00:19<00:03, 28.76it/s] 85%|████████▌ | 568/666 [00:19<00:03, 28.75it/s] 86%|████████▌ | 571/666 [00:20<00:03, 28.75it/s] 86%|████████▌ | 574/666 [00:20<00:03, 28.75it/s] 87%|████████▋ | 577/666 [00:20<00:03, 28.75it/s] 87%|████████▋ | 580/666 [00:20<00:02, 28.77it/s] 88%|████████▊ | 583/666 [00:20<00:02, 28.77it/s] 88%|████████▊ | 586/666 [00:20<00:02, 28.78it/s] 88%|████████▊ | 589/666 [00:20<00:02, 28.76it/s] 89%|████████▉ | 592/666 [00:20<00:02, 28.76it/s] 89%|████████▉ | 595/666 [00:20<00:02, 28.77it/s] 90%|████████▉ | 598/666 [00:20<00:02, 28.77it/s] 90%|█████████ | 601/666 [00:21<00:02, 28.77it/s] 91%|█████████ | 604/666 [00:21<00:02, 28.77it/s] 91%|█████████ | 607/666 [00:21<00:02, 28.75it/s] 92%|█████████▏| 610/666 [00:21<00:01, 28.77it/s] 92%|█████████▏| 613/666 [00:21<00:01, 28.77it/s] 92%|█████████▏| 616/666 [00:21<00:01, 28.76it/s] 93%|█████████▎| 619/666 [00:21<00:01, 28.76it/s] 93%|█████████▎| 622/666 [00:21<00:01, 28.77it/s] 94%|█████████▍| 625/666 [00:21<00:01, 28.77it/s] 94%|█████████▍| 628/666 [00:21<00:01, 28.78it/s] 95%|█████████▍| 631/666 [00:22<00:01, 28.76it/s] 95%|█████████▌| 634/666 [00:22<00:01, 28.76it/s] 96%|█████████▌| 637/666 [00:22<00:01, 28.78it/s] 96%|█████████▌| 640/666 [00:22<00:00, 28.78it/s] 97%|█████████▋| 643/666 [00:22<00:00, 28.77it/s] 97%|█████████▋| 646/666 [00:22<00:00, 28.75it/s] 97%|█████████▋| 649/666 [00:22<00:00, 28.76it/s] 98%|█████████▊| 652/666 [00:22<00:00, 28.77it/s] 98%|█████████▊| 655/666 [00:22<00:00, 28.76it/s] 99%|█████████▉| 658/666 [00:23<00:00, 28.76it/s] 99%|█████████▉| 661/666 [00:23<00:00, 28.30it/s]100%|█████████▉| 664/666 [00:23<00:00, 28.53it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.84it/s][A
  6%|▌         | 10/167 [00:00<00:03, 45.62it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 109.92it/s][A
 32%|███▏      | 54/167 [00:00<00:00, 151.05it/s][A
 46%|████▌     | 76/167 [00:00<00:00, 174.17it/s][A
 59%|█████▊    | 98/167 [00:00<00:00, 188.89it/s][A
 72%|███████▏  | 120/167 [00:00<00:00, 198.36it/s][A
 85%|████████▌ | 142/167 [00:00<00:00, 203.74it/s][A
 99%|█████████▉| 165/167 [00:00<00:00, 209.37it/s][A100%|██████████| 167/167 [00:01<00:00, 163.98it/s]
2022-11-28 21:27:02,287 P59106 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:27:02,287 P59106 INFO Monitor(max) STOP: -10.617075 !
2022-11-28 21:27:02,287 P59106 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:27:02,288 P59106 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:24<00:00, 27.18it/s]
2022-11-28 21:27:02,341 P59106 INFO Train loss: 69.009519
2022-11-28 21:27:02,341 P59106 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:07,  5.20it/s]  1%|          | 4/666 [00:00<00:43, 15.39it/s]  1%|          | 7/666 [00:00<00:31, 20.61it/s]  2%|▏         | 10/666 [00:00<00:28, 23.32it/s]  2%|▏         | 13/666 [00:00<00:26, 25.06it/s]  2%|▏         | 16/666 [00:00<00:24, 26.22it/s]  3%|▎         | 19/666 [00:00<00:23, 27.07it/s]  3%|▎         | 22/666 [00:00<00:23, 27.60it/s]  4%|▍         | 25/666 [00:01<00:22, 27.98it/s]  4%|▍         | 28/666 [00:01<00:22, 28.23it/s]  5%|▍         | 31/666 [00:01<00:22, 28.41it/s]  5%|▌         | 34/666 [00:01<00:22, 28.53it/s]  6%|▌         | 37/666 [00:01<00:21, 28.62it/s]  6%|▌         | 40/666 [00:01<00:21, 28.68it/s]  6%|▋         | 43/666 [00:01<00:21, 28.71it/s]  7%|▋         | 46/666 [00:01<00:21, 28.75it/s]  7%|▋         | 49/666 [00:01<00:21, 28.78it/s]  8%|▊         | 52/666 [00:01<00:21, 28.80it/s]  8%|▊         | 55/666 [00:02<00:21, 28.81it/s]  9%|▊         | 58/666 [00:02<00:21, 28.81it/s]  9%|▉         | 61/666 [00:02<00:20, 28.82it/s] 10%|▉         | 64/666 [00:02<00:20, 28.82it/s] 10%|█         | 67/666 [00:02<00:20, 28.83it/s] 11%|█         | 70/666 [00:02<00:20, 28.82it/s] 11%|█         | 73/666 [00:02<00:20, 28.82it/s] 11%|█▏        | 76/666 [00:02<00:20, 28.81it/s] 12%|█▏        | 79/666 [00:02<00:20, 28.81it/s] 12%|█▏        | 82/666 [00:03<00:20, 28.81it/s] 13%|█▎        | 85/666 [00:03<00:20, 28.83it/s] 13%|█▎        | 88/666 [00:03<00:20, 28.82it/s] 14%|█▎        | 91/666 [00:03<00:19, 28.83it/s] 14%|█▍        | 94/666 [00:03<00:19, 28.85it/s] 15%|█▍        | 97/666 [00:03<00:19, 28.84it/s] 15%|█▌        | 100/666 [00:03<00:19, 28.83it/s] 15%|█▌        | 103/666 [00:03<00:19, 28.84it/s] 16%|█▌        | 106/666 [00:03<00:19, 28.84it/s] 16%|█▋        | 109/666 [00:03<00:19, 28.85it/s] 17%|█▋        | 112/666 [00:04<00:19, 28.85it/s] 17%|█▋        | 115/666 [00:04<00:19, 28.85it/s] 18%|█▊        | 118/666 [00:04<00:18, 28.85it/s] 18%|█▊        | 121/666 [00:04<00:18, 28.84it/s] 19%|█▊        | 124/666 [00:04<00:18, 28.84it/s] 19%|█▉        | 127/666 [00:04<00:18, 28.84it/s] 20%|█▉        | 130/666 [00:04<00:18, 28.83it/s] 20%|█▉        | 133/666 [00:04<00:18, 28.85it/s] 20%|██        | 136/666 [00:04<00:18, 28.84it/s] 21%|██        | 139/666 [00:04<00:18, 28.84it/s] 21%|██▏       | 142/666 [00:05<00:18, 28.82it/s] 22%|██▏       | 145/666 [00:05<00:18, 28.83it/s] 22%|██▏       | 148/666 [00:05<00:17, 28.83it/s] 23%|██▎       | 151/666 [00:05<00:17, 28.83it/s] 23%|██▎       | 154/666 [00:05<00:17, 28.83it/s] 24%|██▎       | 157/666 [00:05<00:17, 28.84it/s] 24%|██▍       | 160/666 [00:05<00:17, 28.85it/s] 24%|██▍       | 163/666 [00:05<00:17, 28.85it/s] 25%|██▍       | 166/666 [00:05<00:17, 28.85it/s] 25%|██▌       | 169/666 [00:06<00:17, 28.85it/s] 26%|██▌       | 172/666 [00:06<00:17, 28.84it/s] 26%|██▋       | 175/666 [00:06<00:17, 28.84it/s] 27%|██▋       | 178/666 [00:06<00:16, 28.84it/s] 27%|██▋       | 181/666 [00:06<00:16, 28.84it/s] 28%|██▊       | 184/666 [00:06<00:16, 28.84it/s] 28%|██▊       | 187/666 [00:06<00:16, 28.85it/s] 29%|██▊       | 190/666 [00:06<00:16, 28.84it/s] 29%|██▉       | 193/666 [00:06<00:16, 28.84it/s] 29%|██▉       | 196/666 [00:06<00:16, 28.83it/s] 30%|██▉       | 199/666 [00:07<00:16, 28.81it/s] 30%|███       | 202/666 [00:07<00:16, 28.82it/s] 31%|███       | 205/666 [00:07<00:15, 28.81it/s] 31%|███       | 208/666 [00:07<00:15, 28.82it/s] 32%|███▏      | 211/666 [00:07<00:15, 28.82it/s] 32%|███▏      | 214/666 [00:07<00:15, 28.83it/s] 33%|███▎      | 217/666 [00:07<00:15, 28.84it/s] 33%|███▎      | 220/666 [00:07<00:15, 28.84it/s] 33%|███▎      | 223/666 [00:07<00:15, 28.84it/s] 34%|███▍      | 226/666 [00:08<00:15, 28.84it/s] 34%|███▍      | 229/666 [00:08<00:15, 28.84it/s] 35%|███▍      | 232/666 [00:08<00:15, 28.84it/s] 35%|███▌      | 235/666 [00:08<00:14, 28.84it/s] 36%|███▌      | 238/666 [00:08<00:14, 28.84it/s] 36%|███▌      | 241/666 [00:08<00:14, 28.84it/s] 37%|███▋      | 244/666 [00:08<00:14, 28.85it/s] 37%|███▋      | 247/666 [00:08<00:14, 28.85it/s] 38%|███▊      | 250/666 [00:08<00:14, 28.85it/s] 38%|███▊      | 253/666 [00:08<00:14, 28.84it/s] 38%|███▊      | 256/666 [00:09<00:14, 28.84it/s] 39%|███▉      | 259/666 [00:09<00:14, 28.84it/s] 39%|███▉      | 262/666 [00:09<00:14, 28.84it/s] 40%|███▉      | 265/666 [00:09<00:13, 28.84it/s] 40%|████      | 268/666 [00:09<00:13, 28.82it/s] 41%|████      | 271/666 [00:09<00:13, 28.79it/s] 41%|████      | 274/666 [00:09<00:13, 28.77it/s] 42%|████▏     | 277/666 [00:09<00:13, 28.77it/s] 42%|████▏     | 280/666 [00:09<00:13, 28.79it/s] 42%|████▏     | 283/666 [00:09<00:13, 28.81it/s] 43%|████▎     | 286/666 [00:10<00:13, 28.81it/s] 43%|████▎     | 289/666 [00:10<00:13, 28.82it/s] 44%|████▍     | 292/666 [00:10<00:12, 28.83it/s] 44%|████▍     | 295/666 [00:10<00:12, 28.84it/s] 45%|████▍     | 298/666 [00:10<00:12, 28.85it/s] 45%|████▌     | 301/666 [00:10<00:12, 28.85it/s] 46%|████▌     | 304/666 [00:10<00:12, 28.86it/s] 46%|████▌     | 307/666 [00:10<00:12, 28.85it/s] 47%|████▋     | 310/666 [00:10<00:12, 28.85it/s] 47%|████▋     | 313/666 [00:11<00:12, 28.85it/s] 47%|████▋     | 316/666 [00:11<00:12, 28.84it/s] 48%|████▊     | 319/666 [00:11<00:12, 28.85it/s] 48%|████▊     | 322/666 [00:11<00:11, 28.85it/s] 49%|████▉     | 325/666 [00:11<00:11, 28.85it/s] 49%|████▉     | 328/666 [00:11<00:11, 28.84it/s] 50%|████▉     | 331/666 [00:11<00:11, 28.85it/s] 50%|█████     | 334/666 [00:11<00:11, 28.85it/s] 51%|█████     | 337/666 [00:11<00:11, 28.85it/s] 51%|█████     | 340/666 [00:11<00:11, 28.84it/s] 52%|█████▏    | 343/666 [00:12<00:11, 28.85it/s] 52%|█████▏    | 346/666 [00:12<00:11, 28.85it/s] 52%|█████▏    | 349/666 [00:12<00:10, 28.85it/s] 53%|█████▎    | 352/666 [00:12<00:10, 28.84it/s] 53%|█████▎    | 355/666 [00:12<00:10, 28.85it/s] 54%|█████▍    | 358/666 [00:12<00:10, 28.85it/s] 54%|█████▍    | 361/666 [00:12<00:10, 28.84it/s] 55%|█████▍    | 364/666 [00:12<00:10, 28.84it/s] 55%|█████▌    | 367/666 [00:12<00:10, 28.84it/s] 56%|█████▌    | 370/666 [00:12<00:10, 28.84it/s] 56%|█████▌    | 373/666 [00:13<00:10, 28.83it/s] 56%|█████▋    | 376/666 [00:13<00:10, 28.83it/s] 57%|█████▋    | 379/666 [00:13<00:09, 28.82it/s] 57%|█████▋    | 382/666 [00:13<00:09, 28.83it/s] 58%|█████▊    | 385/666 [00:13<00:09, 28.82it/s] 58%|█████▊    | 388/666 [00:13<00:09, 28.82it/s] 59%|█████▊    | 391/666 [00:13<00:09, 28.81it/s] 59%|█████▉    | 394/666 [00:13<00:09, 28.82it/s] 60%|█████▉    | 397/666 [00:13<00:09, 28.83it/s] 60%|██████    | 400/666 [00:14<00:09, 28.83it/s] 61%|██████    | 403/666 [00:14<00:09, 28.83it/s] 61%|██████    | 406/666 [00:14<00:09, 28.83it/s] 61%|██████▏   | 409/666 [00:14<00:08, 28.83it/s] 62%|██████▏   | 412/666 [00:14<00:08, 28.83it/s] 62%|██████▏   | 415/666 [00:14<00:08, 28.84it/s] 63%|██████▎   | 418/666 [00:14<00:08, 28.82it/s] 63%|██████▎   | 421/666 [00:14<00:08, 28.82it/s] 64%|██████▎   | 424/666 [00:14<00:08, 28.83it/s] 64%|██████▍   | 427/666 [00:14<00:08, 28.84it/s] 65%|██████▍   | 430/666 [00:15<00:08, 28.84it/s] 65%|██████▌   | 433/666 [00:15<00:08, 28.84it/s] 65%|██████▌   | 436/666 [00:15<00:07, 28.84it/s] 66%|██████▌   | 439/666 [00:15<00:07, 28.84it/s] 66%|██████▋   | 442/666 [00:15<00:07, 28.82it/s] 67%|██████▋   | 445/666 [00:15<00:07, 28.82it/s] 67%|██████▋   | 448/666 [00:15<00:07, 28.82it/s] 68%|██████▊   | 451/666 [00:15<00:07, 28.83it/s] 68%|██████▊   | 454/666 [00:15<00:07, 28.81it/s] 69%|██████▊   | 457/666 [00:16<00:07, 28.83it/s] 69%|██████▉   | 460/666 [00:16<00:07, 28.83it/s] 70%|██████▉   | 463/666 [00:16<00:07, 28.83it/s] 70%|██████▉   | 466/666 [00:16<00:06, 28.84it/s] 70%|███████   | 469/666 [00:16<00:06, 28.84it/s] 71%|███████   | 472/666 [00:16<00:06, 28.83it/s] 71%|███████▏  | 475/666 [00:16<00:06, 28.83it/s] 72%|███████▏  | 478/666 [00:16<00:06, 28.84it/s] 72%|███████▏  | 481/666 [00:16<00:06, 28.84it/s] 73%|███████▎  | 484/666 [00:16<00:06, 28.83it/s] 73%|███████▎  | 487/666 [00:17<00:06, 28.84it/s] 74%|███████▎  | 490/666 [00:17<00:06, 28.84it/s] 74%|███████▍  | 493/666 [00:17<00:05, 28.83it/s] 74%|███████▍  | 496/666 [00:17<00:05, 28.84it/s] 75%|███████▍  | 499/666 [00:17<00:05, 28.82it/s] 75%|███████▌  | 502/666 [00:17<00:05, 28.83it/s] 76%|███████▌  | 505/666 [00:17<00:05, 28.84it/s] 76%|███████▋  | 508/666 [00:17<00:05, 28.84it/s] 77%|███████▋  | 511/666 [00:17<00:05, 28.84it/s] 77%|███████▋  | 514/666 [00:17<00:05, 28.83it/s] 78%|███████▊  | 517/666 [00:18<00:05, 28.83it/s] 78%|███████▊  | 520/666 [00:18<00:05, 28.84it/s] 79%|███████▊  | 523/666 [00:18<00:04, 28.85it/s] 79%|███████▉  | 526/666 [00:18<00:04, 28.85it/s] 79%|███████▉  | 529/666 [00:18<00:04, 28.86it/s] 80%|███████▉  | 532/666 [00:18<00:04, 28.86it/s] 80%|████████  | 535/666 [00:18<00:04, 28.86it/s] 81%|████████  | 538/666 [00:18<00:04, 28.85it/s] 81%|████████  | 541/666 [00:18<00:04, 28.85it/s] 82%|████████▏ | 544/666 [00:19<00:04, 28.85it/s] 82%|████████▏ | 547/666 [00:19<00:04, 28.85it/s] 83%|████████▎ | 550/666 [00:19<00:04, 28.85it/s] 83%|████████▎ | 553/666 [00:19<00:03, 28.85it/s] 83%|████████▎ | 556/666 [00:19<00:03, 28.84it/s] 84%|████████▍ | 559/666 [00:19<00:03, 28.84it/s] 84%|████████▍ | 562/666 [00:19<00:03, 28.84it/s] 85%|████████▍ | 565/666 [00:19<00:03, 28.85it/s] 85%|████████▌ | 568/666 [00:19<00:03, 28.85it/s] 86%|████████▌ | 571/666 [00:19<00:03, 28.84it/s] 86%|████████▌ | 574/666 [00:20<00:03, 28.84it/s] 87%|████████▋ | 577/666 [00:20<00:03, 28.83it/s] 87%|████████▋ | 580/666 [00:20<00:02, 28.83it/s] 88%|████████▊ | 583/666 [00:20<00:02, 28.85it/s] 88%|████████▊ | 586/666 [00:20<00:02, 28.85it/s] 88%|████████▊ | 589/666 [00:20<00:02, 28.84it/s] 89%|████████▉ | 592/666 [00:20<00:02, 28.84it/s] 89%|████████▉ | 595/666 [00:20<00:02, 28.84it/s] 90%|████████▉ | 598/666 [00:20<00:02, 28.84it/s] 90%|█████████ | 601/666 [00:21<00:02, 28.84it/s] 91%|█████████ | 604/666 [00:21<00:02, 28.85it/s] 91%|█████████ | 607/666 [00:21<00:02, 28.85it/s] 92%|█████████▏| 610/666 [00:21<00:01, 28.84it/s] 92%|█████████▏| 613/666 [00:21<00:01, 28.84it/s] 92%|█████████▏| 616/666 [00:21<00:01, 28.83it/s] 93%|█████████▎| 619/666 [00:21<00:01, 28.82it/s] 93%|█████████▎| 622/666 [00:21<00:01, 28.82it/s] 94%|█████████▍| 625/666 [00:21<00:01, 28.83it/s] 94%|█████████▍| 628/666 [00:21<00:01, 28.83it/s] 95%|█████████▍| 631/666 [00:22<00:01, 28.83it/s] 95%|█████████▌| 634/666 [00:22<00:01, 28.84it/s] 96%|█████████▌| 637/666 [00:22<00:01, 28.82it/s] 96%|█████████▌| 640/666 [00:22<00:00, 28.78it/s] 97%|█████████▋| 643/666 [00:22<00:00, 28.80it/s] 97%|█████████▋| 646/666 [00:22<00:00, 28.81it/s] 97%|█████████▋| 649/666 [00:22<00:00, 28.82it/s] 98%|█████████▊| 652/666 [00:22<00:00, 28.82it/s] 98%|█████████▊| 655/666 [00:22<00:00, 28.83it/s] 99%|█████████▉| 658/666 [00:22<00:00, 28.84it/s] 99%|█████████▉| 661/666 [00:23<00:00, 28.26it/s]100%|█████████▉| 664/666 [00:23<00:00, 28.49it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:19,  8.44it/s][A
  6%|▌         | 10/167 [00:00<00:03, 48.64it/s][A
 18%|█▊        | 30/167 [00:00<00:01, 110.54it/s][A
 32%|███▏      | 53/167 [00:00<00:00, 154.01it/s][A
 46%|████▌     | 76/167 [00:00<00:00, 178.96it/s][A
 59%|█████▉    | 99/167 [00:00<00:00, 194.43it/s][A
 73%|███████▎  | 122/167 [00:00<00:00, 204.35it/s][A
 87%|████████▋ | 145/167 [00:00<00:00, 210.40it/s][A100%|██████████| 167/167 [00:00<00:00, 168.04it/s]
2022-11-28 21:27:26,711 P59106 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:27:26,712 P59106 INFO Monitor(max) STOP: -10.617075 !
2022-11-28 21:27:26,712 P59106 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:27:26,712 P59106 INFO Early stopping at epoch=3
2022-11-28 21:27:26,712 P59106 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:24<00:00, 27.23it/s]
2022-11-28 21:27:26,762 P59106 INFO Train loss: 69.009461
2022-11-28 21:27:26,762 P59106 INFO Training finished.
2022-11-28 21:27:26,762 P59106 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_009_58acfdaf.model
2022-11-28 21:27:27,524 P59106 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:57,  5.67it/s]  2%|▏         | 10/666 [00:00<00:15, 41.24it/s]  5%|▍         | 30/666 [00:00<00:06, 100.25it/s]  8%|▊         | 50/666 [00:00<00:04, 134.01it/s] 11%|█         | 70/666 [00:00<00:03, 154.66it/s] 14%|█▎        | 90/666 [00:00<00:03, 168.65it/s] 17%|█▋        | 110/666 [00:00<00:03, 178.28it/s] 20%|█▉        | 130/666 [00:00<00:02, 184.68it/s] 23%|██▎       | 151/666 [00:01<00:02, 189.75it/s] 26%|██▌       | 172/666 [00:01<00:02, 193.66it/s] 29%|██▉       | 193/666 [00:01<00:02, 196.37it/s] 32%|███▏      | 214/666 [00:01<00:02, 198.24it/s] 35%|███▌      | 235/666 [00:01<00:02, 199.69it/s] 38%|███▊      | 256/666 [00:01<00:02, 200.61it/s] 42%|████▏     | 277/666 [00:01<00:01, 200.99it/s] 45%|████▍     | 298/666 [00:01<00:01, 201.48it/s] 48%|████▊     | 319/666 [00:01<00:01, 201.94it/s] 51%|█████     | 340/666 [00:01<00:01, 202.14it/s] 54%|█████▍    | 361/666 [00:02<00:01, 202.32it/s] 57%|█████▋    | 382/666 [00:02<00:01, 201.37it/s] 61%|██████    | 403/666 [00:02<00:01, 197.73it/s] 64%|██████▎   | 424/666 [00:02<00:01, 198.54it/s] 67%|██████▋   | 444/666 [00:02<00:01, 198.85it/s] 70%|██████▉   | 464/666 [00:02<00:01, 198.34it/s] 73%|███████▎  | 484/666 [00:02<00:00, 198.78it/s] 76%|███████▌  | 504/666 [00:02<00:00, 199.11it/s] 79%|███████▊  | 524/666 [00:02<00:00, 199.31it/s] 82%|████████▏ | 544/666 [00:02<00:00, 199.37it/s] 85%|████████▍ | 565/666 [00:03<00:00, 199.94it/s] 88%|████████▊ | 586/666 [00:03<00:00, 200.28it/s] 91%|█████████ | 607/666 [00:03<00:00, 200.56it/s] 94%|█████████▍| 628/666 [00:03<00:00, 200.43it/s] 97%|█████████▋| 649/666 [00:03<00:00, 200.50it/s]100%|██████████| 666/666 [00:03<00:00, 184.10it/s]
2022-11-28 21:27:31,600 P59106 INFO [Metrics] logloss: 11.123019 - AUC: 0.499893
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:17,  9.48it/s]  6%|▌         | 10/167 [00:00<00:03, 50.01it/s] 17%|█▋        | 29/167 [00:00<00:01, 109.34it/s] 29%|██▊       | 48/167 [00:00<00:00, 139.72it/s] 41%|████      | 68/167 [00:00<00:00, 158.21it/s] 53%|█████▎    | 88/167 [00:00<00:00, 169.34it/s] 65%|██████▍   | 108/167 [00:00<00:00, 178.84it/s] 77%|███████▋  | 128/167 [00:00<00:00, 185.09it/s] 89%|████████▉ | 149/167 [00:00<00:00, 190.05it/s]100%|██████████| 167/167 [00:01<00:00, 155.17it/s]
2022-11-28 21:27:32,791 P59106 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:27:36,383 P60897 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "64",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_010_47aff451",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:27:36,385 P60897 INFO Set up feature encoder...
2022-11-28 21:27:36,386 P60897 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:27:36,393 P60897 INFO Loading data...
2022-11-28 21:27:36,402 P60897 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:27:36,629 P60897 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:27:36,724 P60897 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:27:36,724 P60897 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:27:36,724 P60897 INFO Loading train data done.
2022-11-28 21:27:39,423 P60897 INFO Total number of parameters: 15268036.
2022-11-28 21:27:39,423 P60897 INFO Start training: 666 batches/epoch
2022-11-28 21:27:39,423 P60897 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:27:39.751 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:60897 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:27:39.783 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:60897 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:17,  1.11s/it]  1%|          | 8/666 [00:01<01:16,  8.63it/s]  2%|▏         | 13/666 [00:01<00:46, 14.01it/s]  3%|▎         | 20/666 [00:01<00:28, 22.72it/s]  4%|▍         | 27/666 [00:01<00:20, 31.03it/s]  5%|▌         | 34/666 [00:01<00:16, 38.82it/s]  6%|▌         | 41/666 [00:01<00:13, 45.58it/s]  7%|▋         | 48/666 [00:01<00:12, 51.09it/s]  8%|▊         | 55/666 [00:01<00:11, 55.50it/s]  9%|▉         | 62/666 [00:02<00:10, 58.87it/s] 10%|█         | 69/666 [00:02<00:09, 61.36it/s] 11%|█▏        | 76/666 [00:02<00:09, 63.24it/s] 12%|█▏        | 83/666 [00:02<00:09, 64.57it/s] 14%|█▎        | 90/666 [00:02<00:08, 65.54it/s] 15%|█▍        | 97/666 [00:02<00:08, 66.21it/s] 16%|█▌        | 104/666 [00:02<00:08, 66.69it/s] 17%|█▋        | 111/666 [00:02<00:08, 67.00it/s] 18%|█▊        | 118/666 [00:02<00:08, 67.22it/s] 19%|█▉        | 125/666 [00:03<00:08, 67.40it/s] 20%|█▉        | 132/666 [00:03<00:08, 65.64it/s] 21%|██        | 139/666 [00:03<00:07, 66.25it/s] 22%|██▏       | 146/666 [00:03<00:07, 66.70it/s] 23%|██▎       | 153/666 [00:03<00:07, 67.00it/s] 24%|██▍       | 160/666 [00:03<00:07, 67.22it/s] 25%|██▌       | 167/666 [00:03<00:07, 67.37it/s] 26%|██▌       | 174/666 [00:03<00:07, 67.50it/s] 27%|██▋       | 181/666 [00:03<00:07, 67.53it/s] 28%|██▊       | 188/666 [00:03<00:07, 67.62it/s] 29%|██▉       | 195/666 [00:04<00:06, 67.62it/s] 30%|███       | 202/666 [00:04<00:06, 67.65it/s] 31%|███▏      | 209/666 [00:04<00:06, 67.70it/s] 32%|███▏      | 216/666 [00:04<00:06, 67.73it/s] 33%|███▎      | 223/666 [00:04<00:06, 67.74it/s] 35%|███▍      | 230/666 [00:04<00:06, 67.74it/s] 36%|███▌      | 237/666 [00:04<00:06, 67.75it/s] 37%|███▋      | 244/666 [00:04<00:06, 67.74it/s] 38%|███▊      | 251/666 [00:04<00:06, 67.73it/s] 39%|███▊      | 258/666 [00:04<00:06, 67.73it/s] 40%|███▉      | 265/666 [00:05<00:05, 67.75it/s] 41%|████      | 272/666 [00:05<00:05, 67.77it/s] 42%|████▏     | 279/666 [00:05<00:05, 67.76it/s] 43%|████▎     | 286/666 [00:05<00:05, 67.77it/s] 44%|████▍     | 293/666 [00:05<00:05, 67.76it/s] 45%|████▌     | 300/666 [00:05<00:05, 67.76it/s] 46%|████▌     | 307/666 [00:05<00:05, 67.80it/s] 47%|████▋     | 314/666 [00:05<00:05, 67.77it/s] 48%|████▊     | 321/666 [00:05<00:05, 67.72it/s] 49%|████▉     | 328/666 [00:06<00:04, 67.73it/s] 50%|█████     | 335/666 [00:06<00:04, 67.76it/s] 51%|█████▏    | 342/666 [00:06<00:04, 67.75it/s] 52%|█████▏    | 349/666 [00:06<00:04, 67.75it/s] 53%|█████▎    | 356/666 [00:06<00:04, 67.75it/s] 55%|█████▍    | 363/666 [00:06<00:04, 67.74it/s] 56%|█████▌    | 370/666 [00:06<00:04, 67.74it/s] 57%|█████▋    | 377/666 [00:06<00:04, 67.71it/s] 58%|█████▊    | 384/666 [00:06<00:04, 67.70it/s] 59%|█████▊    | 391/666 [00:06<00:04, 67.73it/s] 60%|█████▉    | 398/666 [00:07<00:03, 67.72it/s] 61%|██████    | 405/666 [00:07<00:03, 67.70it/s] 62%|██████▏   | 412/666 [00:07<00:03, 67.69it/s] 63%|██████▎   | 419/666 [00:07<00:03, 67.69it/s] 64%|██████▍   | 426/666 [00:07<00:03, 67.70it/s] 65%|██████▌   | 433/666 [00:07<00:03, 67.69it/s] 66%|██████▌   | 440/666 [00:07<00:03, 67.70it/s] 67%|██████▋   | 447/666 [00:07<00:03, 67.65it/s] 68%|██████▊   | 454/666 [00:07<00:03, 67.65it/s] 69%|██████▉   | 461/666 [00:07<00:03, 67.67it/s] 70%|███████   | 468/666 [00:08<00:02, 67.67it/s] 71%|███████▏  | 475/666 [00:08<00:02, 67.70it/s] 72%|███████▏  | 482/666 [00:08<00:02, 67.70it/s] 73%|███████▎  | 489/666 [00:08<00:02, 67.63it/s] 74%|███████▍  | 496/666 [00:08<00:02, 67.62it/s] 76%|███████▌  | 503/666 [00:08<00:02, 67.63it/s] 77%|███████▋  | 510/666 [00:08<00:02, 67.63it/s] 78%|███████▊  | 517/666 [00:08<00:02, 67.65it/s] 79%|███████▊  | 524/666 [00:08<00:02, 67.67it/s] 80%|███████▉  | 531/666 [00:09<00:01, 67.70it/s] 81%|████████  | 538/666 [00:09<00:01, 66.77it/s] 82%|████████▏ | 545/666 [00:09<00:01, 67.05it/s] 83%|████████▎ | 552/666 [00:09<00:01, 67.20it/s] 84%|████████▍ | 559/666 [00:09<00:01, 67.33it/s] 85%|████████▍ | 566/666 [00:09<00:01, 67.41it/s] 86%|████████▌ | 573/666 [00:09<00:01, 67.43it/s] 87%|████████▋ | 580/666 [00:09<00:01, 67.49it/s] 88%|████████▊ | 587/666 [00:09<00:01, 67.53it/s] 89%|████████▉ | 594/666 [00:09<00:01, 67.55it/s] 90%|█████████ | 601/666 [00:10<00:00, 67.54it/s] 91%|█████████▏| 608/666 [00:10<00:00, 67.57it/s] 92%|█████████▏| 615/666 [00:10<00:00, 67.51it/s] 93%|█████████▎| 622/666 [00:10<00:00, 67.45it/s] 94%|█████████▍| 629/666 [00:10<00:00, 67.42it/s] 95%|█████████▌| 636/666 [00:10<00:00, 67.40it/s] 97%|█████████▋| 643/666 [00:10<00:00, 67.42it/s] 98%|█████████▊| 650/666 [00:10<00:00, 67.46it/s] 99%|█████████▊| 657/666 [00:10<00:00, 67.48it/s]100%|█████████▉| 664/666 [00:10<00:00, 66.30it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.86it/s][A
  6%|▌         | 10/167 [00:00<00:03, 52.32it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 120.92it/s][A
 33%|███▎      | 55/167 [00:00<00:00, 164.13it/s][A
 47%|████▋     | 78/167 [00:00<00:00, 186.84it/s][A
 61%|██████    | 102/167 [00:00<00:00, 201.77it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 210.68it/s][A
 89%|████████▉ | 149/167 [00:00<00:00, 217.07it/s][A100%|██████████| 167/167 [00:00<00:00, 175.14it/s]
2022-11-28 21:27:51,510 P60897 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:27:51,510 P60897 INFO Save best model: monitor(max): -4.497089
2022-11-28 21:27:51,881 P60897 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:12<00:00, 53.30it/s]
2022-11-28 21:27:51,921 P60897 INFO Train loss: 30.976341
2022-11-28 21:27:51,921 P60897 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:55,  5.77it/s]  1%|          | 8/666 [00:00<00:19, 33.21it/s]  2%|▏         | 13/666 [00:00<00:17, 37.72it/s]  3%|▎         | 20/666 [00:00<00:13, 48.46it/s]  4%|▍         | 27/666 [00:00<00:11, 55.25it/s]  5%|▌         | 34/666 [00:00<00:10, 59.69it/s]  6%|▌         | 41/666 [00:00<00:09, 62.60it/s]  7%|▋         | 48/666 [00:00<00:09, 64.59it/s]  8%|▊         | 55/666 [00:01<00:09, 65.92it/s]  9%|▉         | 62/666 [00:01<00:09, 66.89it/s] 10%|█         | 69/666 [00:01<00:08, 67.58it/s] 11%|█▏        | 76/666 [00:01<00:08, 68.08it/s] 12%|█▏        | 83/666 [00:01<00:08, 68.41it/s] 14%|█▎        | 90/666 [00:01<00:08, 68.63it/s] 15%|█▍        | 97/666 [00:01<00:08, 67.45it/s] 16%|█▌        | 104/666 [00:01<00:08, 66.50it/s] 17%|█▋        | 111/666 [00:01<00:08, 65.83it/s] 18%|█▊        | 118/666 [00:01<00:08, 65.42it/s] 19%|█▉        | 125/666 [00:02<00:08, 65.11it/s] 20%|█▉        | 132/666 [00:02<00:08, 64.86it/s] 21%|██        | 139/666 [00:02<00:08, 64.74it/s] 22%|██▏       | 146/666 [00:02<00:08, 64.84it/s] 23%|██▎       | 153/666 [00:02<00:07, 65.99it/s] 24%|██▍       | 160/666 [00:02<00:07, 66.87it/s] 25%|██▌       | 167/666 [00:02<00:07, 67.49it/s] 26%|██▌       | 174/666 [00:02<00:07, 67.94it/s] 27%|██▋       | 181/666 [00:02<00:07, 68.34it/s] 28%|██▊       | 188/666 [00:02<00:06, 68.61it/s] 29%|██▉       | 195/666 [00:03<00:06, 68.80it/s] 30%|███       | 202/666 [00:03<00:06, 68.88it/s] 31%|███▏      | 209/666 [00:03<00:06, 68.98it/s] 32%|███▏      | 216/666 [00:03<00:06, 69.05it/s] 33%|███▎      | 223/666 [00:03<00:06, 69.11it/s] 35%|███▍      | 230/666 [00:03<00:06, 69.05it/s] 36%|███▌      | 237/666 [00:03<00:06, 69.00it/s] 37%|███▋      | 244/666 [00:03<00:06, 69.07it/s] 38%|███▊      | 251/666 [00:03<00:06, 69.09it/s] 39%|███▊      | 258/666 [00:04<00:05, 69.10it/s] 40%|███▉      | 265/666 [00:04<00:05, 69.10it/s] 41%|████      | 272/666 [00:04<00:05, 69.12it/s] 42%|████▏     | 279/666 [00:04<00:05, 69.14it/s] 43%|████▎     | 286/666 [00:04<00:05, 69.17it/s] 44%|████▍     | 293/666 [00:04<00:05, 69.11it/s] 45%|████▌     | 300/666 [00:04<00:05, 69.11it/s] 46%|████▌     | 307/666 [00:04<00:05, 69.12it/s] 47%|████▋     | 314/666 [00:04<00:05, 69.15it/s] 48%|████▊     | 321/666 [00:04<00:04, 69.21it/s] 49%|████▉     | 328/666 [00:05<00:04, 69.22it/s] 50%|█████     | 335/666 [00:05<00:04, 69.23it/s] 51%|█████▏    | 342/666 [00:05<00:04, 69.20it/s] 52%|█████▏    | 349/666 [00:05<00:04, 69.20it/s] 53%|█████▎    | 356/666 [00:05<00:04, 69.15it/s] 55%|█████▍    | 363/666 [00:05<00:04, 69.14it/s] 56%|█████▌    | 370/666 [00:05<00:04, 69.19it/s] 57%|█████▋    | 377/666 [00:05<00:04, 69.19it/s] 58%|█████▊    | 384/666 [00:05<00:04, 69.17it/s] 59%|█████▊    | 391/666 [00:05<00:03, 69.14it/s] 60%|█████▉    | 398/666 [00:06<00:03, 69.17it/s] 61%|██████    | 405/666 [00:06<00:03, 69.16it/s] 62%|██████▏   | 412/666 [00:06<00:03, 69.15it/s] 63%|██████▎   | 419/666 [00:06<00:03, 69.09it/s] 64%|██████▍   | 426/666 [00:06<00:03, 69.00it/s] 65%|██████▌   | 433/666 [00:06<00:03, 69.01it/s] 66%|██████▌   | 440/666 [00:06<00:03, 69.07it/s] 67%|██████▋   | 447/666 [00:06<00:03, 69.10it/s] 68%|██████▊   | 454/666 [00:06<00:03, 69.13it/s] 69%|██████▉   | 461/666 [00:06<00:02, 69.09it/s] 70%|███████   | 468/666 [00:07<00:02, 69.13it/s] 71%|███████▏  | 475/666 [00:07<00:02, 69.11it/s] 72%|███████▏  | 482/666 [00:07<00:02, 69.07it/s] 73%|███████▎  | 489/666 [00:07<00:02, 69.08it/s] 74%|███████▍  | 496/666 [00:07<00:02, 69.13it/s] 76%|███████▌  | 503/666 [00:07<00:02, 69.02it/s] 77%|███████▋  | 510/666 [00:07<00:02, 69.04it/s] 78%|███████▊  | 517/666 [00:07<00:02, 69.02it/s] 79%|███████▊  | 524/666 [00:07<00:02, 69.07it/s] 80%|███████▉  | 531/666 [00:07<00:01, 69.13it/s] 81%|████████  | 538/666 [00:08<00:01, 65.75it/s] 82%|████████▏ | 545/666 [00:08<00:01, 66.71it/s] 83%|████████▎ | 552/666 [00:08<00:01, 67.43it/s] 84%|████████▍ | 559/666 [00:08<00:01, 67.97it/s] 85%|████████▍ | 566/666 [00:08<00:01, 68.29it/s] 86%|████████▌ | 573/666 [00:08<00:01, 68.54it/s] 87%|████████▋ | 580/666 [00:08<00:01, 68.76it/s] 88%|████████▊ | 587/666 [00:08<00:01, 68.90it/s] 89%|████████▉ | 594/666 [00:08<00:01, 68.89it/s] 90%|█████████ | 601/666 [00:08<00:00, 68.98it/s] 91%|█████████▏| 608/666 [00:09<00:00, 68.96it/s] 92%|█████████▏| 615/666 [00:09<00:00, 69.04it/s] 93%|█████████▎| 622/666 [00:09<00:00, 69.08it/s] 94%|█████████▍| 629/666 [00:09<00:00, 69.07it/s] 95%|█████████▌| 636/666 [00:09<00:00, 69.00it/s] 97%|█████████▋| 643/666 [00:09<00:00, 68.89it/s] 98%|█████████▊| 650/666 [00:09<00:00, 68.85it/s] 99%|█████████▊| 657/666 [00:09<00:00, 68.87it/s]100%|█████████▉| 664/666 [00:09<00:00, 67.75it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.12it/s][A
  6%|▌         | 10/167 [00:00<00:03, 43.76it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 115.09it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 155.76it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 179.91it/s][A
 62%|██████▏   | 103/167 [00:00<00:00, 196.60it/s][A
 75%|███████▌  | 126/167 [00:00<00:00, 206.50it/s][A
 89%|████████▉ | 149/167 [00:00<00:00, 213.74it/s][A100%|██████████| 167/167 [00:00<00:00, 168.79it/s]
2022-11-28 21:28:02,950 P60897 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:28:02,950 P60897 INFO Monitor(max) STOP: -4.497089 !
2022-11-28 21:28:02,950 P60897 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:28:02,951 P60897 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:11<00:00, 60.10it/s]
2022-11-28 21:28:03,002 P60897 INFO Train loss: 30.976982
2022-11-28 21:28:03,002 P60897 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:51,  5.97it/s]  1%|          | 8/666 [00:00<00:18, 34.90it/s]  2%|▏         | 13/666 [00:00<00:17, 38.11it/s]  3%|▎         | 20/666 [00:00<00:13, 48.39it/s]  4%|▍         | 27/666 [00:00<00:11, 54.73it/s]  5%|▌         | 34/666 [00:00<00:10, 58.86it/s]  6%|▌         | 41/666 [00:00<00:10, 61.61it/s]  7%|▋         | 48/666 [00:00<00:09, 63.45it/s]  8%|▊         | 55/666 [00:01<00:09, 64.68it/s]  9%|▉         | 62/666 [00:01<00:09, 65.54it/s] 10%|█         | 69/666 [00:01<00:09, 66.15it/s] 11%|█▏        | 76/666 [00:01<00:08, 66.51it/s] 12%|█▏        | 83/666 [00:01<00:08, 66.68it/s] 14%|█▎        | 90/666 [00:01<00:08, 66.92it/s] 15%|█▍        | 97/666 [00:01<00:08, 67.07it/s] 16%|█▌        | 104/666 [00:01<00:08, 67.19it/s] 17%|█▋        | 111/666 [00:01<00:08, 67.26it/s] 18%|█▊        | 118/666 [00:01<00:08, 67.36it/s] 19%|█▉        | 125/666 [00:02<00:08, 67.40it/s] 20%|█▉        | 132/666 [00:02<00:07, 67.44it/s] 21%|██        | 139/666 [00:02<00:07, 67.46it/s] 22%|██▏       | 146/666 [00:02<00:07, 67.46it/s] 23%|██▎       | 153/666 [00:02<00:07, 67.47it/s] 24%|██▍       | 160/666 [00:02<00:07, 67.51it/s] 25%|██▌       | 167/666 [00:02<00:07, 67.49it/s] 26%|██▌       | 174/666 [00:02<00:07, 67.55it/s] 27%|██▋       | 181/666 [00:02<00:07, 67.54it/s] 28%|██▊       | 188/666 [00:02<00:07, 67.55it/s] 29%|██▉       | 195/666 [00:03<00:06, 67.56it/s] 30%|███       | 202/666 [00:03<00:06, 67.56it/s] 31%|███▏      | 209/666 [00:03<00:06, 67.55it/s] 32%|███▏      | 216/666 [00:03<00:06, 67.56it/s] 33%|███▎      | 223/666 [00:03<00:06, 67.54it/s] 35%|███▍      | 230/666 [00:03<00:06, 67.54it/s] 36%|███▌      | 237/666 [00:03<00:06, 67.58it/s] 37%|███▋      | 244/666 [00:03<00:06, 67.56it/s] 38%|███▊      | 251/666 [00:03<00:06, 67.50it/s] 39%|███▊      | 258/666 [00:04<00:06, 67.51it/s] 40%|███▉      | 265/666 [00:04<00:05, 67.51it/s] 41%|████      | 272/666 [00:04<00:05, 67.51it/s] 42%|████▏     | 279/666 [00:04<00:05, 67.51it/s] 43%|████▎     | 286/666 [00:04<00:05, 67.50it/s] 44%|████▍     | 293/666 [00:04<00:05, 67.51it/s] 45%|████▌     | 300/666 [00:04<00:05, 67.51it/s] 46%|████▌     | 307/666 [00:04<00:05, 67.50it/s] 47%|████▋     | 314/666 [00:04<00:05, 67.50it/s] 48%|████▊     | 321/666 [00:04<00:05, 67.47it/s] 49%|████▉     | 328/666 [00:05<00:05, 67.46it/s] 50%|█████     | 335/666 [00:05<00:04, 67.50it/s] 51%|█████▏    | 342/666 [00:05<00:04, 67.54it/s] 52%|█████▏    | 349/666 [00:05<00:04, 67.55it/s] 53%|█████▎    | 356/666 [00:05<00:04, 67.54it/s] 55%|█████▍    | 363/666 [00:05<00:04, 67.56it/s] 56%|█████▌    | 370/666 [00:05<00:04, 67.55it/s] 57%|█████▋    | 377/666 [00:05<00:04, 67.59it/s] 58%|█████▊    | 384/666 [00:05<00:04, 67.55it/s] 59%|█████▊    | 391/666 [00:05<00:04, 67.57it/s] 60%|█████▉    | 398/666 [00:06<00:03, 67.54it/s] 61%|██████    | 405/666 [00:06<00:03, 67.56it/s] 62%|██████▏   | 412/666 [00:06<00:03, 67.53it/s] 63%|██████▎   | 419/666 [00:06<00:03, 67.55it/s] 64%|██████▍   | 426/666 [00:06<00:03, 67.53it/s] 65%|██████▌   | 433/666 [00:06<00:03, 67.52it/s] 66%|██████▌   | 440/666 [00:06<00:03, 67.55it/s] 67%|██████▋   | 447/666 [00:06<00:03, 67.54it/s] 68%|██████▊   | 454/666 [00:06<00:03, 67.53it/s] 69%|██████▉   | 461/666 [00:07<00:03, 67.55it/s] 70%|███████   | 468/666 [00:07<00:02, 67.53it/s] 71%|███████▏  | 475/666 [00:07<00:02, 67.54it/s] 72%|███████▏  | 482/666 [00:07<00:02, 67.55it/s] 73%|███████▎  | 489/666 [00:07<00:02, 67.61it/s] 74%|███████▍  | 496/666 [00:07<00:02, 67.59it/s] 76%|███████▌  | 503/666 [00:07<00:02, 67.58it/s] 77%|███████▋  | 510/666 [00:07<00:02, 67.56it/s] 78%|███████▊  | 517/666 [00:07<00:02, 67.54it/s] 79%|███████▊  | 524/666 [00:07<00:02, 67.54it/s] 80%|███████▉  | 531/666 [00:08<00:01, 67.54it/s] 81%|████████  | 538/666 [00:08<00:01, 67.52it/s] 82%|████████▏ | 545/666 [00:08<00:01, 67.56it/s] 83%|████████▎ | 552/666 [00:08<00:01, 67.58it/s] 84%|████████▍ | 559/666 [00:08<00:01, 67.60it/s] 85%|████████▍ | 566/666 [00:08<00:01, 67.58it/s] 86%|████████▌ | 573/666 [00:08<00:01, 67.59it/s] 87%|████████▋ | 580/666 [00:08<00:01, 67.55it/s] 88%|████████▊ | 587/666 [00:08<00:01, 67.56it/s] 89%|████████▉ | 594/666 [00:08<00:01, 67.56it/s] 90%|█████████ | 601/666 [00:09<00:00, 67.55it/s] 91%|█████████▏| 608/666 [00:09<00:00, 67.60it/s] 92%|█████████▏| 615/666 [00:09<00:00, 67.53it/s] 93%|█████████▎| 622/666 [00:09<00:00, 67.53it/s] 94%|█████████▍| 629/666 [00:09<00:00, 67.51it/s] 95%|█████████▌| 636/666 [00:09<00:00, 67.52it/s] 97%|█████████▋| 643/666 [00:09<00:00, 67.52it/s] 98%|█████████▊| 650/666 [00:09<00:00, 67.52it/s] 99%|█████████▊| 657/666 [00:09<00:00, 67.48it/s]100%|█████████▉| 664/666 [00:10<00:00, 66.33it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:19,  8.64it/s][A
  6%|▌         | 10/167 [00:00<00:03, 49.27it/s][A
 19%|█▉        | 32/167 [00:00<00:01, 121.04it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 163.15it/s][A
 48%|████▊     | 80/167 [00:00<00:00, 187.56it/s][A
 62%|██████▏   | 104/167 [00:00<00:00, 202.35it/s][A
 77%|███████▋  | 128/167 [00:00<00:00, 211.43it/s][A
 91%|█████████ | 152/167 [00:00<00:00, 218.06it/s][A100%|██████████| 167/167 [00:00<00:00, 173.29it/s]
2022-11-28 21:28:14,144 P60897 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:28:14,144 P60897 INFO Monitor(max) STOP: -4.497089 !
2022-11-28 21:28:14,144 P60897 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:28:14,144 P60897 INFO Early stopping at epoch=3
2022-11-28 21:28:14,145 P60897 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:11<00:00, 59.40it/s]
2022-11-28 21:28:14,199 P60897 INFO Train loss: 30.974828
2022-11-28 21:28:14,199 P60897 INFO Training finished.
2022-11-28 21:28:14,199 P60897 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_010_47aff451.model
2022-11-28 21:28:14,469 P60897 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:02,  5.41it/s]  2%|▏         | 10/666 [00:00<00:16, 40.02it/s]  5%|▍         | 33/666 [00:00<00:05, 109.97it/s]  8%|▊         | 56/666 [00:00<00:04, 149.69it/s] 12%|█▏        | 79/666 [00:00<00:03, 173.78it/s] 15%|█▌        | 101/666 [00:00<00:02, 188.35it/s] 18%|█▊        | 123/666 [00:00<00:02, 197.84it/s] 22%|██▏       | 145/666 [00:00<00:02, 204.58it/s] 25%|██▌       | 167/666 [00:01<00:02, 209.27it/s] 28%|██▊       | 189/666 [00:01<00:02, 212.33it/s] 32%|███▏      | 211/666 [00:01<00:02, 213.75it/s] 35%|███▍      | 233/666 [00:01<00:02, 215.26it/s] 38%|███▊      | 255/666 [00:01<00:01, 216.03it/s] 42%|████▏     | 277/666 [00:01<00:01, 216.59it/s] 45%|████▍     | 299/666 [00:01<00:01, 216.65it/s] 48%|████▊     | 321/666 [00:01<00:01, 215.70it/s] 52%|█████▏    | 343/666 [00:01<00:01, 216.50it/s] 55%|█████▍    | 365/666 [00:01<00:01, 216.87it/s] 58%|█████▊    | 387/666 [00:02<00:01, 217.59it/s] 61%|██████▏   | 409/666 [00:02<00:01, 217.68it/s] 65%|██████▍   | 431/666 [00:02<00:01, 217.88it/s] 68%|██████▊   | 453/666 [00:02<00:00, 218.04it/s] 71%|███████▏  | 475/666 [00:02<00:00, 218.19it/s] 75%|███████▍  | 497/666 [00:02<00:00, 218.10it/s] 78%|███████▊  | 519/666 [00:02<00:00, 218.19it/s] 81%|████████  | 541/666 [00:02<00:00, 218.20it/s] 85%|████████▍ | 563/666 [00:02<00:00, 218.39it/s] 88%|████████▊ | 585/666 [00:02<00:00, 218.54it/s] 91%|█████████ | 607/666 [00:03<00:00, 218.59it/s] 94%|█████████▍| 629/666 [00:03<00:00, 218.63it/s] 98%|█████████▊| 651/666 [00:03<00:00, 214.36it/s]100%|██████████| 666/666 [00:03<00:00, 198.86it/s]
2022-11-28 21:28:18,265 P60897 INFO [Metrics] logloss: 4.992712 - AUC: 0.500001
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:18,  8.88it/s]  6%|▌         | 10/167 [00:00<00:03, 51.50it/s] 19%|█▉        | 32/167 [00:00<00:01, 122.57it/s] 32%|███▏      | 54/167 [00:00<00:00, 158.91it/s] 46%|████▌     | 76/167 [00:00<00:00, 179.36it/s] 59%|█████▊    | 98/167 [00:00<00:00, 192.56it/s] 72%|███████▏  | 120/167 [00:00<00:00, 200.96it/s] 85%|████████▌ | 142/167 [00:00<00:00, 206.05it/s] 99%|█████████▉| 165/167 [00:00<00:00, 211.00it/s]100%|██████████| 167/167 [00:00<00:00, 168.19it/s]
2022-11-28 21:28:19,374 P60897 INFO [Metrics] logloss: 4.997136 - AUC: 0.500047
2022-11-28 21:28:21,404 P62682 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "128",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_011_6d1ddf03",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:28:21,406 P62682 INFO Set up feature encoder...
2022-11-28 21:28:21,406 P62682 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:28:21,407 P62682 INFO Loading data...
2022-11-28 21:28:21,410 P62682 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:28:21,636 P62682 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:28:21,733 P62682 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:28:21,734 P62682 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:28:21,734 P62682 INFO Loading train data done.
2022-11-28 21:28:24,749 P62682 INFO Total number of parameters: 29989252.
2022-11-28 21:28:24,749 P62682 INFO Start training: 666 batches/epoch
2022-11-28 21:28:24,749 P62682 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:28:25.087 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:62682 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:28:25.119 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:62682 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:22,  1.12s/it]  1%|          | 6/666 [00:01<01:44,  6.32it/s]  2%|▏         | 11/666 [00:01<00:54, 12.08it/s]  2%|▏         | 15/666 [00:01<00:39, 16.45it/s]  3%|▎         | 20/666 [00:01<00:28, 22.38it/s]  4%|▍         | 25/666 [00:01<00:23, 27.69it/s]  5%|▍         | 30/666 [00:01<00:19, 32.23it/s]  5%|▌         | 35/666 [00:01<00:17, 35.93it/s]  6%|▌         | 40/666 [00:01<00:16, 38.81it/s]  7%|▋         | 45/666 [00:02<00:15, 41.01it/s]  8%|▊         | 50/666 [00:02<00:14, 42.63it/s]  8%|▊         | 55/666 [00:02<00:13, 43.81it/s]  9%|▉         | 60/666 [00:02<00:13, 44.66it/s] 10%|▉         | 65/666 [00:02<00:13, 45.26it/s] 11%|█         | 70/666 [00:02<00:13, 45.70it/s] 11%|█▏        | 75/666 [00:02<00:12, 46.00it/s] 12%|█▏        | 80/666 [00:02<00:12, 46.23it/s] 13%|█▎        | 85/666 [00:02<00:12, 46.37it/s] 14%|█▎        | 90/666 [00:03<00:12, 46.47it/s] 14%|█▍        | 95/666 [00:03<00:12, 46.55it/s] 15%|█▌        | 100/666 [00:03<00:12, 46.59it/s] 16%|█▌        | 105/666 [00:03<00:12, 46.63it/s] 17%|█▋        | 110/666 [00:03<00:11, 46.66it/s] 17%|█▋        | 115/666 [00:03<00:11, 46.62it/s] 18%|█▊        | 120/666 [00:03<00:11, 46.60it/s] 19%|█▉        | 125/666 [00:03<00:11, 45.49it/s] 20%|█▉        | 130/666 [00:03<00:11, 45.80it/s] 20%|██        | 135/666 [00:04<00:11, 46.06it/s] 21%|██        | 140/666 [00:04<00:11, 46.26it/s] 22%|██▏       | 145/666 [00:04<00:11, 46.37it/s] 23%|██▎       | 150/666 [00:04<00:11, 46.41it/s] 23%|██▎       | 155/666 [00:04<00:10, 46.48it/s] 24%|██▍       | 160/666 [00:04<00:10, 46.54it/s] 25%|██▍       | 165/666 [00:04<00:10, 46.57it/s] 26%|██▌       | 170/666 [00:04<00:10, 46.60it/s] 26%|██▋       | 175/666 [00:04<00:10, 46.62it/s] 27%|██▋       | 180/666 [00:04<00:10, 46.62it/s] 28%|██▊       | 185/666 [00:05<00:10, 46.64it/s] 29%|██▊       | 190/666 [00:05<00:10, 46.63it/s] 29%|██▉       | 195/666 [00:05<00:10, 46.60it/s] 30%|███       | 200/666 [00:05<00:09, 46.61it/s] 31%|███       | 205/666 [00:05<00:09, 46.61it/s] 32%|███▏      | 210/666 [00:05<00:09, 46.62it/s] 32%|███▏      | 215/666 [00:05<00:09, 46.65it/s] 33%|███▎      | 220/666 [00:05<00:09, 46.65it/s] 34%|███▍      | 225/666 [00:05<00:09, 46.65it/s] 35%|███▍      | 230/666 [00:06<00:09, 46.64it/s] 35%|███▌      | 235/666 [00:06<00:09, 46.64it/s] 36%|███▌      | 240/666 [00:06<00:09, 46.65it/s] 37%|███▋      | 245/666 [00:06<00:09, 46.65it/s] 38%|███▊      | 250/666 [00:06<00:08, 46.64it/s] 38%|███▊      | 255/666 [00:06<00:08, 46.61it/s] 39%|███▉      | 260/666 [00:06<00:08, 46.62it/s] 40%|███▉      | 265/666 [00:06<00:08, 46.62it/s] 41%|████      | 270/666 [00:06<00:08, 46.63it/s] 41%|████▏     | 275/666 [00:07<00:08, 46.64it/s] 42%|████▏     | 280/666 [00:07<00:08, 46.65it/s] 43%|████▎     | 285/666 [00:07<00:08, 46.65it/s] 44%|████▎     | 290/666 [00:07<00:08, 46.65it/s] 44%|████▍     | 295/666 [00:07<00:07, 46.65it/s] 45%|████▌     | 300/666 [00:07<00:07, 46.64it/s] 46%|████▌     | 305/666 [00:07<00:07, 46.63it/s] 47%|████▋     | 310/666 [00:07<00:07, 46.63it/s] 47%|████▋     | 315/666 [00:07<00:07, 46.64it/s] 48%|████▊     | 320/666 [00:08<00:07, 46.65it/s] 49%|████▉     | 325/666 [00:08<00:07, 46.65it/s] 50%|████▉     | 330/666 [00:08<00:07, 46.62it/s] 50%|█████     | 335/666 [00:08<00:07, 46.62it/s] 51%|█████     | 340/666 [00:08<00:06, 46.62it/s] 52%|█████▏    | 345/666 [00:08<00:06, 46.62it/s] 53%|█████▎    | 350/666 [00:08<00:06, 46.65it/s] 53%|█████▎    | 355/666 [00:08<00:06, 46.63it/s] 54%|█████▍    | 360/666 [00:08<00:06, 46.63it/s] 55%|█████▍    | 365/666 [00:08<00:06, 46.66it/s] 56%|█████▌    | 370/666 [00:09<00:06, 46.67it/s] 56%|█████▋    | 375/666 [00:09<00:06, 46.64it/s] 57%|█████▋    | 380/666 [00:09<00:06, 46.62it/s] 58%|█████▊    | 385/666 [00:09<00:06, 46.61it/s] 59%|█████▊    | 390/666 [00:09<00:05, 46.61it/s] 59%|█████▉    | 395/666 [00:09<00:05, 46.64it/s] 60%|██████    | 400/666 [00:09<00:05, 46.63it/s] 61%|██████    | 405/666 [00:09<00:05, 46.63it/s] 62%|██████▏   | 410/666 [00:09<00:05, 46.64it/s] 62%|██████▏   | 415/666 [00:10<00:05, 46.61it/s] 63%|██████▎   | 420/666 [00:10<00:05, 46.61it/s] 64%|██████▍   | 425/666 [00:10<00:05, 46.61it/s] 65%|██████▍   | 430/666 [00:10<00:05, 46.60it/s] 65%|██████▌   | 435/666 [00:10<00:04, 46.59it/s] 66%|██████▌   | 440/666 [00:10<00:04, 46.60it/s] 67%|██████▋   | 445/666 [00:10<00:04, 46.61it/s] 68%|██████▊   | 450/666 [00:10<00:04, 46.62it/s] 68%|██████▊   | 455/666 [00:10<00:04, 46.63it/s] 69%|██████▉   | 460/666 [00:11<00:04, 46.63it/s] 70%|██████▉   | 465/666 [00:11<00:04, 46.62it/s] 71%|███████   | 470/666 [00:11<00:04, 46.64it/s] 71%|███████▏  | 475/666 [00:11<00:04, 46.64it/s] 72%|███████▏  | 480/666 [00:11<00:03, 46.63it/s] 73%|███████▎  | 485/666 [00:11<00:03, 46.62it/s] 74%|███████▎  | 490/666 [00:11<00:03, 46.61it/s] 74%|███████▍  | 495/666 [00:11<00:03, 46.61it/s] 75%|███████▌  | 500/666 [00:11<00:03, 46.62it/s] 76%|███████▌  | 505/666 [00:11<00:03, 46.62it/s] 77%|███████▋  | 510/666 [00:12<00:03, 46.61it/s] 77%|███████▋  | 515/666 [00:12<00:03, 46.60it/s] 78%|███████▊  | 520/666 [00:12<00:03, 46.61it/s] 79%|███████▉  | 525/666 [00:12<00:03, 46.61it/s] 80%|███████▉  | 530/666 [00:12<00:02, 46.63it/s] 80%|████████  | 535/666 [00:12<00:02, 46.64it/s] 81%|████████  | 540/666 [00:12<00:02, 46.56it/s] 82%|████████▏ | 545/666 [00:12<00:02, 46.58it/s] 83%|████████▎ | 550/666 [00:12<00:02, 46.57it/s] 83%|████████▎ | 555/666 [00:13<00:02, 46.58it/s] 84%|████████▍ | 560/666 [00:13<00:02, 46.54it/s] 85%|████████▍ | 565/666 [00:13<00:02, 46.55it/s] 86%|████████▌ | 570/666 [00:13<00:02, 46.55it/s] 86%|████████▋ | 575/666 [00:13<00:01, 46.57it/s] 87%|████████▋ | 580/666 [00:13<00:01, 46.56it/s] 88%|████████▊ | 585/666 [00:13<00:01, 46.58it/s] 89%|████████▊ | 590/666 [00:13<00:01, 46.58it/s] 89%|████████▉ | 595/666 [00:13<00:01, 46.59it/s] 90%|█████████ | 600/666 [00:14<00:01, 46.58it/s] 91%|█████████ | 605/666 [00:14<00:01, 46.59it/s] 92%|█████████▏| 610/666 [00:14<00:01, 46.57it/s] 92%|█████████▏| 615/666 [00:14<00:01, 46.58it/s] 93%|█████████▎| 620/666 [00:14<00:00, 46.58it/s] 94%|█████████▍| 625/666 [00:14<00:00, 46.59it/s] 95%|█████████▍| 630/666 [00:14<00:00, 46.59it/s] 95%|█████████▌| 635/666 [00:14<00:00, 46.58it/s] 96%|█████████▌| 640/666 [00:14<00:00, 46.59it/s] 97%|█████████▋| 645/666 [00:14<00:00, 46.60it/s] 98%|█████████▊| 650/666 [00:15<00:00, 46.61it/s] 98%|█████████▊| 655/666 [00:15<00:00, 46.61it/s] 99%|█████████▉| 660/666 [00:15<00:00, 45.62it/s]100%|█████████▉| 665/666 [00:15<00:00, 46.08it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.03it/s][A
  6%|▌         | 10/167 [00:00<00:03, 48.73it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 123.86it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 164.54it/s][A
 48%|████▊     | 80/167 [00:00<00:00, 186.19it/s][A
 62%|██████▏   | 103/167 [00:00<00:00, 200.04it/s][A
 75%|███████▌  | 126/167 [00:00<00:00, 209.49it/s][A
 89%|████████▉ | 149/167 [00:00<00:00, 215.80it/s][A100%|██████████| 167/167 [00:00<00:00, 174.13it/s]
2022-11-28 21:28:41,252 P62682 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:28:41,252 P62682 INFO Save best model: monitor(max): -4.497234
2022-11-28 21:28:42,264 P62682 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:17<00:00, 37.94it/s]
2022-11-28 21:28:42,305 P62682 INFO Train loss: 30.972238
2022-11-28 21:28:42,305 P62682 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:56,  5.70it/s]  1%|          | 5/666 [00:00<00:31, 20.85it/s]  2%|▏         | 10/666 [00:00<00:22, 29.25it/s]  2%|▏         | 15/666 [00:00<00:19, 34.18it/s]  3%|▎         | 20/666 [00:00<00:16, 38.26it/s]  4%|▍         | 25/666 [00:00<00:15, 40.87it/s]  5%|▍         | 30/666 [00:00<00:14, 42.65it/s]  5%|▌         | 35/666 [00:00<00:14, 43.85it/s]  6%|▌         | 40/666 [00:01<00:14, 44.64it/s]  7%|▋         | 45/666 [00:01<00:13, 45.21it/s]  8%|▊         | 50/666 [00:01<00:13, 45.60it/s]  8%|▊         | 55/666 [00:01<00:13, 45.89it/s]  9%|▉         | 60/666 [00:01<00:13, 46.10it/s] 10%|▉         | 65/666 [00:01<00:12, 46.24it/s] 11%|█         | 70/666 [00:01<00:12, 46.33it/s] 11%|█▏        | 75/666 [00:01<00:12, 46.40it/s] 12%|█▏        | 80/666 [00:01<00:12, 46.44it/s] 13%|█▎        | 85/666 [00:02<00:12, 46.46it/s] 14%|█▎        | 90/666 [00:02<00:12, 46.48it/s] 14%|█▍        | 95/666 [00:02<00:12, 46.50it/s] 15%|█▌        | 100/666 [00:02<00:12, 46.49it/s] 16%|█▌        | 105/666 [00:02<00:12, 46.50it/s] 17%|█▋        | 110/666 [00:02<00:11, 46.49it/s] 17%|█▋        | 115/666 [00:02<00:11, 46.47it/s] 18%|█▊        | 120/666 [00:02<00:11, 46.50it/s] 19%|█▉        | 125/666 [00:02<00:11, 46.50it/s] 20%|█▉        | 130/666 [00:02<00:11, 46.48it/s] 20%|██        | 135/666 [00:03<00:11, 46.19it/s] 21%|██        | 140/666 [00:03<00:11, 46.29it/s] 22%|██▏       | 145/666 [00:03<00:11, 46.34it/s] 23%|██▎       | 150/666 [00:03<00:11, 46.42it/s] 23%|██▎       | 155/666 [00:03<00:11, 46.45it/s] 24%|██▍       | 160/666 [00:03<00:10, 46.48it/s] 25%|██▍       | 165/666 [00:03<00:10, 46.50it/s] 26%|██▌       | 170/666 [00:03<00:10, 46.53it/s] 26%|██▋       | 175/666 [00:03<00:10, 46.49it/s] 27%|██▋       | 180/666 [00:04<00:10, 46.50it/s] 28%|██▊       | 185/666 [00:04<00:10, 46.51it/s] 29%|██▊       | 190/666 [00:04<00:10, 46.49it/s] 29%|██▉       | 195/666 [00:04<00:10, 46.50it/s] 30%|███       | 200/666 [00:04<00:10, 46.50it/s] 31%|███       | 205/666 [00:04<00:09, 46.51it/s] 32%|███▏      | 210/666 [00:04<00:09, 46.54it/s] 32%|███▏      | 215/666 [00:04<00:09, 46.54it/s] 33%|███▎      | 220/666 [00:04<00:09, 46.53it/s] 34%|███▍      | 225/666 [00:05<00:09, 46.53it/s] 35%|███▍      | 230/666 [00:05<00:09, 46.46it/s] 35%|███▌      | 235/666 [00:05<00:09, 46.45it/s] 36%|███▌      | 240/666 [00:05<00:09, 46.49it/s] 37%|███▋      | 245/666 [00:05<00:09, 46.50it/s] 38%|███▊      | 250/666 [00:05<00:08, 46.52it/s] 38%|███▊      | 255/666 [00:05<00:08, 46.52it/s] 39%|███▉      | 260/666 [00:05<00:08, 46.53it/s] 40%|███▉      | 265/666 [00:05<00:08, 46.51it/s] 41%|████      | 270/666 [00:06<00:08, 46.52it/s] 41%|████▏     | 275/666 [00:06<00:08, 46.53it/s] 42%|████▏     | 280/666 [00:06<00:08, 46.52it/s] 43%|████▎     | 285/666 [00:06<00:08, 46.51it/s] 44%|████▎     | 290/666 [00:06<00:08, 46.53it/s] 44%|████▍     | 295/666 [00:06<00:07, 46.53it/s] 45%|████▌     | 300/666 [00:06<00:07, 46.52it/s] 46%|████▌     | 305/666 [00:06<00:07, 46.54it/s] 47%|████▋     | 310/666 [00:06<00:07, 46.53it/s] 47%|████▋     | 315/666 [00:06<00:07, 46.55it/s] 48%|████▊     | 320/666 [00:07<00:07, 46.54it/s] 49%|████▉     | 325/666 [00:07<00:07, 46.48it/s] 50%|████▉     | 330/666 [00:07<00:07, 46.47it/s] 50%|█████     | 335/666 [00:07<00:07, 46.50it/s] 51%|█████     | 340/666 [00:07<00:07, 46.48it/s] 52%|█████▏    | 345/666 [00:07<00:06, 46.50it/s] 53%|█████▎    | 350/666 [00:07<00:06, 46.50it/s] 53%|█████▎    | 355/666 [00:07<00:06, 46.50it/s] 54%|█████▍    | 360/666 [00:07<00:06, 46.50it/s] 55%|█████▍    | 365/666 [00:08<00:06, 46.48it/s] 56%|█████▌    | 370/666 [00:08<00:06, 46.52it/s] 56%|█████▋    | 375/666 [00:08<00:06, 46.54it/s] 57%|█████▋    | 380/666 [00:08<00:06, 46.58it/s] 58%|█████▊    | 385/666 [00:08<00:06, 46.59it/s] 59%|█████▊    | 390/666 [00:08<00:05, 46.59it/s] 59%|█████▉    | 395/666 [00:08<00:05, 46.59it/s] 60%|██████    | 400/666 [00:08<00:05, 46.59it/s] 61%|██████    | 405/666 [00:08<00:05, 46.60it/s] 62%|██████▏   | 410/666 [00:09<00:05, 46.59it/s] 62%|██████▏   | 415/666 [00:09<00:05, 46.59it/s] 63%|██████▎   | 420/666 [00:09<00:05, 46.58it/s] 64%|██████▍   | 425/666 [00:09<00:05, 46.59it/s] 65%|██████▍   | 430/666 [00:09<00:05, 46.59it/s] 65%|██████▌   | 435/666 [00:09<00:04, 46.60it/s] 66%|██████▌   | 440/666 [00:09<00:04, 46.61it/s] 67%|██████▋   | 445/666 [00:09<00:04, 46.61it/s] 68%|██████▊   | 450/666 [00:09<00:04, 46.59it/s] 68%|██████▊   | 455/666 [00:09<00:04, 46.58it/s] 69%|██████▉   | 460/666 [00:10<00:04, 46.58it/s] 70%|██████▉   | 465/666 [00:10<00:04, 46.57it/s] 71%|███████   | 470/666 [00:10<00:04, 46.57it/s] 71%|███████▏  | 475/666 [00:10<00:04, 46.56it/s] 72%|███████▏  | 480/666 [00:10<00:03, 46.54it/s] 73%|███████▎  | 485/666 [00:10<00:03, 46.53it/s] 74%|███████▎  | 490/666 [00:10<00:03, 46.54it/s] 74%|███████▍  | 495/666 [00:10<00:03, 46.58it/s] 75%|███████▌  | 500/666 [00:10<00:03, 46.60it/s] 76%|███████▌  | 505/666 [00:11<00:03, 46.60it/s] 77%|███████▋  | 510/666 [00:11<00:03, 46.59it/s] 77%|███████▋  | 515/666 [00:11<00:03, 46.58it/s] 78%|███████▊  | 520/666 [00:11<00:03, 46.57it/s] 79%|███████▉  | 525/666 [00:11<00:03, 46.59it/s] 80%|███████▉  | 530/666 [00:11<00:02, 46.59it/s] 80%|████████  | 535/666 [00:11<00:02, 46.51it/s] 81%|████████  | 540/666 [00:11<00:02, 46.34it/s] 82%|████████▏ | 545/666 [00:11<00:02, 46.54it/s] 83%|████████▎ | 550/666 [00:12<00:02, 46.55it/s] 83%|████████▎ | 555/666 [00:12<00:02, 46.57it/s] 84%|████████▍ | 560/666 [00:12<00:02, 46.57it/s] 85%|████████▍ | 565/666 [00:12<00:02, 46.58it/s] 86%|████████▌ | 570/666 [00:12<00:02, 46.60it/s] 86%|████████▋ | 575/666 [00:12<00:01, 46.59it/s] 87%|████████▋ | 580/666 [00:12<00:01, 46.58it/s] 88%|████████▊ | 585/666 [00:12<00:01, 46.58it/s] 89%|████████▊ | 590/666 [00:12<00:01, 46.56it/s] 89%|████████▉ | 595/666 [00:12<00:01, 46.57it/s] 90%|█████████ | 600/666 [00:13<00:01, 46.58it/s] 91%|█████████ | 605/666 [00:13<00:01, 46.55it/s] 92%|█████████▏| 610/666 [00:13<00:01, 46.51it/s] 92%|█████████▏| 615/666 [00:13<00:01, 46.54it/s] 93%|█████████▎| 620/666 [00:13<00:00, 46.55it/s] 94%|█████████▍| 625/666 [00:13<00:00, 46.54it/s] 95%|█████████▍| 630/666 [00:13<00:00, 46.56it/s] 95%|█████████▌| 635/666 [00:13<00:00, 46.59it/s] 96%|█████████▌| 640/666 [00:13<00:00, 46.59it/s] 97%|█████████▋| 645/666 [00:14<00:00, 46.58it/s] 98%|█████████▊| 650/666 [00:14<00:00, 46.58it/s] 98%|█████████▊| 655/666 [00:14<00:00, 46.58it/s] 99%|█████████▉| 660/666 [00:14<00:00, 45.72it/s]100%|█████████▉| 665/666 [00:14<00:00, 46.14it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.65it/s][A
  6%|▌         | 10/167 [00:00<00:03, 46.00it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 118.29it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 159.97it/s][A
 49%|████▊     | 81/167 [00:00<00:00, 184.67it/s][A
 63%|██████▎   | 105/167 [00:00<00:00, 199.88it/s][A
 77%|███████▋  | 128/167 [00:00<00:00, 209.09it/s][A
 91%|█████████ | 152/167 [00:00<00:00, 216.13it/s][A100%|██████████| 167/167 [00:00<00:00, 171.58it/s]
2022-11-28 21:28:57,905 P62682 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:28:57,905 P62682 INFO Monitor(max) STOP: -4.497234 !
2022-11-28 21:28:57,905 P62682 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:28:57,906 P62682 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:15<00:00, 42.56it/s]
2022-11-28 21:28:57,953 P62682 INFO Train loss: 30.969909
2022-11-28 21:28:57,953 P62682 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:52,  5.90it/s]  1%|          | 6/666 [00:00<00:26, 25.13it/s]  2%|▏         | 10/666 [00:00<00:21, 30.60it/s]  2%|▏         | 15/666 [00:00<00:18, 35.93it/s]  3%|▎         | 20/666 [00:00<00:16, 39.71it/s]  4%|▍         | 25/666 [00:00<00:15, 41.94it/s]  5%|▍         | 30/666 [00:00<00:14, 43.44it/s]  5%|▌         | 35/666 [00:00<00:14, 44.43it/s]  6%|▌         | 40/666 [00:01<00:13, 45.09it/s]  7%|▋         | 45/666 [00:01<00:13, 45.54it/s]  8%|▊         | 50/666 [00:01<00:13, 45.86it/s]  8%|▊         | 55/666 [00:01<00:13, 46.07it/s]  9%|▉         | 60/666 [00:01<00:13, 46.24it/s] 10%|▉         | 65/666 [00:01<00:12, 46.34it/s] 11%|█         | 70/666 [00:01<00:12, 46.40it/s] 11%|█▏        | 75/666 [00:01<00:12, 46.47it/s] 12%|█▏        | 80/666 [00:01<00:12, 46.50it/s] 13%|█▎        | 85/666 [00:01<00:12, 46.52it/s] 14%|█▎        | 90/666 [00:02<00:12, 46.55it/s] 14%|█▍        | 95/666 [00:02<00:12, 46.56it/s] 15%|█▌        | 100/666 [00:02<00:12, 46.55it/s] 16%|█▌        | 105/666 [00:02<00:12, 46.57it/s] 17%|█▋        | 110/666 [00:02<00:11, 46.58it/s] 17%|█▋        | 115/666 [00:02<00:11, 46.59it/s] 18%|█▊        | 120/666 [00:02<00:11, 46.58it/s] 19%|█▉        | 125/666 [00:02<00:11, 46.58it/s] 20%|█▉        | 130/666 [00:02<00:11, 46.57it/s] 20%|██        | 135/666 [00:03<00:11, 46.59it/s] 21%|██        | 140/666 [00:03<00:11, 46.59it/s] 22%|██▏       | 145/666 [00:03<00:11, 46.57it/s] 23%|██▎       | 150/666 [00:03<00:11, 46.58it/s] 23%|██▎       | 155/666 [00:03<00:10, 46.58it/s] 24%|██▍       | 160/666 [00:03<00:10, 46.57it/s] 25%|██▍       | 165/666 [00:03<00:10, 46.59it/s] 26%|██▌       | 170/666 [00:03<00:10, 46.60it/s] 26%|██▋       | 175/666 [00:03<00:10, 46.61it/s] 27%|██▋       | 180/666 [00:04<00:10, 46.62it/s] 28%|██▊       | 185/666 [00:04<00:10, 46.62it/s] 29%|██▊       | 190/666 [00:04<00:10, 46.60it/s] 29%|██▉       | 195/666 [00:04<00:10, 46.61it/s] 30%|███       | 200/666 [00:04<00:09, 46.62it/s] 31%|███       | 205/666 [00:04<00:09, 46.59it/s] 32%|███▏      | 210/666 [00:04<00:09, 46.58it/s] 32%|███▏      | 215/666 [00:04<00:09, 46.59it/s] 33%|███▎      | 220/666 [00:04<00:09, 46.56it/s] 34%|███▍      | 225/666 [00:04<00:09, 46.58it/s] 35%|███▍      | 230/666 [00:05<00:09, 46.56it/s] 35%|███▌      | 235/666 [00:05<00:09, 46.58it/s] 36%|███▌      | 240/666 [00:05<00:09, 46.57it/s] 37%|███▋      | 245/666 [00:05<00:09, 46.57it/s] 38%|███▊      | 250/666 [00:05<00:08, 46.57it/s] 38%|███▊      | 255/666 [00:05<00:08, 46.60it/s] 39%|███▉      | 260/666 [00:05<00:08, 46.59it/s] 40%|███▉      | 265/666 [00:05<00:08, 46.58it/s] 41%|████      | 270/666 [00:05<00:08, 46.57it/s] 41%|████▏     | 275/666 [00:06<00:08, 46.60it/s] 42%|████▏     | 280/666 [00:06<00:08, 46.60it/s] 43%|████▎     | 285/666 [00:06<00:08, 46.61it/s] 44%|████▎     | 290/666 [00:06<00:08, 46.62it/s] 44%|████▍     | 295/666 [00:06<00:07, 46.62it/s] 45%|████▌     | 300/666 [00:06<00:07, 46.62it/s] 46%|████▌     | 305/666 [00:06<00:07, 46.61it/s] 47%|████▋     | 310/666 [00:06<00:07, 46.60it/s] 47%|████▋     | 315/666 [00:06<00:07, 46.62it/s] 48%|████▊     | 320/666 [00:07<00:07, 46.64it/s] 49%|████▉     | 325/666 [00:07<00:07, 46.61it/s] 50%|████▉     | 330/666 [00:07<00:07, 46.56it/s] 50%|█████     | 335/666 [00:07<00:07, 46.55it/s] 51%|█████     | 340/666 [00:07<00:07, 46.53it/s] 52%|█████▏    | 345/666 [00:07<00:06, 46.57it/s] 53%|█████▎    | 350/666 [00:07<00:06, 46.59it/s] 53%|█████▎    | 355/666 [00:07<00:06, 46.58it/s] 54%|█████▍    | 360/666 [00:07<00:06, 46.59it/s] 55%|█████▍    | 365/666 [00:08<00:06, 46.59it/s] 56%|█████▌    | 370/666 [00:08<00:06, 46.60it/s] 56%|█████▋    | 375/666 [00:08<00:06, 46.62it/s] 57%|█████▋    | 380/666 [00:08<00:06, 46.62it/s] 58%|█████▊    | 385/666 [00:08<00:06, 46.59it/s] 59%|█████▊    | 390/666 [00:08<00:05, 46.59it/s] 59%|█████▉    | 395/666 [00:08<00:05, 46.60it/s] 60%|██████    | 400/666 [00:08<00:05, 46.62it/s] 61%|██████    | 405/666 [00:08<00:05, 46.63it/s] 62%|██████▏   | 410/666 [00:08<00:05, 46.63it/s] 62%|██████▏   | 415/666 [00:09<00:05, 46.62it/s] 63%|██████▎   | 420/666 [00:09<00:05, 46.60it/s] 64%|██████▍   | 425/666 [00:09<00:05, 46.62it/s] 65%|██████▍   | 430/666 [00:09<00:05, 46.61it/s] 65%|██████▌   | 435/666 [00:09<00:04, 46.64it/s] 66%|██████▌   | 440/666 [00:09<00:04, 46.64it/s] 67%|██████▋   | 445/666 [00:09<00:04, 46.62it/s] 68%|██████▊   | 450/666 [00:09<00:04, 46.62it/s] 68%|██████▊   | 455/666 [00:09<00:04, 46.62it/s] 69%|██████▉   | 460/666 [00:10<00:04, 46.62it/s] 70%|██████▉   | 465/666 [00:10<00:04, 46.63it/s] 71%|███████   | 470/666 [00:10<00:04, 46.63it/s] 71%|███████▏  | 475/666 [00:10<00:04, 46.61it/s] 72%|███████▏  | 480/666 [00:10<00:03, 46.62it/s] 73%|███████▎  | 485/666 [00:10<00:03, 46.65it/s] 74%|███████▎  | 490/666 [00:10<00:03, 46.64it/s] 74%|███████▍  | 495/666 [00:10<00:03, 46.64it/s] 75%|███████▌  | 500/666 [00:10<00:03, 46.62it/s] 76%|███████▌  | 505/666 [00:11<00:03, 46.62it/s] 77%|███████▋  | 510/666 [00:11<00:03, 46.63it/s] 77%|███████▋  | 515/666 [00:11<00:03, 46.62it/s] 78%|███████▊  | 520/666 [00:11<00:03, 46.61it/s] 79%|███████▉  | 525/666 [00:11<00:03, 46.61it/s] 80%|███████▉  | 530/666 [00:11<00:02, 46.64it/s] 80%|████████  | 535/666 [00:11<00:02, 46.64it/s] 81%|████████  | 540/666 [00:11<00:02, 46.65it/s] 82%|████████▏ | 545/666 [00:11<00:02, 46.64it/s] 83%|████████▎ | 550/666 [00:11<00:02, 46.61it/s] 83%|████████▎ | 555/666 [00:12<00:02, 46.62it/s] 84%|████████▍ | 560/666 [00:12<00:02, 46.61it/s] 85%|████████▍ | 565/666 [00:12<00:02, 46.62it/s] 86%|████████▌ | 570/666 [00:12<00:02, 46.64it/s] 86%|████████▋ | 575/666 [00:12<00:01, 46.63it/s] 87%|████████▋ | 580/666 [00:12<00:01, 46.61it/s] 88%|████████▊ | 585/666 [00:12<00:01, 46.62it/s] 89%|████████▊ | 590/666 [00:12<00:01, 46.64it/s] 89%|████████▉ | 595/666 [00:12<00:01, 46.64it/s] 90%|█████████ | 600/666 [00:13<00:01, 46.64it/s] 91%|█████████ | 605/666 [00:13<00:01, 46.64it/s] 92%|█████████▏| 610/666 [00:13<00:01, 46.64it/s] 92%|█████████▏| 615/666 [00:13<00:01, 46.65it/s] 93%|█████████▎| 620/666 [00:13<00:00, 46.64it/s] 94%|█████████▍| 625/666 [00:13<00:00, 46.62it/s] 95%|█████████▍| 630/666 [00:13<00:00, 46.63it/s] 95%|█████████▌| 635/666 [00:13<00:00, 46.64it/s] 96%|█████████▌| 640/666 [00:13<00:00, 46.61it/s] 97%|█████████▋| 645/666 [00:14<00:00, 46.62it/s] 98%|█████████▊| 650/666 [00:14<00:00, 46.63it/s] 98%|█████████▊| 655/666 [00:14<00:00, 46.59it/s] 99%|█████████▉| 660/666 [00:14<00:00, 45.64it/s]100%|█████████▉| 665/666 [00:14<00:00, 46.12it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.38it/s][A
  6%|▌         | 10/167 [00:00<00:03, 50.70it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 125.30it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 162.67it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 184.65it/s][A
 61%|██████    | 102/167 [00:00<00:00, 197.67it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 206.56it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 212.55it/s][A100%|██████████| 167/167 [00:00<00:00, 172.29it/s]
2022-11-28 21:29:13,501 P62682 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:29:13,501 P62682 INFO Monitor(max) STOP: -4.497234 !
2022-11-28 21:29:13,501 P62682 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:29:13,501 P62682 INFO Early stopping at epoch=3
2022-11-28 21:29:13,501 P62682 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:15<00:00, 42.61it/s]
2022-11-28 21:29:13,560 P62682 INFO Train loss: 30.972063
2022-11-28 21:29:13,560 P62682 INFO Training finished.
2022-11-28 21:29:13,560 P62682 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_011_6d1ddf03.model
2022-11-28 21:29:13,669 P62682 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:51,  5.95it/s]  2%|▏         | 10/666 [00:00<00:15, 42.39it/s]  5%|▍         | 33/666 [00:00<00:05, 113.25it/s]  8%|▊         | 56/666 [00:00<00:03, 152.94it/s] 12%|█▏        | 79/666 [00:00<00:03, 176.31it/s] 15%|█▌        | 102/666 [00:00<00:02, 191.13it/s] 19%|█▉        | 125/666 [00:00<00:02, 200.52it/s] 22%|██▏       | 148/666 [00:00<00:02, 207.31it/s] 26%|██▌       | 171/666 [00:01<00:02, 211.60it/s] 29%|██▉       | 193/666 [00:01<00:02, 213.50it/s] 32%|███▏      | 215/666 [00:01<00:02, 213.16it/s] 36%|███▌      | 237/666 [00:01<00:02, 212.79it/s] 39%|███▉      | 259/666 [00:01<00:01, 213.14it/s] 42%|████▏     | 281/666 [00:01<00:01, 213.76it/s] 46%|████▌     | 304/666 [00:01<00:01, 215.86it/s] 49%|████▉     | 326/666 [00:01<00:01, 216.43it/s] 52%|█████▏    | 348/666 [00:01<00:01, 217.29it/s] 56%|█████▌    | 370/666 [00:01<00:01, 216.42it/s] 59%|█████▉    | 392/666 [00:02<00:01, 217.21it/s] 62%|██████▏   | 414/666 [00:02<00:01, 216.93it/s] 65%|██████▌   | 436/666 [00:02<00:01, 217.15it/s] 69%|██████▉   | 458/666 [00:02<00:00, 215.86it/s] 72%|███████▏  | 480/666 [00:02<00:00, 216.45it/s] 75%|███████▌  | 502/666 [00:02<00:00, 216.94it/s] 79%|███████▊  | 524/666 [00:02<00:00, 216.20it/s] 82%|████████▏ | 546/666 [00:02<00:00, 216.48it/s] 85%|████████▌ | 568/666 [00:02<00:00, 216.73it/s] 89%|████████▊ | 590/666 [00:02<00:00, 214.27it/s] 92%|█████████▏| 612/666 [00:03<00:00, 214.58it/s] 95%|█████████▌| 634/666 [00:03<00:00, 215.02it/s] 98%|█████████▊| 656/666 [00:03<00:00, 213.72it/s]100%|██████████| 666/666 [00:03<00:00, 198.55it/s]
2022-11-28 21:29:17,474 P62682 INFO [Metrics] logloss: 4.992098 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:18,  9.17it/s]  6%|▌         | 10/167 [00:00<00:03, 50.23it/s] 19%|█▊        | 31/167 [00:00<00:01, 116.97it/s] 31%|███       | 52/167 [00:00<00:00, 151.08it/s] 44%|████▎     | 73/167 [00:00<00:00, 170.18it/s] 56%|█████▋    | 94/167 [00:00<00:00, 182.33it/s] 69%|██████▉   | 115/167 [00:00<00:00, 190.18it/s] 81%|████████▏ | 136/167 [00:00<00:00, 195.60it/s] 94%|█████████▍| 157/167 [00:00<00:00, 199.07it/s]100%|██████████| 167/167 [00:01<00:00, 161.94it/s]
2022-11-28 21:29:18,620 P62682 INFO [Metrics] logloss: 4.997230 - AUC: 0.499996
2022-11-28 21:29:21,498 P64467 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "256",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_012_3e90a2fa",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:29:21,500 P64467 INFO Set up feature encoder...
2022-11-28 21:29:21,501 P64467 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:29:21,507 P64467 INFO Loading data...
2022-11-28 21:29:21,515 P64467 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:29:21,767 P64467 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:29:21,857 P64467 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:29:21,857 P64467 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:29:21,857 P64467 INFO Loading train data done.
2022-11-28 21:29:25,490 P64467 INFO Total number of parameters: 59431684.
2022-11-28 21:29:25,490 P64467 INFO Start training: 666 batches/epoch
2022-11-28 21:29:25,490 P64467 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:29:25.822 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:64467 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:29:25.853 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:64467 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:28,  1.13s/it]  1%|          | 4/666 [00:01<02:41,  4.10it/s]  1%|          | 7/666 [00:01<01:27,  7.57it/s]  2%|▏         | 10/666 [00:01<00:59, 11.08it/s]  2%|▏         | 13/666 [00:01<00:45, 14.42it/s]  2%|▏         | 16/666 [00:01<00:37, 17.47it/s]  3%|▎         | 19/666 [00:01<00:32, 20.09it/s]  3%|▎         | 22/666 [00:01<00:28, 22.30it/s]  4%|▍         | 25/666 [00:01<00:26, 24.01it/s]  4%|▍         | 28/666 [00:02<00:25, 25.31it/s]  5%|▍         | 31/666 [00:02<00:24, 26.28it/s]  5%|▌         | 34/666 [00:02<00:23, 26.99it/s]  6%|▌         | 37/666 [00:02<00:22, 27.51it/s]  6%|▌         | 40/666 [00:02<00:22, 27.88it/s]  6%|▋         | 43/666 [00:02<00:22, 28.15it/s]  7%|▋         | 46/666 [00:02<00:21, 28.34it/s]  7%|▋         | 49/666 [00:02<00:21, 28.40it/s]  8%|▊         | 52/666 [00:02<00:21, 28.52it/s]  8%|▊         | 55/666 [00:03<00:21, 28.64it/s]  9%|▊         | 58/666 [00:03<00:21, 28.72it/s]  9%|▉         | 61/666 [00:03<00:21, 28.79it/s] 10%|▉         | 64/666 [00:03<00:20, 28.80it/s] 10%|█         | 67/666 [00:03<00:20, 28.81it/s] 11%|█         | 70/666 [00:03<00:20, 28.84it/s] 11%|█         | 73/666 [00:03<00:20, 28.88it/s] 11%|█▏        | 76/666 [00:03<00:20, 28.90it/s] 12%|█▏        | 79/666 [00:03<00:20, 28.90it/s] 12%|█▏        | 82/666 [00:03<00:20, 28.91it/s] 13%|█▎        | 85/666 [00:04<00:20, 28.92it/s] 13%|█▎        | 88/666 [00:04<00:19, 28.92it/s] 14%|█▎        | 91/666 [00:04<00:19, 28.92it/s] 14%|█▍        | 94/666 [00:04<00:19, 28.92it/s] 15%|█▍        | 97/666 [00:04<00:19, 28.91it/s] 15%|█▌        | 100/666 [00:04<00:19, 28.92it/s] 15%|█▌        | 103/666 [00:04<00:19, 28.92it/s] 16%|█▌        | 106/666 [00:04<00:19, 28.92it/s] 16%|█▋        | 109/666 [00:04<00:19, 28.92it/s] 17%|█▋        | 112/666 [00:04<00:19, 28.92it/s] 17%|█▋        | 115/666 [00:05<00:19, 28.93it/s] 18%|█▊        | 118/666 [00:05<00:18, 28.93it/s] 18%|█▊        | 121/666 [00:05<00:18, 28.91it/s] 19%|█▊        | 124/666 [00:05<00:18, 28.90it/s] 19%|█▉        | 127/666 [00:05<00:18, 28.91it/s] 20%|█▉        | 130/666 [00:05<00:18, 28.89it/s] 20%|█▉        | 133/666 [00:05<00:18, 28.90it/s] 20%|██        | 136/666 [00:05<00:18, 28.92it/s] 21%|██        | 139/666 [00:05<00:18, 28.92it/s] 21%|██▏       | 142/666 [00:06<00:18, 28.92it/s] 22%|██▏       | 145/666 [00:06<00:18, 28.91it/s] 22%|██▏       | 148/666 [00:06<00:17, 28.91it/s] 23%|██▎       | 151/666 [00:06<00:17, 28.92it/s] 23%|██▎       | 154/666 [00:06<00:17, 28.93it/s] 24%|██▎       | 157/666 [00:06<00:17, 28.93it/s] 24%|██▍       | 160/666 [00:06<00:17, 28.93it/s] 24%|██▍       | 163/666 [00:06<00:17, 28.90it/s] 25%|██▍       | 166/666 [00:06<00:17, 28.91it/s] 25%|██▌       | 169/666 [00:06<00:17, 28.92it/s] 26%|██▌       | 172/666 [00:07<00:17, 28.92it/s] 26%|██▋       | 175/666 [00:07<00:16, 28.91it/s] 27%|██▋       | 178/666 [00:07<00:16, 28.93it/s] 27%|██▋       | 181/666 [00:07<00:16, 28.93it/s] 28%|██▊       | 184/666 [00:07<00:16, 28.92it/s] 28%|██▊       | 187/666 [00:07<00:16, 28.92it/s] 29%|██▊       | 190/666 [00:07<00:16, 28.91it/s] 29%|██▉       | 193/666 [00:07<00:16, 28.91it/s] 29%|██▉       | 196/666 [00:07<00:16, 28.92it/s] 30%|██▉       | 199/666 [00:08<00:16, 28.92it/s] 30%|███       | 202/666 [00:08<00:16, 28.92it/s] 31%|███       | 205/666 [00:08<00:15, 28.92it/s] 31%|███       | 208/666 [00:08<00:15, 28.93it/s] 32%|███▏      | 211/666 [00:08<00:15, 28.93it/s] 32%|███▏      | 214/666 [00:08<00:15, 28.95it/s] 33%|███▎      | 217/666 [00:08<00:15, 28.94it/s] 33%|███▎      | 220/666 [00:08<00:15, 28.94it/s] 33%|███▎      | 223/666 [00:08<00:15, 28.94it/s] 34%|███▍      | 226/666 [00:08<00:15, 28.93it/s] 34%|███▍      | 229/666 [00:09<00:15, 28.94it/s] 35%|███▍      | 232/666 [00:09<00:14, 28.94it/s] 35%|███▌      | 235/666 [00:09<00:14, 28.93it/s] 36%|███▌      | 238/666 [00:09<00:14, 28.92it/s] 36%|███▌      | 241/666 [00:09<00:14, 28.92it/s] 37%|███▋      | 244/666 [00:09<00:14, 28.92it/s] 37%|███▋      | 247/666 [00:09<00:14, 28.92it/s] 38%|███▊      | 250/666 [00:09<00:14, 28.91it/s] 38%|███▊      | 253/666 [00:09<00:14, 28.91it/s] 38%|███▊      | 256/666 [00:09<00:14, 28.91it/s] 39%|███▉      | 259/666 [00:10<00:14, 28.91it/s] 39%|███▉      | 262/666 [00:10<00:13, 28.92it/s] 40%|███▉      | 265/666 [00:10<00:13, 28.94it/s] 40%|████      | 268/666 [00:10<00:13, 28.92it/s] 41%|████      | 271/666 [00:10<00:13, 28.92it/s] 41%|████      | 274/666 [00:10<00:13, 28.93it/s] 42%|████▏     | 277/666 [00:10<00:13, 28.93it/s] 42%|████▏     | 280/666 [00:10<00:13, 28.93it/s] 42%|████▏     | 283/666 [00:10<00:13, 28.93it/s] 43%|████▎     | 286/666 [00:11<00:13, 28.93it/s] 43%|████▎     | 289/666 [00:11<00:13, 28.94it/s] 44%|████▍     | 292/666 [00:11<00:12, 28.94it/s] 44%|████▍     | 295/666 [00:11<00:12, 28.94it/s] 45%|████▍     | 298/666 [00:11<00:12, 28.96it/s] 45%|████▌     | 301/666 [00:11<00:12, 28.96it/s] 46%|████▌     | 304/666 [00:11<00:12, 28.95it/s] 46%|████▌     | 307/666 [00:11<00:12, 28.94it/s] 47%|████▋     | 310/666 [00:11<00:12, 28.95it/s] 47%|████▋     | 313/666 [00:11<00:12, 28.95it/s] 47%|████▋     | 316/666 [00:12<00:12, 28.94it/s] 48%|████▊     | 319/666 [00:12<00:11, 28.93it/s] 48%|████▊     | 322/666 [00:12<00:11, 28.93it/s] 49%|████▉     | 325/666 [00:12<00:11, 28.95it/s] 49%|████▉     | 328/666 [00:12<00:11, 28.96it/s] 50%|████▉     | 331/666 [00:12<00:11, 28.96it/s] 50%|█████     | 334/666 [00:12<00:11, 28.96it/s] 51%|█████     | 337/666 [00:12<00:11, 28.96it/s] 51%|█████     | 340/666 [00:12<00:11, 28.95it/s] 52%|█████▏    | 343/666 [00:12<00:11, 28.94it/s] 52%|█████▏    | 346/666 [00:13<00:11, 28.94it/s] 52%|█████▏    | 349/666 [00:13<00:10, 28.93it/s] 53%|█████▎    | 352/666 [00:13<00:10, 28.94it/s] 53%|█████▎    | 355/666 [00:13<00:10, 28.94it/s] 54%|█████▍    | 358/666 [00:13<00:10, 28.94it/s] 54%|█████▍    | 361/666 [00:13<00:10, 28.95it/s] 55%|█████▍    | 364/666 [00:13<00:10, 28.96it/s] 55%|█████▌    | 367/666 [00:13<00:10, 28.96it/s] 56%|█████▌    | 370/666 [00:13<00:10, 28.94it/s] 56%|█████▌    | 373/666 [00:14<00:10, 28.93it/s] 56%|█████▋    | 376/666 [00:14<00:10, 28.93it/s] 57%|█████▋    | 379/666 [00:14<00:09, 28.94it/s] 57%|█████▋    | 382/666 [00:14<00:09, 28.93it/s] 58%|█████▊    | 385/666 [00:14<00:09, 28.93it/s] 58%|█████▊    | 388/666 [00:14<00:09, 28.92it/s] 59%|█████▊    | 391/666 [00:14<00:09, 28.93it/s] 59%|█████▉    | 394/666 [00:14<00:09, 28.93it/s] 60%|█████▉    | 397/666 [00:14<00:09, 28.93it/s] 60%|██████    | 400/666 [00:14<00:09, 28.93it/s] 61%|██████    | 403/666 [00:15<00:09, 28.94it/s] 61%|██████    | 406/666 [00:15<00:08, 28.93it/s] 61%|██████▏   | 409/666 [00:15<00:08, 28.94it/s] 62%|██████▏   | 412/666 [00:15<00:08, 28.94it/s] 62%|██████▏   | 415/666 [00:15<00:08, 28.94it/s] 63%|██████▎   | 418/666 [00:15<00:08, 28.94it/s] 63%|██████▎   | 421/666 [00:15<00:08, 28.94it/s] 64%|██████▎   | 424/666 [00:15<00:08, 28.94it/s] 64%|██████▍   | 427/666 [00:15<00:08, 28.93it/s] 65%|██████▍   | 430/666 [00:15<00:08, 28.94it/s] 65%|██████▌   | 433/666 [00:16<00:08, 28.93it/s] 65%|██████▌   | 436/666 [00:16<00:07, 28.91it/s] 66%|██████▌   | 439/666 [00:16<00:07, 28.92it/s] 66%|██████▋   | 442/666 [00:16<00:07, 28.93it/s] 67%|██████▋   | 445/666 [00:16<00:07, 28.92it/s] 67%|██████▋   | 448/666 [00:16<00:07, 28.92it/s] 68%|██████▊   | 451/666 [00:16<00:07, 28.93it/s] 68%|██████▊   | 454/666 [00:16<00:07, 28.92it/s] 69%|██████▊   | 457/666 [00:16<00:07, 28.92it/s] 69%|██████▉   | 460/666 [00:17<00:07, 28.94it/s] 70%|██████▉   | 463/666 [00:17<00:07, 28.94it/s] 70%|██████▉   | 466/666 [00:17<00:06, 28.94it/s] 70%|███████   | 469/666 [00:17<00:06, 28.94it/s] 71%|███████   | 472/666 [00:17<00:06, 28.93it/s] 71%|███████▏  | 475/666 [00:17<00:06, 28.92it/s] 72%|███████▏  | 478/666 [00:17<00:06, 28.92it/s] 72%|███████▏  | 481/666 [00:17<00:06, 28.92it/s] 73%|███████▎  | 484/666 [00:17<00:06, 28.94it/s] 73%|███████▎  | 487/666 [00:17<00:06, 28.94it/s] 74%|███████▎  | 490/666 [00:18<00:06, 28.93it/s] 74%|███████▍  | 493/666 [00:18<00:05, 28.94it/s] 74%|███████▍  | 496/666 [00:18<00:05, 28.95it/s] 75%|███████▍  | 499/666 [00:18<00:05, 28.96it/s] 75%|███████▌  | 502/666 [00:18<00:05, 28.95it/s] 76%|███████▌  | 505/666 [00:18<00:05, 28.96it/s] 76%|███████▋  | 508/666 [00:18<00:05, 28.94it/s] 77%|███████▋  | 511/666 [00:18<00:05, 28.94it/s] 77%|███████▋  | 514/666 [00:18<00:05, 28.93it/s] 78%|███████▊  | 517/666 [00:18<00:05, 28.94it/s] 78%|███████▊  | 520/666 [00:19<00:05, 28.95it/s] 79%|███████▊  | 523/666 [00:19<00:04, 28.95it/s] 79%|███████▉  | 526/666 [00:19<00:04, 28.95it/s] 79%|███████▉  | 529/666 [00:19<00:04, 28.96it/s] 80%|███████▉  | 532/666 [00:19<00:04, 28.93it/s] 80%|████████  | 535/666 [00:19<00:04, 28.93it/s] 81%|████████  | 538/666 [00:19<00:04, 28.93it/s] 81%|████████  | 541/666 [00:19<00:04, 28.94it/s] 82%|████████▏ | 544/666 [00:19<00:04, 28.93it/s] 82%|████████▏ | 547/666 [00:20<00:04, 28.91it/s] 83%|████████▎ | 550/666 [00:20<00:04, 28.93it/s] 83%|████████▎ | 553/666 [00:20<00:03, 28.92it/s] 83%|████████▎ | 556/666 [00:20<00:03, 28.93it/s] 84%|████████▍ | 559/666 [00:20<00:03, 28.93it/s] 84%|████████▍ | 562/666 [00:20<00:03, 28.93it/s] 85%|████████▍ | 565/666 [00:20<00:03, 28.92it/s] 85%|████████▌ | 568/666 [00:20<00:03, 28.92it/s] 86%|████████▌ | 571/666 [00:20<00:03, 28.93it/s] 86%|████████▌ | 574/666 [00:20<00:03, 28.93it/s] 87%|████████▋ | 577/666 [00:21<00:03, 28.91it/s] 87%|████████▋ | 580/666 [00:21<00:02, 28.90it/s] 88%|████████▊ | 583/666 [00:21<00:02, 28.89it/s] 88%|████████▊ | 586/666 [00:21<00:02, 28.90it/s] 88%|████████▊ | 589/666 [00:21<00:02, 28.90it/s] 89%|████████▉ | 592/666 [00:21<00:02, 28.92it/s] 89%|████████▉ | 595/666 [00:21<00:02, 28.93it/s] 90%|████████▉ | 598/666 [00:21<00:02, 28.90it/s] 90%|█████████ | 601/666 [00:21<00:02, 28.86it/s] 91%|█████████ | 604/666 [00:22<00:02, 28.86it/s] 91%|█████████ | 607/666 [00:22<00:02, 28.87it/s] 92%|█████████▏| 610/666 [00:22<00:01, 28.89it/s] 92%|█████████▏| 613/666 [00:22<00:01, 28.89it/s] 92%|█████████▏| 616/666 [00:22<00:01, 28.91it/s] 93%|█████████▎| 619/666 [00:22<00:01, 28.92it/s] 93%|█████████▎| 622/666 [00:22<00:01, 28.91it/s] 94%|█████████▍| 625/666 [00:22<00:01, 28.91it/s] 94%|█████████▍| 628/666 [00:22<00:01, 28.90it/s] 95%|█████████▍| 631/666 [00:22<00:01, 28.90it/s] 95%|█████████▌| 634/666 [00:23<00:01, 28.89it/s] 96%|█████████▌| 637/666 [00:23<00:01, 28.90it/s] 96%|█████████▌| 640/666 [00:23<00:00, 28.92it/s] 97%|█████████▋| 643/666 [00:23<00:00, 28.92it/s] 97%|█████████▋| 646/666 [00:23<00:00, 28.91it/s] 97%|█████████▋| 649/666 [00:23<00:00, 28.92it/s] 98%|█████████▊| 652/666 [00:23<00:00, 28.92it/s] 98%|█████████▊| 655/666 [00:23<00:00, 28.91it/s] 99%|█████████▉| 658/666 [00:23<00:00, 28.91it/s] 99%|█████████▉| 661/666 [00:23<00:00, 28.44it/s]100%|█████████▉| 664/666 [00:24<00:00, 28.65it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.42it/s][A
  6%|▌         | 10/167 [00:00<00:03, 51.28it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 127.07it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 164.19it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 185.74it/s][A
 61%|██████    | 102/167 [00:00<00:00, 199.10it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 207.74it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 212.59it/s][A100%|██████████| 167/167 [00:00<00:00, 172.22it/s]
2022-11-28 21:29:50,724 P64467 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:29:50,724 P64467 INFO Save best model: monitor(max): -10.617075
2022-11-28 21:29:53,063 P64467 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:27<00:00, 24.13it/s]
2022-11-28 21:29:53,099 P64467 INFO Train loss: 69.009578
2022-11-28 21:29:53,099 P64467 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:14,  4.95it/s]  1%|          | 4/666 [00:00<00:46, 14.19it/s]  1%|          | 7/666 [00:00<00:34, 18.98it/s]  2%|▏         | 10/666 [00:00<00:29, 22.08it/s]  2%|▏         | 13/666 [00:00<00:27, 24.10it/s]  2%|▏         | 16/666 [00:00<00:25, 25.52it/s]  3%|▎         | 19/666 [00:00<00:24, 26.57it/s]  3%|▎         | 22/666 [00:00<00:23, 27.24it/s]  4%|▍         | 25/666 [00:01<00:23, 27.69it/s]  4%|▍         | 28/666 [00:01<00:22, 28.01it/s]  5%|▍         | 31/666 [00:01<00:22, 28.24it/s]  5%|▌         | 34/666 [00:01<00:22, 28.40it/s]  6%|▌         | 37/666 [00:01<00:22, 28.51it/s]  6%|▌         | 40/666 [00:01<00:21, 28.57it/s]  6%|▋         | 43/666 [00:01<00:21, 28.63it/s]  7%|▋         | 46/666 [00:01<00:21, 28.67it/s]  7%|▋         | 49/666 [00:01<00:21, 28.69it/s]  8%|▊         | 52/666 [00:02<00:21, 28.72it/s]  8%|▊         | 55/666 [00:02<00:21, 28.72it/s]  9%|▊         | 58/666 [00:02<00:21, 28.72it/s]  9%|▉         | 61/666 [00:02<00:21, 28.73it/s] 10%|▉         | 64/666 [00:02<00:20, 28.72it/s] 10%|█         | 67/666 [00:02<00:20, 28.73it/s] 11%|█         | 70/666 [00:02<00:20, 28.74it/s] 11%|█         | 73/666 [00:02<00:20, 28.74it/s] 11%|█▏        | 76/666 [00:02<00:20, 28.74it/s] 12%|█▏        | 79/666 [00:02<00:20, 28.76it/s] 12%|█▏        | 82/666 [00:03<00:20, 28.76it/s] 13%|█▎        | 85/666 [00:03<00:20, 28.76it/s] 13%|█▎        | 88/666 [00:03<00:20, 28.76it/s] 14%|█▎        | 91/666 [00:03<00:19, 28.75it/s] 14%|█▍        | 94/666 [00:03<00:19, 28.76it/s] 15%|█▍        | 97/666 [00:03<00:19, 28.75it/s] 15%|█▌        | 100/666 [00:03<00:19, 28.74it/s] 15%|█▌        | 103/666 [00:03<00:19, 28.75it/s] 16%|█▌        | 106/666 [00:03<00:19, 28.75it/s] 16%|█▋        | 109/666 [00:03<00:19, 28.75it/s] 17%|█▋        | 112/666 [00:04<00:19, 28.74it/s] 17%|█▋        | 115/666 [00:04<00:19, 28.75it/s] 18%|█▊        | 118/666 [00:04<00:19, 28.75it/s] 18%|█▊        | 121/666 [00:04<00:18, 28.76it/s] 19%|█▊        | 124/666 [00:04<00:18, 28.76it/s] 19%|█▉        | 127/666 [00:04<00:18, 28.76it/s] 20%|█▉        | 130/666 [00:04<00:18, 28.76it/s] 20%|█▉        | 133/666 [00:04<00:18, 28.76it/s] 20%|██        | 136/666 [00:04<00:18, 28.76it/s] 21%|██        | 139/666 [00:05<00:18, 28.76it/s] 21%|██▏       | 142/666 [00:05<00:18, 28.76it/s] 22%|██▏       | 145/666 [00:05<00:18, 28.76it/s] 22%|██▏       | 148/666 [00:05<00:18, 28.76it/s] 23%|██▎       | 151/666 [00:05<00:17, 28.76it/s] 23%|██▎       | 154/666 [00:05<00:17, 28.76it/s] 24%|██▎       | 157/666 [00:05<00:17, 28.76it/s] 24%|██▍       | 160/666 [00:05<00:17, 28.76it/s] 24%|██▍       | 163/666 [00:05<00:17, 28.77it/s] 25%|██▍       | 166/666 [00:05<00:17, 28.76it/s] 25%|██▌       | 169/666 [00:06<00:17, 28.76it/s] 26%|██▌       | 172/666 [00:06<00:17, 28.74it/s] 26%|██▋       | 175/666 [00:06<00:17, 28.75it/s] 27%|██▋       | 178/666 [00:06<00:16, 28.75it/s] 27%|██▋       | 181/666 [00:06<00:16, 28.75it/s] 28%|██▊       | 184/666 [00:06<00:16, 28.74it/s] 28%|██▊       | 187/666 [00:06<00:16, 28.74it/s] 29%|██▊       | 190/666 [00:06<00:16, 28.75it/s] 29%|██▉       | 193/666 [00:06<00:16, 28.75it/s] 29%|██▉       | 196/666 [00:07<00:16, 28.75it/s] 30%|██▉       | 199/666 [00:07<00:16, 28.73it/s] 30%|███       | 202/666 [00:07<00:16, 28.72it/s] 31%|███       | 205/666 [00:07<00:16, 28.73it/s] 31%|███       | 208/666 [00:07<00:15, 28.74it/s] 32%|███▏      | 211/666 [00:07<00:15, 28.75it/s] 32%|███▏      | 214/666 [00:07<00:15, 28.74it/s] 33%|███▎      | 217/666 [00:07<00:15, 28.73it/s] 33%|███▎      | 220/666 [00:07<00:15, 28.75it/s] 33%|███▎      | 223/666 [00:07<00:15, 28.75it/s] 34%|███▍      | 226/666 [00:08<00:15, 28.75it/s] 34%|███▍      | 229/666 [00:08<00:15, 28.75it/s] 35%|███▍      | 232/666 [00:08<00:15, 28.75it/s] 35%|███▌      | 235/666 [00:08<00:15, 28.72it/s] 36%|███▌      | 238/666 [00:08<00:14, 28.73it/s] 36%|███▌      | 241/666 [00:08<00:14, 28.73it/s] 37%|███▋      | 244/666 [00:08<00:14, 28.73it/s] 37%|███▋      | 247/666 [00:08<00:14, 28.73it/s] 38%|███▊      | 250/666 [00:08<00:14, 28.74it/s] 38%|███▊      | 253/666 [00:08<00:14, 28.75it/s] 38%|███▊      | 256/666 [00:09<00:14, 28.75it/s] 39%|███▉      | 259/666 [00:09<00:14, 28.75it/s] 39%|███▉      | 262/666 [00:09<00:14, 28.75it/s] 40%|███▉      | 265/666 [00:09<00:13, 28.76it/s] 40%|████      | 268/666 [00:09<00:13, 28.76it/s] 41%|████      | 271/666 [00:09<00:13, 28.75it/s] 41%|████      | 274/666 [00:09<00:13, 28.72it/s] 42%|████▏     | 277/666 [00:09<00:13, 28.71it/s] 42%|████▏     | 280/666 [00:09<00:13, 28.73it/s] 42%|████▏     | 283/666 [00:10<00:13, 28.73it/s] 43%|████▎     | 286/666 [00:10<00:13, 28.74it/s] 43%|████▎     | 289/666 [00:10<00:13, 28.73it/s] 44%|████▍     | 292/666 [00:10<00:13, 28.74it/s] 44%|████▍     | 295/666 [00:10<00:12, 28.75it/s] 45%|████▍     | 298/666 [00:10<00:12, 28.74it/s] 45%|████▌     | 301/666 [00:10<00:12, 28.75it/s] 46%|████▌     | 304/666 [00:10<00:12, 28.74it/s] 46%|████▌     | 307/666 [00:10<00:12, 28.74it/s] 47%|████▋     | 310/666 [00:10<00:12, 28.74it/s] 47%|████▋     | 313/666 [00:11<00:12, 28.75it/s] 47%|████▋     | 316/666 [00:11<00:12, 28.75it/s] 48%|████▊     | 319/666 [00:11<00:12, 28.75it/s] 48%|████▊     | 322/666 [00:11<00:11, 28.75it/s] 49%|████▉     | 325/666 [00:11<00:11, 28.76it/s] 49%|████▉     | 328/666 [00:11<00:11, 28.77it/s] 50%|████▉     | 331/666 [00:11<00:11, 28.75it/s] 50%|█████     | 334/666 [00:11<00:11, 28.75it/s] 51%|█████     | 337/666 [00:11<00:11, 28.75it/s] 51%|█████     | 340/666 [00:12<00:11, 28.75it/s] 52%|█████▏    | 343/666 [00:12<00:11, 28.74it/s] 52%|█████▏    | 346/666 [00:12<00:11, 28.75it/s] 52%|█████▏    | 349/666 [00:12<00:11, 28.76it/s] 53%|█████▎    | 352/666 [00:12<00:10, 28.76it/s] 53%|█████▎    | 355/666 [00:12<00:10, 28.74it/s] 54%|█████▍    | 358/666 [00:12<00:10, 28.73it/s] 54%|█████▍    | 361/666 [00:12<00:10, 28.73it/s] 55%|█████▍    | 364/666 [00:12<00:10, 28.74it/s] 55%|█████▌    | 367/666 [00:12<00:10, 28.74it/s] 56%|█████▌    | 370/666 [00:13<00:10, 28.75it/s] 56%|█████▌    | 373/666 [00:13<00:10, 28.76it/s] 56%|█████▋    | 376/666 [00:13<00:10, 28.74it/s] 57%|█████▋    | 379/666 [00:13<00:09, 28.75it/s] 57%|█████▋    | 382/666 [00:13<00:09, 28.76it/s] 58%|█████▊    | 385/666 [00:13<00:09, 28.77it/s] 58%|█████▊    | 388/666 [00:13<00:09, 28.76it/s] 59%|█████▊    | 391/666 [00:13<00:09, 28.76it/s] 59%|█████▉    | 394/666 [00:13<00:09, 28.76it/s] 60%|█████▉    | 397/666 [00:14<00:09, 28.76it/s] 60%|██████    | 400/666 [00:14<00:09, 28.76it/s] 61%|██████    | 403/666 [00:14<00:09, 28.76it/s] 61%|██████    | 406/666 [00:14<00:09, 28.76it/s] 61%|██████▏   | 409/666 [00:14<00:08, 28.77it/s] 62%|██████▏   | 412/666 [00:14<00:08, 28.77it/s] 62%|██████▏   | 415/666 [00:14<00:08, 28.77it/s] 63%|██████▎   | 418/666 [00:14<00:08, 28.75it/s] 63%|██████▎   | 421/666 [00:14<00:08, 28.74it/s] 64%|██████▎   | 424/666 [00:14<00:08, 28.75it/s] 64%|██████▍   | 427/666 [00:15<00:08, 28.75it/s] 65%|██████▍   | 430/666 [00:15<00:08, 28.75it/s] 65%|██████▌   | 433/666 [00:15<00:08, 28.76it/s] 65%|██████▌   | 436/666 [00:15<00:08, 28.75it/s] 66%|██████▌   | 439/666 [00:15<00:07, 28.74it/s] 66%|██████▋   | 442/666 [00:15<00:07, 28.76it/s] 67%|██████▋   | 445/666 [00:15<00:07, 28.76it/s] 67%|██████▋   | 448/666 [00:15<00:07, 28.77it/s] 68%|██████▊   | 451/666 [00:15<00:07, 28.77it/s] 68%|██████▊   | 454/666 [00:15<00:07, 28.76it/s] 69%|██████▊   | 457/666 [00:16<00:07, 28.76it/s] 69%|██████▉   | 460/666 [00:16<00:07, 28.76it/s] 70%|██████▉   | 463/666 [00:16<00:07, 28.76it/s] 70%|██████▉   | 466/666 [00:16<00:06, 28.75it/s] 70%|███████   | 469/666 [00:16<00:06, 28.75it/s] 71%|███████   | 472/666 [00:16<00:06, 28.77it/s] 71%|███████▏  | 475/666 [00:16<00:06, 28.76it/s] 72%|███████▏  | 478/666 [00:16<00:06, 28.76it/s] 72%|███████▏  | 481/666 [00:16<00:06, 28.76it/s] 73%|███████▎  | 484/666 [00:17<00:06, 28.75it/s] 73%|███████▎  | 487/666 [00:17<00:06, 28.74it/s] 74%|███████▎  | 490/666 [00:17<00:06, 28.75it/s] 74%|███████▍  | 493/666 [00:17<00:06, 28.76it/s] 74%|███████▍  | 496/666 [00:17<00:05, 28.76it/s] 75%|███████▍  | 499/666 [00:17<00:05, 28.77it/s] 75%|███████▌  | 502/666 [00:17<00:05, 28.77it/s] 76%|███████▌  | 505/666 [00:17<00:05, 28.76it/s] 76%|███████▋  | 508/666 [00:17<00:05, 28.77it/s] 77%|███████▋  | 511/666 [00:17<00:05, 28.79it/s] 77%|███████▋  | 514/666 [00:18<00:05, 28.78it/s] 78%|███████▊  | 517/666 [00:18<00:05, 28.78it/s] 78%|███████▊  | 520/666 [00:18<00:05, 28.78it/s] 79%|███████▊  | 523/666 [00:18<00:04, 28.77it/s] 79%|███████▉  | 526/666 [00:18<00:04, 28.78it/s] 79%|███████▉  | 529/666 [00:18<00:04, 28.78it/s] 80%|███████▉  | 532/666 [00:18<00:04, 28.77it/s] 80%|████████  | 535/666 [00:18<00:04, 28.62it/s] 81%|████████  | 538/666 [00:18<00:04, 28.62it/s] 81%|████████  | 541/666 [00:19<00:04, 28.66it/s] 82%|████████▏ | 544/666 [00:19<00:04, 28.68it/s] 82%|████████▏ | 547/666 [00:19<00:04, 28.70it/s] 83%|████████▎ | 550/666 [00:19<00:04, 28.72it/s] 83%|████████▎ | 553/666 [00:19<00:03, 28.73it/s] 83%|████████▎ | 556/666 [00:19<00:03, 28.75it/s] 84%|████████▍ | 559/666 [00:19<00:03, 28.75it/s] 84%|████████▍ | 562/666 [00:19<00:03, 28.74it/s] 85%|████████▍ | 565/666 [00:19<00:03, 28.74it/s] 85%|████████▌ | 568/666 [00:19<00:03, 28.74it/s] 86%|████████▌ | 571/666 [00:20<00:03, 28.75it/s] 86%|████████▌ | 574/666 [00:20<00:03, 28.74it/s] 87%|████████▋ | 577/666 [00:20<00:03, 28.76it/s] 87%|████████▋ | 580/666 [00:20<00:02, 28.76it/s] 88%|████████▊ | 583/666 [00:20<00:02, 28.76it/s] 88%|████████▊ | 586/666 [00:20<00:02, 28.76it/s] 88%|████████▊ | 589/666 [00:20<00:02, 28.76it/s] 89%|████████▉ | 592/666 [00:20<00:02, 28.75it/s] 89%|████████▉ | 595/666 [00:20<00:02, 28.76it/s] 90%|████████▉ | 598/666 [00:20<00:02, 28.76it/s] 90%|█████████ | 601/666 [00:21<00:02, 28.76it/s] 91%|█████████ | 604/666 [00:21<00:02, 28.76it/s] 91%|█████████ | 607/666 [00:21<00:02, 28.75it/s] 92%|█████████▏| 610/666 [00:21<00:01, 28.76it/s] 92%|█████████▏| 613/666 [00:21<00:01, 28.77it/s] 92%|█████████▏| 616/666 [00:21<00:01, 28.77it/s] 93%|█████████▎| 619/666 [00:21<00:01, 28.77it/s] 93%|█████████▎| 622/666 [00:21<00:01, 28.76it/s] 94%|█████████▍| 625/666 [00:21<00:01, 28.76it/s] 94%|█████████▍| 628/666 [00:22<00:01, 28.77it/s] 95%|█████████▍| 631/666 [00:22<00:01, 28.77it/s] 95%|█████████▌| 634/666 [00:22<00:01, 28.77it/s] 96%|█████████▌| 637/666 [00:22<00:01, 28.76it/s] 96%|█████████▌| 640/666 [00:22<00:00, 28.75it/s] 97%|█████████▋| 643/666 [00:22<00:00, 28.75it/s] 97%|█████████▋| 646/666 [00:22<00:00, 28.75it/s] 97%|█████████▋| 649/666 [00:22<00:00, 28.75it/s] 98%|█████████▊| 652/666 [00:22<00:00, 28.75it/s] 98%|█████████▊| 655/666 [00:22<00:00, 28.75it/s] 99%|█████████▉| 658/666 [00:23<00:00, 28.74it/s] 99%|█████████▉| 661/666 [00:23<00:00, 28.19it/s]100%|█████████▉| 664/666 [00:23<00:00, 28.43it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.95it/s][A
  6%|▌         | 10/167 [00:00<00:03, 42.36it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 112.83it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 152.78it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 176.68it/s][A
 61%|██████    | 102/167 [00:00<00:00, 192.92it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 203.69it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 210.99it/s][A100%|██████████| 167/167 [00:01<00:00, 165.17it/s]
2022-11-28 21:30:17,587 P64467 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:30:17,587 P64467 INFO Monitor(max) STOP: -10.617075 !
2022-11-28 21:30:17,587 P64467 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:30:17,588 P64467 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:24<00:00, 27.14it/s]
2022-11-28 21:30:17,641 P64467 INFO Train loss: 69.009519
2022-11-28 21:30:17,641 P64467 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:11,  5.04it/s]  1%|          | 4/666 [00:00<00:43, 15.07it/s]  1%|          | 7/666 [00:00<00:32, 20.31it/s]  2%|▏         | 10/666 [00:00<00:28, 23.08it/s]  2%|▏         | 13/666 [00:00<00:26, 24.91it/s]  2%|▏         | 16/666 [00:00<00:24, 26.08it/s]  3%|▎         | 19/666 [00:00<00:24, 26.94it/s]  3%|▎         | 22/666 [00:00<00:23, 27.48it/s]  4%|▍         | 25/666 [00:01<00:23, 27.87it/s]  4%|▍         | 28/666 [00:01<00:22, 28.12it/s]  5%|▍         | 31/666 [00:01<00:22, 28.29it/s]  5%|▌         | 34/666 [00:01<00:22, 28.41it/s]  6%|▌         | 37/666 [00:01<00:22, 28.50it/s]  6%|▌         | 40/666 [00:01<00:21, 28.57it/s]  6%|▋         | 43/666 [00:01<00:21, 28.61it/s]  7%|▋         | 46/666 [00:01<00:21, 28.65it/s]  7%|▋         | 49/666 [00:01<00:21, 28.67it/s]  8%|▊         | 52/666 [00:01<00:21, 28.67it/s]  8%|▊         | 55/666 [00:02<00:21, 28.68it/s]  9%|▊         | 58/666 [00:02<00:21, 28.70it/s]  9%|▉         | 61/666 [00:02<00:21, 28.70it/s] 10%|▉         | 64/666 [00:02<00:20, 28.70it/s] 10%|█         | 67/666 [00:02<00:20, 28.70it/s] 11%|█         | 70/666 [00:02<00:20, 28.69it/s] 11%|█         | 73/666 [00:02<00:20, 28.69it/s] 11%|█▏        | 76/666 [00:02<00:20, 28.70it/s] 12%|█▏        | 79/666 [00:02<00:20, 28.70it/s] 12%|█▏        | 82/666 [00:03<00:20, 28.69it/s] 13%|█▎        | 85/666 [00:03<00:20, 28.69it/s] 13%|█▎        | 88/666 [00:03<00:20, 28.68it/s] 14%|█▎        | 91/666 [00:03<00:20, 28.69it/s] 14%|█▍        | 94/666 [00:03<00:19, 28.68it/s] 15%|█▍        | 97/666 [00:03<00:19, 28.66it/s] 15%|█▌        | 100/666 [00:03<00:19, 28.68it/s] 15%|█▌        | 103/666 [00:03<00:19, 28.69it/s] 16%|█▌        | 106/666 [00:03<00:19, 28.69it/s] 16%|█▋        | 109/666 [00:03<00:19, 28.69it/s] 17%|█▋        | 112/666 [00:04<00:19, 28.69it/s] 17%|█▋        | 115/666 [00:04<00:19, 28.70it/s] 18%|█▊        | 118/666 [00:04<00:19, 28.68it/s] 18%|█▊        | 121/666 [00:04<00:19, 28.67it/s] 19%|█▊        | 124/666 [00:04<00:18, 28.68it/s] 19%|█▉        | 127/666 [00:04<00:18, 28.69it/s] 20%|█▉        | 130/666 [00:04<00:18, 28.69it/s] 20%|█▉        | 133/666 [00:04<00:18, 28.69it/s] 20%|██        | 136/666 [00:04<00:18, 28.69it/s] 21%|██        | 139/666 [00:05<00:18, 28.68it/s] 21%|██▏       | 142/666 [00:05<00:18, 28.67it/s] 22%|██▏       | 145/666 [00:05<00:18, 28.68it/s] 22%|██▏       | 148/666 [00:05<00:18, 28.68it/s] 23%|██▎       | 151/666 [00:05<00:17, 28.66it/s] 23%|██▎       | 154/666 [00:05<00:17, 28.67it/s] 24%|██▎       | 157/666 [00:05<00:17, 28.67it/s] 24%|██▍       | 160/666 [00:05<00:17, 28.68it/s] 24%|██▍       | 163/666 [00:05<00:17, 28.68it/s] 25%|██▍       | 166/666 [00:05<00:17, 28.68it/s] 25%|██▌       | 169/666 [00:06<00:17, 28.67it/s] 26%|██▌       | 172/666 [00:06<00:17, 28.67it/s] 26%|██▋       | 175/666 [00:06<00:17, 28.67it/s] 27%|██▋       | 178/666 [00:06<00:17, 28.65it/s] 27%|██▋       | 181/666 [00:06<00:16, 28.66it/s] 28%|██▊       | 184/666 [00:06<00:16, 28.67it/s] 28%|██▊       | 187/666 [00:06<00:16, 28.66it/s] 29%|██▊       | 190/666 [00:06<00:16, 28.67it/s] 29%|██▉       | 193/666 [00:06<00:16, 28.67it/s] 29%|██▉       | 196/666 [00:06<00:16, 28.68it/s] 30%|██▉       | 199/666 [00:07<00:16, 28.67it/s] 30%|███       | 202/666 [00:07<00:16, 28.62it/s] 31%|███       | 205/666 [00:07<00:16, 28.61it/s] 31%|███       | 208/666 [00:07<00:15, 28.63it/s] 32%|███▏      | 211/666 [00:07<00:15, 28.64it/s] 32%|███▏      | 214/666 [00:07<00:15, 28.66it/s] 33%|███▎      | 217/666 [00:07<00:15, 28.67it/s] 33%|███▎      | 220/666 [00:07<00:15, 28.67it/s] 33%|███▎      | 223/666 [00:07<00:15, 28.68it/s] 34%|███▍      | 226/666 [00:08<00:15, 28.67it/s] 34%|███▍      | 229/666 [00:08<00:15, 28.67it/s] 35%|███▍      | 232/666 [00:08<00:15, 28.66it/s] 35%|███▌      | 235/666 [00:08<00:15, 28.66it/s] 36%|███▌      | 238/666 [00:08<00:14, 28.67it/s] 36%|███▌      | 241/666 [00:08<00:14, 28.67it/s] 37%|███▋      | 244/666 [00:08<00:14, 28.68it/s] 37%|███▋      | 247/666 [00:08<00:14, 28.65it/s] 38%|███▊      | 250/666 [00:08<00:14, 28.65it/s] 38%|███▊      | 253/666 [00:08<00:14, 28.66it/s] 38%|███▊      | 256/666 [00:09<00:14, 28.67it/s] 39%|███▉      | 259/666 [00:09<00:14, 28.66it/s] 39%|███▉      | 262/666 [00:09<00:14, 28.67it/s] 40%|███▉      | 265/666 [00:09<00:13, 28.67it/s] 40%|████      | 268/666 [00:09<00:13, 28.66it/s] 41%|████      | 271/666 [00:09<00:13, 28.66it/s] 41%|████      | 274/666 [00:09<00:13, 28.67it/s] 42%|████▏     | 277/666 [00:09<00:13, 28.67it/s] 42%|████▏     | 280/666 [00:09<00:13, 28.68it/s] 42%|████▏     | 283/666 [00:10<00:13, 28.66it/s] 43%|████▎     | 286/666 [00:10<00:13, 28.66it/s] 43%|████▎     | 289/666 [00:10<00:13, 28.66it/s] 44%|████▍     | 292/666 [00:10<00:13, 28.66it/s] 44%|████▍     | 295/666 [00:10<00:12, 28.65it/s] 45%|████▍     | 298/666 [00:10<00:12, 28.65it/s] 45%|████▌     | 301/666 [00:10<00:12, 28.66it/s] 46%|████▌     | 304/666 [00:10<00:12, 28.66it/s] 46%|████▌     | 307/666 [00:10<00:12, 28.67it/s] 47%|████▋     | 310/666 [00:10<00:12, 28.66it/s] 47%|████▋     | 313/666 [00:11<00:12, 28.67it/s] 47%|████▋     | 316/666 [00:11<00:12, 28.68it/s] 48%|████▊     | 319/666 [00:11<00:12, 28.67it/s] 48%|████▊     | 322/666 [00:11<00:11, 28.68it/s] 49%|████▉     | 325/666 [00:11<00:11, 28.67it/s] 49%|████▉     | 328/666 [00:11<00:11, 28.67it/s] 50%|████▉     | 331/666 [00:11<00:11, 28.66it/s] 50%|█████     | 334/666 [00:11<00:11, 28.67it/s] 51%|█████     | 337/666 [00:11<00:11, 28.68it/s] 51%|█████     | 340/666 [00:12<00:11, 28.67it/s] 52%|█████▏    | 343/666 [00:12<00:11, 28.68it/s] 52%|█████▏    | 346/666 [00:12<00:11, 28.68it/s] 52%|█████▏    | 349/666 [00:12<00:11, 28.67it/s] 53%|█████▎    | 352/666 [00:12<00:10, 28.68it/s] 53%|█████▎    | 355/666 [00:12<00:10, 28.69it/s] 54%|█████▍    | 358/666 [00:12<00:10, 28.68it/s] 54%|█████▍    | 361/666 [00:12<00:10, 28.69it/s] 55%|█████▍    | 364/666 [00:12<00:10, 28.70it/s] 55%|█████▌    | 367/666 [00:12<00:10, 28.71it/s] 56%|█████▌    | 370/666 [00:13<00:10, 28.71it/s] 56%|█████▌    | 373/666 [00:13<00:10, 28.70it/s] 56%|█████▋    | 376/666 [00:13<00:10, 28.70it/s] 57%|█████▋    | 379/666 [00:13<00:10, 28.70it/s] 57%|█████▋    | 382/666 [00:13<00:09, 28.69it/s] 58%|█████▊    | 385/666 [00:13<00:09, 28.70it/s] 58%|█████▊    | 388/666 [00:13<00:09, 28.70it/s] 59%|█████▊    | 391/666 [00:13<00:09, 28.69it/s] 59%|█████▉    | 394/666 [00:13<00:09, 28.69it/s] 60%|█████▉    | 397/666 [00:14<00:09, 28.70it/s] 60%|██████    | 400/666 [00:14<00:09, 28.70it/s] 61%|██████    | 403/666 [00:14<00:09, 28.70it/s] 61%|██████    | 406/666 [00:14<00:09, 28.70it/s] 61%|██████▏   | 409/666 [00:14<00:08, 28.69it/s] 62%|██████▏   | 412/666 [00:14<00:08, 28.69it/s] 62%|██████▏   | 415/666 [00:14<00:08, 28.68it/s] 63%|██████▎   | 418/666 [00:14<00:08, 28.69it/s] 63%|██████▎   | 421/666 [00:14<00:08, 28.68it/s] 64%|██████▎   | 424/666 [00:14<00:08, 28.68it/s] 64%|██████▍   | 427/666 [00:15<00:08, 28.68it/s] 65%|██████▍   | 430/666 [00:15<00:08, 28.68it/s] 65%|██████▌   | 433/666 [00:15<00:08, 28.69it/s] 65%|██████▌   | 436/666 [00:15<00:08, 28.69it/s] 66%|██████▌   | 439/666 [00:15<00:07, 28.68it/s] 66%|██████▋   | 442/666 [00:15<00:07, 28.69it/s] 67%|██████▋   | 445/666 [00:15<00:07, 28.68it/s] 67%|██████▋   | 448/666 [00:15<00:07, 28.69it/s] 68%|██████▊   | 451/666 [00:15<00:07, 28.69it/s] 68%|██████▊   | 454/666 [00:15<00:07, 28.67it/s] 69%|██████▊   | 457/666 [00:16<00:07, 28.68it/s] 69%|██████▉   | 460/666 [00:16<00:07, 28.69it/s] 70%|██████▉   | 463/666 [00:16<00:07, 28.69it/s] 70%|██████▉   | 466/666 [00:16<00:06, 28.69it/s] 70%|███████   | 469/666 [00:16<00:06, 28.70it/s] 71%|███████   | 472/666 [00:16<00:06, 28.70it/s] 71%|███████▏  | 475/666 [00:16<00:06, 28.70it/s] 72%|███████▏  | 478/666 [00:16<00:06, 28.69it/s] 72%|███████▏  | 481/666 [00:16<00:06, 28.70it/s] 73%|███████▎  | 484/666 [00:17<00:06, 28.71it/s] 73%|███████▎  | 487/666 [00:17<00:06, 28.71it/s] 74%|███████▎  | 490/666 [00:17<00:06, 28.70it/s] 74%|███████▍  | 493/666 [00:17<00:06, 28.70it/s] 74%|███████▍  | 496/666 [00:17<00:05, 28.69it/s] 75%|███████▍  | 499/666 [00:17<00:05, 28.69it/s] 75%|███████▌  | 502/666 [00:17<00:05, 28.69it/s] 76%|███████▌  | 505/666 [00:17<00:05, 28.70it/s] 76%|███████▋  | 508/666 [00:17<00:05, 28.69it/s] 77%|███████▋  | 511/666 [00:17<00:05, 28.68it/s] 77%|███████▋  | 514/666 [00:18<00:05, 28.67it/s] 78%|███████▊  | 517/666 [00:18<00:05, 28.68it/s] 78%|███████▊  | 520/666 [00:18<00:05, 28.68it/s] 79%|███████▊  | 523/666 [00:18<00:04, 28.68it/s] 79%|███████▉  | 526/666 [00:18<00:04, 28.69it/s] 79%|███████▉  | 529/666 [00:18<00:04, 28.69it/s] 80%|███████▉  | 532/666 [00:18<00:04, 28.69it/s] 80%|████████  | 535/666 [00:18<00:04, 28.69it/s] 81%|████████  | 538/666 [00:18<00:04, 28.68it/s] 81%|████████  | 541/666 [00:19<00:04, 28.68it/s] 82%|████████▏ | 544/666 [00:19<00:04, 28.68it/s] 82%|████████▏ | 547/666 [00:19<00:04, 28.69it/s] 83%|████████▎ | 550/666 [00:19<00:04, 28.68it/s] 83%|████████▎ | 553/666 [00:19<00:03, 28.69it/s] 83%|████████▎ | 556/666 [00:19<00:03, 28.69it/s] 84%|████████▍ | 559/666 [00:19<00:03, 28.69it/s] 84%|████████▍ | 562/666 [00:19<00:03, 28.67it/s] 85%|████████▍ | 565/666 [00:19<00:03, 28.69it/s] 85%|████████▌ | 568/666 [00:19<00:03, 28.69it/s] 86%|████████▌ | 571/666 [00:20<00:03, 28.69it/s] 86%|████████▌ | 574/666 [00:20<00:03, 28.68it/s] 87%|████████▋ | 577/666 [00:20<00:03, 28.67it/s] 87%|████████▋ | 580/666 [00:20<00:03, 28.62it/s] 88%|████████▊ | 583/666 [00:20<00:02, 28.64it/s] 88%|████████▊ | 586/666 [00:20<00:02, 28.64it/s] 88%|████████▊ | 589/666 [00:20<00:02, 28.66it/s] 89%|████████▉ | 592/666 [00:20<00:02, 28.67it/s] 89%|████████▉ | 595/666 [00:20<00:02, 28.68it/s] 90%|████████▉ | 598/666 [00:21<00:02, 28.69it/s] 90%|█████████ | 601/666 [00:21<00:02, 28.68it/s] 91%|█████████ | 604/666 [00:21<00:02, 28.69it/s] 91%|█████████ | 607/666 [00:21<00:02, 28.68it/s] 92%|█████████▏| 610/666 [00:21<00:01, 28.68it/s] 92%|█████████▏| 613/666 [00:21<00:01, 28.68it/s] 92%|█████████▏| 616/666 [00:21<00:01, 28.68it/s] 93%|█████████▎| 619/666 [00:21<00:01, 28.68it/s] 93%|█████████▎| 622/666 [00:21<00:01, 28.68it/s] 94%|█████████▍| 625/666 [00:21<00:01, 28.68it/s] 94%|█████████▍| 628/666 [00:22<00:01, 28.66it/s] 95%|█████████▍| 631/666 [00:22<00:01, 28.67it/s] 95%|█████████▌| 634/666 [00:22<00:01, 28.68it/s] 96%|█████████▌| 637/666 [00:22<00:01, 28.68it/s] 96%|█████████▌| 640/666 [00:22<00:00, 28.67it/s] 97%|█████████▋| 643/666 [00:22<00:00, 28.69it/s] 97%|█████████▋| 646/666 [00:22<00:00, 28.68it/s] 97%|█████████▋| 649/666 [00:22<00:00, 28.68it/s] 98%|█████████▊| 652/666 [00:22<00:00, 28.68it/s] 98%|█████████▊| 655/666 [00:23<00:00, 28.69it/s] 99%|█████████▉| 658/666 [00:23<00:00, 28.69it/s] 99%|█████████▉| 661/666 [00:23<00:00, 28.14it/s]100%|█████████▉| 664/666 [00:23<00:00, 28.38it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.77it/s][A
  6%|▌         | 10/167 [00:00<00:02, 52.75it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 121.35it/s][A
 32%|███▏      | 54/167 [00:00<00:00, 161.35it/s][A
 46%|████▌     | 77/167 [00:00<00:00, 184.13it/s][A
 60%|█████▉    | 100/167 [00:00<00:00, 197.17it/s][A
 74%|███████▎  | 123/167 [00:00<00:00, 206.03it/s][A
 87%|████████▋ | 146/167 [00:00<00:00, 211.95it/s][A100%|██████████| 167/167 [00:00<00:00, 172.54it/s]
2022-11-28 21:30:42,116 P64467 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:30:42,116 P64467 INFO Monitor(max) STOP: -10.617075 !
2022-11-28 21:30:42,116 P64467 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:30:42,116 P64467 INFO Early stopping at epoch=3
2022-11-28 21:30:42,117 P64467 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:24<00:00, 27.12it/s]
2022-11-28 21:30:42,163 P64467 INFO Train loss: 69.009461
2022-11-28 21:30:42,163 P64467 INFO Training finished.
2022-11-28 21:30:42,163 P64467 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_012_3e90a2fa.model
2022-11-28 21:30:42,353 P64467 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:55,  5.77it/s]  2%|▏         | 10/666 [00:00<00:15, 41.78it/s]  5%|▍         | 32/666 [00:00<00:05, 109.66it/s]  8%|▊         | 54/666 [00:00<00:04, 148.31it/s] 11%|█▏        | 76/666 [00:00<00:03, 170.38it/s] 15%|█▍        | 98/666 [00:00<00:03, 184.57it/s] 18%|█▊        | 120/666 [00:00<00:02, 193.51it/s] 21%|██▏       | 142/666 [00:00<00:02, 199.93it/s] 25%|██▍       | 164/666 [00:01<00:02, 203.78it/s] 28%|██▊       | 186/666 [00:01<00:02, 206.12it/s] 31%|███       | 208/666 [00:01<00:02, 208.23it/s] 35%|███▍      | 230/666 [00:01<00:02, 209.66it/s] 38%|███▊      | 252/666 [00:01<00:01, 210.41it/s] 41%|████      | 274/666 [00:01<00:01, 210.96it/s] 44%|████▍     | 296/666 [00:01<00:01, 211.35it/s] 48%|████▊     | 318/666 [00:01<00:01, 211.37it/s] 51%|█████     | 340/666 [00:01<00:01, 210.93it/s] 54%|█████▍    | 362/666 [00:01<00:01, 210.76it/s] 58%|█████▊    | 384/666 [00:02<00:01, 211.10it/s] 61%|██████    | 406/666 [00:02<00:01, 211.04it/s] 64%|██████▍   | 428/666 [00:02<00:01, 210.96it/s] 68%|██████▊   | 450/666 [00:02<00:01, 210.74it/s] 71%|███████   | 472/666 [00:02<00:00, 208.61it/s] 74%|███████▍  | 493/666 [00:02<00:00, 208.74it/s] 77%|███████▋  | 515/666 [00:02<00:00, 209.17it/s] 80%|████████  | 536/666 [00:02<00:00, 208.79it/s] 84%|████████▎ | 557/666 [00:02<00:00, 208.90it/s] 87%|████████▋ | 578/666 [00:02<00:00, 208.55it/s] 90%|████████▉ | 599/666 [00:03<00:00, 208.41it/s] 93%|█████████▎| 620/666 [00:03<00:00, 207.98it/s] 96%|█████████▌| 641/666 [00:03<00:00, 208.07it/s] 99%|█████████▉| 662/666 [00:03<00:00, 204.40it/s]100%|██████████| 666/666 [00:03<00:00, 193.38it/s]
2022-11-28 21:30:46,260 P64467 INFO [Metrics] logloss: 11.123019 - AUC: 0.499893
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:18,  9.08it/s]  6%|▌         | 10/167 [00:00<00:03, 49.33it/s] 18%|█▊        | 30/167 [00:00<00:01, 112.48it/s] 31%|███       | 51/167 [00:00<00:00, 146.52it/s] 43%|████▎     | 71/167 [00:00<00:00, 164.77it/s] 55%|█████▌    | 92/167 [00:00<00:00, 177.39it/s] 68%|██████▊   | 113/167 [00:00<00:00, 185.85it/s] 80%|████████  | 134/167 [00:00<00:00, 191.88it/s] 93%|█████████▎| 155/167 [00:00<00:00, 196.15it/s]100%|██████████| 167/167 [00:01<00:00, 158.18it/s]
2022-11-28 21:30:47,428 P64467 INFO [Metrics] logloss: 11.117083 - AUC: 0.500008
2022-11-28 21:30:51,581 P1016 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "64",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_013_77ca4f4f",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:30:51,583 P1016 INFO Set up feature encoder...
2022-11-28 21:30:51,584 P1016 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:30:51,585 P1016 INFO Loading data...
2022-11-28 21:30:51,588 P1016 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:30:51,856 P1016 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:30:51,959 P1016 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:30:51,959 P1016 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:30:51,959 P1016 INFO Loading train data done.
2022-11-28 21:30:54,649 P1016 INFO Total number of parameters: 15268036.
2022-11-28 21:30:54,649 P1016 INFO Start training: 666 batches/epoch
2022-11-28 21:30:54,650 P1016 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:30:54.986 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:1016 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:30:55.018 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:1016 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:35,  1.14s/it]  1%|          | 6/666 [00:01<01:44,  6.30it/s]  2%|▏         | 11/666 [00:01<00:54, 12.11it/s]  2%|▏         | 15/666 [00:01<00:39, 16.58it/s]  3%|▎         | 20/666 [00:01<00:28, 22.73it/s]  4%|▍         | 26/666 [00:01<00:21, 29.37it/s]  5%|▍         | 32/666 [00:01<00:18, 34.71it/s]  6%|▌         | 38/666 [00:01<00:16, 38.90it/s]  7%|▋         | 44/666 [00:02<00:14, 42.09it/s]  8%|▊         | 50/666 [00:02<00:13, 44.51it/s]  8%|▊         | 56/666 [00:02<00:13, 46.22it/s]  9%|▉         | 62/666 [00:02<00:12, 47.42it/s] 10%|█         | 68/666 [00:02<00:12, 48.29it/s] 11%|█         | 74/666 [00:02<00:12, 48.97it/s] 12%|█▏        | 80/666 [00:02<00:11, 49.42it/s] 13%|█▎        | 86/666 [00:02<00:11, 49.72it/s] 14%|█▍        | 92/666 [00:02<00:11, 49.96it/s] 15%|█▍        | 98/666 [00:03<00:11, 50.11it/s] 16%|█▌        | 104/666 [00:03<00:11, 50.22it/s] 17%|█▋        | 110/666 [00:03<00:11, 50.32it/s] 17%|█▋        | 116/666 [00:03<00:10, 50.35it/s] 18%|█▊        | 122/666 [00:03<00:10, 50.37it/s] 19%|█▉        | 128/666 [00:03<00:10, 49.55it/s] 20%|██        | 134/666 [00:03<00:10, 49.82it/s] 21%|██        | 140/666 [00:03<00:10, 49.99it/s] 22%|██▏       | 146/666 [00:04<00:10, 50.15it/s] 23%|██▎       | 152/666 [00:04<00:10, 50.30it/s] 24%|██▎       | 158/666 [00:04<00:10, 50.31it/s] 25%|██▍       | 164/666 [00:04<00:09, 50.33it/s] 26%|██▌       | 170/666 [00:04<00:09, 50.41it/s] 26%|██▋       | 176/666 [00:04<00:09, 50.43it/s] 27%|██▋       | 182/666 [00:04<00:09, 50.37it/s] 28%|██▊       | 188/666 [00:04<00:09, 50.33it/s] 29%|██▉       | 194/666 [00:05<00:09, 50.35it/s] 30%|███       | 200/666 [00:05<00:09, 50.43it/s] 31%|███       | 206/666 [00:05<00:09, 50.42it/s] 32%|███▏      | 212/666 [00:05<00:09, 50.42it/s] 33%|███▎      | 218/666 [00:05<00:08, 50.42it/s] 34%|███▎      | 224/666 [00:05<00:08, 50.45it/s] 35%|███▍      | 230/666 [00:05<00:08, 50.42it/s] 35%|███▌      | 236/666 [00:05<00:08, 50.39it/s] 36%|███▋      | 242/666 [00:05<00:08, 50.42it/s] 37%|███▋      | 248/666 [00:06<00:08, 50.48it/s] 38%|███▊      | 254/666 [00:06<00:08, 50.42it/s] 39%|███▉      | 260/666 [00:06<00:08, 50.41it/s] 40%|███▉      | 266/666 [00:06<00:07, 50.35it/s] 41%|████      | 272/666 [00:06<00:07, 50.42it/s] 42%|████▏     | 278/666 [00:06<00:07, 50.45it/s] 43%|████▎     | 284/666 [00:06<00:07, 50.37it/s] 44%|████▎     | 290/666 [00:06<00:07, 50.35it/s] 44%|████▍     | 296/666 [00:07<00:07, 50.39it/s] 45%|████▌     | 302/666 [00:07<00:07, 50.44it/s] 46%|████▌     | 308/666 [00:07<00:07, 50.39it/s] 47%|████▋     | 314/666 [00:07<00:06, 50.36it/s] 48%|████▊     | 320/666 [00:07<00:06, 50.34it/s] 49%|████▉     | 326/666 [00:07<00:06, 50.37it/s] 50%|████▉     | 332/666 [00:07<00:06, 50.42it/s] 51%|█████     | 338/666 [00:07<00:06, 50.42it/s] 52%|█████▏    | 344/666 [00:07<00:06, 50.44it/s] 53%|█████▎    | 350/666 [00:08<00:06, 50.42it/s] 53%|█████▎    | 356/666 [00:08<00:06, 50.39it/s] 54%|█████▍    | 362/666 [00:08<00:06, 50.42it/s] 55%|█████▌    | 368/666 [00:08<00:05, 50.37it/s] 56%|█████▌    | 374/666 [00:08<00:05, 50.42it/s] 57%|█████▋    | 380/666 [00:08<00:05, 50.39it/s] 58%|█████▊    | 386/666 [00:08<00:05, 50.40it/s] 59%|█████▉    | 392/666 [00:08<00:05, 50.41it/s] 60%|█████▉    | 398/666 [00:09<00:05, 50.46it/s] 61%|██████    | 404/666 [00:09<00:05, 50.44it/s] 62%|██████▏   | 410/666 [00:09<00:05, 50.41it/s] 62%|██████▏   | 416/666 [00:09<00:04, 50.46it/s] 63%|██████▎   | 422/666 [00:09<00:04, 50.52it/s] 64%|██████▍   | 428/666 [00:09<00:04, 50.50it/s] 65%|██████▌   | 434/666 [00:09<00:04, 50.57it/s] 66%|██████▌   | 440/666 [00:09<00:04, 50.57it/s] 67%|██████▋   | 446/666 [00:10<00:04, 50.54it/s] 68%|██████▊   | 452/666 [00:10<00:04, 50.60it/s] 69%|██████▉   | 458/666 [00:10<00:04, 50.55it/s] 70%|██████▉   | 464/666 [00:10<00:03, 50.54it/s] 71%|███████   | 470/666 [00:10<00:03, 50.56it/s] 71%|███████▏  | 476/666 [00:10<00:03, 50.50it/s] 72%|███████▏  | 482/666 [00:10<00:03, 50.52it/s] 73%|███████▎  | 488/666 [00:10<00:03, 50.55it/s] 74%|███████▍  | 494/666 [00:10<00:03, 50.59it/s] 75%|███████▌  | 500/666 [00:11<00:03, 50.57it/s] 76%|███████▌  | 506/666 [00:11<00:03, 50.58it/s] 77%|███████▋  | 512/666 [00:11<00:03, 50.60it/s] 78%|███████▊  | 518/666 [00:11<00:02, 50.59it/s] 79%|███████▊  | 524/666 [00:11<00:02, 50.63it/s] 80%|███████▉  | 530/666 [00:11<00:02, 50.59it/s] 80%|████████  | 536/666 [00:11<00:02, 50.55it/s] 81%|████████▏ | 542/666 [00:11<00:02, 50.41it/s] 82%|████████▏ | 548/666 [00:12<00:02, 50.56it/s] 83%|████████▎ | 554/666 [00:12<00:02, 50.52it/s] 84%|████████▍ | 560/666 [00:12<00:02, 50.51it/s] 85%|████████▍ | 566/666 [00:12<00:01, 50.56it/s] 86%|████████▌ | 572/666 [00:12<00:01, 50.50it/s] 87%|████████▋ | 578/666 [00:12<00:01, 50.49it/s] 88%|████████▊ | 584/666 [00:12<00:01, 50.54it/s] 89%|████████▊ | 590/666 [00:12<00:01, 50.55it/s] 89%|████████▉ | 596/666 [00:12<00:01, 50.57it/s] 90%|█████████ | 602/666 [00:13<00:01, 50.60it/s] 91%|█████████▏| 608/666 [00:13<00:01, 50.56it/s] 92%|█████████▏| 614/666 [00:13<00:01, 50.60it/s] 93%|█████████▎| 620/666 [00:13<00:00, 50.64it/s] 94%|█████████▍| 626/666 [00:13<00:00, 50.55it/s] 95%|█████████▍| 632/666 [00:13<00:00, 50.54it/s] 96%|█████████▌| 638/666 [00:13<00:00, 50.59it/s] 97%|█████████▋| 644/666 [00:13<00:00, 50.58it/s] 98%|█████████▊| 650/666 [00:14<00:00, 50.61it/s] 98%|█████████▊| 656/666 [00:14<00:00, 50.62it/s] 99%|█████████▉| 662/666 [00:14<00:00, 49.74it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:19,  8.32it/s][A
  6%|▌         | 10/167 [00:00<00:03, 50.74it/s][A
 16%|█▌        | 26/167 [00:00<00:01, 96.46it/s][A
 30%|██▉       | 50/167 [00:00<00:00, 149.13it/s][A
 44%|████▍     | 74/167 [00:00<00:00, 178.80it/s][A
 59%|█████▊    | 98/167 [00:00<00:00, 197.39it/s][A
 73%|███████▎  | 122/167 [00:00<00:00, 209.71it/s][A
 87%|████████▋ | 146/167 [00:00<00:00, 217.85it/s][A100%|██████████| 167/167 [00:00<00:00, 169.43it/s]
2022-11-28 21:31:10,115 P1016 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:31:10,115 P1016 INFO Save best model: monitor(max): -10.620960
2022-11-28 21:31:10,477 P1016 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:15<00:00, 41.97it/s]
2022-11-28 21:31:10,520 P1016 INFO Train loss: 43.079753
2022-11-28 21:31:10,520 P1016 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:56,  5.69it/s]  1%|          | 6/666 [00:00<00:26, 24.47it/s]  2%|▏         | 10/666 [00:00<00:21, 30.16it/s]  2%|▏         | 15/666 [00:00<00:18, 35.48it/s]  3%|▎         | 21/666 [00:00<00:15, 41.42it/s]  4%|▍         | 27/666 [00:00<00:14, 44.80it/s]  5%|▍         | 33/666 [00:00<00:13, 47.05it/s]  6%|▌         | 39/666 [00:00<00:12, 48.45it/s]  7%|▋         | 45/666 [00:01<00:12, 49.45it/s]  8%|▊         | 51/666 [00:01<00:12, 50.07it/s]  9%|▊         | 57/666 [00:01<00:12, 50.56it/s]  9%|▉         | 63/666 [00:01<00:11, 50.89it/s] 10%|█         | 69/666 [00:01<00:11, 51.12it/s] 11%|█▏        | 75/666 [00:01<00:11, 51.29it/s] 12%|█▏        | 81/666 [00:01<00:11, 51.41it/s] 13%|█▎        | 87/666 [00:01<00:11, 51.50it/s] 14%|█▍        | 93/666 [00:02<00:11, 51.48it/s] 15%|█▍        | 99/666 [00:02<00:11, 51.54it/s] 16%|█▌        | 105/666 [00:02<00:10, 51.57it/s] 17%|█▋        | 111/666 [00:02<00:10, 51.59it/s] 18%|█▊        | 117/666 [00:02<00:10, 51.61it/s] 18%|█▊        | 123/666 [00:02<00:10, 51.67it/s] 19%|█▉        | 129/666 [00:02<00:10, 51.67it/s] 20%|██        | 135/666 [00:02<00:10, 51.67it/s] 21%|██        | 141/666 [00:02<00:10, 51.69it/s] 22%|██▏       | 147/666 [00:03<00:10, 51.72it/s] 23%|██▎       | 153/666 [00:03<00:09, 51.74it/s] 24%|██▍       | 159/666 [00:03<00:09, 51.74it/s] 25%|██▍       | 165/666 [00:03<00:09, 51.74it/s] 26%|██▌       | 171/666 [00:03<00:09, 51.71it/s] 27%|██▋       | 177/666 [00:03<00:09, 51.70it/s] 27%|██▋       | 183/666 [00:03<00:09, 51.69it/s] 28%|██▊       | 189/666 [00:03<00:09, 51.71it/s] 29%|██▉       | 195/666 [00:03<00:09, 51.72it/s] 30%|███       | 201/666 [00:04<00:08, 51.73it/s] 31%|███       | 207/666 [00:04<00:08, 51.71it/s] 32%|███▏      | 213/666 [00:04<00:08, 51.72it/s] 33%|███▎      | 219/666 [00:04<00:08, 51.71it/s] 34%|███▍      | 225/666 [00:04<00:08, 51.71it/s] 35%|███▍      | 231/666 [00:04<00:08, 51.70it/s] 36%|███▌      | 237/666 [00:04<00:08, 51.69it/s] 36%|███▋      | 243/666 [00:04<00:08, 51.68it/s] 37%|███▋      | 249/666 [00:05<00:08, 51.70it/s] 38%|███▊      | 255/666 [00:05<00:07, 51.72it/s] 39%|███▉      | 261/666 [00:05<00:07, 51.72it/s] 40%|████      | 267/666 [00:05<00:07, 51.72it/s] 41%|████      | 273/666 [00:05<00:07, 51.72it/s] 42%|████▏     | 279/666 [00:05<00:07, 51.73it/s] 43%|████▎     | 285/666 [00:05<00:07, 51.75it/s] 44%|████▎     | 291/666 [00:05<00:07, 51.75it/s] 45%|████▍     | 297/666 [00:05<00:07, 51.73it/s] 45%|████▌     | 303/666 [00:06<00:07, 51.72it/s] 46%|████▋     | 309/666 [00:06<00:06, 51.72it/s] 47%|████▋     | 315/666 [00:06<00:06, 51.71it/s] 48%|████▊     | 321/666 [00:06<00:06, 51.71it/s] 49%|████▉     | 327/666 [00:06<00:06, 51.72it/s] 50%|█████     | 333/666 [00:06<00:06, 51.70it/s] 51%|█████     | 339/666 [00:06<00:06, 51.67it/s] 52%|█████▏    | 345/666 [00:06<00:06, 51.63it/s] 53%|█████▎    | 351/666 [00:07<00:06, 51.65it/s] 54%|█████▎    | 357/666 [00:07<00:05, 51.68it/s] 55%|█████▍    | 363/666 [00:07<00:05, 51.68it/s] 55%|█████▌    | 369/666 [00:07<00:05, 51.69it/s] 56%|█████▋    | 375/666 [00:07<00:05, 51.70it/s] 57%|█████▋    | 381/666 [00:07<00:05, 51.70it/s] 58%|█████▊    | 387/666 [00:07<00:05, 51.67it/s] 59%|█████▉    | 393/666 [00:07<00:05, 51.70it/s] 60%|█████▉    | 399/666 [00:07<00:05, 51.71it/s] 61%|██████    | 405/666 [00:08<00:05, 51.54it/s] 62%|██████▏   | 411/666 [00:08<00:04, 51.57it/s] 63%|██████▎   | 417/666 [00:08<00:04, 51.62it/s] 64%|██████▎   | 423/666 [00:08<00:04, 51.61it/s] 64%|██████▍   | 429/666 [00:08<00:04, 51.66it/s] 65%|██████▌   | 435/666 [00:08<00:04, 51.67it/s] 66%|██████▌   | 441/666 [00:08<00:04, 51.69it/s] 67%|██████▋   | 447/666 [00:08<00:04, 51.71it/s] 68%|██████▊   | 453/666 [00:08<00:04, 51.70it/s] 69%|██████▉   | 459/666 [00:09<00:04, 51.72it/s] 70%|██████▉   | 465/666 [00:09<00:03, 51.72it/s] 71%|███████   | 471/666 [00:09<00:03, 51.71it/s] 72%|███████▏  | 477/666 [00:09<00:03, 51.72it/s] 73%|███████▎  | 483/666 [00:09<00:03, 51.70it/s] 73%|███████▎  | 489/666 [00:09<00:03, 51.71it/s] 74%|███████▍  | 495/666 [00:09<00:03, 51.72it/s] 75%|███████▌  | 501/666 [00:09<00:03, 51.73it/s] 76%|███████▌  | 507/666 [00:10<00:03, 51.75it/s] 77%|███████▋  | 513/666 [00:10<00:02, 51.75it/s] 78%|███████▊  | 519/666 [00:10<00:02, 51.70it/s] 79%|███████▉  | 525/666 [00:10<00:02, 51.69it/s] 80%|███████▉  | 531/666 [00:10<00:02, 51.67it/s] 81%|████████  | 537/666 [00:10<00:02, 51.55it/s] 82%|████████▏ | 543/666 [00:10<00:02, 51.60it/s] 82%|████████▏ | 549/666 [00:10<00:02, 51.63it/s] 83%|████████▎ | 555/666 [00:10<00:02, 51.66it/s] 84%|████████▍ | 561/666 [00:11<00:02, 51.69it/s] 85%|████████▌ | 567/666 [00:11<00:01, 51.70it/s] 86%|████████▌ | 573/666 [00:11<00:01, 51.72it/s] 87%|████████▋ | 579/666 [00:11<00:01, 51.73it/s] 88%|████████▊ | 585/666 [00:11<00:01, 51.74it/s] 89%|████████▊ | 591/666 [00:11<00:01, 51.73it/s] 90%|████████▉ | 597/666 [00:11<00:01, 51.74it/s] 91%|█████████ | 603/666 [00:11<00:01, 51.74it/s] 91%|█████████▏| 609/666 [00:11<00:01, 51.73it/s] 92%|█████████▏| 615/666 [00:12<00:00, 51.74it/s] 93%|█████████▎| 621/666 [00:12<00:00, 51.74it/s] 94%|█████████▍| 627/666 [00:12<00:00, 51.74it/s] 95%|█████████▌| 633/666 [00:12<00:00, 51.73it/s] 96%|█████████▌| 639/666 [00:12<00:00, 51.72it/s] 97%|█████████▋| 645/666 [00:12<00:00, 51.73it/s] 98%|█████████▊| 651/666 [00:12<00:00, 51.73it/s] 99%|█████████▊| 657/666 [00:12<00:00, 51.73it/s]100%|█████████▉| 663/666 [00:13<00:00, 50.91it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.43it/s][A
  6%|▌         | 10/167 [00:00<00:03, 48.77it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 124.35it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 166.83it/s][A
 49%|████▊     | 81/167 [00:00<00:00, 191.44it/s][A
 63%|██████▎   | 105/167 [00:00<00:00, 207.10it/s][A
 77%|███████▋  | 129/167 [00:00<00:00, 217.31it/s][A
 92%|█████████▏| 153/167 [00:00<00:00, 224.17it/s][A100%|██████████| 167/167 [00:00<00:00, 177.01it/s]
2022-11-28 21:31:24,674 P1016 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:31:24,674 P1016 INFO Monitor(max) STOP: -10.620960 !
2022-11-28 21:31:24,674 P1016 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:31:24,675 P1016 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:14<00:00, 46.87it/s]
2022-11-28 21:31:24,730 P1016 INFO Train loss: 69.028800
2022-11-28 21:31:24,730 P1016 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:09,  5.12it/s]  1%|          | 6/666 [00:00<00:27, 24.07it/s]  2%|▏         | 11/666 [00:00<00:21, 30.87it/s]  2%|▏         | 16/666 [00:00<00:17, 37.12it/s]  3%|▎         | 22/666 [00:00<00:15, 41.89it/s]  4%|▍         | 28/666 [00:00<00:14, 44.78it/s]  5%|▌         | 34/666 [00:00<00:13, 46.62it/s]  6%|▌         | 40/666 [00:00<00:13, 47.77it/s]  7%|▋         | 46/666 [00:01<00:12, 48.56it/s]  8%|▊         | 52/666 [00:01<00:12, 49.08it/s]  9%|▊         | 58/666 [00:01<00:12, 49.48it/s] 10%|▉         | 64/666 [00:01<00:12, 49.76it/s] 11%|█         | 70/666 [00:01<00:11, 49.90it/s] 11%|█▏        | 76/666 [00:01<00:11, 49.99it/s] 12%|█▏        | 82/666 [00:01<00:11, 50.05it/s] 13%|█▎        | 88/666 [00:01<00:11, 50.11it/s] 14%|█▍        | 94/666 [00:02<00:11, 50.18it/s] 15%|█▌        | 100/666 [00:02<00:11, 50.27it/s] 16%|█▌        | 106/666 [00:02<00:11, 50.28it/s] 17%|█▋        | 112/666 [00:02<00:11, 50.28it/s] 18%|█▊        | 118/666 [00:02<00:10, 50.25it/s] 19%|█▊        | 124/666 [00:02<00:10, 50.22it/s] 20%|█▉        | 130/666 [00:02<00:10, 50.26it/s] 20%|██        | 136/666 [00:02<00:10, 50.31it/s] 21%|██▏       | 142/666 [00:03<00:10, 50.28it/s] 22%|██▏       | 148/666 [00:03<00:10, 50.29it/s] 23%|██▎       | 154/666 [00:03<00:10, 50.28it/s] 24%|██▍       | 160/666 [00:03<00:10, 50.33it/s] 25%|██▍       | 166/666 [00:03<00:09, 50.35it/s] 26%|██▌       | 172/666 [00:03<00:09, 50.31it/s] 27%|██▋       | 178/666 [00:03<00:09, 50.30it/s] 28%|██▊       | 184/666 [00:03<00:09, 50.27it/s] 29%|██▊       | 190/666 [00:03<00:09, 50.25it/s] 29%|██▉       | 196/666 [00:04<00:09, 50.28it/s] 30%|███       | 202/666 [00:04<00:09, 50.33it/s] 31%|███       | 208/666 [00:04<00:09, 50.33it/s] 32%|███▏      | 214/666 [00:04<00:08, 50.31it/s] 33%|███▎      | 220/666 [00:04<00:08, 50.26it/s] 34%|███▍      | 226/666 [00:04<00:08, 50.25it/s] 35%|███▍      | 232/666 [00:04<00:08, 50.27it/s] 36%|███▌      | 238/666 [00:04<00:08, 50.32it/s] 37%|███▋      | 244/666 [00:05<00:08, 50.31it/s] 38%|███▊      | 250/666 [00:05<00:08, 50.29it/s] 38%|███▊      | 256/666 [00:05<00:08, 50.28it/s] 39%|███▉      | 262/666 [00:05<00:08, 50.28it/s] 40%|████      | 268/666 [00:05<00:07, 50.22it/s] 41%|████      | 274/666 [00:05<00:07, 50.30it/s] 42%|████▏     | 280/666 [00:05<00:07, 50.31it/s] 43%|████▎     | 286/666 [00:05<00:07, 50.29it/s] 44%|████▍     | 292/666 [00:06<00:07, 50.28it/s] 45%|████▍     | 298/666 [00:06<00:07, 50.31it/s] 46%|████▌     | 304/666 [00:06<00:07, 50.35it/s] 47%|████▋     | 310/666 [00:06<00:07, 50.33it/s] 47%|████▋     | 316/666 [00:06<00:06, 50.33it/s] 48%|████▊     | 322/666 [00:06<00:06, 50.28it/s] 49%|████▉     | 328/666 [00:06<00:06, 50.27it/s] 50%|█████     | 334/666 [00:06<00:06, 50.32it/s] 51%|█████     | 340/666 [00:06<00:06, 50.36it/s] 52%|█████▏    | 346/666 [00:07<00:06, 50.35it/s] 53%|█████▎    | 352/666 [00:07<00:06, 50.32it/s] 54%|█████▍    | 358/666 [00:07<00:06, 50.31it/s] 55%|█████▍    | 364/666 [00:07<00:05, 50.37it/s] 56%|█████▌    | 370/666 [00:07<00:05, 50.22it/s] 56%|█████▋    | 376/666 [00:07<00:05, 50.26it/s] 57%|█████▋    | 382/666 [00:07<00:05, 50.27it/s] 58%|█████▊    | 388/666 [00:07<00:05, 50.28it/s] 59%|█████▉    | 394/666 [00:08<00:05, 50.25it/s] 60%|██████    | 400/666 [00:08<00:05, 50.20it/s] 61%|██████    | 406/666 [00:08<00:05, 50.30it/s] 62%|██████▏   | 412/666 [00:08<00:05, 50.32it/s] 63%|██████▎   | 418/666 [00:08<00:04, 50.27it/s] 64%|██████▎   | 424/666 [00:08<00:04, 50.22it/s] 65%|██████▍   | 430/666 [00:08<00:04, 50.18it/s] 65%|██████▌   | 436/666 [00:08<00:04, 50.18it/s] 66%|██████▋   | 442/666 [00:08<00:04, 50.15it/s] 67%|██████▋   | 448/666 [00:09<00:04, 50.23it/s] 68%|██████▊   | 454/666 [00:09<00:04, 50.29it/s] 69%|██████▉   | 460/666 [00:09<00:04, 50.29it/s] 70%|██████▉   | 466/666 [00:09<00:03, 50.23it/s] 71%|███████   | 472/666 [00:09<00:03, 50.19it/s] 72%|███████▏  | 478/666 [00:09<00:03, 50.19it/s] 73%|███████▎  | 484/666 [00:09<00:03, 50.22it/s] 74%|███████▎  | 490/666 [00:09<00:03, 50.29it/s] 74%|███████▍  | 496/666 [00:10<00:03, 50.31it/s] 75%|███████▌  | 502/666 [00:10<00:03, 50.30it/s] 76%|███████▋  | 508/666 [00:10<00:03, 50.26it/s] 77%|███████▋  | 514/666 [00:10<00:03, 50.24it/s] 78%|███████▊  | 520/666 [00:10<00:02, 50.16it/s] 79%|███████▉  | 526/666 [00:10<00:02, 50.18it/s] 80%|███████▉  | 532/666 [00:10<00:02, 50.19it/s] 81%|████████  | 538/666 [00:10<00:02, 50.26it/s] 82%|████████▏ | 544/666 [00:11<00:02, 50.28it/s] 83%|████████▎ | 550/666 [00:11<00:02, 50.29it/s] 83%|████████▎ | 556/666 [00:11<00:02, 50.28it/s] 84%|████████▍ | 562/666 [00:11<00:02, 50.29it/s] 85%|████████▌ | 568/666 [00:11<00:01, 50.31it/s] 86%|████████▌ | 574/666 [00:11<00:01, 50.31it/s] 87%|████████▋ | 580/666 [00:11<00:01, 50.27it/s] 88%|████████▊ | 586/666 [00:11<00:01, 50.28it/s] 89%|████████▉ | 592/666 [00:11<00:01, 50.30it/s] 90%|████████▉ | 598/666 [00:12<00:01, 50.28it/s] 91%|█████████ | 604/666 [00:12<00:01, 50.34it/s] 92%|█████████▏| 610/666 [00:12<00:01, 50.34it/s] 92%|█████████▏| 616/666 [00:12<00:00, 50.33it/s] 93%|█████████▎| 622/666 [00:12<00:00, 50.19it/s] 94%|█████████▍| 628/666 [00:12<00:00, 50.18it/s] 95%|█████████▌| 634/666 [00:12<00:00, 50.17it/s] 96%|█████████▌| 640/666 [00:12<00:00, 50.18it/s] 97%|█████████▋| 646/666 [00:13<00:00, 50.17it/s] 98%|█████████▊| 652/666 [00:13<00:00, 50.26it/s] 99%|█████████▉| 658/666 [00:13<00:00, 50.30it/s]100%|█████████▉| 664/666 [00:13<00:00, 49.71it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.84it/s][A
  6%|▌         | 10/167 [00:00<00:03, 50.77it/s][A
 20%|██        | 34/167 [00:00<00:01, 129.58it/s][A
 35%|███▍      | 58/167 [00:00<00:00, 169.57it/s][A
 49%|████▉     | 82/167 [00:00<00:00, 192.51it/s][A
 63%|██████▎   | 106/167 [00:00<00:00, 206.67it/s][A
 78%|███████▊  | 130/167 [00:00<00:00, 215.45it/s][A
 92%|█████████▏| 154/167 [00:00<00:00, 221.08it/s][A100%|██████████| 167/167 [00:00<00:00, 174.46it/s]
2022-11-28 21:31:39,251 P1016 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:31:39,251 P1016 INFO Monitor(max) STOP: -10.620960 !
2022-11-28 21:31:39,252 P1016 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:31:39,252 P1016 INFO Early stopping at epoch=3
2022-11-28 21:31:39,252 P1016 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:14<00:00, 45.63it/s]
2022-11-28 21:31:39,305 P1016 INFO Train loss: 69.029888
2022-11-28 21:31:39,305 P1016 INFO Training finished.
2022-11-28 21:31:39,305 P1016 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_013_77ca4f4f.model
2022-11-28 21:31:39,591 P1016 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:53,  5.88it/s]  2%|▏         | 10/666 [00:00<00:15, 42.25it/s]  5%|▍         | 32/666 [00:00<00:05, 110.26it/s]  8%|▊         | 52/666 [00:00<00:04, 141.64it/s] 11%|█         | 72/666 [00:00<00:03, 160.10it/s] 14%|█▍        | 92/666 [00:00<00:03, 172.65it/s] 17%|█▋        | 112/666 [00:00<00:03, 180.72it/s] 20%|█▉        | 132/666 [00:00<00:02, 186.02it/s] 23%|██▎       | 152/666 [00:00<00:02, 189.80it/s] 26%|██▌       | 172/666 [00:01<00:02, 191.97it/s] 29%|██▉       | 192/666 [00:01<00:02, 193.25it/s] 32%|███▏      | 212/666 [00:01<00:02, 194.38it/s] 35%|███▍      | 232/666 [00:01<00:02, 195.17it/s] 38%|███▊      | 252/666 [00:01<00:02, 195.37it/s] 41%|████      | 272/666 [00:01<00:02, 196.09it/s] 44%|████▍     | 292/666 [00:01<00:01, 196.50it/s] 47%|████▋     | 312/666 [00:01<00:01, 196.69it/s] 50%|████▉     | 332/666 [00:01<00:01, 196.99it/s] 53%|█████▎    | 352/666 [00:02<00:01, 197.06it/s] 56%|█████▌    | 372/666 [00:02<00:01, 196.95it/s] 59%|█████▉    | 392/666 [00:02<00:01, 196.89it/s] 62%|██████▏   | 412/666 [00:02<00:01, 195.75it/s] 65%|██████▍   | 432/666 [00:02<00:01, 196.06it/s] 68%|██████▊   | 452/666 [00:02<00:01, 196.40it/s] 71%|███████   | 472/666 [00:02<00:00, 196.47it/s] 74%|███████▍  | 492/666 [00:02<00:00, 196.26it/s] 77%|███████▋  | 512/666 [00:02<00:00, 196.44it/s] 80%|███████▉  | 532/666 [00:02<00:00, 196.46it/s] 83%|████████▎ | 552/666 [00:03<00:00, 196.50it/s] 86%|████████▌ | 572/666 [00:03<00:00, 196.69it/s] 89%|████████▉ | 592/666 [00:03<00:00, 196.66it/s] 92%|█████████▏| 612/666 [00:03<00:00, 196.56it/s] 95%|█████████▍| 632/666 [00:03<00:00, 196.50it/s] 98%|█████████▊| 652/666 [00:03<00:00, 196.48it/s]100%|██████████| 666/666 [00:03<00:00, 181.89it/s]
2022-11-28 21:31:43,702 P1016 INFO [Metrics] logloss: 11.126093 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:18,  8.78it/s]  6%|▌         | 10/167 [00:00<00:03, 49.57it/s] 19%|█▉        | 32/167 [00:00<00:01, 120.26it/s] 32%|███▏      | 54/167 [00:00<00:00, 156.95it/s] 46%|████▌     | 76/167 [00:00<00:00, 177.87it/s] 59%|█████▊    | 98/167 [00:00<00:00, 191.36it/s] 72%|███████▏  | 120/167 [00:00<00:00, 200.09it/s] 85%|████████▌ | 142/167 [00:00<00:00, 205.62it/s] 99%|█████████▉| 165/167 [00:00<00:00, 210.41it/s]100%|██████████| 167/167 [00:01<00:00, 165.29it/s]
2022-11-28 21:31:44,823 P1016 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:31:51,687 P2801 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "128",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_014_25d003bd",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:31:51,689 P2801 INFO Set up feature encoder...
2022-11-28 21:31:51,690 P2801 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:31:51,691 P2801 INFO Loading data...
2022-11-28 21:31:51,694 P2801 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:31:52,033 P2801 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:31:52,156 P2801 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:31:52,156 P2801 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:31:52,156 P2801 INFO Loading train data done.
2022-11-28 21:31:55,169 P2801 INFO Total number of parameters: 29989252.
2022-11-28 21:31:55,170 P2801 INFO Start training: 666 batches/epoch
2022-11-28 21:31:55,170 P2801 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:31:55.496 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:2801 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:31:55.527 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:2801 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:24,  1.12s/it]  1%|          | 5/666 [00:01<02:07,  5.20it/s]  1%|▏         | 9/666 [00:01<01:07,  9.74it/s]  2%|▏         | 13/666 [00:01<00:45, 14.24it/s]  3%|▎         | 17/666 [00:01<00:35, 18.52it/s]  3%|▎         | 21/666 [00:01<00:28, 22.45it/s]  4%|▍         | 25/666 [00:01<00:24, 25.74it/s]  4%|▍         | 29/666 [00:01<00:22, 28.40it/s]  5%|▍         | 33/666 [00:02<00:20, 30.51it/s]  6%|▌         | 37/666 [00:02<00:19, 32.06it/s]  6%|▌         | 41/666 [00:02<00:18, 33.24it/s]  7%|▋         | 45/666 [00:02<00:18, 34.11it/s]  7%|▋         | 49/666 [00:02<00:17, 34.69it/s]  8%|▊         | 53/666 [00:02<00:17, 35.14it/s]  9%|▊         | 57/666 [00:02<00:17, 35.45it/s]  9%|▉         | 61/666 [00:02<00:16, 35.61it/s] 10%|▉         | 65/666 [00:02<00:17, 34.85it/s] 10%|█         | 69/666 [00:03<00:16, 35.21it/s] 11%|█         | 73/666 [00:03<00:16, 35.52it/s] 12%|█▏        | 77/666 [00:03<00:16, 35.71it/s] 12%|█▏        | 81/666 [00:03<00:16, 35.86it/s] 13%|█▎        | 85/666 [00:03<00:16, 35.97it/s] 13%|█▎        | 89/666 [00:03<00:16, 36.01it/s] 14%|█▍        | 93/666 [00:03<00:15, 36.08it/s] 15%|█▍        | 97/666 [00:03<00:15, 36.11it/s] 15%|█▌        | 101/666 [00:03<00:15, 36.11it/s] 16%|█▌        | 105/666 [00:04<00:15, 36.14it/s] 16%|█▋        | 109/666 [00:04<00:15, 36.14it/s] 17%|█▋        | 113/666 [00:04<00:15, 36.13it/s] 18%|█▊        | 117/666 [00:04<00:15, 36.18it/s] 18%|█▊        | 121/666 [00:04<00:15, 36.16it/s] 19%|█▉        | 125/666 [00:04<00:14, 36.15it/s] 19%|█▉        | 129/666 [00:04<00:14, 36.17it/s] 20%|█▉        | 133/666 [00:04<00:14, 36.08it/s] 21%|██        | 137/666 [00:04<00:14, 36.12it/s] 21%|██        | 141/666 [00:05<00:14, 36.19it/s] 22%|██▏       | 145/666 [00:05<00:14, 36.19it/s] 22%|██▏       | 149/666 [00:05<00:14, 36.22it/s] 23%|██▎       | 153/666 [00:05<00:14, 36.25it/s] 24%|██▎       | 157/666 [00:05<00:14, 36.25it/s] 24%|██▍       | 161/666 [00:05<00:13, 36.27it/s] 25%|██▍       | 165/666 [00:05<00:13, 36.25it/s] 25%|██▌       | 169/666 [00:05<00:13, 36.26it/s] 26%|██▌       | 173/666 [00:05<00:13, 36.25it/s] 27%|██▋       | 177/666 [00:06<00:13, 36.26it/s] 27%|██▋       | 181/666 [00:06<00:13, 36.27it/s] 28%|██▊       | 185/666 [00:06<00:13, 36.24it/s] 28%|██▊       | 189/666 [00:06<00:13, 36.27it/s] 29%|██▉       | 193/666 [00:06<00:13, 36.25it/s] 30%|██▉       | 197/666 [00:06<00:12, 36.25it/s] 30%|███       | 201/666 [00:06<00:12, 36.24it/s] 31%|███       | 205/666 [00:06<00:12, 36.23it/s] 31%|███▏      | 209/666 [00:06<00:12, 36.25it/s] 32%|███▏      | 213/666 [00:07<00:12, 36.23it/s] 33%|███▎      | 217/666 [00:07<00:12, 36.26it/s] 33%|███▎      | 221/666 [00:07<00:12, 36.25it/s] 34%|███▍      | 225/666 [00:07<00:12, 36.26it/s] 34%|███▍      | 229/666 [00:07<00:12, 36.26it/s] 35%|███▍      | 233/666 [00:07<00:11, 36.22it/s] 36%|███▌      | 237/666 [00:07<00:11, 36.24it/s] 36%|███▌      | 241/666 [00:07<00:11, 36.24it/s] 37%|███▋      | 245/666 [00:07<00:11, 36.26it/s] 37%|███▋      | 249/666 [00:07<00:11, 36.26it/s] 38%|███▊      | 253/666 [00:08<00:11, 36.25it/s] 39%|███▊      | 257/666 [00:08<00:11, 36.27it/s] 39%|███▉      | 261/666 [00:08<00:11, 36.25it/s] 40%|███▉      | 265/666 [00:08<00:11, 36.27it/s] 40%|████      | 269/666 [00:08<00:10, 36.26it/s] 41%|████      | 273/666 [00:08<00:10, 36.27it/s] 42%|████▏     | 277/666 [00:08<00:10, 36.26it/s] 42%|████▏     | 281/666 [00:08<00:10, 36.24it/s] 43%|████▎     | 285/666 [00:08<00:10, 36.26it/s] 43%|████▎     | 289/666 [00:09<00:10, 36.24it/s] 44%|████▍     | 293/666 [00:09<00:10, 36.26it/s] 45%|████▍     | 297/666 [00:09<00:10, 36.26it/s] 45%|████▌     | 301/666 [00:09<00:10, 36.25it/s] 46%|████▌     | 305/666 [00:09<00:09, 36.27it/s] 46%|████▋     | 309/666 [00:09<00:09, 36.25it/s] 47%|████▋     | 313/666 [00:09<00:09, 36.26it/s] 48%|████▊     | 317/666 [00:09<00:09, 36.23it/s] 48%|████▊     | 321/666 [00:09<00:09, 36.23it/s] 49%|████▉     | 325/666 [00:10<00:09, 36.25it/s] 49%|████▉     | 329/666 [00:10<00:09, 36.23it/s] 50%|█████     | 333/666 [00:10<00:09, 36.26it/s] 51%|█████     | 337/666 [00:10<00:09, 36.25it/s] 51%|█████     | 341/666 [00:10<00:08, 36.28it/s] 52%|█████▏    | 345/666 [00:10<00:08, 36.26it/s] 52%|█████▏    | 349/666 [00:10<00:08, 36.23it/s] 53%|█████▎    | 353/666 [00:10<00:08, 36.27it/s] 54%|█████▎    | 357/666 [00:10<00:08, 36.24it/s] 54%|█████▍    | 361/666 [00:11<00:08, 36.27it/s] 55%|█████▍    | 365/666 [00:11<00:08, 36.26it/s] 55%|█████▌    | 369/666 [00:11<00:08, 36.27it/s] 56%|█████▌    | 373/666 [00:11<00:08, 36.27it/s] 57%|█████▋    | 377/666 [00:11<00:07, 36.24it/s] 57%|█████▋    | 381/666 [00:11<00:07, 36.24it/s] 58%|█████▊    | 385/666 [00:11<00:07, 36.21it/s] 58%|█████▊    | 389/666 [00:11<00:07, 36.20it/s] 59%|█████▉    | 393/666 [00:11<00:07, 36.23it/s] 60%|█████▉    | 397/666 [00:12<00:07, 36.21it/s] 60%|██████    | 401/666 [00:12<00:07, 36.23it/s] 61%|██████    | 405/666 [00:12<00:07, 36.22it/s] 61%|██████▏   | 409/666 [00:12<00:07, 36.20it/s] 62%|██████▏   | 413/666 [00:12<00:06, 36.23it/s] 63%|██████▎   | 417/666 [00:12<00:06, 36.20it/s] 63%|██████▎   | 421/666 [00:12<00:06, 36.21it/s] 64%|██████▍   | 425/666 [00:12<00:06, 36.22it/s] 64%|██████▍   | 429/666 [00:12<00:06, 36.18it/s] 65%|██████▌   | 433/666 [00:13<00:06, 36.21it/s] 66%|██████▌   | 437/666 [00:13<00:06, 36.20it/s] 66%|██████▌   | 441/666 [00:13<00:06, 36.13it/s] 67%|██████▋   | 445/666 [00:13<00:06, 36.10it/s] 67%|██████▋   | 449/666 [00:13<00:06, 36.14it/s] 68%|██████▊   | 453/666 [00:13<00:05, 36.12it/s] 69%|██████▊   | 457/666 [00:13<00:05, 36.10it/s] 69%|██████▉   | 461/666 [00:13<00:05, 36.13it/s] 70%|██████▉   | 465/666 [00:13<00:05, 35.99it/s] 70%|███████   | 469/666 [00:14<00:05, 36.02it/s] 71%|███████   | 473/666 [00:14<00:05, 36.03it/s] 72%|███████▏  | 477/666 [00:14<00:05, 36.06it/s] 72%|███████▏  | 481/666 [00:14<00:05, 36.08it/s] 73%|███████▎  | 485/666 [00:14<00:05, 36.04it/s] 73%|███████▎  | 489/666 [00:14<00:04, 36.06it/s] 74%|███████▍  | 493/666 [00:14<00:04, 36.10it/s] 75%|███████▍  | 497/666 [00:14<00:04, 36.00it/s] 75%|███████▌  | 501/666 [00:14<00:04, 36.01it/s] 76%|███████▌  | 505/666 [00:15<00:04, 36.01it/s] 76%|███████▋  | 509/666 [00:15<00:04, 35.95it/s] 77%|███████▋  | 513/666 [00:15<00:04, 36.02it/s] 78%|███████▊  | 517/666 [00:15<00:04, 36.03it/s] 78%|███████▊  | 521/666 [00:15<00:04, 36.03it/s] 79%|███████▉  | 525/666 [00:15<00:03, 36.06it/s] 79%|███████▉  | 529/666 [00:15<00:03, 36.10it/s] 80%|████████  | 533/666 [00:15<00:03, 36.09it/s] 81%|████████  | 537/666 [00:15<00:03, 36.08it/s] 81%|████████  | 541/666 [00:16<00:03, 36.11it/s] 82%|████████▏ | 545/666 [00:16<00:03, 36.08it/s] 82%|████████▏ | 549/666 [00:16<00:03, 36.08it/s] 83%|████████▎ | 553/666 [00:16<00:03, 36.12it/s] 84%|████████▎ | 557/666 [00:16<00:03, 36.10it/s] 84%|████████▍ | 561/666 [00:16<00:02, 36.09it/s] 85%|████████▍ | 565/666 [00:16<00:02, 36.11it/s] 85%|████████▌ | 569/666 [00:16<00:02, 36.10it/s] 86%|████████▌ | 573/666 [00:16<00:02, 36.08it/s] 87%|████████▋ | 577/666 [00:17<00:02, 36.07it/s] 87%|████████▋ | 581/666 [00:17<00:02, 36.11it/s] 88%|████████▊ | 585/666 [00:17<00:02, 36.10it/s] 88%|████████▊ | 589/666 [00:17<00:02, 36.09it/s] 89%|████████▉ | 593/666 [00:17<00:02, 36.13it/s] 90%|████████▉ | 597/666 [00:17<00:01, 36.09it/s] 90%|█████████ | 601/666 [00:17<00:01, 36.06it/s] 91%|█████████ | 605/666 [00:17<00:01, 36.09it/s] 91%|█████████▏| 609/666 [00:17<00:01, 36.09it/s] 92%|█████████▏| 613/666 [00:18<00:01, 36.08it/s] 93%|█████████▎| 617/666 [00:18<00:01, 36.06it/s] 93%|█████████▎| 621/666 [00:18<00:01, 36.09it/s] 94%|█████████▍| 625/666 [00:18<00:01, 36.10it/s] 94%|█████████▍| 629/666 [00:18<00:01, 36.07it/s] 95%|█████████▌| 633/666 [00:18<00:00, 36.06it/s] 96%|█████████▌| 637/666 [00:18<00:00, 36.11it/s] 96%|█████████▌| 641/666 [00:18<00:00, 36.09it/s] 97%|█████████▋| 645/666 [00:18<00:00, 36.08it/s] 97%|█████████▋| 649/666 [00:19<00:00, 36.10it/s] 98%|█████████▊| 653/666 [00:19<00:00, 36.10it/s] 99%|█████████▊| 657/666 [00:19<00:00, 36.08it/s] 99%|█████████▉| 661/666 [00:19<00:00, 35.39it/s]100%|█████████▉| 665/666 [00:19<00:00, 35.71it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.25it/s][A
  6%|▌         | 10/167 [00:00<00:03, 50.61it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 126.60it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 165.44it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 188.02it/s][A
 61%|██████    | 102/167 [00:00<00:00, 201.69it/s][A
 75%|███████▌  | 126/167 [00:00<00:00, 211.13it/s][A
 89%|████████▉ | 149/167 [00:00<00:00, 215.68it/s][A100%|██████████| 167/167 [00:00<00:00, 174.77it/s]
2022-11-28 21:32:15,781 P2801 INFO [Metrics] logloss: 4.997987 - AUC: 0.500113
2022-11-28 21:32:15,781 P2801 INFO Save best model: monitor(max): -4.497874
2022-11-28 21:32:16,833 P2801 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:21<00:00, 30.69it/s]
2022-11-28 21:32:16,874 P2801 INFO Train loss: 31.021789
2022-11-28 21:32:16,874 P2801 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:01,  5.46it/s]  1%|          | 5/666 [00:00<00:35, 18.48it/s]  1%|▏         | 9/666 [00:00<00:26, 24.86it/s]  2%|▏         | 13/666 [00:00<00:22, 28.41it/s]  3%|▎         | 17/666 [00:00<00:20, 31.09it/s]  3%|▎         | 21/666 [00:00<00:19, 32.88it/s]  4%|▍         | 25/666 [00:00<00:18, 34.11it/s]  4%|▍         | 29/666 [00:00<00:18, 34.95it/s]  5%|▍         | 33/666 [00:01<00:17, 35.51it/s]  6%|▌         | 37/666 [00:01<00:17, 35.92it/s]  6%|▌         | 41/666 [00:01<00:17, 36.20it/s]  7%|▋         | 45/666 [00:01<00:17, 36.38it/s]  7%|▋         | 49/666 [00:01<00:16, 36.49it/s]  8%|▊         | 53/666 [00:01<00:16, 36.60it/s]  9%|▊         | 57/666 [00:01<00:16, 36.67it/s]  9%|▉         | 61/666 [00:01<00:16, 36.72it/s] 10%|▉         | 65/666 [00:01<00:16, 36.77it/s] 10%|█         | 69/666 [00:02<00:16, 36.79it/s] 11%|█         | 73/666 [00:02<00:16, 36.81it/s] 12%|█▏        | 77/666 [00:02<00:15, 36.83it/s] 12%|█▏        | 81/666 [00:02<00:15, 36.82it/s] 13%|█▎        | 85/666 [00:02<00:15, 36.83it/s] 13%|█▎        | 89/666 [00:02<00:15, 36.84it/s] 14%|█▍        | 93/666 [00:02<00:15, 36.84it/s] 15%|█▍        | 97/666 [00:02<00:15, 36.84it/s] 15%|█▌        | 101/666 [00:02<00:15, 36.81it/s] 16%|█▌        | 105/666 [00:03<00:15, 36.81it/s] 16%|█▋        | 109/666 [00:03<00:15, 36.79it/s] 17%|█▋        | 113/666 [00:03<00:15, 36.68it/s] 18%|█▊        | 117/666 [00:03<00:14, 36.66it/s] 18%|█▊        | 121/666 [00:03<00:14, 36.69it/s] 19%|█▉        | 125/666 [00:03<00:14, 36.73it/s] 19%|█▉        | 129/666 [00:03<00:14, 36.76it/s] 20%|█▉        | 133/666 [00:03<00:14, 36.79it/s] 21%|██        | 137/666 [00:03<00:14, 36.81it/s] 21%|██        | 141/666 [00:04<00:14, 36.82it/s] 22%|██▏       | 145/666 [00:04<00:14, 36.82it/s] 22%|██▏       | 149/666 [00:04<00:14, 36.81it/s] 23%|██▎       | 153/666 [00:04<00:13, 36.80it/s] 24%|██▎       | 157/666 [00:04<00:13, 36.78it/s] 24%|██▍       | 161/666 [00:04<00:13, 36.78it/s] 25%|██▍       | 165/666 [00:04<00:13, 36.77it/s] 25%|██▌       | 169/666 [00:04<00:13, 36.77it/s] 26%|██▌       | 173/666 [00:04<00:13, 36.77it/s] 27%|██▋       | 177/666 [00:04<00:13, 36.78it/s] 27%|██▋       | 181/666 [00:05<00:13, 36.40it/s] 28%|██▊       | 185/666 [00:05<00:13, 36.09it/s] 28%|██▊       | 189/666 [00:05<00:13, 35.85it/s] 29%|██▉       | 193/666 [00:05<00:13, 35.66it/s] 30%|██▉       | 197/666 [00:05<00:13, 35.57it/s] 30%|███       | 201/666 [00:05<00:13, 35.48it/s] 31%|███       | 205/666 [00:05<00:13, 35.41it/s] 31%|███▏      | 209/666 [00:05<00:12, 35.39it/s] 32%|███▏      | 213/666 [00:06<00:12, 35.35it/s] 33%|███▎      | 217/666 [00:06<00:12, 35.30it/s] 33%|███▎      | 221/666 [00:06<00:12, 35.32it/s] 34%|███▍      | 225/666 [00:06<00:12, 35.29it/s] 34%|███▍      | 229/666 [00:06<00:12, 35.28it/s] 35%|███▍      | 233/666 [00:06<00:12, 35.30it/s] 36%|███▌      | 237/666 [00:06<00:12, 35.27it/s] 36%|███▌      | 241/666 [00:06<00:12, 35.28it/s] 37%|███▋      | 245/666 [00:06<00:11, 35.31it/s] 37%|███▋      | 249/666 [00:07<00:11, 35.29it/s] 38%|███▊      | 253/666 [00:07<00:11, 35.29it/s] 39%|███▊      | 257/666 [00:07<00:11, 35.32it/s] 39%|███▉      | 261/666 [00:07<00:11, 35.30it/s] 40%|███▉      | 265/666 [00:07<00:11, 35.29it/s] 40%|████      | 269/666 [00:07<00:11, 35.32it/s] 41%|████      | 273/666 [00:07<00:11, 35.29it/s] 42%|████▏     | 277/666 [00:07<00:11, 35.29it/s] 42%|████▏     | 281/666 [00:07<00:10, 35.32it/s] 43%|████▎     | 285/666 [00:08<00:10, 35.28it/s] 43%|████▎     | 289/666 [00:08<00:10, 35.28it/s] 44%|████▍     | 293/666 [00:08<00:10, 35.30it/s] 45%|████▍     | 297/666 [00:08<00:10, 35.24it/s] 45%|████▌     | 301/666 [00:08<00:10, 35.25it/s] 46%|████▌     | 305/666 [00:08<00:10, 35.27it/s] 46%|████▋     | 309/666 [00:08<00:10, 35.25it/s] 47%|████▋     | 313/666 [00:08<00:10, 35.28it/s] 48%|████▊     | 317/666 [00:08<00:09, 35.29it/s] 48%|████▊     | 321/666 [00:09<00:09, 35.24it/s] 49%|████▉     | 325/666 [00:09<00:09, 35.27it/s] 49%|████▉     | 329/666 [00:09<00:09, 35.24it/s] 50%|█████     | 333/666 [00:09<00:09, 35.23it/s] 51%|█████     | 337/666 [00:09<00:09, 35.26it/s] 51%|█████     | 341/666 [00:09<00:09, 35.20it/s] 52%|█████▏    | 345/666 [00:09<00:09, 35.23it/s] 52%|█████▏    | 349/666 [00:09<00:08, 35.22it/s] 53%|█████▎    | 353/666 [00:09<00:08, 35.24it/s] 54%|█████▎    | 357/666 [00:10<00:08, 35.26it/s] 54%|█████▍    | 361/666 [00:10<00:08, 35.24it/s] 55%|█████▍    | 365/666 [00:10<00:08, 35.26it/s] 55%|█████▌    | 369/666 [00:10<00:08, 35.28it/s] 56%|█████▌    | 373/666 [00:10<00:08, 35.21it/s] 57%|█████▋    | 377/666 [00:10<00:08, 35.16it/s] 57%|█████▋    | 381/666 [00:10<00:08, 35.14it/s] 58%|█████▊    | 385/666 [00:10<00:07, 35.19it/s] 58%|█████▊    | 389/666 [00:11<00:07, 35.21it/s] 59%|█████▉    | 393/666 [00:11<00:07, 35.22it/s] 60%|█████▉    | 397/666 [00:11<00:07, 35.26it/s] 60%|██████    | 401/666 [00:11<00:07, 35.27it/s] 61%|██████    | 405/666 [00:11<00:07, 35.26it/s] 61%|██████▏   | 409/666 [00:11<00:07, 35.28it/s] 62%|██████▏   | 413/666 [00:11<00:07, 35.26it/s] 63%|██████▎   | 417/666 [00:11<00:07, 35.26it/s] 63%|██████▎   | 421/666 [00:11<00:06, 35.26it/s] 64%|██████▍   | 425/666 [00:12<00:06, 35.25it/s] 64%|██████▍   | 429/666 [00:12<00:06, 35.27it/s] 65%|██████▌   | 433/666 [00:12<00:06, 35.29it/s] 66%|██████▌   | 437/666 [00:12<00:06, 35.26it/s] 66%|██████▌   | 441/666 [00:12<00:06, 35.27it/s] 67%|██████▋   | 445/666 [00:12<00:06, 35.28it/s] 67%|██████▋   | 449/666 [00:12<00:06, 35.26it/s] 68%|██████▊   | 453/666 [00:12<00:06, 35.26it/s] 69%|██████▊   | 457/666 [00:12<00:05, 35.24it/s] 69%|██████▉   | 461/666 [00:13<00:05, 35.24it/s] 70%|██████▉   | 465/666 [00:13<00:05, 35.27it/s] 70%|███████   | 469/666 [00:13<00:05, 35.26it/s] 71%|███████   | 473/666 [00:13<00:05, 35.27it/s] 72%|███████▏  | 477/666 [00:13<00:05, 35.29it/s] 72%|███████▏  | 481/666 [00:13<00:05, 35.27it/s] 73%|███████▎  | 485/666 [00:13<00:05, 35.27it/s] 73%|███████▎  | 489/666 [00:13<00:05, 35.29it/s] 74%|███████▍  | 493/666 [00:13<00:04, 35.27it/s] 75%|███████▍  | 497/666 [00:14<00:04, 35.29it/s] 75%|███████▌  | 501/666 [00:14<00:04, 35.30it/s] 76%|███████▌  | 505/666 [00:14<00:04, 35.28it/s] 76%|███████▋  | 509/666 [00:14<00:04, 35.30it/s] 77%|███████▋  | 513/666 [00:14<00:04, 35.29it/s] 78%|███████▊  | 517/666 [00:14<00:04, 35.25it/s] 78%|███████▊  | 521/666 [00:14<00:04, 35.28it/s] 79%|███████▉  | 525/666 [00:14<00:03, 35.28it/s] 79%|███████▉  | 529/666 [00:14<00:03, 35.26it/s] 80%|████████  | 533/666 [00:15<00:03, 35.26it/s] 81%|████████  | 537/666 [00:15<00:03, 35.12it/s] 81%|████████  | 541/666 [00:15<00:03, 35.17it/s] 82%|████████▏ | 545/666 [00:15<00:03, 35.13it/s] 82%|████████▏ | 549/666 [00:15<00:03, 35.17it/s] 83%|████████▎ | 553/666 [00:15<00:03, 35.18it/s] 84%|████████▎ | 557/666 [00:15<00:03, 35.21it/s] 84%|████████▍ | 561/666 [00:15<00:02, 35.24it/s] 85%|████████▍ | 565/666 [00:16<00:02, 35.25it/s] 85%|████████▌ | 569/666 [00:16<00:02, 35.25it/s] 86%|████████▌ | 573/666 [00:16<00:02, 35.27it/s] 87%|████████▋ | 577/666 [00:16<00:02, 35.25it/s] 87%|████████▋ | 581/666 [00:16<00:02, 35.27it/s] 88%|████████▊ | 585/666 [00:16<00:02, 35.28it/s] 88%|████████▊ | 589/666 [00:16<00:02, 35.26it/s] 89%|████████▉ | 593/666 [00:16<00:02, 35.27it/s] 90%|████████▉ | 597/666 [00:16<00:01, 35.27it/s] 90%|█████████ | 601/666 [00:17<00:01, 35.25it/s] 91%|█████████ | 605/666 [00:17<00:01, 35.27it/s] 91%|█████████▏| 609/666 [00:17<00:01, 35.24it/s] 92%|█████████▏| 613/666 [00:17<00:01, 35.26it/s] 93%|█████████▎| 617/666 [00:17<00:01, 35.30it/s] 93%|█████████▎| 621/666 [00:17<00:01, 35.29it/s] 94%|█████████▍| 625/666 [00:17<00:01, 35.27it/s] 94%|█████████▍| 629/666 [00:17<00:01, 35.30it/s] 95%|█████████▌| 633/666 [00:17<00:00, 35.30it/s] 96%|█████████▌| 637/666 [00:18<00:00, 35.26it/s] 96%|█████████▌| 641/666 [00:18<00:00, 35.28it/s] 97%|█████████▋| 645/666 [00:18<00:00, 35.25it/s] 97%|█████████▋| 649/666 [00:18<00:00, 35.26it/s] 98%|█████████▊| 653/666 [00:18<00:00, 35.27it/s] 99%|█████████▊| 657/666 [00:18<00:00, 35.25it/s] 99%|█████████▉| 661/666 [00:18<00:00, 34.61it/s]100%|█████████▉| 665/666 [00:18<00:00, 34.92it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.96it/s][A
  6%|▌         | 10/167 [00:00<00:03, 47.05it/s][A
 18%|█▊        | 30/167 [00:00<00:01, 107.90it/s][A
 31%|███       | 51/167 [00:00<00:00, 143.90it/s][A
 43%|████▎     | 72/167 [00:00<00:00, 165.53it/s][A
 56%|█████▌    | 93/167 [00:00<00:00, 178.95it/s][A
 68%|██████▊   | 114/167 [00:00<00:00, 187.80it/s][A
 81%|████████  | 135/167 [00:00<00:00, 193.72it/s][A
 93%|█████████▎| 156/167 [00:00<00:00, 197.88it/s][A100%|██████████| 167/167 [00:01<00:00, 158.19it/s]
2022-11-28 21:32:36,913 P2801 INFO [Metrics] logloss: 4.999405 - AUC: 0.500106
2022-11-28 21:32:36,913 P2801 INFO Monitor(max) STOP: -4.499299 !
2022-11-28 21:32:36,913 P2801 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:32:36,914 P2801 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:20<00:00, 33.15it/s]
2022-11-28 21:32:36,965 P2801 INFO Train loss: 30.982314
2022-11-28 21:32:36,965 P2801 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:59,  5.58it/s]  1%|          | 5/666 [00:00<00:33, 19.80it/s]  1%|▏         | 9/666 [00:00<00:24, 26.35it/s]  2%|▏         | 13/666 [00:00<00:21, 29.76it/s]  3%|▎         | 17/666 [00:00<00:20, 31.93it/s]  3%|▎         | 21/666 [00:00<00:19, 33.28it/s]  4%|▍         | 25/666 [00:00<00:18, 34.20it/s]  4%|▍         | 29/666 [00:00<00:18, 34.79it/s]  5%|▍         | 33/666 [00:01<00:17, 35.18it/s]  6%|▌         | 37/666 [00:01<00:17, 35.48it/s]  6%|▌         | 41/666 [00:01<00:17, 35.67it/s]  7%|▋         | 45/666 [00:01<00:17, 35.75it/s]  7%|▋         | 49/666 [00:01<00:17, 35.87it/s]  8%|▊         | 53/666 [00:01<00:17, 35.95it/s]  9%|▊         | 57/666 [00:01<00:16, 35.99it/s]  9%|▉         | 61/666 [00:01<00:16, 36.02it/s] 10%|▉         | 65/666 [00:01<00:16, 36.08it/s] 10%|█         | 69/666 [00:02<00:16, 36.09it/s] 11%|█         | 73/666 [00:02<00:16, 36.06it/s] 12%|█▏        | 77/666 [00:02<00:16, 36.12it/s] 12%|█▏        | 81/666 [00:02<00:16, 36.10it/s] 13%|█▎        | 85/666 [00:02<00:16, 36.08it/s] 13%|█▎        | 89/666 [00:02<00:15, 36.12it/s] 14%|█▍        | 93/666 [00:02<00:15, 36.12it/s] 15%|█▍        | 97/666 [00:02<00:15, 36.09it/s] 15%|█▌        | 101/666 [00:02<00:15, 36.12it/s] 16%|█▌        | 105/666 [00:03<00:15, 36.13it/s] 16%|█▋        | 109/666 [00:03<00:15, 36.09it/s] 17%|█▋        | 113/666 [00:03<00:15, 36.10it/s] 18%|█▊        | 117/666 [00:03<00:15, 36.14it/s] 18%|█▊        | 121/666 [00:03<00:15, 36.10it/s] 19%|█▉        | 125/666 [00:03<00:14, 36.09it/s] 19%|█▉        | 129/666 [00:03<00:14, 36.13it/s] 20%|█▉        | 133/666 [00:03<00:14, 36.11it/s] 21%|██        | 137/666 [00:03<00:14, 36.09it/s] 21%|██        | 141/666 [00:04<00:14, 36.13it/s] 22%|██▏       | 145/666 [00:04<00:14, 36.10it/s] 22%|██▏       | 149/666 [00:04<00:14, 36.09it/s] 23%|██▎       | 153/666 [00:04<00:14, 36.12it/s] 24%|██▎       | 157/666 [00:04<00:14, 36.12it/s] 24%|██▍       | 161/666 [00:04<00:13, 36.09it/s] 25%|██▍       | 165/666 [00:04<00:13, 36.11it/s] 25%|██▌       | 169/666 [00:04<00:13, 36.12it/s] 26%|██▌       | 173/666 [00:04<00:13, 36.11it/s] 27%|██▋       | 177/666 [00:05<00:13, 36.07it/s] 27%|██▋       | 181/666 [00:05<00:13, 36.10it/s] 28%|██▊       | 185/666 [00:05<00:13, 36.11it/s] 28%|██▊       | 189/666 [00:05<00:13, 36.07it/s] 29%|██▉       | 193/666 [00:05<00:13, 36.10it/s] 30%|██▉       | 197/666 [00:05<00:12, 36.10it/s] 30%|███       | 201/666 [00:05<00:12, 36.08it/s] 31%|███       | 205/666 [00:05<00:12, 36.04it/s] 31%|███▏      | 209/666 [00:05<00:12, 36.08it/s] 32%|███▏      | 213/666 [00:06<00:12, 36.08it/s] 33%|███▎      | 217/666 [00:06<00:12, 36.07it/s] 33%|███▎      | 221/666 [00:06<00:12, 36.07it/s] 34%|███▍      | 225/666 [00:06<00:12, 36.09it/s] 34%|███▍      | 229/666 [00:06<00:12, 36.09it/s] 35%|███▍      | 233/666 [00:06<00:12, 36.06it/s] 36%|███▌      | 237/666 [00:06<00:11, 36.08it/s] 36%|███▌      | 241/666 [00:06<00:11, 36.10it/s] 37%|███▋      | 245/666 [00:06<00:11, 36.08it/s] 37%|███▋      | 249/666 [00:07<00:11, 36.06it/s] 38%|███▊      | 253/666 [00:07<00:11, 36.10it/s] 39%|███▊      | 257/666 [00:07<00:11, 36.10it/s] 39%|███▉      | 261/666 [00:07<00:11, 36.05it/s] 40%|███▉      | 265/666 [00:07<00:11, 36.07it/s] 40%|████      | 269/666 [00:07<00:11, 36.07it/s] 41%|████      | 273/666 [00:07<00:10, 36.05it/s] 42%|████▏     | 277/666 [00:07<00:10, 36.04it/s] 42%|████▏     | 281/666 [00:07<00:10, 36.09it/s] 43%|████▎     | 285/666 [00:08<00:10, 36.08it/s] 43%|████▎     | 289/666 [00:08<00:10, 36.06it/s] 44%|████▍     | 293/666 [00:08<00:10, 36.06it/s] 45%|████▍     | 297/666 [00:08<00:10, 36.08it/s] 45%|████▌     | 301/666 [00:08<00:10, 36.08it/s] 46%|████▌     | 305/666 [00:08<00:10, 36.06it/s] 46%|████▋     | 309/666 [00:08<00:09, 36.07it/s] 47%|████▋     | 313/666 [00:08<00:09, 36.09it/s] 48%|████▊     | 317/666 [00:08<00:09, 36.08it/s] 48%|████▊     | 321/666 [00:09<00:09, 36.07it/s] 49%|████▉     | 325/666 [00:09<00:09, 36.10it/s] 49%|████▉     | 329/666 [00:09<00:09, 36.08it/s] 50%|█████     | 333/666 [00:09<00:09, 36.05it/s] 51%|█████     | 337/666 [00:09<00:09, 36.05it/s] 51%|█████     | 341/666 [00:09<00:09, 36.09it/s] 52%|█████▏    | 345/666 [00:09<00:08, 36.06it/s] 52%|█████▏    | 349/666 [00:09<00:08, 36.06it/s] 53%|█████▎    | 353/666 [00:09<00:08, 36.10it/s] 54%|█████▎    | 357/666 [00:10<00:08, 36.09it/s] 54%|█████▍    | 361/666 [00:10<00:08, 36.06it/s] 55%|█████▍    | 365/666 [00:10<00:08, 36.08it/s] 55%|█████▌    | 369/666 [00:10<00:08, 36.09it/s] 56%|█████▌    | 373/666 [00:10<00:08, 36.07it/s] 57%|█████▋    | 377/666 [00:10<00:08, 36.06it/s] 57%|█████▋    | 381/666 [00:10<00:07, 36.07it/s] 58%|█████▊    | 385/666 [00:10<00:07, 36.08it/s] 58%|█████▊    | 389/666 [00:10<00:07, 36.05it/s] 59%|█████▉    | 393/666 [00:11<00:07, 36.01it/s] 60%|█████▉    | 397/666 [00:11<00:07, 36.06it/s] 60%|██████    | 401/666 [00:11<00:07, 36.08it/s] 61%|██████    | 405/666 [00:11<00:07, 36.06it/s] 61%|██████▏   | 409/666 [00:11<00:07, 36.06it/s] 62%|██████▏   | 413/666 [00:11<00:07, 36.10it/s] 63%|██████▎   | 417/666 [00:11<00:06, 36.08it/s] 63%|██████▎   | 421/666 [00:11<00:06, 36.05it/s] 64%|██████▍   | 425/666 [00:11<00:06, 36.10it/s] 64%|██████▍   | 429/666 [00:12<00:06, 36.09it/s] 65%|██████▌   | 433/666 [00:12<00:06, 36.08it/s] 66%|██████▌   | 437/666 [00:12<00:06, 36.05it/s] 66%|██████▌   | 441/666 [00:12<00:06, 36.08it/s] 67%|██████▋   | 445/666 [00:12<00:06, 36.08it/s] 67%|██████▋   | 449/666 [00:12<00:06, 36.07it/s] 68%|██████▊   | 453/666 [00:12<00:05, 36.04it/s] 69%|██████▊   | 457/666 [00:12<00:05, 36.09it/s] 69%|██████▉   | 461/666 [00:12<00:05, 36.08it/s] 70%|██████▉   | 465/666 [00:13<00:05, 36.06it/s] 70%|███████   | 469/666 [00:13<00:05, 36.10it/s] 71%|███████   | 473/666 [00:13<00:05, 36.09it/s] 72%|███████▏  | 477/666 [00:13<00:05, 36.08it/s] 72%|███████▏  | 481/666 [00:13<00:05, 36.12it/s] 73%|███████▎  | 485/666 [00:13<00:05, 36.12it/s] 73%|███████▎  | 489/666 [00:13<00:04, 36.11it/s] 74%|███████▍  | 493/666 [00:13<00:04, 36.14it/s] 75%|███████▍  | 497/666 [00:13<00:04, 36.14it/s] 75%|███████▌  | 501/666 [00:14<00:04, 36.09it/s] 76%|███████▌  | 505/666 [00:14<00:04, 36.10it/s] 76%|███████▋  | 509/666 [00:14<00:04, 36.11it/s] 77%|███████▋  | 513/666 [00:14<00:04, 36.10it/s] 78%|███████▊  | 517/666 [00:14<00:04, 36.07it/s] 78%|███████▊  | 521/666 [00:14<00:04, 36.11it/s] 79%|███████▉  | 525/666 [00:14<00:03, 36.12it/s] 79%|███████▉  | 529/666 [00:14<00:03, 36.09it/s] 80%|████████  | 533/666 [00:14<00:03, 36.13it/s] 81%|████████  | 537/666 [00:15<00:03, 36.13it/s] 81%|████████  | 541/666 [00:15<00:03, 36.12it/s] 82%|████████▏ | 545/666 [00:15<00:03, 36.14it/s] 82%|████████▏ | 549/666 [00:15<00:03, 36.14it/s] 83%|████████▎ | 553/666 [00:15<00:03, 36.12it/s] 84%|████████▎ | 557/666 [00:15<00:03, 36.15it/s] 84%|████████▍ | 561/666 [00:15<00:02, 36.15it/s] 85%|████████▍ | 565/666 [00:15<00:02, 36.09it/s] 85%|████████▌ | 569/666 [00:15<00:02, 36.07it/s] 86%|████████▌ | 573/666 [00:16<00:02, 36.12it/s] 87%|████████▋ | 577/666 [00:16<00:02, 36.09it/s] 87%|████████▋ | 581/666 [00:16<00:02, 36.07it/s] 88%|████████▊ | 585/666 [00:16<00:02, 36.11it/s] 88%|████████▊ | 589/666 [00:16<00:02, 36.11it/s] 89%|████████▉ | 593/666 [00:16<00:02, 36.09it/s] 90%|████████▉ | 597/666 [00:16<00:01, 36.10it/s] 90%|█████████ | 601/666 [00:16<00:01, 36.13it/s] 91%|█████████ | 605/666 [00:16<00:01, 36.11it/s] 91%|█████████▏| 609/666 [00:17<00:01, 36.14it/s] 92%|█████████▏| 613/666 [00:17<00:01, 36.15it/s] 93%|█████████▎| 617/666 [00:17<00:01, 36.12it/s] 93%|█████████▎| 621/666 [00:17<00:01, 36.11it/s] 94%|█████████▍| 625/666 [00:17<00:01, 36.14it/s] 94%|█████████▍| 629/666 [00:17<00:01, 36.11it/s] 95%|█████████▌| 633/666 [00:17<00:00, 36.09it/s] 96%|█████████▌| 637/666 [00:17<00:00, 36.14it/s] 96%|█████████▌| 641/666 [00:17<00:00, 36.10it/s] 97%|█████████▋| 645/666 [00:18<00:00, 36.07it/s] 97%|█████████▋| 649/666 [00:18<00:00, 36.10it/s] 98%|█████████▊| 653/666 [00:18<00:00, 36.11it/s] 99%|█████████▊| 657/666 [00:18<00:00, 36.09it/s] 99%|█████████▉| 661/666 [00:18<00:00, 35.40it/s]100%|█████████▉| 665/666 [00:18<00:00, 35.70it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.13it/s][A
  6%|▌         | 10/167 [00:00<00:02, 53.12it/s][A
 19%|█▉        | 32/167 [00:00<00:01, 124.61it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 166.24it/s][A
 48%|████▊     | 80/167 [00:00<00:00, 189.22it/s][A
 62%|██████▏   | 104/167 [00:00<00:00, 203.49it/s][A
 77%|███████▋  | 128/167 [00:00<00:00, 212.54it/s][A
 91%|█████████ | 152/167 [00:00<00:00, 219.12it/s][A100%|██████████| 167/167 [00:00<00:00, 174.93it/s]
2022-11-28 21:32:56,644 P2801 INFO [Metrics] logloss: 4.999500 - AUC: 0.500107
2022-11-28 21:32:56,645 P2801 INFO Monitor(max) STOP: -4.499393 !
2022-11-28 21:32:56,645 P2801 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:32:56,645 P2801 INFO Early stopping at epoch=3
2022-11-28 21:32:56,645 P2801 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:19<00:00, 33.69it/s]
2022-11-28 21:32:56,702 P2801 INFO Train loss: 30.980881
2022-11-28 21:32:56,703 P2801 INFO Training finished.
2022-11-28 21:32:56,703 P2801 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_014_25d003bd.model
2022-11-28 21:32:56,806 P2801 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:52,  5.94it/s]  2%|▏         | 10/666 [00:00<00:15, 42.03it/s]  5%|▍         | 33/666 [00:00<00:05, 113.48it/s]  9%|▊         | 57/666 [00:00<00:03, 156.08it/s] 12%|█▏        | 80/666 [00:00<00:03, 180.19it/s] 15%|█▌        | 103/666 [00:00<00:02, 194.32it/s] 19%|█▉        | 126/666 [00:00<00:02, 203.07it/s] 22%|██▏       | 149/666 [00:00<00:02, 209.10it/s] 26%|██▌       | 172/666 [00:01<00:02, 213.30it/s] 29%|██▉       | 195/666 [00:01<00:02, 216.12it/s] 33%|███▎      | 217/666 [00:01<00:02, 216.89it/s] 36%|███▌      | 240/666 [00:01<00:01, 218.03it/s] 39%|███▉      | 263/666 [00:01<00:01, 218.85it/s] 43%|████▎     | 286/666 [00:01<00:01, 219.52it/s] 46%|████▋     | 309/666 [00:01<00:01, 219.78it/s] 50%|████▉     | 332/666 [00:01<00:01, 219.82it/s] 53%|█████▎    | 355/666 [00:01<00:01, 219.32it/s] 57%|█████▋    | 377/666 [00:01<00:01, 219.23it/s] 60%|█████▉    | 399/666 [00:02<00:01, 218.81it/s] 63%|██████▎   | 421/666 [00:02<00:01, 218.79it/s] 67%|██████▋   | 443/666 [00:02<00:01, 218.41it/s] 70%|██████▉   | 465/666 [00:02<00:00, 218.38it/s] 73%|███████▎  | 487/666 [00:02<00:00, 217.82it/s] 76%|███████▋  | 509/666 [00:02<00:00, 217.78it/s] 80%|███████▉  | 531/666 [00:02<00:00, 215.45it/s] 83%|████████▎ | 553/666 [00:02<00:00, 215.60it/s] 86%|████████▋ | 575/666 [00:02<00:00, 212.83it/s] 90%|████████▉ | 597/666 [00:02<00:00, 213.66it/s] 93%|█████████▎| 619/666 [00:03<00:00, 214.08it/s] 96%|█████████▌| 641/666 [00:03<00:00, 214.47it/s]100%|█████████▉| 663/666 [00:03<00:00, 209.49it/s]100%|██████████| 666/666 [00:03<00:00, 200.18it/s]
2022-11-28 21:33:00,590 P2801 INFO [Metrics] logloss: 4.992263 - AUC: 0.500165
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:16,  9.95it/s]  6%|▌         | 10/167 [00:00<00:03, 51.94it/s] 19%|█▊        | 31/167 [00:00<00:01, 118.72it/s] 31%|███       | 52/167 [00:00<00:00, 151.65it/s] 44%|████▎     | 73/167 [00:00<00:00, 170.55it/s] 56%|█████▋    | 94/167 [00:00<00:00, 181.93it/s] 69%|██████▉   | 115/167 [00:00<00:00, 189.72it/s] 81%|████████▏ | 136/167 [00:00<00:00, 194.48it/s] 94%|█████████▍| 157/167 [00:00<00:00, 198.10it/s]100%|██████████| 167/167 [00:01<00:00, 161.84it/s]
2022-11-28 21:33:01,736 P2801 INFO [Metrics] logloss: 4.997987 - AUC: 0.500113
2022-11-28 21:33:06,744 P4586 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "256",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_015_bad91adf",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:33:06,746 P4586 INFO Set up feature encoder...
2022-11-28 21:33:06,747 P4586 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:33:06,748 P4586 INFO Loading data...
2022-11-28 21:33:06,751 P4586 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:33:07,029 P4586 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:33:07,168 P4586 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:33:07,169 P4586 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:33:07,169 P4586 INFO Loading train data done.
2022-11-28 21:33:10,799 P4586 INFO Total number of parameters: 59431684.
2022-11-28 21:33:10,800 P4586 INFO Start training: 666 batches/epoch
2022-11-28 21:33:10,800 P4586 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:33:11.124 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:4586 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:33:11.155 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:4586 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:40,  1.14s/it]  1%|          | 4/666 [00:01<02:48,  3.94it/s]  1%|          | 7/666 [00:01<01:33,  7.07it/s]  2%|▏         | 10/666 [00:01<01:04, 10.11it/s]  2%|▏         | 13/666 [00:01<00:50, 12.85it/s]  2%|▏         | 16/666 [00:01<00:42, 15.22it/s]  3%|▎         | 19/666 [00:01<00:37, 17.17it/s]  3%|▎         | 22/666 [00:02<00:34, 18.71it/s]  4%|▍         | 25/666 [00:02<00:32, 19.89it/s]  4%|▍         | 28/666 [00:02<00:30, 20.76it/s]  5%|▍         | 31/666 [00:02<00:29, 21.41it/s]  5%|▌         | 34/666 [00:02<00:28, 21.89it/s]  6%|▌         | 37/666 [00:02<00:28, 22.20it/s]  6%|▌         | 40/666 [00:02<00:27, 22.46it/s]  6%|▋         | 43/666 [00:02<00:27, 22.63it/s]  7%|▋         | 46/666 [00:03<00:27, 22.74it/s]  7%|▋         | 49/666 [00:03<00:27, 22.84it/s]  8%|▊         | 52/666 [00:03<00:26, 22.90it/s]  8%|▊         | 55/666 [00:03<00:26, 22.94it/s]  9%|▊         | 58/666 [00:03<00:26, 22.97it/s]  9%|▉         | 61/666 [00:03<00:26, 22.98it/s] 10%|▉         | 64/666 [00:03<00:26, 23.00it/s] 10%|█         | 67/666 [00:04<00:26, 23.01it/s] 11%|█         | 70/666 [00:04<00:25, 23.02it/s] 11%|█         | 73/666 [00:04<00:25, 23.02it/s] 11%|█▏        | 76/666 [00:04<00:25, 23.02it/s] 12%|█▏        | 79/666 [00:04<00:25, 23.03it/s] 12%|█▏        | 82/666 [00:04<00:25, 23.03it/s] 13%|█▎        | 85/666 [00:04<00:25, 23.03it/s] 13%|█▎        | 88/666 [00:04<00:25, 23.04it/s] 14%|█▎        | 91/666 [00:05<00:24, 23.04it/s] 14%|█▍        | 94/666 [00:05<00:24, 23.05it/s] 15%|█▍        | 97/666 [00:05<00:24, 23.05it/s] 15%|█▌        | 100/666 [00:05<00:24, 23.06it/s] 15%|█▌        | 103/666 [00:05<00:24, 23.04it/s] 16%|█▌        | 106/666 [00:05<00:24, 23.04it/s] 16%|█▋        | 109/666 [00:05<00:24, 23.02it/s] 17%|█▋        | 112/666 [00:05<00:24, 23.01it/s] 17%|█▋        | 115/666 [00:06<00:23, 23.02it/s] 18%|█▊        | 118/666 [00:06<00:23, 23.02it/s] 18%|█▊        | 121/666 [00:06<00:23, 23.02it/s] 19%|█▊        | 124/666 [00:06<00:23, 23.00it/s] 19%|█▉        | 127/666 [00:06<00:23, 23.00it/s] 20%|█▉        | 130/666 [00:06<00:23, 23.01it/s] 20%|█▉        | 133/666 [00:06<00:23, 23.02it/s] 20%|██        | 136/666 [00:07<00:23, 23.03it/s] 21%|██        | 139/666 [00:07<00:22, 23.01it/s] 21%|██▏       | 142/666 [00:07<00:22, 23.02it/s] 22%|██▏       | 145/666 [00:07<00:22, 23.01it/s] 22%|██▏       | 148/666 [00:07<00:22, 23.02it/s] 23%|██▎       | 151/666 [00:07<00:22, 23.03it/s] 23%|██▎       | 154/666 [00:07<00:22, 23.04it/s] 24%|██▎       | 157/666 [00:07<00:22, 23.04it/s] 24%|██▍       | 160/666 [00:08<00:21, 23.04it/s] 24%|██▍       | 163/666 [00:08<00:21, 23.04it/s] 25%|██▍       | 166/666 [00:08<00:21, 23.04it/s] 25%|██▌       | 169/666 [00:08<00:21, 23.02it/s] 26%|██▌       | 172/666 [00:08<00:21, 23.02it/s] 26%|██▋       | 175/666 [00:08<00:21, 23.00it/s] 27%|██▋       | 178/666 [00:08<00:21, 23.02it/s] 27%|██▋       | 181/666 [00:08<00:21, 23.01it/s] 28%|██▊       | 184/666 [00:09<00:20, 23.03it/s] 28%|██▊       | 187/666 [00:09<00:20, 23.03it/s] 29%|██▊       | 190/666 [00:09<00:20, 23.02it/s] 29%|██▉       | 193/666 [00:09<00:20, 23.01it/s] 29%|██▉       | 196/666 [00:09<00:20, 23.02it/s] 30%|██▉       | 199/666 [00:09<00:20, 23.03it/s] 30%|███       | 202/666 [00:09<00:20, 23.00it/s] 31%|███       | 205/666 [00:10<00:20, 23.01it/s] 31%|███       | 208/666 [00:10<00:19, 23.02it/s] 32%|███▏      | 211/666 [00:10<00:19, 23.02it/s] 32%|███▏      | 214/666 [00:10<00:19, 23.01it/s] 33%|███▎      | 217/666 [00:10<00:19, 23.02it/s] 33%|███▎      | 220/666 [00:10<00:19, 23.03it/s] 33%|███▎      | 223/666 [00:10<00:19, 23.03it/s] 34%|███▍      | 226/666 [00:10<00:19, 23.02it/s] 34%|███▍      | 229/666 [00:11<00:18, 23.02it/s] 35%|███▍      | 232/666 [00:11<00:18, 23.00it/s] 35%|███▌      | 235/666 [00:11<00:18, 23.00it/s] 36%|███▌      | 238/666 [00:11<00:18, 23.01it/s] 36%|███▌      | 241/666 [00:11<00:18, 23.01it/s] 37%|███▋      | 244/666 [00:11<00:18, 23.02it/s] 37%|███▋      | 247/666 [00:11<00:18, 23.02it/s] 38%|███▊      | 250/666 [00:11<00:18, 23.01it/s] 38%|███▊      | 253/666 [00:12<00:17, 23.01it/s] 38%|███▊      | 256/666 [00:12<00:17, 23.00it/s] 39%|███▉      | 259/666 [00:12<00:17, 23.02it/s] 39%|███▉      | 262/666 [00:12<00:17, 23.01it/s] 40%|███▉      | 265/666 [00:12<00:17, 23.01it/s] 40%|████      | 268/666 [00:12<00:17, 23.00it/s] 41%|████      | 271/666 [00:12<00:17, 23.01it/s] 41%|████      | 274/666 [00:13<00:17, 23.01it/s] 42%|████▏     | 277/666 [00:13<00:16, 23.01it/s] 42%|████▏     | 280/666 [00:13<00:16, 23.02it/s] 42%|████▏     | 283/666 [00:13<00:16, 23.03it/s] 43%|████▎     | 286/666 [00:13<00:16, 23.03it/s] 43%|████▎     | 289/666 [00:13<00:16, 23.02it/s] 44%|████▍     | 292/666 [00:13<00:16, 23.03it/s] 44%|████▍     | 295/666 [00:13<00:16, 23.04it/s] 45%|████▍     | 298/666 [00:14<00:15, 23.01it/s] 45%|████▌     | 301/666 [00:14<00:15, 23.02it/s] 46%|████▌     | 304/666 [00:14<00:15, 23.02it/s] 46%|████▌     | 307/666 [00:14<00:15, 23.02it/s] 47%|████▋     | 310/666 [00:14<00:15, 23.02it/s] 47%|████▋     | 313/666 [00:14<00:15, 23.02it/s] 47%|████▋     | 316/666 [00:14<00:15, 23.03it/s] 48%|████▊     | 319/666 [00:14<00:15, 23.01it/s] 48%|████▊     | 322/666 [00:15<00:14, 23.01it/s] 49%|████▉     | 325/666 [00:15<00:14, 23.00it/s] 49%|████▉     | 328/666 [00:15<00:14, 22.99it/s] 50%|████▉     | 331/666 [00:15<00:14, 23.00it/s] 50%|█████     | 334/666 [00:15<00:14, 23.00it/s] 51%|█████     | 337/666 [00:15<00:14, 23.01it/s] 51%|█████     | 340/666 [00:15<00:14, 23.02it/s] 52%|█████▏    | 343/666 [00:16<00:14, 23.02it/s] 52%|█████▏    | 346/666 [00:16<00:13, 23.04it/s] 52%|█████▏    | 349/666 [00:16<00:13, 23.03it/s] 53%|█████▎    | 352/666 [00:16<00:13, 23.03it/s] 53%|█████▎    | 355/666 [00:16<00:13, 23.01it/s] 54%|█████▍    | 358/666 [00:16<00:13, 23.00it/s] 54%|█████▍    | 361/666 [00:16<00:13, 23.01it/s] 55%|█████▍    | 364/666 [00:16<00:13, 23.02it/s] 55%|█████▌    | 367/666 [00:17<00:12, 23.02it/s] 56%|█████▌    | 370/666 [00:17<00:12, 23.02it/s] 56%|█████▌    | 373/666 [00:17<00:12, 23.03it/s] 56%|█████▋    | 376/666 [00:17<00:12, 23.02it/s] 57%|█████▋    | 379/666 [00:17<00:12, 23.01it/s] 57%|█████▋    | 382/666 [00:17<00:12, 23.01it/s] 58%|█████▊    | 385/666 [00:17<00:12, 23.00it/s] 58%|█████▊    | 388/666 [00:17<00:12, 23.01it/s] 59%|█████▊    | 391/666 [00:18<00:11, 23.01it/s] 59%|█████▉    | 394/666 [00:18<00:11, 23.02it/s] 60%|█████▉    | 397/666 [00:18<00:11, 23.02it/s] 60%|██████    | 400/666 [00:18<00:11, 23.03it/s] 61%|██████    | 403/666 [00:18<00:11, 23.03it/s] 61%|██████    | 406/666 [00:18<00:11, 23.02it/s] 61%|██████▏   | 409/666 [00:18<00:11, 23.03it/s] 62%|██████▏   | 412/666 [00:19<00:11, 23.02it/s] 62%|██████▏   | 415/666 [00:19<00:10, 22.91it/s] 63%|██████▎   | 418/666 [00:19<00:10, 22.95it/s] 63%|██████▎   | 421/666 [00:19<00:10, 22.98it/s] 64%|██████▎   | 424/666 [00:19<00:10, 23.00it/s] 64%|██████▍   | 427/666 [00:19<00:10, 23.00it/s] 65%|██████▍   | 430/666 [00:19<00:10, 23.02it/s] 65%|██████▌   | 433/666 [00:19<00:10, 23.02it/s] 65%|██████▌   | 436/666 [00:20<00:09, 23.02it/s] 66%|██████▌   | 439/666 [00:20<00:09, 23.03it/s] 66%|██████▋   | 442/666 [00:20<00:09, 23.01it/s] 67%|██████▋   | 445/666 [00:20<00:09, 23.01it/s] 67%|██████▋   | 448/666 [00:20<00:09, 23.01it/s] 68%|██████▊   | 451/666 [00:20<00:09, 23.02it/s] 68%|██████▊   | 454/666 [00:20<00:09, 23.02it/s] 69%|██████▊   | 457/666 [00:20<00:09, 23.03it/s] 69%|██████▉   | 460/666 [00:21<00:08, 23.03it/s] 70%|██████▉   | 463/666 [00:21<00:08, 23.04it/s] 70%|██████▉   | 466/666 [00:21<00:08, 23.04it/s] 70%|███████   | 469/666 [00:21<00:08, 23.03it/s] 71%|███████   | 472/666 [00:21<00:08, 23.01it/s] 71%|███████▏  | 475/666 [00:21<00:08, 23.01it/s] 72%|███████▏  | 478/666 [00:21<00:08, 23.01it/s] 72%|███████▏  | 481/666 [00:22<00:08, 23.01it/s] 73%|███████▎  | 484/666 [00:22<00:07, 23.02it/s] 73%|███████▎  | 487/666 [00:22<00:07, 23.02it/s] 74%|███████▎  | 490/666 [00:22<00:07, 23.02it/s] 74%|███████▍  | 493/666 [00:22<00:07, 23.03it/s] 74%|███████▍  | 496/666 [00:22<00:07, 23.03it/s] 75%|███████▍  | 499/666 [00:22<00:07, 23.04it/s] 75%|███████▌  | 502/666 [00:22<00:07, 23.03it/s] 76%|███████▌  | 505/666 [00:23<00:06, 23.03it/s] 76%|███████▋  | 508/666 [00:23<00:06, 23.02it/s] 77%|███████▋  | 511/666 [00:23<00:06, 23.01it/s] 77%|███████▋  | 514/666 [00:23<00:06, 23.02it/s] 78%|███████▊  | 517/666 [00:23<00:06, 23.02it/s] 78%|███████▊  | 520/666 [00:23<00:06, 23.03it/s] 79%|███████▊  | 523/666 [00:23<00:06, 23.03it/s] 79%|███████▉  | 526/666 [00:23<00:06, 23.03it/s] 79%|███████▉  | 529/666 [00:24<00:05, 23.04it/s] 80%|███████▉  | 532/666 [00:24<00:05, 23.04it/s] 80%|████████  | 535/666 [00:24<00:05, 23.03it/s] 81%|████████  | 538/666 [00:24<00:05, 23.03it/s] 81%|████████  | 541/666 [00:24<00:05, 22.99it/s] 82%|████████▏ | 544/666 [00:24<00:05, 23.03it/s] 82%|████████▏ | 547/666 [00:24<00:05, 23.02it/s] 83%|████████▎ | 550/666 [00:25<00:05, 23.02it/s] 83%|████████▎ | 553/666 [00:25<00:04, 23.03it/s] 83%|████████▎ | 556/666 [00:25<00:04, 23.03it/s] 84%|████████▍ | 559/666 [00:25<00:04, 23.02it/s] 84%|████████▍ | 562/666 [00:25<00:04, 23.01it/s] 85%|████████▍ | 565/666 [00:25<00:04, 23.01it/s] 85%|████████▌ | 568/666 [00:25<00:04, 23.01it/s] 86%|████████▌ | 571/666 [00:25<00:04, 23.01it/s] 86%|████████▌ | 574/666 [00:26<00:04, 23.00it/s] 87%|████████▋ | 577/666 [00:26<00:03, 23.01it/s] 87%|████████▋ | 580/666 [00:26<00:03, 23.01it/s] 88%|████████▊ | 583/666 [00:26<00:03, 23.03it/s] 88%|████████▊ | 586/666 [00:26<00:03, 23.04it/s] 88%|████████▊ | 589/666 [00:26<00:03, 23.03it/s] 89%|████████▉ | 592/666 [00:26<00:03, 23.02it/s] 89%|████████▉ | 595/666 [00:26<00:03, 23.02it/s] 90%|████████▉ | 598/666 [00:27<00:02, 23.02it/s] 90%|█████████ | 601/666 [00:27<00:02, 23.00it/s] 91%|█████████ | 604/666 [00:27<00:02, 23.01it/s] 91%|█████████ | 607/666 [00:27<00:02, 23.02it/s] 92%|█████████▏| 610/666 [00:27<00:02, 23.02it/s] 92%|█████████▏| 613/666 [00:27<00:02, 23.02it/s] 92%|█████████▏| 616/666 [00:27<00:02, 23.02it/s] 93%|█████████▎| 619/666 [00:28<00:02, 23.03it/s] 93%|█████████▎| 622/666 [00:28<00:01, 23.02it/s] 94%|█████████▍| 625/666 [00:28<00:01, 23.02it/s] 94%|█████████▍| 628/666 [00:28<00:01, 23.02it/s] 95%|█████████▍| 631/666 [00:28<00:01, 23.01it/s] 95%|█████████▌| 634/666 [00:28<00:01, 23.01it/s] 96%|█████████▌| 637/666 [00:28<00:01, 23.01it/s] 96%|█████████▌| 640/666 [00:28<00:01, 23.02it/s] 97%|█████████▋| 643/666 [00:29<00:00, 23.03it/s] 97%|█████████▋| 646/666 [00:29<00:00, 23.03it/s] 97%|█████████▋| 649/666 [00:29<00:00, 23.02it/s] 98%|█████████▊| 652/666 [00:29<00:00, 23.02it/s] 98%|█████████▊| 655/666 [00:29<00:00, 23.03it/s] 99%|█████████▉| 658/666 [00:29<00:00, 23.02it/s] 99%|█████████▉| 661/666 [00:29<00:00, 22.72it/s]100%|█████████▉| 664/666 [00:29<00:00, 22.86it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 2/167 [00:00<00:08, 18.61it/s][A
  6%|▌         | 10/167 [00:00<00:03, 50.58it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 126.60it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 164.17it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 185.15it/s][A
 61%|██████    | 102/167 [00:00<00:00, 198.02it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 206.03it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 211.20it/s][A100%|██████████| 167/167 [00:00<00:00, 173.22it/s]
2022-11-28 21:33:41,925 P4586 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:33:41,926 P4586 INFO Save best model: monitor(max): -4.497136
2022-11-28 21:33:44,335 P4586 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:33<00:00, 19.84it/s]
2022-11-28 21:33:44,374 P4586 INFO Train loss: 54.673207
2022-11-28 21:33:44,374 P4586 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:05,  5.31it/s]  1%|          | 4/666 [00:00<00:48, 13.72it/s]  1%|          | 7/666 [00:00<00:38, 17.31it/s]  2%|▏         | 10/666 [00:00<00:34, 19.12it/s]  2%|▏         | 13/666 [00:00<00:31, 20.42it/s]  2%|▏         | 16/666 [00:00<00:30, 21.27it/s]  3%|▎         | 19/666 [00:00<00:29, 21.84it/s]  3%|▎         | 22/666 [00:01<00:28, 22.22it/s]  4%|▍         | 25/666 [00:01<00:28, 22.47it/s]  4%|▍         | 28/666 [00:01<00:28, 22.66it/s]  5%|▍         | 31/666 [00:01<00:27, 22.77it/s]  5%|▌         | 34/666 [00:01<00:27, 22.86it/s]  6%|▌         | 37/666 [00:01<00:27, 22.92it/s]  6%|▌         | 40/666 [00:01<00:27, 22.95it/s]  6%|▋         | 43/666 [00:02<00:27, 22.98it/s]  7%|▋         | 46/666 [00:02<00:26, 23.00it/s]  7%|▋         | 49/666 [00:02<00:26, 23.00it/s]  8%|▊         | 52/666 [00:02<00:26, 22.99it/s]  8%|▊         | 55/666 [00:02<00:26, 23.01it/s]  9%|▊         | 58/666 [00:02<00:26, 23.02it/s]  9%|▉         | 61/666 [00:02<00:26, 23.03it/s] 10%|▉         | 64/666 [00:02<00:26, 23.02it/s] 10%|█         | 67/666 [00:03<00:26, 22.99it/s] 11%|█         | 70/666 [00:03<00:25, 23.01it/s] 11%|█         | 73/666 [00:03<00:25, 23.02it/s] 11%|█▏        | 76/666 [00:03<00:25, 23.02it/s] 12%|█▏        | 79/666 [00:03<00:25, 23.02it/s] 12%|█▏        | 82/666 [00:03<00:25, 23.02it/s] 13%|█▎        | 85/666 [00:03<00:25, 23.02it/s] 13%|█▎        | 88/666 [00:03<00:25, 23.01it/s] 14%|█▎        | 91/666 [00:04<00:24, 23.02it/s] 14%|█▍        | 94/666 [00:04<00:24, 23.02it/s] 15%|█▍        | 97/666 [00:04<00:24, 23.02it/s] 15%|█▌        | 100/666 [00:04<00:24, 23.01it/s] 15%|█▌        | 103/666 [00:04<00:24, 23.01it/s] 16%|█▌        | 106/666 [00:04<00:24, 23.01it/s] 16%|█▋        | 109/666 [00:04<00:24, 23.01it/s] 17%|█▋        | 112/666 [00:05<00:24, 23.00it/s] 17%|█▋        | 115/666 [00:05<00:23, 23.00it/s] 18%|█▊        | 118/666 [00:05<00:23, 23.00it/s] 18%|█▊        | 121/666 [00:05<00:23, 23.01it/s] 19%|█▊        | 124/666 [00:05<00:23, 23.00it/s] 19%|█▉        | 127/666 [00:05<00:23, 23.01it/s] 20%|█▉        | 130/666 [00:05<00:23, 23.01it/s] 20%|█▉        | 133/666 [00:05<00:23, 23.01it/s] 20%|██        | 136/666 [00:06<00:23, 23.02it/s] 21%|██        | 139/666 [00:06<00:22, 23.02it/s] 21%|██▏       | 142/666 [00:06<00:22, 23.03it/s] 22%|██▏       | 145/666 [00:06<00:22, 23.02it/s] 22%|██▏       | 148/666 [00:06<00:22, 23.02it/s] 23%|██▎       | 151/666 [00:06<00:22, 23.02it/s] 23%|██▎       | 154/666 [00:06<00:22, 23.03it/s] 24%|██▎       | 157/666 [00:06<00:22, 23.03it/s] 24%|██▍       | 160/666 [00:07<00:21, 23.03it/s] 24%|██▍       | 163/666 [00:07<00:21, 23.03it/s] 25%|██▍       | 166/666 [00:07<00:21, 23.00it/s] 25%|██▌       | 169/666 [00:07<00:21, 23.01it/s] 26%|██▌       | 172/666 [00:07<00:21, 22.99it/s] 26%|██▋       | 175/666 [00:07<00:21, 23.00it/s] 27%|██▋       | 178/666 [00:07<00:21, 22.98it/s] 27%|██▋       | 181/666 [00:08<00:21, 22.98it/s] 28%|██▊       | 184/666 [00:08<00:20, 22.99it/s] 28%|██▊       | 187/666 [00:08<00:20, 22.95it/s] 29%|██▊       | 190/666 [00:08<00:20, 22.97it/s] 29%|██▉       | 193/666 [00:08<00:20, 22.97it/s] 29%|██▉       | 196/666 [00:08<00:20, 23.00it/s] 30%|██▉       | 199/666 [00:08<00:20, 22.98it/s] 30%|███       | 202/666 [00:08<00:20, 22.98it/s] 31%|███       | 205/666 [00:09<00:20, 22.99it/s] 31%|███       | 208/666 [00:09<00:19, 22.99it/s] 32%|███▏      | 211/666 [00:09<00:19, 22.99it/s] 32%|███▏      | 214/666 [00:09<00:19, 22.98it/s] 33%|███▎      | 217/666 [00:09<00:19, 23.00it/s] 33%|███▎      | 220/666 [00:09<00:19, 22.98it/s] 33%|███▎      | 223/666 [00:09<00:19, 22.98it/s] 34%|███▍      | 226/666 [00:09<00:19, 22.99it/s] 34%|███▍      | 229/666 [00:10<00:19, 22.99it/s] 35%|███▍      | 232/666 [00:10<00:18, 22.99it/s] 35%|███▌      | 235/666 [00:10<00:18, 22.98it/s] 36%|███▌      | 238/666 [00:10<00:18, 22.99it/s] 36%|███▌      | 241/666 [00:10<00:18, 22.98it/s] 37%|███▋      | 244/666 [00:10<00:18, 22.99it/s] 37%|███▋      | 247/666 [00:10<00:18, 22.99it/s] 38%|███▊      | 250/666 [00:11<00:18, 22.98it/s] 38%|███▊      | 253/666 [00:11<00:17, 23.00it/s] 38%|███▊      | 256/666 [00:11<00:17, 22.99it/s] 39%|███▉      | 259/666 [00:11<00:17, 23.00it/s] 39%|███▉      | 262/666 [00:11<00:17, 22.99it/s] 40%|███▉      | 265/666 [00:11<00:17, 22.99it/s] 40%|████      | 268/666 [00:11<00:17, 23.00it/s] 41%|████      | 271/666 [00:11<00:17, 23.00it/s] 41%|████      | 274/666 [00:12<00:17, 23.01it/s] 42%|████▏     | 277/666 [00:12<00:16, 22.99it/s] 42%|████▏     | 280/666 [00:12<00:16, 22.99it/s] 42%|████▏     | 283/666 [00:12<00:16, 23.00it/s] 43%|████▎     | 286/666 [00:12<00:16, 23.00it/s] 43%|████▎     | 289/666 [00:12<00:16, 23.01it/s] 44%|████▍     | 292/666 [00:12<00:16, 23.00it/s] 44%|████▍     | 295/666 [00:12<00:16, 23.01it/s] 45%|████▍     | 298/666 [00:13<00:15, 23.01it/s] 45%|████▌     | 301/666 [00:13<00:15, 23.00it/s] 46%|████▌     | 304/666 [00:13<00:15, 22.99it/s] 46%|████▌     | 307/666 [00:13<00:15, 22.99it/s] 47%|████▋     | 310/666 [00:13<00:15, 23.00it/s] 47%|████▋     | 313/666 [00:13<00:15, 23.00it/s] 47%|████▋     | 316/666 [00:13<00:15, 23.00it/s] 48%|████▊     | 319/666 [00:14<00:15, 23.00it/s] 48%|████▊     | 322/666 [00:14<00:14, 23.01it/s] 49%|████▉     | 325/666 [00:14<00:14, 23.02it/s] 49%|████▉     | 328/666 [00:14<00:14, 23.01it/s] 50%|████▉     | 331/666 [00:14<00:14, 23.01it/s] 50%|█████     | 334/666 [00:14<00:14, 22.99it/s] 51%|█████     | 337/666 [00:14<00:14, 23.01it/s] 51%|█████     | 340/666 [00:14<00:14, 22.99it/s] 52%|█████▏    | 343/666 [00:15<00:14, 23.00it/s] 52%|█████▏    | 346/666 [00:15<00:13, 23.00it/s] 52%|█████▏    | 349/666 [00:15<00:13, 22.99it/s] 53%|█████▎    | 352/666 [00:15<00:13, 23.01it/s] 53%|█████▎    | 355/666 [00:15<00:13, 23.00it/s] 54%|█████▍    | 358/666 [00:15<00:13, 23.00it/s] 54%|█████▍    | 361/666 [00:15<00:13, 23.01it/s] 55%|█████▍    | 364/666 [00:15<00:13, 23.01it/s] 55%|█████▌    | 367/666 [00:16<00:12, 23.00it/s] 56%|█████▌    | 370/666 [00:16<00:12, 22.98it/s] 56%|█████▌    | 373/666 [00:16<00:12, 22.98it/s] 56%|█████▋    | 376/666 [00:16<00:12, 22.99it/s] 57%|█████▋    | 379/666 [00:16<00:12, 23.00it/s] 57%|█████▋    | 382/666 [00:16<00:12, 23.00it/s] 58%|█████▊    | 385/666 [00:16<00:12, 22.97it/s] 58%|█████▊    | 388/666 [00:17<00:12, 22.98it/s] 59%|█████▊    | 391/666 [00:17<00:11, 22.98it/s] 59%|█████▉    | 394/666 [00:17<00:11, 22.99it/s] 60%|█████▉    | 397/666 [00:17<00:11, 22.98it/s] 60%|██████    | 400/666 [00:17<00:11, 22.99it/s] 61%|██████    | 403/666 [00:17<00:11, 22.99it/s] 61%|██████    | 406/666 [00:17<00:11, 23.00it/s] 61%|██████▏   | 409/666 [00:17<00:11, 22.99it/s] 62%|██████▏   | 412/666 [00:18<00:11, 22.98it/s] 62%|██████▏   | 415/666 [00:18<00:10, 23.00it/s] 63%|██████▎   | 418/666 [00:18<00:10, 23.00it/s] 63%|██████▎   | 421/666 [00:18<00:10, 22.99it/s] 64%|██████▎   | 424/666 [00:18<00:10, 22.99it/s] 64%|██████▍   | 427/666 [00:18<00:10, 22.99it/s] 65%|██████▍   | 430/666 [00:18<00:10, 22.99it/s] 65%|██████▌   | 433/666 [00:18<00:10, 23.00it/s] 65%|██████▌   | 436/666 [00:19<00:09, 23.01it/s] 66%|██████▌   | 439/666 [00:19<00:09, 23.01it/s] 66%|██████▋   | 442/666 [00:19<00:09, 23.01it/s] 67%|██████▋   | 445/666 [00:19<00:09, 23.01it/s] 67%|██████▋   | 448/666 [00:19<00:09, 23.01it/s] 68%|██████▊   | 451/666 [00:19<00:09, 23.00it/s] 68%|██████▊   | 454/666 [00:19<00:09, 23.00it/s] 69%|██████▊   | 457/666 [00:20<00:09, 23.01it/s] 69%|██████▉   | 460/666 [00:20<00:08, 23.02it/s] 70%|██████▉   | 463/666 [00:20<00:08, 23.02it/s] 70%|██████▉   | 466/666 [00:20<00:08, 23.01it/s] 70%|███████   | 469/666 [00:20<00:08, 23.00it/s] 71%|███████   | 472/666 [00:20<00:08, 23.01it/s] 71%|███████▏  | 475/666 [00:20<00:08, 23.01it/s] 72%|███████▏  | 478/666 [00:20<00:08, 23.01it/s] 72%|███████▏  | 481/666 [00:21<00:08, 23.01it/s] 73%|███████▎  | 484/666 [00:21<00:07, 23.01it/s] 73%|███████▎  | 487/666 [00:21<00:07, 23.01it/s] 74%|███████▎  | 490/666 [00:21<00:07, 23.02it/s] 74%|███████▍  | 493/666 [00:21<00:07, 23.02it/s] 74%|███████▍  | 496/666 [00:21<00:07, 23.01it/s] 75%|███████▍  | 499/666 [00:21<00:07, 23.00it/s] 75%|███████▌  | 502/666 [00:21<00:07, 23.00it/s] 76%|███████▌  | 505/666 [00:22<00:07, 22.99it/s] 76%|███████▋  | 508/666 [00:22<00:06, 22.99it/s] 77%|███████▋  | 511/666 [00:22<00:06, 23.00it/s] 77%|███████▋  | 514/666 [00:22<00:06, 23.02it/s] 78%|███████▊  | 517/666 [00:22<00:06, 23.01it/s] 78%|███████▊  | 520/666 [00:22<00:06, 23.01it/s] 79%|███████▊  | 523/666 [00:22<00:06, 23.01it/s] 79%|███████▉  | 526/666 [00:23<00:06, 22.99it/s] 79%|███████▉  | 529/666 [00:23<00:05, 22.99it/s] 80%|███████▉  | 532/666 [00:23<00:05, 22.99it/s] 80%|████████  | 535/666 [00:23<00:05, 22.80it/s] 81%|████████  | 538/666 [00:23<00:05, 22.83it/s] 81%|████████  | 541/666 [00:23<00:05, 22.88it/s] 82%|████████▏ | 544/666 [00:23<00:05, 22.91it/s] 82%|████████▏ | 547/666 [00:23<00:05, 22.94it/s] 83%|████████▎ | 550/666 [00:24<00:05, 22.96it/s] 83%|████████▎ | 553/666 [00:24<00:04, 22.96it/s] 83%|████████▎ | 556/666 [00:24<00:04, 22.97it/s] 84%|████████▍ | 559/666 [00:24<00:04, 22.98it/s] 84%|████████▍ | 562/666 [00:24<00:04, 22.98it/s] 85%|████████▍ | 565/666 [00:24<00:04, 22.98it/s] 85%|████████▌ | 568/666 [00:24<00:04, 22.99it/s] 86%|████████▌ | 571/666 [00:24<00:04, 22.98it/s] 86%|████████▌ | 574/666 [00:25<00:04, 22.99it/s] 87%|████████▋ | 577/666 [00:25<00:03, 23.00it/s] 87%|████████▋ | 580/666 [00:25<00:03, 23.00it/s] 88%|████████▊ | 583/666 [00:25<00:03, 23.02it/s] 88%|████████▊ | 586/666 [00:25<00:03, 23.01it/s] 88%|████████▊ | 589/666 [00:25<00:03, 23.00it/s] 89%|████████▉ | 592/666 [00:25<00:03, 22.99it/s] 89%|████████▉ | 595/666 [00:26<00:03, 23.00it/s] 90%|████████▉ | 598/666 [00:26<00:02, 23.00it/s] 90%|█████████ | 601/666 [00:26<00:02, 23.00it/s] 91%|█████████ | 604/666 [00:26<00:02, 23.01it/s] 91%|█████████ | 607/666 [00:26<00:02, 22.99it/s] 92%|█████████▏| 610/666 [00:26<00:02, 22.99it/s] 92%|█████████▏| 613/666 [00:26<00:02, 22.99it/s] 92%|█████████▏| 616/666 [00:26<00:02, 23.00it/s] 93%|█████████▎| 619/666 [00:27<00:02, 23.01it/s] 93%|█████████▎| 622/666 [00:27<00:01, 23.01it/s] 94%|█████████▍| 625/666 [00:27<00:01, 23.01it/s] 94%|█████████▍| 628/666 [00:27<00:01, 23.01it/s] 95%|█████████▍| 631/666 [00:27<00:01, 23.00it/s] 95%|█████████▌| 634/666 [00:27<00:01, 23.00it/s] 96%|█████████▌| 637/666 [00:27<00:01, 23.01it/s] 96%|█████████▌| 640/666 [00:27<00:01, 23.00it/s] 97%|█████████▋| 643/666 [00:28<00:01, 22.99it/s] 97%|█████████▋| 646/666 [00:28<00:00, 22.99it/s] 97%|█████████▋| 649/666 [00:28<00:00, 22.98it/s] 98%|█████████▊| 652/666 [00:28<00:00, 23.00it/s] 98%|█████████▊| 655/666 [00:28<00:00, 22.99it/s] 99%|█████████▉| 658/666 [00:28<00:00, 23.00it/s] 99%|█████████▉| 661/666 [00:28<00:00, 22.72it/s]100%|█████████▉| 664/666 [00:29<00:00, 22.85it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  2%|▏         | 3/167 [00:00<00:08, 20.14it/s][A
  7%|▋         | 11/167 [00:00<00:03, 48.18it/s][A
 20%|██        | 34/167 [00:00<00:01, 120.88it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 159.84it/s][A
 48%|████▊     | 80/167 [00:00<00:00, 182.76it/s][A
 62%|██████▏   | 103/167 [00:00<00:00, 197.18it/s][A
 75%|███████▌  | 126/167 [00:00<00:00, 206.06it/s][A
 89%|████████▉ | 149/167 [00:00<00:00, 212.45it/s][A100%|██████████| 167/167 [00:00<00:00, 167.70it/s]
2022-11-28 21:34:14,602 P4586 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:34:14,603 P4586 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:34:14,603 P4586 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:34:14,603 P4586 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:30<00:00, 21.99it/s]
2022-11-28 21:34:14,655 P4586 INFO Train loss: 30.971723
2022-11-28 21:34:14,655 P4586 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:09,  5.15it/s]  1%|          | 4/666 [00:00<00:47, 13.81it/s]  1%|          | 7/666 [00:00<00:37, 17.60it/s]  2%|▏         | 10/666 [00:00<00:33, 19.46it/s]  2%|▏         | 13/666 [00:00<00:31, 20.62it/s]  2%|▏         | 16/666 [00:00<00:30, 21.39it/s]  3%|▎         | 19/666 [00:00<00:29, 21.89it/s]  3%|▎         | 22/666 [00:01<00:28, 22.21it/s]  4%|▍         | 25/666 [00:01<00:28, 22.45it/s]  4%|▍         | 28/666 [00:01<00:28, 22.61it/s]  5%|▍         | 31/666 [00:01<00:27, 22.72it/s]  5%|▌         | 34/666 [00:01<00:27, 22.79it/s]  6%|▌         | 37/666 [00:01<00:27, 22.86it/s]  6%|▌         | 40/666 [00:01<00:27, 22.90it/s]  6%|▋         | 43/666 [00:02<00:27, 22.91it/s]  7%|▋         | 46/666 [00:02<00:27, 22.93it/s]  7%|▋         | 49/666 [00:02<00:26, 22.93it/s]  8%|▊         | 52/666 [00:02<00:26, 22.95it/s]  8%|▊         | 55/666 [00:02<00:26, 22.94it/s]  9%|▊         | 58/666 [00:02<00:26, 22.93it/s]  9%|▉         | 61/666 [00:02<00:26, 22.94it/s] 10%|▉         | 64/666 [00:02<00:26, 22.95it/s] 10%|█         | 67/666 [00:03<00:26, 22.96it/s] 11%|█         | 70/666 [00:03<00:25, 22.97it/s] 11%|█         | 73/666 [00:03<00:25, 22.97it/s] 11%|█▏        | 76/666 [00:03<00:25, 22.97it/s] 12%|█▏        | 79/666 [00:03<00:25, 22.97it/s] 12%|█▏        | 82/666 [00:03<00:25, 22.96it/s] 13%|█▎        | 85/666 [00:03<00:25, 22.98it/s] 13%|█▎        | 88/666 [00:03<00:25, 22.98it/s] 14%|█▎        | 91/666 [00:04<00:25, 22.98it/s] 14%|█▍        | 94/666 [00:04<00:24, 22.98it/s] 15%|█▍        | 97/666 [00:04<00:24, 22.98it/s] 15%|█▌        | 100/666 [00:04<00:24, 22.98it/s] 15%|█▌        | 103/666 [00:04<00:24, 22.97it/s] 16%|█▌        | 106/666 [00:04<00:24, 22.98it/s] 16%|█▋        | 109/666 [00:04<00:24, 22.98it/s] 17%|█▋        | 112/666 [00:05<00:24, 22.98it/s] 17%|█▋        | 115/666 [00:05<00:23, 22.99it/s] 18%|█▊        | 118/666 [00:05<00:23, 22.99it/s] 18%|█▊        | 121/666 [00:05<00:23, 23.00it/s] 19%|█▊        | 124/666 [00:05<00:23, 23.00it/s] 19%|█▉        | 127/666 [00:05<00:23, 22.98it/s] 20%|█▉        | 130/666 [00:05<00:23, 22.97it/s] 20%|█▉        | 133/666 [00:05<00:23, 22.98it/s] 20%|██        | 136/666 [00:06<00:23, 22.97it/s] 21%|██        | 139/666 [00:06<00:22, 22.98it/s] 21%|██▏       | 142/666 [00:06<00:22, 22.96it/s] 22%|██▏       | 145/666 [00:06<00:22, 22.96it/s] 22%|██▏       | 148/666 [00:06<00:22, 22.97it/s] 23%|██▎       | 151/666 [00:06<00:22, 22.97it/s] 23%|██▎       | 154/666 [00:06<00:22, 22.98it/s] 24%|██▎       | 157/666 [00:06<00:22, 22.99it/s] 24%|██▍       | 160/666 [00:07<00:21, 23.00it/s] 24%|██▍       | 163/666 [00:07<00:21, 23.00it/s] 25%|██▍       | 166/666 [00:07<00:21, 23.01it/s] 25%|██▌       | 169/666 [00:07<00:21, 22.99it/s] 26%|██▌       | 172/666 [00:07<00:21, 22.97it/s] 26%|██▋       | 175/666 [00:07<00:21, 22.97it/s] 27%|██▋       | 178/666 [00:07<00:21, 22.97it/s] 27%|██▋       | 181/666 [00:08<00:21, 22.97it/s] 28%|██▊       | 184/666 [00:08<00:20, 22.97it/s] 28%|██▊       | 187/666 [00:08<00:20, 22.96it/s] 29%|██▊       | 190/666 [00:08<00:20, 22.97it/s] 29%|██▉       | 193/666 [00:08<00:20, 22.97it/s] 29%|██▉       | 196/666 [00:08<00:20, 22.97it/s] 30%|██▉       | 199/666 [00:08<00:20, 22.98it/s] 30%|███       | 202/666 [00:08<00:20, 22.98it/s] 31%|███       | 205/666 [00:09<00:20, 22.97it/s] 31%|███       | 208/666 [00:09<00:19, 22.97it/s] 32%|███▏      | 211/666 [00:09<00:19, 22.97it/s] 32%|███▏      | 214/666 [00:09<00:19, 22.98it/s] 33%|███▎      | 217/666 [00:09<00:19, 22.98it/s] 33%|███▎      | 220/666 [00:09<00:19, 22.97it/s] 33%|███▎      | 223/666 [00:09<00:19, 22.98it/s] 34%|███▍      | 226/666 [00:09<00:19, 22.98it/s] 34%|███▍      | 229/666 [00:10<00:19, 22.98it/s] 35%|███▍      | 232/666 [00:10<00:18, 22.98it/s] 35%|███▌      | 235/666 [00:10<00:18, 22.97it/s] 36%|███▌      | 238/666 [00:10<00:18, 22.97it/s] 36%|███▌      | 241/666 [00:10<00:18, 22.98it/s] 37%|███▋      | 244/666 [00:10<00:18, 22.97it/s] 37%|███▋      | 247/666 [00:10<00:18, 22.97it/s] 38%|███▊      | 250/666 [00:11<00:18, 22.97it/s] 38%|███▊      | 253/666 [00:11<00:17, 22.98it/s] 38%|███▊      | 256/666 [00:11<00:17, 22.98it/s] 39%|███▉      | 259/666 [00:11<00:17, 22.97it/s] 39%|███▉      | 262/666 [00:11<00:17, 22.98it/s] 40%|███▉      | 265/666 [00:11<00:17, 22.97it/s] 40%|████      | 268/666 [00:11<00:17, 22.97it/s] 41%|████      | 271/666 [00:11<00:17, 22.96it/s] 41%|████      | 274/666 [00:12<00:17, 22.97it/s] 42%|████▏     | 277/666 [00:12<00:16, 22.97it/s] 42%|████▏     | 280/666 [00:12<00:16, 22.97it/s] 42%|████▏     | 283/666 [00:12<00:16, 22.98it/s] 43%|████▎     | 286/666 [00:12<00:16, 22.98it/s] 43%|████▎     | 289/666 [00:12<00:16, 22.97it/s] 44%|████▍     | 292/666 [00:12<00:16, 22.95it/s] 44%|████▍     | 295/666 [00:12<00:16, 22.96it/s] 45%|████▍     | 298/666 [00:13<00:16, 22.96it/s] 45%|████▌     | 301/666 [00:13<00:15, 22.96it/s] 46%|████▌     | 304/666 [00:13<00:15, 22.97it/s] 46%|████▌     | 307/666 [00:13<00:15, 22.97it/s] 47%|████▋     | 310/666 [00:13<00:15, 22.97it/s] 47%|████▋     | 313/666 [00:13<00:15, 22.97it/s] 47%|████▋     | 316/666 [00:13<00:15, 22.98it/s] 48%|████▊     | 319/666 [00:14<00:15, 22.97it/s] 48%|████▊     | 322/666 [00:14<00:14, 22.96it/s] 49%|████▉     | 325/666 [00:14<00:14, 22.97it/s] 49%|████▉     | 328/666 [00:14<00:14, 22.96it/s] 50%|████▉     | 331/666 [00:14<00:14, 22.97it/s] 50%|█████     | 334/666 [00:14<00:14, 22.97it/s] 51%|█████     | 337/666 [00:14<00:14, 22.97it/s] 51%|█████     | 340/666 [00:14<00:14, 22.97it/s] 52%|█████▏    | 343/666 [00:15<00:14, 22.97it/s] 52%|█████▏    | 346/666 [00:15<00:13, 22.97it/s] 52%|█████▏    | 349/666 [00:15<00:13, 22.97it/s] 53%|█████▎    | 352/666 [00:15<00:13, 22.98it/s] 53%|█████▎    | 355/666 [00:15<00:13, 22.98it/s] 54%|█████▍    | 358/666 [00:15<00:13, 22.99it/s] 54%|█████▍    | 361/666 [00:15<00:13, 22.97it/s] 55%|█████▍    | 364/666 [00:15<00:13, 22.98it/s] 55%|█████▌    | 367/666 [00:16<00:13, 22.98it/s] 56%|█████▌    | 370/666 [00:16<00:12, 22.97it/s] 56%|█████▌    | 373/666 [00:16<00:12, 22.96it/s] 56%|█████▋    | 376/666 [00:16<00:12, 22.98it/s] 57%|█████▋    | 379/666 [00:16<00:12, 22.98it/s] 57%|█████▋    | 382/666 [00:16<00:12, 22.96it/s] 58%|█████▊    | 385/666 [00:16<00:12, 22.97it/s] 58%|█████▊    | 388/666 [00:17<00:12, 22.97it/s] 59%|█████▊    | 391/666 [00:17<00:11, 22.96it/s] 59%|█████▉    | 394/666 [00:17<00:11, 22.96it/s] 60%|█████▉    | 397/666 [00:17<00:11, 22.98it/s] 60%|██████    | 400/666 [00:17<00:11, 22.96it/s] 61%|██████    | 403/666 [00:17<00:11, 22.95it/s] 61%|██████    | 406/666 [00:17<00:11, 22.96it/s] 61%|██████▏   | 409/666 [00:17<00:11, 22.97it/s] 62%|██████▏   | 412/666 [00:18<00:11, 22.97it/s] 62%|██████▏   | 415/666 [00:18<00:10, 22.97it/s] 63%|██████▎   | 418/666 [00:18<00:10, 22.98it/s] 63%|██████▎   | 421/666 [00:18<00:10, 22.98it/s] 64%|██████▎   | 424/666 [00:18<00:10, 22.98it/s] 64%|██████▍   | 427/666 [00:18<00:10, 22.98it/s] 65%|██████▍   | 430/666 [00:18<00:10, 22.98it/s] 65%|██████▌   | 433/666 [00:19<00:10, 22.98it/s] 65%|██████▌   | 436/666 [00:19<00:10, 22.98it/s] 66%|██████▌   | 439/666 [00:19<00:09, 22.98it/s] 66%|██████▋   | 442/666 [00:19<00:09, 22.97it/s] 67%|██████▋   | 445/666 [00:19<00:09, 22.97it/s] 67%|██████▋   | 448/666 [00:19<00:09, 22.97it/s] 68%|██████▊   | 451/666 [00:19<00:09, 22.96it/s] 68%|██████▊   | 454/666 [00:19<00:09, 22.96it/s] 69%|██████▊   | 457/666 [00:20<00:09, 22.96it/s] 69%|██████▉   | 460/666 [00:20<00:08, 22.97it/s] 70%|██████▉   | 463/666 [00:20<00:08, 22.97it/s] 70%|██████▉   | 466/666 [00:20<00:08, 22.98it/s] 70%|███████   | 469/666 [00:20<00:08, 22.98it/s] 71%|███████   | 472/666 [00:20<00:08, 22.98it/s] 71%|███████▏  | 475/666 [00:20<00:08, 22.98it/s] 72%|███████▏  | 478/666 [00:20<00:08, 22.97it/s] 72%|███████▏  | 481/666 [00:21<00:08, 22.98it/s] 73%|███████▎  | 484/666 [00:21<00:07, 22.97it/s] 73%|███████▎  | 487/666 [00:21<00:07, 22.98it/s] 74%|███████▎  | 490/666 [00:21<00:07, 22.98it/s] 74%|███████▍  | 493/666 [00:21<00:07, 22.98it/s] 74%|███████▍  | 496/666 [00:21<00:07, 22.98it/s] 75%|███████▍  | 499/666 [00:21<00:07, 22.98it/s] 75%|███████▌  | 502/666 [00:22<00:07, 22.99it/s] 76%|███████▌  | 505/666 [00:22<00:07, 22.99it/s] 76%|███████▋  | 508/666 [00:22<00:06, 22.99it/s] 77%|███████▋  | 511/666 [00:22<00:06, 22.99it/s] 77%|███████▋  | 514/666 [00:22<00:06, 22.98it/s] 78%|███████▊  | 517/666 [00:22<00:06, 22.99it/s] 78%|███████▊  | 520/666 [00:22<00:06, 22.99it/s] 79%|███████▊  | 523/666 [00:22<00:06, 22.98it/s] 79%|███████▉  | 526/666 [00:23<00:06, 22.98it/s] 79%|███████▉  | 529/666 [00:23<00:05, 22.99it/s] 80%|███████▉  | 532/666 [00:23<00:05, 22.97it/s] 80%|████████  | 535/666 [00:23<00:05, 22.98it/s] 81%|████████  | 538/666 [00:23<00:05, 22.98it/s] 81%|████████  | 541/666 [00:23<00:05, 22.98it/s] 82%|████████▏ | 544/666 [00:23<00:05, 22.95it/s] 82%|████████▏ | 547/666 [00:23<00:05, 22.96it/s] 83%|████████▎ | 550/666 [00:24<00:05, 22.95it/s] 83%|████████▎ | 553/666 [00:24<00:04, 22.96it/s] 83%|████████▎ | 556/666 [00:24<00:04, 22.86it/s] 84%|████████▍ | 559/666 [00:24<00:04, 22.89it/s] 84%|████████▍ | 562/666 [00:24<00:04, 22.59it/s] 85%|████████▍ | 565/666 [00:24<00:04, 22.70it/s] 85%|████████▌ | 568/666 [00:24<00:04, 22.77it/s] 86%|████████▌ | 571/666 [00:25<00:04, 22.82it/s] 86%|████████▌ | 574/666 [00:25<00:04, 22.86it/s] 87%|████████▋ | 577/666 [00:25<00:03, 22.89it/s] 87%|████████▋ | 580/666 [00:25<00:03, 22.92it/s] 88%|████████▊ | 583/666 [00:25<00:03, 22.94it/s] 88%|████████▊ | 586/666 [00:25<00:03, 22.95it/s] 88%|████████▊ | 589/666 [00:25<00:03, 22.96it/s] 89%|████████▉ | 592/666 [00:25<00:03, 22.97it/s] 89%|████████▉ | 595/666 [00:26<00:03, 22.97it/s] 90%|████████▉ | 598/666 [00:26<00:02, 22.96it/s] 90%|█████████ | 601/666 [00:26<00:02, 22.96it/s] 91%|█████████ | 604/666 [00:26<00:02, 22.96it/s] 91%|█████████ | 607/666 [00:26<00:02, 22.97it/s] 92%|█████████▏| 610/666 [00:26<00:02, 22.97it/s] 92%|█████████▏| 613/666 [00:26<00:02, 22.95it/s] 92%|█████████▏| 616/666 [00:26<00:02, 22.96it/s] 93%|█████████▎| 619/666 [00:27<00:02, 22.97it/s] 93%|█████████▎| 622/666 [00:27<00:01, 22.98it/s] 94%|█████████▍| 625/666 [00:27<00:01, 22.98it/s] 94%|█████████▍| 628/666 [00:27<00:01, 22.98it/s] 95%|█████████▍| 631/666 [00:27<00:01, 22.97it/s] 95%|█████████▌| 634/666 [00:27<00:01, 22.98it/s] 96%|█████████▌| 637/666 [00:27<00:01, 22.98it/s] 96%|█████████▌| 640/666 [00:28<00:01, 22.96it/s] 97%|█████████▋| 643/666 [00:28<00:01, 22.97it/s] 97%|█████████▋| 646/666 [00:28<00:00, 22.96it/s] 97%|█████████▋| 649/666 [00:28<00:00, 22.97it/s] 98%|█████████▊| 652/666 [00:28<00:00, 22.98it/s] 98%|█████████▊| 655/666 [00:28<00:00, 22.97it/s] 99%|█████████▉| 658/666 [00:28<00:00, 22.97it/s] 99%|█████████▉| 661/666 [00:28<00:00, 22.59it/s]100%|█████████▉| 664/666 [00:29<00:00, 22.75it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:16,  9.95it/s][A
  6%|▌         | 10/167 [00:00<00:03, 52.00it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 127.71it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 165.34it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 186.47it/s][A
 61%|██████    | 102/167 [00:00<00:00, 199.21it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 207.68it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 213.26it/s][A100%|██████████| 167/167 [00:00<00:00, 175.23it/s]
2022-11-28 21:34:44,878 P4586 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:34:44,879 P4586 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:34:44,879 P4586 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:34:44,879 P4586 INFO Early stopping at epoch=3
2022-11-28 21:34:44,879 P4586 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:30<00:00, 21.97it/s]
2022-11-28 21:34:44,925 P4586 INFO Train loss: 30.971538
2022-11-28 21:34:44,925 P4586 INFO Training finished.
2022-11-28 21:34:44,925 P4586 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_015_bad91adf.model
2022-11-28 21:34:45,121 P4586 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:44,  6.38it/s]  2%|▏         | 10/666 [00:00<00:14, 45.13it/s]  5%|▍         | 32/666 [00:00<00:05, 113.39it/s]  8%|▊         | 55/666 [00:00<00:03, 154.58it/s] 12%|█▏        | 78/666 [00:00<00:03, 178.08it/s] 15%|█▌        | 100/666 [00:00<00:02, 191.60it/s] 18%|█▊        | 122/666 [00:00<00:02, 200.55it/s] 22%|██▏       | 145/666 [00:00<00:02, 207.41it/s] 25%|██▌       | 168/666 [00:00<00:02, 211.61it/s] 29%|██▊       | 191/666 [00:01<00:02, 214.70it/s] 32%|███▏      | 214/666 [00:01<00:02, 216.77it/s] 36%|███▌      | 237/666 [00:01<00:01, 218.16it/s] 39%|███▉      | 259/666 [00:01<00:01, 217.30it/s] 42%|████▏     | 281/666 [00:01<00:01, 217.81it/s] 45%|████▌     | 303/666 [00:01<00:01, 218.13it/s] 49%|████▉     | 326/666 [00:01<00:01, 218.85it/s] 52%|█████▏    | 348/666 [00:01<00:01, 218.79it/s] 56%|█████▌    | 370/666 [00:01<00:01, 218.97it/s] 59%|█████▉    | 392/666 [00:01<00:01, 218.65it/s] 62%|██████▏   | 414/666 [00:02<00:01, 218.74it/s] 65%|██████▌   | 436/666 [00:02<00:01, 218.48it/s] 69%|██████▉   | 458/666 [00:02<00:00, 218.32it/s] 72%|███████▏  | 480/666 [00:02<00:00, 218.07it/s] 75%|███████▌  | 502/666 [00:02<00:00, 218.20it/s] 79%|███████▊  | 524/666 [00:02<00:00, 218.35it/s] 82%|████████▏ | 546/666 [00:02<00:00, 218.00it/s] 85%|████████▌ | 568/666 [00:02<00:00, 217.67it/s] 89%|████████▊ | 590/666 [00:02<00:00, 218.00it/s] 92%|█████████▏| 612/666 [00:03<00:00, 217.25it/s] 95%|█████████▌| 634/666 [00:03<00:00, 217.41it/s] 98%|█████████▊| 656/666 [00:03<00:00, 212.36it/s]100%|██████████| 666/666 [00:03<00:00, 200.81it/s]
2022-11-28 21:34:48,887 P4586 INFO [Metrics] logloss: 4.992003 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  2%|▏         | 3/167 [00:00<00:05, 27.61it/s]  6%|▌         | 10/167 [00:00<00:03, 50.23it/s] 19%|█▊        | 31/167 [00:00<00:01, 119.18it/s] 31%|███       | 52/167 [00:00<00:00, 151.80it/s] 44%|████▎     | 73/167 [00:00<00:00, 169.81it/s] 56%|█████▋    | 94/167 [00:00<00:00, 181.30it/s] 69%|██████▉   | 115/167 [00:00<00:00, 189.04it/s] 81%|████████▏ | 136/167 [00:00<00:00, 193.94it/s] 94%|█████████▍| 157/167 [00:00<00:00, 198.04it/s]100%|██████████| 167/167 [00:01<00:00, 164.17it/s]
2022-11-28 21:34:50,019 P4586 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:34:56,833 P6371 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "64",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_016_75687b53",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:34:56,834 P6371 INFO Set up feature encoder...
2022-11-28 21:34:56,836 P6371 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:34:56,837 P6371 INFO Loading data...
2022-11-28 21:34:56,840 P6371 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:34:57,097 P6371 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:34:57,263 P6371 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:34:57,263 P6371 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:34:57,263 P6371 INFO Loading train data done.
2022-11-28 21:34:59,948 P6371 INFO Total number of parameters: 15268036.
2022-11-28 21:34:59,948 P6371 INFO Start training: 666 batches/epoch
2022-11-28 21:34:59,948 P6371 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:35:00.276 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:6371 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:35:00.308 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:6371 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:17,  1.11s/it]  1%|          | 6/666 [00:01<01:42,  6.43it/s]  2%|▏         | 11/666 [00:01<00:53, 12.32it/s]  2%|▏         | 15/666 [00:01<00:38, 16.82it/s]  3%|▎         | 20/666 [00:01<00:28, 22.97it/s]  4%|▍         | 25/666 [00:01<00:22, 28.63it/s]  5%|▍         | 30/666 [00:01<00:18, 33.57it/s]  5%|▌         | 36/666 [00:01<00:16, 38.26it/s]  6%|▋         | 42/666 [00:01<00:14, 41.73it/s]  7%|▋         | 48/666 [00:02<00:13, 44.21it/s]  8%|▊         | 54/666 [00:02<00:13, 46.02it/s]  9%|▉         | 60/666 [00:02<00:12, 47.28it/s] 10%|▉         | 65/666 [00:02<00:12, 46.82it/s] 11%|█         | 71/666 [00:02<00:12, 47.91it/s] 12%|█▏        | 77/666 [00:02<00:12, 48.65it/s] 12%|█▏        | 83/666 [00:02<00:11, 49.14it/s] 13%|█▎        | 89/666 [00:02<00:11, 49.46it/s] 14%|█▍        | 95/666 [00:03<00:11, 49.70it/s] 15%|█▌        | 101/666 [00:03<00:11, 49.89it/s] 16%|█▌        | 107/666 [00:03<00:11, 50.04it/s] 17%|█▋        | 113/666 [00:03<00:11, 50.11it/s] 18%|█▊        | 119/666 [00:03<00:10, 50.11it/s] 19%|█▉        | 125/666 [00:03<00:10, 50.13it/s] 20%|█▉        | 131/666 [00:03<00:10, 50.12it/s] 21%|██        | 137/666 [00:03<00:10, 50.18it/s] 21%|██▏       | 143/666 [00:03<00:10, 50.25it/s] 22%|██▏       | 149/666 [00:04<00:10, 50.28it/s] 23%|██▎       | 155/666 [00:04<00:10, 50.25it/s] 24%|██▍       | 161/666 [00:04<00:10, 50.24it/s] 25%|██▌       | 167/666 [00:04<00:09, 50.19it/s] 26%|██▌       | 173/666 [00:04<00:09, 50.19it/s] 27%|██▋       | 179/666 [00:04<00:09, 50.21it/s] 28%|██▊       | 185/666 [00:04<00:09, 50.27it/s] 29%|██▊       | 191/666 [00:04<00:09, 50.29it/s] 30%|██▉       | 197/666 [00:05<00:09, 50.28it/s] 30%|███       | 203/666 [00:05<00:09, 50.25it/s] 31%|███▏      | 209/666 [00:05<00:09, 50.23it/s] 32%|███▏      | 215/666 [00:05<00:08, 50.25it/s] 33%|███▎      | 221/666 [00:05<00:08, 50.30it/s] 34%|███▍      | 227/666 [00:05<00:08, 50.34it/s] 35%|███▍      | 233/666 [00:05<00:08, 50.31it/s] 36%|███▌      | 239/666 [00:05<00:08, 50.27it/s] 37%|███▋      | 245/666 [00:06<00:08, 50.24it/s] 38%|███▊      | 251/666 [00:06<00:08, 50.21it/s] 39%|███▊      | 257/666 [00:06<00:08, 50.23it/s] 39%|███▉      | 263/666 [00:06<00:08, 50.31it/s] 40%|████      | 269/666 [00:06<00:07, 50.31it/s] 41%|████▏     | 275/666 [00:06<00:07, 50.28it/s] 42%|████▏     | 281/666 [00:06<00:07, 50.26it/s] 43%|████▎     | 287/666 [00:06<00:07, 50.28it/s] 44%|████▍     | 293/666 [00:06<00:07, 50.34it/s] 45%|████▍     | 299/666 [00:07<00:07, 50.33it/s] 46%|████▌     | 305/666 [00:07<00:07, 50.29it/s] 47%|████▋     | 311/666 [00:07<00:07, 50.27it/s] 48%|████▊     | 317/666 [00:07<00:06, 50.20it/s] 48%|████▊     | 323/666 [00:07<00:06, 50.19it/s] 49%|████▉     | 329/666 [00:07<00:06, 50.22it/s] 50%|█████     | 335/666 [00:07<00:06, 50.29it/s] 51%|█████     | 341/666 [00:07<00:06, 50.30it/s] 52%|█████▏    | 347/666 [00:08<00:06, 50.27it/s] 53%|█████▎    | 353/666 [00:08<00:06, 50.22it/s] 54%|█████▍    | 359/666 [00:08<00:06, 50.22it/s] 55%|█████▍    | 365/666 [00:08<00:05, 50.25it/s] 56%|█████▌    | 371/666 [00:08<00:05, 50.30it/s] 57%|█████▋    | 377/666 [00:08<00:05, 50.31it/s] 58%|█████▊    | 383/666 [00:08<00:05, 50.25it/s] 58%|█████▊    | 389/666 [00:08<00:05, 50.26it/s] 59%|█████▉    | 395/666 [00:09<00:05, 50.23it/s] 60%|██████    | 401/666 [00:09<00:05, 50.19it/s] 61%|██████    | 407/666 [00:09<00:05, 50.21it/s] 62%|██████▏   | 413/666 [00:09<00:05, 50.24it/s] 63%|██████▎   | 419/666 [00:09<00:04, 50.27it/s] 64%|██████▍   | 425/666 [00:09<00:04, 50.24it/s] 65%|██████▍   | 431/666 [00:09<00:04, 50.22it/s] 66%|██████▌   | 437/666 [00:09<00:04, 50.20it/s] 67%|██████▋   | 443/666 [00:09<00:04, 50.16it/s] 67%|██████▋   | 449/666 [00:10<00:04, 50.15it/s] 68%|██████▊   | 455/666 [00:10<00:04, 50.15it/s] 69%|██████▉   | 461/666 [00:10<00:04, 50.11it/s] 70%|███████   | 467/666 [00:10<00:03, 50.18it/s] 71%|███████   | 473/666 [00:10<00:03, 50.25it/s] 72%|███████▏  | 479/666 [00:10<00:03, 50.26it/s] 73%|███████▎  | 485/666 [00:10<00:03, 50.25it/s] 74%|███████▎  | 491/666 [00:10<00:03, 50.21it/s] 75%|███████▍  | 497/666 [00:11<00:03, 50.18it/s] 76%|███████▌  | 503/666 [00:11<00:03, 50.17it/s] 76%|███████▋  | 509/666 [00:11<00:03, 50.16it/s] 77%|███████▋  | 515/666 [00:11<00:03, 50.22it/s] 78%|███████▊  | 521/666 [00:11<00:02, 50.27it/s] 79%|███████▉  | 527/666 [00:11<00:02, 50.27it/s] 80%|████████  | 533/666 [00:11<00:02, 50.24it/s] 81%|████████  | 539/666 [00:11<00:02, 50.21it/s] 82%|████████▏ | 545/666 [00:11<00:02, 50.20it/s] 83%|████████▎ | 551/666 [00:12<00:02, 50.20it/s] 84%|████████▎ | 557/666 [00:12<00:02, 50.25it/s] 85%|████████▍ | 563/666 [00:12<00:02, 50.28it/s] 85%|████████▌ | 569/666 [00:12<00:01, 50.25it/s] 86%|████████▋ | 575/666 [00:12<00:01, 50.25it/s] 87%|████████▋ | 581/666 [00:12<00:01, 50.21it/s] 88%|████████▊ | 587/666 [00:12<00:01, 50.18it/s] 89%|████████▉ | 593/666 [00:12<00:01, 50.19it/s] 90%|████████▉ | 599/666 [00:13<00:01, 50.21it/s] 91%|█████████ | 605/666 [00:13<00:01, 50.27it/s] 92%|█████████▏| 611/666 [00:13<00:01, 50.27it/s] 93%|█████████▎| 617/666 [00:13<00:00, 50.26it/s] 94%|█████████▎| 623/666 [00:13<00:00, 50.23it/s] 94%|█████████▍| 629/666 [00:13<00:00, 50.19it/s] 95%|█████████▌| 635/666 [00:13<00:00, 50.17it/s] 96%|█████████▌| 641/666 [00:13<00:00, 50.19it/s] 97%|█████████▋| 647/666 [00:14<00:00, 50.24it/s] 98%|█████████▊| 653/666 [00:14<00:00, 50.28it/s] 99%|█████████▉| 659/666 [00:14<00:00, 50.27it/s]100%|█████████▉| 665/666 [00:14<00:00, 49.56it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:19,  8.61it/s][A
  6%|▌         | 10/167 [00:00<00:03, 48.68it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 123.68it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 164.36it/s][A
 48%|████▊     | 80/167 [00:00<00:00, 186.25it/s][A
 62%|██████▏   | 103/167 [00:00<00:00, 200.17it/s][A
 76%|███████▌  | 127/167 [00:00<00:00, 210.01it/s][A
 90%|████████▉ | 150/167 [00:00<00:00, 216.15it/s][A100%|██████████| 167/167 [00:00<00:00, 173.17it/s]
2022-11-28 21:35:15,432 P6371 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:35:15,433 P6371 INFO Save best model: monitor(max): -10.620960
2022-11-28 21:35:15,809 P6371 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:15<00:00, 41.89it/s]
2022-11-28 21:35:15,849 P6371 INFO Train loss: 42.956414
2022-11-28 21:35:15,849 P6371 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:04,  5.32it/s]  1%|          | 7/666 [00:00<00:24, 26.72it/s]  2%|▏         | 11/666 [00:00<00:22, 28.73it/s]  2%|▏         | 16/666 [00:00<00:18, 35.47it/s]  3%|▎         | 22/666 [00:00<00:15, 40.68it/s]  4%|▍         | 27/666 [00:00<00:14, 43.43it/s]  5%|▍         | 33/666 [00:00<00:13, 45.66it/s]  6%|▌         | 39/666 [00:00<00:13, 47.07it/s]  7%|▋         | 45/666 [00:01<00:12, 48.00it/s]  8%|▊         | 50/666 [00:01<00:12, 48.51it/s]  8%|▊         | 55/666 [00:01<00:12, 48.92it/s]  9%|▉         | 60/666 [00:01<00:12, 49.23it/s] 10%|▉         | 66/666 [00:01<00:12, 49.48it/s] 11%|█         | 72/666 [00:01<00:11, 49.67it/s] 12%|█▏        | 78/666 [00:01<00:11, 49.78it/s] 12%|█▏        | 83/666 [00:01<00:11, 49.84it/s] 13%|█▎        | 88/666 [00:01<00:11, 49.85it/s] 14%|█▍        | 93/666 [00:02<00:11, 49.89it/s] 15%|█▍        | 99/666 [00:02<00:11, 49.91it/s] 16%|█▌        | 105/666 [00:02<00:11, 49.92it/s] 17%|█▋        | 110/666 [00:02<00:11, 49.92it/s] 17%|█▋        | 116/666 [00:02<00:11, 49.97it/s] 18%|█▊        | 122/666 [00:02<00:10, 50.00it/s] 19%|█▉        | 128/666 [00:02<00:10, 50.02it/s] 20%|██        | 134/666 [00:02<00:10, 50.04it/s] 21%|██        | 140/666 [00:03<00:10, 50.04it/s] 22%|██▏       | 146/666 [00:03<00:10, 50.03it/s] 23%|██▎       | 152/666 [00:03<00:10, 50.03it/s] 24%|██▎       | 158/666 [00:03<00:10, 50.02it/s] 25%|██▍       | 164/666 [00:03<00:10, 50.00it/s] 26%|██▌       | 170/666 [00:03<00:09, 50.00it/s] 26%|██▋       | 176/666 [00:03<00:09, 49.98it/s] 27%|██▋       | 182/666 [00:03<00:09, 50.00it/s] 28%|██▊       | 188/666 [00:03<00:09, 50.02it/s] 29%|██▉       | 194/666 [00:04<00:09, 50.02it/s] 30%|███       | 200/666 [00:04<00:09, 50.00it/s] 31%|███       | 206/666 [00:04<00:09, 50.01it/s] 32%|███▏      | 212/666 [00:04<00:09, 49.98it/s] 33%|███▎      | 218/666 [00:04<00:08, 49.99it/s] 34%|███▎      | 224/666 [00:04<00:08, 50.00it/s] 35%|███▍      | 230/666 [00:04<00:08, 50.01it/s] 35%|███▌      | 236/666 [00:04<00:08, 50.00it/s] 36%|███▋      | 242/666 [00:05<00:08, 50.00it/s] 37%|███▋      | 248/666 [00:05<00:08, 50.01it/s] 38%|███▊      | 254/666 [00:05<00:08, 49.97it/s] 39%|███▉      | 260/666 [00:05<00:08, 49.99it/s] 40%|███▉      | 265/666 [00:05<00:08, 49.99it/s] 41%|████      | 270/666 [00:05<00:07, 49.98it/s] 41%|████▏     | 276/666 [00:05<00:07, 49.99it/s] 42%|████▏     | 281/666 [00:05<00:07, 49.98it/s] 43%|████▎     | 287/666 [00:05<00:07, 49.99it/s] 44%|████▍     | 292/666 [00:06<00:07, 49.99it/s] 45%|████▍     | 297/666 [00:06<00:07, 49.92it/s] 45%|████▌     | 303/666 [00:06<00:07, 49.96it/s] 46%|████▋     | 309/666 [00:06<00:07, 49.99it/s] 47%|████▋     | 314/666 [00:06<00:07, 49.99it/s] 48%|████▊     | 320/666 [00:06<00:06, 50.00it/s] 49%|████▉     | 325/666 [00:06<00:06, 49.99it/s] 50%|████▉     | 330/666 [00:06<00:06, 49.99it/s] 50%|█████     | 336/666 [00:06<00:06, 49.99it/s] 51%|█████     | 341/666 [00:07<00:06, 49.99it/s] 52%|█████▏    | 347/666 [00:07<00:06, 50.00it/s] 53%|█████▎    | 353/666 [00:07<00:06, 50.00it/s] 54%|█████▍    | 359/666 [00:07<00:06, 49.99it/s] 55%|█████▍    | 365/666 [00:07<00:06, 50.00it/s] 56%|█████▌    | 371/666 [00:07<00:05, 50.00it/s] 57%|█████▋    | 377/666 [00:07<00:05, 50.02it/s] 58%|█████▊    | 383/666 [00:07<00:05, 50.00it/s] 58%|█████▊    | 389/666 [00:07<00:05, 50.00it/s] 59%|█████▉    | 395/666 [00:08<00:05, 49.98it/s] 60%|██████    | 401/666 [00:08<00:05, 50.00it/s] 61%|██████    | 407/666 [00:08<00:05, 50.00it/s] 62%|██████▏   | 413/666 [00:08<00:05, 50.00it/s] 63%|██████▎   | 419/666 [00:08<00:04, 50.00it/s] 64%|██████▍   | 425/666 [00:08<00:04, 50.00it/s] 65%|██████▍   | 430/666 [00:08<00:04, 49.99it/s] 65%|██████▌   | 436/666 [00:08<00:04, 50.01it/s] 66%|██████▋   | 442/666 [00:09<00:04, 50.03it/s] 67%|██████▋   | 448/666 [00:09<00:04, 49.99it/s] 68%|██████▊   | 453/666 [00:09<00:04, 49.98it/s] 69%|██████▉   | 458/666 [00:09<00:04, 49.86it/s] 70%|██████▉   | 464/666 [00:09<00:04, 49.94it/s] 71%|███████   | 470/666 [00:09<00:03, 49.99it/s] 71%|███████▏  | 476/666 [00:09<00:03, 50.03it/s] 72%|███████▏  | 482/666 [00:09<00:03, 50.04it/s] 73%|███████▎  | 488/666 [00:09<00:03, 50.04it/s] 74%|███████▍  | 494/666 [00:10<00:03, 50.03it/s] 75%|███████▌  | 500/666 [00:10<00:03, 50.01it/s] 76%|███████▌  | 506/666 [00:10<00:03, 50.00it/s] 77%|███████▋  | 512/666 [00:10<00:03, 50.01it/s] 78%|███████▊  | 518/666 [00:10<00:02, 49.99it/s] 79%|███████▊  | 524/666 [00:10<00:02, 50.00it/s] 80%|███████▉  | 530/666 [00:10<00:02, 50.00it/s] 80%|████████  | 535/666 [00:10<00:02, 49.88it/s] 81%|████████  | 540/666 [00:11<00:02, 49.67it/s] 82%|████████▏ | 546/666 [00:11<00:02, 49.94it/s] 83%|████████▎ | 552/666 [00:11<00:02, 50.01it/s] 84%|████████▍ | 558/666 [00:11<00:02, 50.08it/s] 85%|████████▍ | 564/666 [00:11<00:02, 50.10it/s] 86%|████████▌ | 570/666 [00:11<00:01, 50.07it/s] 86%|████████▋ | 576/666 [00:11<00:01, 50.06it/s] 87%|████████▋ | 582/666 [00:11<00:01, 50.06it/s] 88%|████████▊ | 588/666 [00:11<00:01, 50.02it/s] 89%|████████▉ | 594/666 [00:12<00:01, 50.03it/s] 90%|█████████ | 600/666 [00:12<00:01, 50.03it/s] 91%|█████████ | 606/666 [00:12<00:01, 50.01it/s] 92%|█████████▏| 612/666 [00:12<00:01, 50.03it/s] 93%|█████████▎| 618/666 [00:12<00:00, 50.00it/s] 94%|█████████▎| 624/666 [00:12<00:00, 50.01it/s] 95%|█████████▍| 630/666 [00:12<00:00, 50.02it/s] 95%|█████████▌| 636/666 [00:12<00:00, 50.00it/s] 96%|█████████▋| 642/666 [00:13<00:00, 50.00it/s] 97%|█████████▋| 647/666 [00:13<00:00, 50.00it/s] 98%|█████████▊| 652/666 [00:13<00:00, 49.96it/s] 99%|█████████▊| 657/666 [00:13<00:00, 49.97it/s] 99%|█████████▉| 662/666 [00:13<00:00, 49.26it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.13it/s][A
  6%|▌         | 10/167 [00:00<00:03, 45.43it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 118.85it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 160.30it/s][A
 48%|████▊     | 80/167 [00:00<00:00, 183.45it/s][A
 61%|██████    | 102/167 [00:00<00:00, 193.46it/s][A
 74%|███████▎  | 123/167 [00:00<00:00, 196.22it/s][A
 86%|████████▌ | 144/167 [00:00<00:00, 198.52it/s][A
 99%|█████████▉| 165/167 [00:00<00:00, 200.66it/s][A100%|██████████| 167/167 [00:01<00:00, 161.61it/s]
2022-11-28 21:35:30,533 P6371 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:35:30,533 P6371 INFO Monitor(max) STOP: -10.620960 !
2022-11-28 21:35:30,533 P6371 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:35:30,534 P6371 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:14<00:00, 45.19it/s]
2022-11-28 21:35:30,589 P6371 INFO Train loss: 69.028783
2022-11-28 21:35:30,589 P6371 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:58,  5.63it/s]  1%|          | 6/666 [00:00<00:26, 25.31it/s]  2%|▏         | 10/666 [00:00<00:21, 30.68it/s]  2%|▏         | 15/666 [00:00<00:17, 37.20it/s]  3%|▎         | 21/666 [00:00<00:15, 42.08it/s]  4%|▍         | 26/666 [00:00<00:14, 44.49it/s]  5%|▍         | 31/666 [00:00<00:13, 46.14it/s]  5%|▌         | 36/666 [00:00<00:13, 47.31it/s]  6%|▌         | 41/666 [00:01<00:12, 48.09it/s]  7%|▋         | 46/666 [00:01<00:12, 48.64it/s]  8%|▊         | 52/666 [00:01<00:12, 49.11it/s]  9%|▊         | 58/666 [00:01<00:12, 49.40it/s] 10%|▉         | 64/666 [00:01<00:12, 49.59it/s] 10%|█         | 69/666 [00:01<00:12, 49.70it/s] 11%|█         | 74/666 [00:01<00:11, 49.77it/s] 12%|█▏        | 79/666 [00:01<00:11, 49.83it/s] 13%|█▎        | 84/666 [00:01<00:11, 49.86it/s] 13%|█▎        | 89/666 [00:01<00:11, 49.89it/s] 14%|█▍        | 94/666 [00:02<00:11, 49.92it/s] 15%|█▌        | 100/666 [00:02<00:11, 49.94it/s] 16%|█▌        | 106/666 [00:02<00:11, 49.97it/s] 17%|█▋        | 111/666 [00:02<00:11, 49.94it/s] 17%|█▋        | 116/666 [00:02<00:11, 49.92it/s] 18%|█▊        | 121/666 [00:02<00:10, 49.89it/s] 19%|█▉        | 126/666 [00:02<00:10, 49.85it/s] 20%|█▉        | 131/666 [00:02<00:10, 49.80it/s] 20%|██        | 136/666 [00:02<00:10, 49.77it/s] 21%|██        | 141/666 [00:03<00:10, 49.77it/s] 22%|██▏       | 146/666 [00:03<00:10, 49.81it/s] 23%|██▎       | 151/666 [00:03<00:10, 49.84it/s] 23%|██▎       | 156/666 [00:03<00:10, 49.88it/s] 24%|██▍       | 161/666 [00:03<00:10, 49.91it/s] 25%|██▌       | 167/666 [00:03<00:09, 49.95it/s] 26%|██▌       | 172/666 [00:03<00:09, 49.94it/s] 27%|██▋       | 178/666 [00:03<00:09, 49.95it/s] 27%|██▋       | 183/666 [00:03<00:09, 49.96it/s] 28%|██▊       | 188/666 [00:03<00:09, 49.94it/s] 29%|██▉       | 193/666 [00:04<00:09, 49.94it/s] 30%|██▉       | 198/666 [00:04<00:09, 49.94it/s] 30%|███       | 203/666 [00:04<00:09, 49.92it/s] 31%|███       | 208/666 [00:04<00:09, 49.89it/s] 32%|███▏      | 213/666 [00:04<00:09, 49.86it/s] 33%|███▎      | 218/666 [00:04<00:08, 49.81it/s] 33%|███▎      | 223/666 [00:04<00:08, 49.79it/s] 34%|███▍      | 228/666 [00:04<00:08, 49.80it/s] 35%|███▍      | 233/666 [00:04<00:08, 49.83it/s] 36%|███▌      | 238/666 [00:04<00:08, 49.84it/s] 36%|███▋      | 243/666 [00:05<00:08, 49.87it/s] 37%|███▋      | 248/666 [00:05<00:08, 49.89it/s] 38%|███▊      | 253/666 [00:05<00:08, 49.92it/s] 39%|███▉      | 259/666 [00:05<00:08, 49.95it/s] 40%|███▉      | 264/666 [00:05<00:08, 49.96it/s] 40%|████      | 269/666 [00:05<00:07, 49.97it/s] 41%|████      | 274/666 [00:05<00:07, 49.97it/s] 42%|████▏     | 280/666 [00:05<00:07, 49.99it/s] 43%|████▎     | 286/666 [00:05<00:07, 50.00it/s] 44%|████▎     | 291/666 [00:06<00:07, 50.00it/s] 44%|████▍     | 296/666 [00:06<00:07, 49.99it/s] 45%|████▌     | 301/666 [00:06<00:07, 49.99it/s] 46%|████▌     | 307/666 [00:06<00:07, 50.00it/s] 47%|████▋     | 313/666 [00:06<00:07, 49.99it/s] 48%|████▊     | 318/666 [00:06<00:06, 49.99it/s] 48%|████▊     | 323/666 [00:06<00:06, 49.98it/s] 49%|████▉     | 328/666 [00:06<00:06, 49.96it/s] 50%|█████     | 334/666 [00:06<00:06, 49.99it/s] 51%|█████     | 340/666 [00:06<00:06, 50.00it/s] 52%|█████▏    | 346/666 [00:07<00:06, 50.01it/s] 53%|█████▎    | 352/666 [00:07<00:06, 50.02it/s] 54%|█████▍    | 358/666 [00:07<00:06, 50.00it/s] 55%|█████▍    | 363/666 [00:07<00:06, 49.99it/s] 55%|█████▌    | 369/666 [00:07<00:05, 50.00it/s] 56%|█████▋    | 375/666 [00:07<00:05, 49.99it/s] 57%|█████▋    | 380/666 [00:07<00:05, 49.99it/s] 58%|█████▊    | 385/666 [00:07<00:05, 49.97it/s] 59%|█████▊    | 390/666 [00:07<00:05, 49.96it/s] 59%|█████▉    | 395/666 [00:08<00:05, 49.97it/s] 60%|██████    | 401/666 [00:08<00:05, 50.00it/s] 61%|██████    | 406/666 [00:08<00:05, 49.99it/s] 62%|██████▏   | 412/666 [00:08<00:05, 50.00it/s] 63%|██████▎   | 417/666 [00:08<00:04, 49.99it/s] 64%|██████▎   | 423/666 [00:08<00:04, 50.00it/s] 64%|██████▍   | 429/666 [00:08<00:04, 50.01it/s] 65%|██████▌   | 435/666 [00:08<00:04, 50.00it/s] 66%|██████▌   | 441/666 [00:09<00:04, 50.00it/s] 67%|██████▋   | 446/666 [00:09<00:04, 49.94it/s] 68%|██████▊   | 451/666 [00:09<00:04, 49.91it/s] 68%|██████▊   | 456/666 [00:09<00:04, 49.84it/s] 69%|██████▉   | 461/666 [00:09<00:04, 49.79it/s] 70%|██████▉   | 466/666 [00:09<00:04, 49.79it/s] 71%|███████   | 471/666 [00:09<00:03, 49.81it/s] 71%|███████▏  | 476/666 [00:09<00:03, 49.79it/s] 72%|███████▏  | 481/666 [00:09<00:03, 49.85it/s] 73%|███████▎  | 486/666 [00:09<00:03, 49.89it/s] 74%|███████▎  | 491/666 [00:10<00:03, 49.91it/s] 74%|███████▍  | 496/666 [00:10<00:03, 49.91it/s] 75%|███████▌  | 502/666 [00:10<00:03, 49.94it/s] 76%|███████▌  | 507/666 [00:10<00:03, 49.90it/s] 77%|███████▋  | 512/666 [00:10<00:03, 49.93it/s] 78%|███████▊  | 517/666 [00:10<00:02, 49.91it/s] 78%|███████▊  | 522/666 [00:10<00:02, 49.91it/s] 79%|███████▉  | 527/666 [00:10<00:02, 49.90it/s] 80%|███████▉  | 532/666 [00:10<00:02, 49.86it/s] 81%|████████  | 537/666 [00:10<00:02, 49.82it/s] 81%|████████▏ | 542/666 [00:11<00:02, 49.79it/s] 82%|████████▏ | 547/666 [00:11<00:02, 49.76it/s] 83%|████████▎ | 552/666 [00:11<00:02, 49.79it/s] 84%|████████▎ | 557/666 [00:11<00:02, 49.84it/s] 84%|████████▍ | 562/666 [00:11<00:02, 49.87it/s] 85%|████████▌ | 568/666 [00:11<00:01, 49.92it/s] 86%|████████▌ | 573/666 [00:11<00:01, 49.93it/s] 87%|████████▋ | 578/666 [00:11<00:01, 49.94it/s] 88%|████████▊ | 584/666 [00:11<00:01, 49.97it/s] 89%|████████▊ | 590/666 [00:11<00:01, 49.99it/s] 89%|████████▉ | 595/666 [00:12<00:01, 49.94it/s] 90%|█████████ | 600/666 [00:12<00:01, 49.95it/s] 91%|█████████ | 605/666 [00:12<00:01, 49.96it/s] 92%|█████████▏| 610/666 [00:12<00:01, 49.05it/s] 92%|█████████▏| 615/666 [00:12<00:01, 49.26it/s] 93%|█████████▎| 620/666 [00:12<00:00, 49.42it/s] 94%|█████████▍| 625/666 [00:12<00:00, 49.56it/s] 95%|█████████▍| 630/666 [00:12<00:00, 49.69it/s] 95%|█████████▌| 635/666 [00:12<00:00, 49.76it/s] 96%|█████████▌| 640/666 [00:13<00:00, 49.82it/s] 97%|█████████▋| 645/666 [00:13<00:00, 49.83it/s] 98%|█████████▊| 651/666 [00:13<00:00, 49.89it/s] 98%|█████████▊| 656/666 [00:13<00:00, 49.91it/s] 99%|█████████▉| 661/666 [00:13<00:00, 49.12it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.76it/s][A
  4%|▍         | 7/167 [00:00<00:04, 36.21it/s][A
  8%|▊         | 13/167 [00:00<00:03, 46.47it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 104.10it/s][A
 32%|███▏      | 53/167 [00:00<00:00, 135.43it/s][A
 44%|████▎     | 73/167 [00:00<00:00, 154.93it/s][A
 56%|█████▌    | 93/167 [00:00<00:00, 167.99it/s][A
 69%|██████▉   | 116/167 [00:00<00:00, 186.54it/s][A
 83%|████████▎ | 139/167 [00:00<00:00, 198.63it/s][A
 97%|█████████▋| 162/167 [00:01<00:00, 206.71it/s][A100%|██████████| 167/167 [00:01<00:00, 149.58it/s]
2022-11-28 21:35:45,349 P6371 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:35:45,349 P6371 INFO Monitor(max) STOP: -10.620960 !
2022-11-28 21:35:45,349 P6371 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:35:45,349 P6371 INFO Early stopping at epoch=3
2022-11-28 21:35:45,350 P6371 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:14<00:00, 44.88it/s]
2022-11-28 21:35:45,408 P6371 INFO Train loss: 69.029874
2022-11-28 21:35:45,408 P6371 INFO Training finished.
2022-11-28 21:35:45,409 P6371 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_016_75687b53.model
2022-11-28 21:35:45,700 P6371 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:54,  5.82it/s]  2%|▏         | 10/666 [00:00<00:15, 41.15it/s]  5%|▍         | 32/666 [00:00<00:05, 108.30it/s]  8%|▊         | 54/666 [00:00<00:04, 146.93it/s] 11%|█▏        | 76/666 [00:00<00:03, 170.61it/s] 15%|█▍        | 98/666 [00:00<00:03, 185.06it/s] 18%|█▊        | 120/666 [00:00<00:02, 195.22it/s] 21%|██▏       | 142/666 [00:00<00:02, 202.36it/s] 25%|██▍       | 164/666 [00:00<00:02, 207.31it/s] 28%|██▊       | 186/666 [00:01<00:02, 210.55it/s] 31%|███       | 208/666 [00:01<00:02, 212.69it/s] 35%|███▍      | 230/666 [00:01<00:02, 212.25it/s] 38%|███▊      | 252/666 [00:01<00:01, 207.32it/s] 41%|████      | 273/666 [00:01<00:01, 204.71it/s] 44%|████▍     | 294/666 [00:01<00:01, 202.15it/s] 47%|████▋     | 315/666 [00:01<00:01, 200.93it/s] 50%|█████     | 336/666 [00:01<00:01, 199.69it/s] 53%|█████▎    | 356/666 [00:01<00:01, 199.38it/s] 56%|█████▋    | 376/666 [00:02<00:01, 197.11it/s] 59%|█████▉    | 396/666 [00:02<00:01, 197.63it/s] 62%|██████▏   | 416/666 [00:02<00:01, 197.84it/s] 65%|██████▌   | 436/666 [00:02<00:01, 198.08it/s] 68%|██████▊   | 456/666 [00:02<00:01, 198.40it/s] 71%|███████▏  | 476/666 [00:02<00:00, 198.60it/s] 74%|███████▍  | 496/666 [00:02<00:00, 198.67it/s] 77%|███████▋  | 516/666 [00:02<00:00, 198.77it/s] 80%|████████  | 536/666 [00:02<00:00, 198.81it/s] 83%|████████▎ | 556/666 [00:02<00:00, 198.72it/s] 86%|████████▋ | 576/666 [00:03<00:00, 197.50it/s] 89%|████████▉ | 596/666 [00:03<00:00, 197.88it/s] 92%|█████████▏| 616/666 [00:03<00:00, 198.17it/s] 95%|█████████▌| 636/666 [00:03<00:00, 198.37it/s] 98%|█████████▊| 656/666 [00:03<00:00, 194.50it/s]100%|██████████| 666/666 [00:03<00:00, 186.98it/s]
2022-11-28 21:35:49,708 P6371 INFO [Metrics] logloss: 11.126093 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:17,  9.46it/s]  6%|▌         | 10/167 [00:00<00:03, 50.92it/s] 19%|█▉        | 32/167 [00:00<00:01, 121.42it/s] 32%|███▏      | 54/167 [00:00<00:00, 156.52it/s] 46%|████▌     | 76/167 [00:00<00:00, 176.88it/s] 59%|█████▊    | 98/167 [00:00<00:00, 188.82it/s] 72%|███████▏  | 120/167 [00:00<00:00, 197.29it/s] 85%|████████▌ | 142/167 [00:00<00:00, 203.31it/s] 99%|█████████▉| 165/167 [00:00<00:00, 208.72it/s]100%|██████████| 167/167 [00:01<00:00, 165.27it/s]
2022-11-28 21:35:50,832 P6371 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:35:56,906 P8156 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "128",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_017_182318ab",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:35:56,908 P8156 INFO Set up feature encoder...
2022-11-28 21:35:56,917 P8156 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:35:56,923 P8156 INFO Loading data...
2022-11-28 21:35:56,926 P8156 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:35:57,178 P8156 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:35:57,273 P8156 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:35:57,273 P8156 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:35:57,273 P8156 INFO Loading train data done.
2022-11-28 21:36:00,309 P8156 INFO Total number of parameters: 29989252.
2022-11-28 21:36:00,310 P8156 INFO Start training: 666 batches/epoch
2022-11-28 21:36:00,310 P8156 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:36:00.645 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:8156 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:36:00.677 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:8156 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:40,  1.14s/it]  1%|          | 5/666 [00:01<02:09,  5.10it/s]  1%|▏         | 9/666 [00:01<01:08,  9.54it/s]  2%|▏         | 13/666 [00:01<00:46, 13.99it/s]  3%|▎         | 17/666 [00:01<00:35, 18.19it/s]  3%|▎         | 21/666 [00:01<00:29, 22.16it/s]  4%|▍         | 25/666 [00:01<00:25, 25.53it/s]  4%|▍         | 29/666 [00:01<00:22, 28.27it/s]  5%|▍         | 33/666 [00:02<00:20, 30.45it/s]  6%|▌         | 37/666 [00:02<00:19, 32.11it/s]  6%|▌         | 41/666 [00:02<00:18, 33.36it/s]  7%|▋         | 45/666 [00:02<00:18, 34.27it/s]  7%|▋         | 49/666 [00:02<00:17, 34.91it/s]  8%|▊         | 53/666 [00:02<00:17, 35.38it/s]  9%|▊         | 57/666 [00:02<00:17, 35.70it/s]  9%|▉         | 61/666 [00:02<00:16, 35.95it/s] 10%|▉         | 65/666 [00:02<00:16, 36.04it/s] 10%|█         | 69/666 [00:03<00:16, 36.18it/s] 11%|█         | 73/666 [00:03<00:16, 36.30it/s] 12%|█▏        | 77/666 [00:03<00:16, 36.35it/s] 12%|█▏        | 81/666 [00:03<00:16, 36.40it/s] 13%|█▎        | 85/666 [00:03<00:15, 36.44it/s] 13%|█▎        | 89/666 [00:03<00:15, 36.45it/s] 14%|█▍        | 93/666 [00:03<00:15, 36.47it/s] 15%|█▍        | 97/666 [00:03<00:15, 36.46it/s] 15%|█▌        | 101/666 [00:03<00:15, 36.49it/s] 16%|█▌        | 105/666 [00:04<00:15, 36.50it/s] 16%|█▋        | 109/666 [00:04<00:15, 36.49it/s] 17%|█▋        | 113/666 [00:04<00:15, 36.51it/s] 18%|█▊        | 117/666 [00:04<00:15, 36.51it/s] 18%|█▊        | 121/666 [00:04<00:14, 36.52it/s] 19%|█▉        | 125/666 [00:04<00:14, 36.23it/s] 19%|█▉        | 129/666 [00:04<00:14, 36.27it/s] 20%|█▉        | 133/666 [00:04<00:14, 36.34it/s] 21%|██        | 137/666 [00:04<00:14, 36.41it/s] 21%|██        | 141/666 [00:05<00:14, 36.44it/s] 22%|██▏       | 145/666 [00:05<00:14, 36.49it/s] 22%|██▏       | 149/666 [00:05<00:14, 36.51it/s] 23%|██▎       | 153/666 [00:05<00:14, 36.49it/s] 24%|██▎       | 157/666 [00:05<00:13, 36.52it/s] 24%|██▍       | 161/666 [00:05<00:13, 36.52it/s] 25%|██▍       | 165/666 [00:05<00:13, 36.50it/s] 25%|██▌       | 169/666 [00:05<00:13, 36.36it/s] 26%|██▌       | 173/666 [00:05<00:13, 36.40it/s] 27%|██▋       | 177/666 [00:06<00:13, 36.43it/s] 27%|██▋       | 181/666 [00:06<00:13, 36.46it/s] 28%|██▊       | 185/666 [00:06<00:13, 36.48it/s] 28%|██▊       | 189/666 [00:06<00:13, 36.49it/s] 29%|██▉       | 193/666 [00:06<00:12, 36.49it/s] 30%|██▉       | 197/666 [00:06<00:12, 36.50it/s] 30%|███       | 201/666 [00:06<00:12, 36.49it/s] 31%|███       | 205/666 [00:06<00:12, 36.52it/s] 31%|███▏      | 209/666 [00:06<00:12, 36.50it/s] 32%|███▏      | 213/666 [00:06<00:12, 36.52it/s] 33%|███▎      | 217/666 [00:07<00:12, 36.50it/s] 33%|███▎      | 221/666 [00:07<00:12, 36.49it/s] 34%|███▍      | 225/666 [00:07<00:12, 36.52it/s] 34%|███▍      | 229/666 [00:07<00:11, 36.53it/s] 35%|███▍      | 233/666 [00:07<00:11, 36.51it/s] 36%|███▌      | 237/666 [00:07<00:11, 36.53it/s] 36%|███▌      | 241/666 [00:07<00:11, 36.51it/s] 37%|███▋      | 245/666 [00:07<00:11, 36.53it/s] 37%|███▋      | 249/666 [00:07<00:11, 36.52it/s] 38%|███▊      | 253/666 [00:08<00:11, 36.51it/s] 39%|███▊      | 257/666 [00:08<00:11, 36.51it/s] 39%|███▉      | 261/666 [00:08<00:11, 36.51it/s] 40%|███▉      | 265/666 [00:08<00:10, 36.56it/s] 40%|████      | 269/666 [00:08<00:10, 36.59it/s] 41%|████      | 273/666 [00:08<00:10, 36.61it/s] 42%|████▏     | 277/666 [00:08<00:10, 36.59it/s] 42%|████▏     | 281/666 [00:08<00:10, 36.61it/s] 43%|████▎     | 285/666 [00:08<00:10, 36.61it/s] 43%|████▎     | 289/666 [00:09<00:10, 36.61it/s] 44%|████▍     | 293/666 [00:09<00:10, 36.62it/s] 45%|████▍     | 297/666 [00:09<00:10, 36.64it/s] 45%|████▌     | 301/666 [00:09<00:09, 36.64it/s] 46%|████▌     | 305/666 [00:09<00:09, 36.64it/s] 46%|████▋     | 309/666 [00:09<00:09, 36.64it/s] 47%|████▋     | 313/666 [00:09<00:09, 36.63it/s] 48%|████▊     | 317/666 [00:09<00:09, 36.59it/s] 48%|████▊     | 321/666 [00:09<00:09, 36.60it/s] 49%|████▉     | 325/666 [00:10<00:09, 36.60it/s] 49%|████▉     | 329/666 [00:10<00:09, 36.60it/s] 50%|█████     | 333/666 [00:10<00:09, 36.63it/s] 51%|█████     | 337/666 [00:10<00:08, 36.64it/s] 51%|█████     | 341/666 [00:10<00:08, 36.62it/s] 52%|█████▏    | 345/666 [00:10<00:08, 36.64it/s] 52%|█████▏    | 349/666 [00:10<00:08, 36.64it/s] 53%|█████▎    | 353/666 [00:10<00:08, 36.64it/s] 54%|█████▎    | 357/666 [00:10<00:08, 36.62it/s] 54%|█████▍    | 361/666 [00:11<00:08, 36.65it/s] 55%|█████▍    | 365/666 [00:11<00:08, 36.65it/s] 55%|█████▌    | 369/666 [00:11<00:08, 36.64it/s] 56%|█████▌    | 373/666 [00:11<00:07, 36.66it/s] 57%|█████▋    | 377/666 [00:11<00:07, 36.66it/s] 57%|█████▋    | 381/666 [00:11<00:07, 36.63it/s] 58%|█████▊    | 385/666 [00:11<00:07, 36.64it/s] 58%|█████▊    | 389/666 [00:11<00:07, 36.65it/s] 59%|█████▉    | 393/666 [00:11<00:07, 36.65it/s] 60%|█████▉    | 397/666 [00:12<00:07, 36.64it/s] 60%|██████    | 401/666 [00:12<00:07, 36.62it/s] 61%|██████    | 405/666 [00:12<00:07, 36.63it/s] 61%|██████▏   | 409/666 [00:12<00:07, 36.64it/s] 62%|██████▏   | 413/666 [00:12<00:06, 36.65it/s] 63%|██████▎   | 417/666 [00:12<00:06, 36.66it/s] 63%|██████▎   | 421/666 [00:12<00:06, 36.64it/s] 64%|██████▍   | 425/666 [00:12<00:06, 36.63it/s] 64%|██████▍   | 429/666 [00:12<00:06, 36.63it/s] 65%|██████▌   | 433/666 [00:12<00:06, 36.62it/s] 66%|██████▌   | 437/666 [00:13<00:06, 36.61it/s] 66%|██████▌   | 441/666 [00:13<00:06, 36.63it/s] 67%|██████▋   | 445/666 [00:13<00:06, 36.63it/s] 67%|██████▋   | 449/666 [00:13<00:05, 36.62it/s] 68%|██████▊   | 453/666 [00:13<00:05, 36.64it/s] 69%|██████▊   | 457/666 [00:13<00:05, 36.65it/s] 69%|██████▉   | 461/666 [00:13<00:05, 36.64it/s] 70%|██████▉   | 465/666 [00:13<00:05, 36.62it/s] 70%|███████   | 469/666 [00:13<00:05, 36.64it/s] 71%|███████   | 473/666 [00:14<00:05, 36.51it/s] 72%|███████▏  | 477/666 [00:14<00:05, 36.57it/s] 72%|███████▏  | 481/666 [00:14<00:05, 36.61it/s] 73%|███████▎  | 485/666 [00:14<00:04, 36.62it/s] 73%|███████▎  | 489/666 [00:14<00:04, 36.62it/s] 74%|███████▍  | 493/666 [00:14<00:04, 36.64it/s] 75%|███████▍  | 497/666 [00:14<00:04, 36.62it/s] 75%|███████▌  | 501/666 [00:14<00:04, 36.60it/s] 76%|███████▌  | 505/666 [00:14<00:04, 36.62it/s] 76%|███████▋  | 509/666 [00:15<00:04, 36.61it/s] 77%|███████▋  | 513/666 [00:15<00:04, 36.60it/s] 78%|███████▊  | 517/666 [00:15<00:04, 36.61it/s] 78%|███████▊  | 521/666 [00:15<00:03, 36.62it/s] 79%|███████▉  | 525/666 [00:15<00:03, 36.61it/s] 79%|███████▉  | 529/666 [00:15<00:03, 36.62it/s] 80%|████████  | 533/666 [00:15<00:03, 36.64it/s] 81%|████████  | 537/666 [00:15<00:03, 36.64it/s] 81%|████████  | 541/666 [00:15<00:03, 36.57it/s] 82%|████████▏ | 545/666 [00:16<00:03, 36.65it/s] 82%|████████▏ | 549/666 [00:16<00:03, 36.63it/s] 83%|████████▎ | 553/666 [00:16<00:03, 36.60it/s] 84%|████████▎ | 557/666 [00:16<00:02, 36.62it/s] 84%|████████▍ | 561/666 [00:16<00:02, 36.63it/s] 85%|████████▍ | 565/666 [00:16<00:02, 36.63it/s] 85%|████████▌ | 569/666 [00:16<00:02, 36.61it/s] 86%|████████▌ | 573/666 [00:16<00:02, 36.62it/s] 87%|████████▋ | 577/666 [00:16<00:02, 36.60it/s] 87%|████████▋ | 581/666 [00:17<00:02, 36.59it/s] 88%|████████▊ | 585/666 [00:17<00:02, 36.61it/s] 88%|████████▊ | 589/666 [00:17<00:02, 36.61it/s] 89%|████████▉ | 593/666 [00:17<00:01, 36.61it/s] 90%|████████▉ | 597/666 [00:17<00:01, 36.62it/s] 90%|█████████ | 601/666 [00:17<00:01, 36.62it/s] 91%|█████████ | 605/666 [00:17<00:01, 36.60it/s] 91%|█████████▏| 609/666 [00:17<00:01, 36.62it/s] 92%|█████████▏| 613/666 [00:17<00:01, 36.63it/s] 93%|█████████▎| 617/666 [00:18<00:01, 36.61it/s] 93%|█████████▎| 621/666 [00:18<00:01, 36.62it/s] 94%|█████████▍| 625/666 [00:18<00:01, 36.64it/s] 94%|█████████▍| 629/666 [00:18<00:01, 36.63it/s] 95%|█████████▌| 633/666 [00:18<00:00, 36.62it/s] 96%|█████████▌| 637/666 [00:18<00:00, 36.64it/s] 96%|█████████▌| 641/666 [00:18<00:00, 36.61it/s] 97%|█████████▋| 645/666 [00:18<00:00, 36.59it/s] 97%|█████████▋| 649/666 [00:18<00:00, 36.60it/s] 98%|█████████▊| 653/666 [00:19<00:00, 36.60it/s] 99%|█████████▊| 657/666 [00:19<00:00, 36.60it/s] 99%|█████████▉| 661/666 [00:19<00:00, 35.98it/s]100%|█████████▉| 665/666 [00:19<00:00, 36.28it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.03it/s][A
  6%|▌         | 10/167 [00:00<00:03, 51.57it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 128.53it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 168.57it/s][A
 49%|████▊     | 81/167 [00:00<00:00, 191.40it/s][A
 63%|██████▎   | 105/167 [00:00<00:00, 205.16it/s][A
 77%|███████▋  | 129/167 [00:00<00:00, 213.34it/s][A
 91%|█████████ | 152/167 [00:00<00:00, 218.45it/s][A100%|██████████| 167/167 [00:00<00:00, 173.92it/s]
2022-11-28 21:36:20,748 P8156 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:36:20,748 P8156 INFO Save best model: monitor(max): -10.620960
2022-11-28 21:36:21,781 P8156 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:21<00:00, 30.95it/s]
2022-11-28 21:36:21,830 P8156 INFO Train loss: 42.082714
2022-11-28 21:36:21,830 P8156 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:07,  5.20it/s]  1%|          | 5/666 [00:00<00:36, 18.25it/s]  1%|▏         | 9/666 [00:00<00:26, 24.74it/s]  2%|▏         | 13/666 [00:00<00:22, 28.60it/s]  3%|▎         | 17/666 [00:00<00:20, 31.19it/s]  3%|▎         | 21/666 [00:00<00:19, 32.90it/s]  4%|▍         | 25/666 [00:00<00:18, 34.05it/s]  4%|▍         | 29/666 [00:00<00:18, 34.80it/s]  5%|▍         | 33/666 [00:01<00:17, 35.34it/s]  6%|▌         | 37/666 [00:01<00:17, 35.71it/s]  6%|▌         | 41/666 [00:01<00:17, 35.93it/s]  7%|▋         | 45/666 [00:01<00:17, 36.11it/s]  7%|▋         | 49/666 [00:01<00:17, 36.18it/s]  8%|▊         | 53/666 [00:01<00:16, 36.28it/s]  9%|▊         | 57/666 [00:01<00:16, 36.34it/s]  9%|▉         | 61/666 [00:01<00:16, 36.40it/s] 10%|▉         | 65/666 [00:01<00:16, 36.45it/s] 10%|█         | 69/666 [00:02<00:16, 36.46it/s] 11%|█         | 73/666 [00:02<00:16, 36.50it/s] 12%|█▏        | 77/666 [00:02<00:16, 36.50it/s] 12%|█▏        | 81/666 [00:02<00:16, 36.50it/s] 13%|█▎        | 85/666 [00:02<00:15, 36.52it/s] 13%|█▎        | 89/666 [00:02<00:15, 36.51it/s] 14%|█▍        | 93/666 [00:02<00:15, 36.52it/s] 15%|█▍        | 97/666 [00:02<00:15, 36.54it/s] 15%|█▌        | 101/666 [00:02<00:15, 36.48it/s] 16%|█▌        | 105/666 [00:03<00:15, 36.51it/s] 16%|█▋        | 109/666 [00:03<00:15, 36.51it/s] 17%|█▋        | 113/666 [00:03<00:15, 36.49it/s] 18%|█▊        | 117/666 [00:03<00:15, 36.51it/s] 18%|█▊        | 121/666 [00:03<00:14, 36.51it/s] 19%|█▉        | 125/666 [00:03<00:14, 36.52it/s] 19%|█▉        | 129/666 [00:03<00:14, 36.53it/s] 20%|█▉        | 133/666 [00:03<00:14, 36.52it/s] 21%|██        | 137/666 [00:03<00:14, 36.53it/s] 21%|██        | 141/666 [00:04<00:14, 36.51it/s] 22%|██▏       | 145/666 [00:04<00:14, 36.51it/s] 22%|██▏       | 149/666 [00:04<00:14, 36.50it/s] 23%|██▎       | 153/666 [00:04<00:14, 36.50it/s] 24%|██▎       | 157/666 [00:04<00:13, 36.53it/s] 24%|██▍       | 161/666 [00:04<00:13, 36.51it/s] 25%|██▍       | 165/666 [00:04<00:13, 36.51it/s] 25%|██▌       | 169/666 [00:04<00:13, 36.51it/s] 26%|██▌       | 173/666 [00:04<00:13, 36.49it/s] 27%|██▋       | 177/666 [00:05<00:13, 36.51it/s] 27%|██▋       | 181/666 [00:05<00:13, 36.51it/s] 28%|██▊       | 185/666 [00:05<00:13, 36.51it/s] 28%|██▊       | 189/666 [00:05<00:13, 36.53it/s] 29%|██▉       | 193/666 [00:05<00:12, 36.52it/s] 30%|██▉       | 197/666 [00:05<00:12, 36.48it/s] 30%|███       | 201/666 [00:05<00:12, 36.47it/s] 31%|███       | 205/666 [00:05<00:12, 36.48it/s] 31%|███▏      | 209/666 [00:05<00:12, 36.49it/s] 32%|███▏      | 213/666 [00:06<00:12, 36.49it/s] 33%|███▎      | 217/666 [00:06<00:12, 36.52it/s] 33%|███▎      | 221/666 [00:06<00:12, 36.52it/s] 34%|███▍      | 225/666 [00:06<00:12, 36.52it/s] 34%|███▍      | 229/666 [00:06<00:11, 36.53it/s] 35%|███▍      | 233/666 [00:06<00:11, 36.51it/s] 36%|███▌      | 237/666 [00:06<00:11, 36.50it/s] 36%|███▌      | 241/666 [00:06<00:11, 36.50it/s] 37%|███▋      | 245/666 [00:06<00:11, 36.50it/s] 37%|███▋      | 249/666 [00:07<00:11, 36.52it/s] 38%|███▊      | 253/666 [00:07<00:11, 36.51it/s] 39%|███▊      | 257/666 [00:07<00:11, 36.51it/s] 39%|███▉      | 261/666 [00:07<00:11, 36.51it/s] 40%|███▉      | 265/666 [00:07<00:10, 36.50it/s] 40%|████      | 269/666 [00:07<00:10, 36.51it/s] 41%|████      | 273/666 [00:07<00:10, 36.51it/s] 42%|████▏     | 277/666 [00:07<00:10, 36.51it/s] 42%|████▏     | 281/666 [00:07<00:10, 36.52it/s] 43%|████▎     | 285/666 [00:07<00:10, 36.50it/s] 43%|████▎     | 289/666 [00:08<00:10, 36.51it/s] 44%|████▍     | 293/666 [00:08<00:10, 36.49it/s] 45%|████▍     | 297/666 [00:08<00:10, 36.47it/s] 45%|████▌     | 301/666 [00:08<00:10, 36.49it/s] 46%|████▌     | 305/666 [00:08<00:09, 36.48it/s] 46%|████▋     | 309/666 [00:08<00:09, 36.51it/s] 47%|████▋     | 313/666 [00:08<00:09, 36.49it/s] 48%|████▊     | 317/666 [00:08<00:09, 36.50it/s] 48%|████▊     | 321/666 [00:08<00:09, 36.53it/s] 49%|████▉     | 325/666 [00:09<00:09, 36.51it/s] 49%|████▉     | 329/666 [00:09<00:09, 36.53it/s] 50%|█████     | 333/666 [00:09<00:09, 36.53it/s] 51%|█████     | 337/666 [00:09<00:09, 36.53it/s] 51%|█████     | 341/666 [00:09<00:08, 36.55it/s] 52%|█████▏    | 345/666 [00:09<00:08, 36.53it/s] 52%|█████▏    | 349/666 [00:09<00:08, 36.52it/s] 53%|█████▎    | 353/666 [00:09<00:08, 36.53it/s] 54%|█████▎    | 357/666 [00:09<00:08, 36.53it/s] 54%|█████▍    | 361/666 [00:10<00:08, 36.53it/s] 55%|█████▍    | 365/666 [00:10<00:08, 36.52it/s] 55%|█████▌    | 369/666 [00:10<00:08, 36.52it/s] 56%|█████▌    | 373/666 [00:10<00:08, 36.52it/s] 57%|█████▋    | 377/666 [00:10<00:07, 36.49it/s] 57%|█████▋    | 381/666 [00:10<00:07, 36.51it/s] 58%|█████▊    | 385/666 [00:10<00:07, 36.51it/s] 58%|█████▊    | 389/666 [00:10<00:07, 36.50it/s] 59%|█████▉    | 393/666 [00:10<00:07, 36.52it/s] 60%|█████▉    | 397/666 [00:11<00:07, 36.51it/s] 60%|██████    | 401/666 [00:11<00:07, 36.49it/s] 61%|██████    | 405/666 [00:11<00:07, 36.49it/s] 61%|██████▏   | 409/666 [00:11<00:07, 36.48it/s] 62%|██████▏   | 413/666 [00:11<00:06, 36.50it/s] 63%|██████▎   | 417/666 [00:11<00:06, 36.49it/s] 63%|██████▎   | 421/666 [00:11<00:06, 36.49it/s] 64%|██████▍   | 425/666 [00:11<00:06, 36.51it/s] 64%|██████▍   | 429/666 [00:11<00:06, 36.50it/s] 65%|██████▌   | 433/666 [00:12<00:06, 36.52it/s] 66%|██████▌   | 437/666 [00:12<00:06, 36.51it/s] 66%|██████▌   | 441/666 [00:12<00:06, 36.49it/s] 67%|██████▋   | 445/666 [00:12<00:06, 36.52it/s] 67%|██████▋   | 449/666 [00:12<00:05, 36.50it/s] 68%|██████▊   | 453/666 [00:12<00:05, 36.52it/s] 69%|██████▊   | 457/666 [00:12<00:05, 36.53it/s] 69%|██████▉   | 461/666 [00:12<00:05, 36.53it/s] 70%|██████▉   | 465/666 [00:12<00:05, 36.54it/s] 70%|███████   | 469/666 [00:13<00:05, 36.52it/s] 71%|███████   | 473/666 [00:13<00:05, 36.51it/s] 72%|███████▏  | 477/666 [00:13<00:05, 36.53it/s] 72%|███████▏  | 481/666 [00:13<00:05, 36.52it/s] 73%|███████▎  | 485/666 [00:13<00:04, 36.53it/s] 73%|███████▎  | 489/666 [00:13<00:04, 36.53it/s] 74%|███████▍  | 493/666 [00:13<00:04, 36.53it/s] 75%|███████▍  | 497/666 [00:13<00:04, 36.53it/s] 75%|███████▌  | 501/666 [00:13<00:04, 36.47it/s] 76%|███████▌  | 505/666 [00:14<00:04, 36.49it/s] 76%|███████▋  | 509/666 [00:14<00:04, 36.49it/s] 77%|███████▋  | 513/666 [00:14<00:04, 36.45it/s] 78%|███████▊  | 517/666 [00:14<00:04, 36.47it/s] 78%|███████▊  | 521/666 [00:14<00:03, 36.47it/s] 79%|███████▉  | 525/666 [00:14<00:03, 36.49it/s] 79%|███████▉  | 529/666 [00:14<00:03, 36.48it/s] 80%|████████  | 533/666 [00:14<00:03, 36.49it/s] 81%|████████  | 537/666 [00:14<00:03, 36.40it/s] 81%|████████  | 541/666 [00:15<00:03, 36.44it/s] 82%|████████▏ | 545/666 [00:15<00:03, 36.42it/s] 82%|████████▏ | 549/666 [00:15<00:03, 36.43it/s] 83%|████████▎ | 553/666 [00:15<00:03, 36.46it/s] 84%|████████▎ | 557/666 [00:15<00:02, 36.45it/s] 84%|████████▍ | 561/666 [00:15<00:02, 36.49it/s] 85%|████████▍ | 565/666 [00:15<00:02, 36.47it/s] 85%|████████▌ | 569/666 [00:15<00:02, 36.47it/s] 86%|████████▌ | 573/666 [00:15<00:02, 36.48it/s] 87%|████████▋ | 577/666 [00:15<00:02, 36.47it/s] 87%|████████▋ | 581/666 [00:16<00:02, 36.49it/s] 88%|████████▊ | 585/666 [00:16<00:02, 36.49it/s] 88%|████████▊ | 589/666 [00:16<00:02, 36.50it/s] 89%|████████▉ | 593/666 [00:16<00:01, 36.51it/s] 90%|████████▉ | 597/666 [00:16<00:01, 36.48it/s] 90%|█████████ | 601/666 [00:16<00:01, 36.51it/s] 91%|█████████ | 605/666 [00:16<00:01, 36.50it/s] 91%|█████████▏| 609/666 [00:16<00:01, 36.50it/s] 92%|█████████▏| 613/666 [00:16<00:01, 36.51it/s] 93%|█████████▎| 617/666 [00:17<00:01, 36.48it/s] 93%|█████████▎| 621/666 [00:17<00:01, 36.51it/s] 94%|█████████▍| 625/666 [00:17<00:01, 36.50it/s] 94%|█████████▍| 629/666 [00:17<00:01, 36.48it/s] 95%|█████████▌| 633/666 [00:17<00:00, 36.49it/s] 96%|█████████▌| 637/666 [00:17<00:00, 36.48it/s] 96%|█████████▌| 641/666 [00:17<00:00, 36.50it/s] 97%|█████████▋| 645/666 [00:17<00:00, 36.48it/s] 97%|█████████▋| 649/666 [00:17<00:00, 36.50it/s] 98%|█████████▊| 653/666 [00:18<00:00, 36.51it/s] 99%|█████████▊| 657/666 [00:18<00:00, 36.49it/s] 99%|█████████▉| 661/666 [00:18<00:00, 35.86it/s]100%|█████████▉| 665/666 [00:18<00:00, 36.17it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.50it/s][A
  6%|▌         | 10/167 [00:00<00:03, 42.78it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 114.47it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 154.84it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 179.05it/s][A
 61%|██████    | 102/167 [00:00<00:00, 194.73it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 205.22it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 212.41it/s][A100%|██████████| 167/167 [00:01<00:00, 165.04it/s]
2022-11-28 21:36:41,388 P8156 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:36:41,388 P8156 INFO Monitor(max) STOP: -10.620960 !
2022-11-28 21:36:41,388 P8156 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:36:41,388 P8156 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:19<00:00, 33.95it/s]
2022-11-28 21:36:41,446 P8156 INFO Train loss: 69.038083
2022-11-28 21:36:41,446 P8156 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:02,  5.44it/s]  1%|          | 5/666 [00:00<00:33, 19.56it/s]  1%|▏         | 9/666 [00:00<00:25, 26.16it/s]  2%|▏         | 13/666 [00:00<00:21, 29.69it/s]  3%|▎         | 17/666 [00:00<00:20, 31.96it/s]  3%|▎         | 21/666 [00:00<00:19, 33.40it/s]  4%|▍         | 25/666 [00:00<00:18, 34.31it/s]  4%|▍         | 29/666 [00:00<00:18, 34.93it/s]  5%|▍         | 33/666 [00:01<00:17, 35.37it/s]  6%|▌         | 37/666 [00:01<00:17, 35.69it/s]  6%|▌         | 41/666 [00:01<00:17, 35.89it/s]  7%|▋         | 45/666 [00:01<00:17, 36.06it/s]  7%|▋         | 49/666 [00:01<00:17, 36.14it/s]  8%|▊         | 53/666 [00:01<00:17, 36.05it/s]  9%|▊         | 57/666 [00:01<00:16, 35.91it/s]  9%|▉         | 61/666 [00:01<00:16, 35.85it/s] 10%|▉         | 65/666 [00:01<00:16, 35.80it/s] 10%|█         | 69/666 [00:02<00:16, 35.76it/s] 11%|█         | 73/666 [00:02<00:16, 35.73it/s] 12%|█▏        | 77/666 [00:02<00:16, 35.71it/s] 12%|█▏        | 81/666 [00:02<00:16, 35.68it/s] 13%|█▎        | 85/666 [00:02<00:16, 35.68it/s] 13%|█▎        | 89/666 [00:02<00:16, 35.68it/s] 14%|█▍        | 93/666 [00:02<00:16, 35.68it/s] 15%|█▍        | 97/666 [00:02<00:15, 35.68it/s] 15%|█▌        | 101/666 [00:02<00:15, 35.68it/s] 16%|█▌        | 105/666 [00:03<00:15, 35.69it/s] 16%|█▋        | 109/666 [00:03<00:15, 35.71it/s] 17%|█▋        | 113/666 [00:03<00:15, 35.72it/s] 18%|█▊        | 117/666 [00:03<00:15, 35.70it/s] 18%|█▊        | 121/666 [00:03<00:15, 35.72it/s] 19%|█▉        | 125/666 [00:03<00:15, 35.65it/s] 19%|█▉        | 129/666 [00:03<00:15, 35.69it/s] 20%|█▉        | 133/666 [00:03<00:14, 35.72it/s] 21%|██        | 137/666 [00:03<00:14, 35.72it/s] 21%|██        | 141/666 [00:04<00:14, 35.73it/s] 22%|██▏       | 145/666 [00:04<00:14, 35.73it/s] 22%|██▏       | 149/666 [00:04<00:14, 35.71it/s] 23%|██▎       | 153/666 [00:04<00:14, 35.70it/s] 24%|██▎       | 157/666 [00:04<00:14, 35.73it/s] 24%|██▍       | 161/666 [00:04<00:14, 35.72it/s] 25%|██▍       | 165/666 [00:04<00:14, 35.71it/s] 25%|██▌       | 169/666 [00:04<00:13, 35.72it/s] 26%|██▌       | 173/666 [00:04<00:13, 35.73it/s] 27%|██▋       | 177/666 [00:05<00:13, 35.72it/s] 27%|██▋       | 181/666 [00:05<00:13, 35.71it/s] 28%|██▊       | 185/666 [00:05<00:13, 35.72it/s] 28%|██▊       | 189/666 [00:05<00:13, 35.71it/s] 29%|██▉       | 193/666 [00:05<00:13, 35.71it/s] 30%|██▉       | 197/666 [00:05<00:13, 35.71it/s] 30%|███       | 201/666 [00:05<00:13, 35.71it/s] 31%|███       | 205/666 [00:05<00:12, 35.70it/s] 31%|███▏      | 209/666 [00:05<00:12, 35.71it/s] 32%|███▏      | 213/666 [00:06<00:12, 35.70it/s] 33%|███▎      | 217/666 [00:06<00:12, 35.73it/s] 33%|███▎      | 221/666 [00:06<00:12, 35.72it/s] 34%|███▍      | 225/666 [00:06<00:12, 35.69it/s] 34%|███▍      | 229/666 [00:06<00:12, 35.72it/s] 35%|███▍      | 233/666 [00:06<00:12, 35.72it/s] 36%|███▌      | 237/666 [00:06<00:12, 35.72it/s] 36%|███▌      | 241/666 [00:06<00:11, 35.72it/s] 37%|███▋      | 245/666 [00:06<00:11, 35.71it/s] 37%|███▋      | 249/666 [00:07<00:11, 35.72it/s] 38%|███▊      | 253/666 [00:07<00:11, 35.72it/s] 39%|███▊      | 257/666 [00:07<00:11, 35.72it/s] 39%|███▉      | 261/666 [00:07<00:11, 35.71it/s] 40%|███▉      | 265/666 [00:07<00:11, 35.72it/s] 40%|████      | 269/666 [00:07<00:11, 35.71it/s] 41%|████      | 273/666 [00:07<00:11, 35.72it/s] 42%|████▏     | 277/666 [00:07<00:10, 35.72it/s] 42%|████▏     | 281/666 [00:08<00:10, 35.72it/s] 43%|████▎     | 285/666 [00:08<00:10, 35.72it/s] 43%|████▎     | 289/666 [00:08<00:10, 35.72it/s] 44%|████▍     | 293/666 [00:08<00:10, 35.72it/s] 45%|████▍     | 297/666 [00:08<00:10, 35.71it/s] 45%|████▌     | 301/666 [00:08<00:10, 35.72it/s] 46%|████▌     | 305/666 [00:08<00:10, 35.72it/s] 46%|████▋     | 309/666 [00:08<00:09, 35.71it/s] 47%|████▋     | 313/666 [00:08<00:09, 35.70it/s] 48%|████▊     | 317/666 [00:09<00:09, 35.70it/s] 48%|████▊     | 321/666 [00:09<00:09, 35.70it/s] 49%|████▉     | 325/666 [00:09<00:09, 35.71it/s] 49%|████▉     | 329/666 [00:09<00:09, 35.71it/s] 50%|█████     | 333/666 [00:09<00:09, 35.72it/s] 51%|█████     | 337/666 [00:09<00:09, 35.72it/s] 51%|█████     | 341/666 [00:09<00:09, 35.72it/s] 52%|█████▏    | 345/666 [00:09<00:08, 35.73it/s] 52%|█████▏    | 349/666 [00:09<00:08, 35.73it/s] 53%|█████▎    | 353/666 [00:10<00:08, 35.72it/s] 54%|█████▎    | 357/666 [00:10<00:08, 35.73it/s] 54%|█████▍    | 361/666 [00:10<00:08, 35.72it/s] 55%|█████▍    | 365/666 [00:10<00:08, 35.71it/s] 55%|█████▌    | 369/666 [00:10<00:08, 35.69it/s] 56%|█████▌    | 373/666 [00:10<00:08, 35.62it/s] 57%|█████▋    | 377/666 [00:10<00:08, 35.64it/s] 57%|█████▋    | 381/666 [00:10<00:07, 35.68it/s] 58%|█████▊    | 385/666 [00:10<00:07, 35.71it/s] 58%|█████▊    | 389/666 [00:11<00:07, 35.73it/s] 59%|█████▉    | 393/666 [00:11<00:07, 35.73it/s] 60%|█████▉    | 397/666 [00:11<00:07, 35.75it/s] 60%|██████    | 401/666 [00:11<00:07, 35.73it/s] 61%|██████    | 405/666 [00:11<00:07, 35.73it/s] 61%|██████▏   | 409/666 [00:11<00:07, 35.74it/s] 62%|██████▏   | 413/666 [00:11<00:07, 35.74it/s] 63%|██████▎   | 417/666 [00:11<00:06, 35.73it/s] 63%|██████▎   | 421/666 [00:11<00:06, 35.73it/s] 64%|██████▍   | 425/666 [00:12<00:06, 35.71it/s] 64%|██████▍   | 429/666 [00:12<00:06, 35.72it/s] 65%|██████▌   | 433/666 [00:12<00:06, 35.72it/s] 66%|██████▌   | 437/666 [00:12<00:06, 35.71it/s] 66%|██████▌   | 441/666 [00:12<00:06, 35.71it/s] 67%|██████▋   | 445/666 [00:12<00:06, 35.64it/s] 67%|██████▋   | 449/666 [00:12<00:06, 35.68it/s] 68%|██████▊   | 453/666 [00:12<00:05, 35.69it/s] 69%|██████▊   | 457/666 [00:12<00:05, 35.72it/s] 69%|██████▉   | 461/666 [00:13<00:05, 35.73it/s] 70%|██████▉   | 465/666 [00:13<00:05, 35.74it/s] 70%|███████   | 469/666 [00:13<00:05, 35.74it/s] 71%|███████   | 473/666 [00:13<00:05, 35.74it/s] 72%|███████▏  | 477/666 [00:13<00:05, 35.73it/s] 72%|███████▏  | 481/666 [00:13<00:05, 35.72it/s] 73%|███████▎  | 485/666 [00:13<00:05, 35.71it/s] 73%|███████▎  | 489/666 [00:13<00:04, 35.71it/s] 74%|███████▍  | 493/666 [00:13<00:04, 35.71it/s] 75%|███████▍  | 497/666 [00:14<00:04, 35.71it/s] 75%|███████▌  | 501/666 [00:14<00:04, 35.72it/s] 76%|███████▌  | 505/666 [00:14<00:04, 35.72it/s] 76%|███████▋  | 509/666 [00:14<00:04, 35.72it/s] 77%|███████▋  | 513/666 [00:14<00:04, 35.72it/s] 78%|███████▊  | 517/666 [00:14<00:04, 35.64it/s] 78%|███████▊  | 521/666 [00:14<00:04, 35.67it/s] 79%|███████▉  | 525/666 [00:14<00:03, 35.71it/s] 79%|███████▉  | 529/666 [00:14<00:03, 35.73it/s] 80%|████████  | 533/666 [00:15<00:03, 35.74it/s] 81%|████████  | 537/666 [00:15<00:03, 35.74it/s] 81%|████████  | 541/666 [00:15<00:03, 35.73it/s] 82%|████████▏ | 545/666 [00:15<00:03, 35.73it/s] 82%|████████▏ | 549/666 [00:15<00:03, 35.74it/s] 83%|████████▎ | 553/666 [00:15<00:03, 35.73it/s] 84%|████████▎ | 557/666 [00:15<00:03, 35.73it/s] 84%|████████▍ | 561/666 [00:15<00:02, 35.72it/s] 85%|████████▍ | 565/666 [00:15<00:02, 35.70it/s] 85%|████████▌ | 569/666 [00:16<00:02, 35.71it/s] 86%|████████▌ | 573/666 [00:16<00:02, 35.71it/s] 87%|████████▋ | 577/666 [00:16<00:02, 35.70it/s] 87%|████████▋ | 581/666 [00:16<00:02, 35.70it/s] 88%|████████▊ | 585/666 [00:16<00:02, 35.71it/s] 88%|████████▊ | 589/666 [00:16<00:02, 35.66it/s] 89%|████████▉ | 593/666 [00:16<00:02, 35.69it/s] 90%|████████▉ | 597/666 [00:16<00:01, 35.72it/s] 90%|█████████ | 601/666 [00:16<00:01, 35.74it/s] 91%|█████████ | 605/666 [00:17<00:01, 35.47it/s] 91%|█████████▏| 609/666 [00:17<00:01, 35.53it/s] 92%|█████████▏| 613/666 [00:17<00:01, 35.58it/s] 93%|█████████▎| 617/666 [00:17<00:01, 35.59it/s] 93%|█████████▎| 621/666 [00:17<00:01, 35.62it/s] 94%|█████████▍| 625/666 [00:17<00:01, 35.61it/s] 94%|█████████▍| 629/666 [00:17<00:01, 35.63it/s] 95%|█████████▌| 633/666 [00:17<00:00, 35.65it/s] 96%|█████████▌| 637/666 [00:17<00:00, 35.68it/s] 96%|█████████▌| 641/666 [00:18<00:00, 35.69it/s] 97%|█████████▋| 645/666 [00:18<00:00, 35.69it/s] 97%|█████████▋| 649/666 [00:18<00:00, 35.71it/s] 98%|█████████▊| 653/666 [00:18<00:00, 35.70it/s] 99%|█████████▊| 657/666 [00:18<00:00, 35.71it/s] 99%|█████████▉| 661/666 [00:18<00:00, 35.19it/s]100%|█████████▉| 665/666 [00:18<00:00, 35.47it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.89it/s][A
  6%|▌         | 10/167 [00:00<00:03, 50.03it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 124.76it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 163.03it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 184.52it/s][A
 61%|██████    | 102/167 [00:00<00:00, 198.39it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 206.91it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 212.20it/s][A100%|██████████| 167/167 [00:00<00:00, 171.03it/s]
2022-11-28 21:37:01,326 P8156 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:37:01,326 P8156 INFO Monitor(max) STOP: -10.620960 !
2022-11-28 21:37:01,326 P8156 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:37:01,327 P8156 INFO Early stopping at epoch=3
2022-11-28 21:37:01,327 P8156 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:19<00:00, 33.36it/s]
2022-11-28 21:37:01,382 P8156 INFO Train loss: 69.031487
2022-11-28 21:37:01,382 P8156 INFO Training finished.
2022-11-28 21:37:01,382 P8156 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_017_182318ab.model
2022-11-28 21:37:01,489 P8156 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:52,  5.89it/s]  2%|▏         | 10/666 [00:00<00:15, 42.63it/s]  5%|▍         | 33/666 [00:00<00:05, 113.76it/s]  8%|▊         | 56/666 [00:00<00:03, 153.14it/s] 12%|█▏        | 77/666 [00:00<00:03, 171.29it/s] 15%|█▍        | 98/666 [00:00<00:03, 180.82it/s] 18%|█▊        | 118/666 [00:00<00:02, 186.35it/s] 21%|██        | 138/666 [00:00<00:02, 189.23it/s] 24%|██▍       | 159/666 [00:00<00:02, 192.63it/s] 27%|██▋       | 179/666 [00:01<00:02, 194.55it/s] 30%|██▉       | 199/666 [00:01<00:02, 196.04it/s] 33%|███▎      | 219/666 [00:01<00:02, 196.83it/s] 36%|███▌      | 239/666 [00:01<00:02, 196.82it/s] 39%|███▉      | 259/666 [00:01<00:02, 197.31it/s] 42%|████▏     | 279/666 [00:01<00:01, 197.46it/s] 45%|████▍     | 299/666 [00:01<00:01, 197.31it/s] 48%|████▊     | 319/666 [00:01<00:01, 197.47it/s] 51%|█████     | 339/666 [00:01<00:01, 197.53it/s] 54%|█████▍    | 359/666 [00:02<00:01, 197.47it/s] 57%|█████▋    | 379/666 [00:02<00:01, 197.25it/s] 60%|█████▉    | 399/666 [00:02<00:01, 197.14it/s] 63%|██████▎   | 419/666 [00:02<00:01, 196.69it/s] 66%|██████▌   | 439/666 [00:02<00:01, 196.42it/s] 69%|██████▉   | 459/666 [00:02<00:01, 196.17it/s] 72%|███████▏  | 479/666 [00:02<00:00, 195.44it/s] 75%|███████▍  | 499/666 [00:02<00:00, 195.28it/s] 78%|███████▊  | 519/666 [00:02<00:00, 195.11it/s] 81%|████████  | 539/666 [00:02<00:00, 195.07it/s] 84%|████████▍ | 559/666 [00:03<00:00, 194.87it/s] 87%|████████▋ | 579/666 [00:03<00:00, 192.49it/s] 90%|████████▉ | 599/666 [00:03<00:00, 192.77it/s] 93%|█████████▎| 619/666 [00:03<00:00, 192.60it/s] 96%|█████████▌| 639/666 [00:03<00:00, 192.41it/s] 99%|█████████▉| 659/666 [00:03<00:00, 188.34it/s]100%|██████████| 666/666 [00:03<00:00, 182.09it/s]
2022-11-28 21:37:05,600 P8156 INFO [Metrics] logloss: 11.126093 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:19,  8.68it/s]  6%|▌         | 10/167 [00:00<00:03, 49.83it/s] 19%|█▊        | 31/167 [00:00<00:01, 116.47it/s] 31%|███       | 52/167 [00:00<00:00, 149.94it/s] 44%|████▎     | 73/167 [00:00<00:00, 169.39it/s] 56%|█████▋    | 94/167 [00:00<00:00, 181.55it/s] 69%|██████▉   | 115/167 [00:00<00:00, 189.36it/s] 81%|████████▏ | 136/167 [00:00<00:00, 194.77it/s] 94%|█████████▍| 157/167 [00:00<00:00, 198.11it/s]100%|██████████| 167/167 [00:01<00:00, 159.13it/s]
2022-11-28 21:37:06,761 P8156 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:37:12,016 P9947 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "256",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_018_b16d0df3",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:37:12,017 P9947 INFO Set up feature encoder...
2022-11-28 21:37:12,019 P9947 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:37:12,020 P9947 INFO Loading data...
2022-11-28 21:37:12,023 P9947 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:37:12,299 P9947 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:37:12,388 P9947 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:37:12,388 P9947 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:37:12,388 P9947 INFO Loading train data done.
2022-11-28 21:37:16,013 P9947 INFO Total number of parameters: 59431684.
2022-11-28 21:37:16,014 P9947 INFO Start training: 666 batches/epoch
2022-11-28 21:37:16,014 P9947 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:37:16.340 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:9947 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:37:16.371 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:9947 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:33,  1.13s/it]  1%|          | 4/666 [00:01<02:46,  3.97it/s]  1%|          | 7/666 [00:01<01:32,  7.11it/s]  2%|▏         | 10/666 [00:01<01:04, 10.13it/s]  2%|▏         | 13/666 [00:01<00:50, 12.83it/s]  2%|▏         | 16/666 [00:01<00:42, 15.16it/s]  3%|▎         | 19/666 [00:01<00:37, 17.09it/s]  3%|▎         | 22/666 [00:02<00:34, 18.62it/s]  4%|▍         | 25/666 [00:02<00:32, 19.79it/s]  4%|▍         | 28/666 [00:02<00:30, 20.64it/s]  5%|▍         | 31/666 [00:02<00:29, 21.28it/s]  5%|▌         | 34/666 [00:02<00:29, 21.73it/s]  6%|▌         | 37/666 [00:02<00:28, 22.07it/s]  6%|▌         | 40/666 [00:02<00:28, 22.31it/s]  6%|▋         | 43/666 [00:02<00:27, 22.48it/s]  7%|▋         | 46/666 [00:03<00:27, 22.60it/s]  7%|▋         | 49/666 [00:03<00:27, 22.68it/s]  8%|▊         | 52/666 [00:03<00:26, 22.74it/s]  8%|▊         | 55/666 [00:03<00:26, 22.78it/s]  9%|▊         | 58/666 [00:03<00:26, 22.81it/s]  9%|▉         | 61/666 [00:03<00:26, 22.83it/s] 10%|▉         | 64/666 [00:03<00:26, 22.85it/s] 10%|█         | 67/666 [00:04<00:26, 22.29it/s] 11%|█         | 70/666 [00:04<00:26, 22.43it/s] 11%|█         | 73/666 [00:04<00:26, 22.53it/s] 11%|█▏        | 76/666 [00:04<00:26, 22.60it/s] 12%|█▏        | 79/666 [00:04<00:25, 22.65it/s] 12%|█▏        | 82/666 [00:04<00:25, 22.68it/s] 13%|█▎        | 85/666 [00:04<00:25, 22.70it/s] 13%|█▎        | 88/666 [00:04<00:25, 22.72it/s] 14%|█▎        | 91/666 [00:05<00:25, 22.73it/s] 14%|█▍        | 94/666 [00:05<00:25, 22.74it/s] 15%|█▍        | 97/666 [00:05<00:25, 22.75it/s] 15%|█▌        | 100/666 [00:05<00:24, 22.75it/s] 15%|█▌        | 103/666 [00:05<00:24, 22.76it/s] 16%|█▌        | 106/666 [00:05<00:24, 22.76it/s] 16%|█▋        | 109/666 [00:05<00:24, 22.76it/s] 17%|█▋        | 112/666 [00:06<00:24, 22.75it/s] 17%|█▋        | 115/666 [00:06<00:24, 22.75it/s] 18%|█▊        | 118/666 [00:06<00:24, 22.75it/s] 18%|█▊        | 121/666 [00:06<00:23, 22.75it/s] 19%|█▊        | 124/666 [00:06<00:23, 22.75it/s] 19%|█▉        | 127/666 [00:06<00:23, 22.75it/s] 20%|█▉        | 130/666 [00:06<00:23, 22.76it/s] 20%|█▉        | 133/666 [00:06<00:23, 22.79it/s] 20%|██        | 136/666 [00:07<00:23, 22.81it/s] 21%|██        | 139/666 [00:07<00:23, 22.84it/s] 21%|██▏       | 142/666 [00:07<00:22, 22.85it/s] 22%|██▏       | 145/666 [00:07<00:22, 22.85it/s] 22%|██▏       | 148/666 [00:07<00:22, 22.85it/s] 23%|██▎       | 151/666 [00:07<00:22, 22.86it/s] 23%|██▎       | 154/666 [00:07<00:22, 22.87it/s] 24%|██▎       | 157/666 [00:07<00:22, 22.87it/s] 24%|██▍       | 160/666 [00:08<00:22, 22.88it/s] 24%|██▍       | 163/666 [00:08<00:21, 22.87it/s] 25%|██▍       | 166/666 [00:08<00:21, 22.87it/s] 25%|██▌       | 169/666 [00:08<00:21, 22.88it/s] 26%|██▌       | 172/666 [00:08<00:21, 22.86it/s] 26%|██▋       | 175/666 [00:08<00:21, 22.83it/s] 27%|██▋       | 178/666 [00:08<00:21, 22.81it/s] 27%|██▋       | 181/666 [00:09<00:21, 22.75it/s] 28%|██▊       | 184/666 [00:09<00:21, 22.73it/s] 28%|██▊       | 187/666 [00:09<00:21, 22.73it/s] 29%|██▊       | 190/666 [00:09<00:20, 22.74it/s] 29%|██▉       | 193/666 [00:09<00:20, 22.76it/s] 29%|██▉       | 196/666 [00:09<00:20, 22.79it/s] 30%|██▉       | 199/666 [00:09<00:20, 22.81it/s] 30%|███       | 202/666 [00:09<00:20, 22.83it/s] 31%|███       | 205/666 [00:10<00:20, 22.84it/s] 31%|███       | 208/666 [00:10<00:20, 22.84it/s] 32%|███▏      | 211/666 [00:10<00:19, 22.85it/s] 32%|███▏      | 214/666 [00:10<00:19, 22.84it/s] 33%|███▎      | 217/666 [00:10<00:19, 22.85it/s] 33%|███▎      | 220/666 [00:10<00:19, 22.85it/s] 33%|███▎      | 223/666 [00:10<00:19, 22.86it/s] 34%|███▍      | 226/666 [00:11<00:19, 22.85it/s] 34%|███▍      | 229/666 [00:11<00:19, 22.85it/s] 35%|███▍      | 232/666 [00:11<00:18, 22.85it/s] 35%|███▌      | 235/666 [00:11<00:18, 22.85it/s] 36%|███▌      | 238/666 [00:11<00:18, 22.86it/s] 36%|███▌      | 241/666 [00:11<00:18, 22.85it/s] 37%|███▋      | 244/666 [00:11<00:18, 22.84it/s] 37%|███▋      | 247/666 [00:11<00:18, 22.82it/s] 38%|███▊      | 250/666 [00:12<00:18, 22.80it/s] 38%|███▊      | 253/666 [00:12<00:18, 22.78it/s] 38%|███▊      | 256/666 [00:12<00:17, 22.79it/s] 39%|███▉      | 259/666 [00:12<00:17, 22.81it/s] 39%|███▉      | 262/666 [00:12<00:17, 22.83it/s] 40%|███▉      | 265/666 [00:12<00:17, 22.85it/s] 40%|████      | 268/666 [00:12<00:17, 22.85it/s] 41%|████      | 271/666 [00:12<00:17, 22.86it/s] 41%|████      | 274/666 [00:13<00:17, 22.85it/s] 42%|████▏     | 277/666 [00:13<00:17, 22.86it/s] 42%|████▏     | 280/666 [00:13<00:16, 22.86it/s] 42%|████▏     | 283/666 [00:13<00:16, 22.85it/s] 43%|████▎     | 286/666 [00:13<00:16, 22.85it/s] 43%|████▎     | 289/666 [00:13<00:16, 22.85it/s] 44%|████▍     | 292/666 [00:13<00:16, 22.85it/s] 44%|████▍     | 295/666 [00:14<00:16, 22.85it/s] 45%|████▍     | 298/666 [00:14<00:16, 22.84it/s] 45%|████▌     | 301/666 [00:14<00:16, 22.81it/s] 46%|████▌     | 304/666 [00:14<00:15, 22.79it/s] 46%|████▌     | 307/666 [00:14<00:15, 22.78it/s] 47%|████▋     | 310/666 [00:14<00:15, 22.76it/s] 47%|████▋     | 313/666 [00:14<00:15, 22.75it/s] 47%|████▋     | 316/666 [00:14<00:15, 22.75it/s] 48%|████▊     | 319/666 [00:15<00:15, 22.74it/s] 48%|████▊     | 322/666 [00:15<00:15, 22.73it/s] 49%|████▉     | 325/666 [00:15<00:14, 22.76it/s] 49%|████▉     | 328/666 [00:15<00:14, 22.77it/s] 50%|████▉     | 331/666 [00:15<00:14, 22.80it/s] 50%|█████     | 334/666 [00:15<00:14, 22.81it/s] 51%|█████     | 337/666 [00:15<00:14, 22.83it/s] 51%|█████     | 340/666 [00:16<00:14, 22.84it/s] 52%|█████▏    | 343/666 [00:16<00:14, 22.84it/s] 52%|█████▏    | 346/666 [00:16<00:14, 22.85it/s] 52%|█████▏    | 349/666 [00:16<00:13, 22.86it/s] 53%|█████▎    | 352/666 [00:16<00:13, 22.86it/s] 53%|█████▎    | 355/666 [00:16<00:13, 22.86it/s] 54%|█████▍    | 358/666 [00:16<00:13, 22.85it/s] 54%|█████▍    | 361/666 [00:16<00:13, 22.82it/s] 55%|█████▍    | 364/666 [00:17<00:13, 22.79it/s] 55%|█████▌    | 367/666 [00:17<00:13, 22.77it/s] 56%|█████▌    | 370/666 [00:17<00:13, 22.76it/s] 56%|█████▌    | 373/666 [00:17<00:12, 22.74it/s] 56%|█████▋    | 376/666 [00:17<00:12, 22.74it/s] 57%|█████▋    | 379/666 [00:17<00:12, 22.73it/s] 57%|█████▋    | 382/666 [00:17<00:12, 22.75it/s] 58%|█████▊    | 385/666 [00:17<00:12, 22.78it/s] 58%|█████▊    | 388/666 [00:18<00:12, 22.81it/s] 59%|█████▊    | 391/666 [00:18<00:12, 22.83it/s] 59%|█████▉    | 394/666 [00:18<00:11, 22.84it/s] 60%|█████▉    | 397/666 [00:18<00:11, 22.85it/s] 60%|██████    | 400/666 [00:18<00:11, 22.84it/s] 61%|██████    | 403/666 [00:18<00:11, 22.85it/s] 61%|██████    | 406/666 [00:18<00:11, 22.86it/s] 61%|██████▏   | 409/666 [00:19<00:11, 22.86it/s] 62%|██████▏   | 412/666 [00:19<00:11, 22.85it/s] 62%|██████▏   | 415/666 [00:19<00:10, 22.86it/s] 63%|██████▎   | 418/666 [00:19<00:10, 22.85it/s] 63%|██████▎   | 421/666 [00:19<00:10, 22.86it/s] 64%|██████▎   | 424/666 [00:19<00:10, 22.85it/s] 64%|██████▍   | 427/666 [00:19<00:10, 22.82it/s] 65%|██████▍   | 430/666 [00:19<00:10, 22.80it/s] 65%|██████▌   | 433/666 [00:20<00:10, 22.78it/s] 65%|██████▌   | 436/666 [00:20<00:10, 22.76it/s] 66%|██████▌   | 439/666 [00:20<00:09, 22.76it/s] 66%|██████▋   | 442/666 [00:20<00:09, 22.75it/s] 67%|██████▋   | 445/666 [00:20<00:09, 22.74it/s] 67%|██████▋   | 448/666 [00:20<00:09, 22.73it/s] 68%|██████▊   | 451/666 [00:20<00:09, 22.77it/s] 68%|██████▊   | 454/666 [00:21<00:09, 22.80it/s] 69%|██████▊   | 457/666 [00:21<00:09, 22.81it/s] 69%|██████▉   | 460/666 [00:21<00:09, 22.83it/s] 70%|██████▉   | 463/666 [00:21<00:08, 22.84it/s] 70%|██████▉   | 466/666 [00:21<00:08, 22.84it/s] 70%|███████   | 469/666 [00:21<00:08, 22.85it/s] 71%|███████   | 472/666 [00:21<00:08, 22.85it/s] 71%|███████▏  | 475/666 [00:21<00:08, 22.85it/s] 72%|███████▏  | 478/666 [00:22<00:08, 22.86it/s] 72%|███████▏  | 481/666 [00:22<00:08, 22.85it/s] 73%|███████▎  | 484/666 [00:22<00:07, 22.85it/s] 73%|███████▎  | 487/666 [00:22<00:07, 22.83it/s] 74%|███████▎  | 490/666 [00:22<00:07, 22.80it/s] 74%|███████▍  | 493/666 [00:22<00:07, 22.78it/s] 74%|███████▍  | 496/666 [00:22<00:07, 22.76it/s] 75%|███████▍  | 499/666 [00:22<00:07, 22.76it/s] 75%|███████▌  | 502/666 [00:23<00:07, 22.75it/s] 76%|███████▌  | 505/666 [00:23<00:07, 22.72it/s] 76%|███████▋  | 508/666 [00:23<00:06, 22.73it/s] 77%|███████▋  | 511/666 [00:23<00:06, 22.77it/s] 77%|███████▋  | 514/666 [00:23<00:06, 22.80it/s] 78%|███████▊  | 517/666 [00:23<00:06, 22.82it/s] 78%|███████▊  | 520/666 [00:23<00:06, 22.84it/s] 79%|███████▊  | 523/666 [00:24<00:06, 22.84it/s] 79%|███████▉  | 526/666 [00:24<00:06, 22.84it/s] 79%|███████▉  | 529/666 [00:24<00:05, 22.85it/s] 80%|███████▉  | 532/666 [00:24<00:05, 22.86it/s] 80%|████████  | 535/666 [00:24<00:05, 22.86it/s] 81%|████████  | 538/666 [00:24<00:05, 22.85it/s] 81%|████████  | 541/666 [00:24<00:05, 22.86it/s] 82%|████████▏ | 544/666 [00:24<00:05, 22.86it/s] 82%|████████▏ | 547/666 [00:25<00:05, 22.87it/s] 83%|████████▎ | 550/666 [00:25<00:05, 22.85it/s] 83%|████████▎ | 553/666 [00:25<00:04, 22.82it/s] 83%|████████▎ | 556/666 [00:25<00:04, 22.80it/s] 84%|████████▍ | 559/666 [00:25<00:04, 22.78it/s] 84%|████████▍ | 562/666 [00:25<00:04, 22.76it/s] 85%|████████▍ | 565/666 [00:25<00:04, 22.75it/s] 85%|████████▌ | 568/666 [00:26<00:04, 22.74it/s] 86%|████████▌ | 571/666 [00:26<00:04, 22.74it/s] 86%|████████▌ | 574/666 [00:26<00:04, 22.74it/s] 87%|████████▋ | 577/666 [00:26<00:03, 22.74it/s] 87%|████████▋ | 580/666 [00:26<00:03, 22.73it/s] 88%|████████▊ | 583/666 [00:26<00:03, 22.74it/s] 88%|████████▊ | 586/666 [00:26<00:03, 22.73it/s] 88%|████████▊ | 589/666 [00:26<00:03, 22.73it/s] 89%|████████▉ | 592/666 [00:27<00:03, 22.73it/s] 89%|████████▉ | 595/666 [00:27<00:03, 22.73it/s] 90%|████████▉ | 598/666 [00:27<00:02, 22.73it/s] 90%|█████████ | 601/666 [00:27<00:02, 22.73it/s] 91%|█████████ | 604/666 [00:27<00:02, 22.74it/s] 91%|█████████ | 607/666 [00:27<00:02, 22.74it/s] 92%|█████████▏| 610/666 [00:27<00:02, 22.74it/s] 92%|█████████▏| 613/666 [00:27<00:02, 22.75it/s] 92%|█████████▏| 616/666 [00:28<00:02, 22.74it/s] 93%|█████████▎| 619/666 [00:28<00:02, 22.73it/s] 93%|█████████▎| 622/666 [00:28<00:01, 22.74it/s] 94%|█████████▍| 625/666 [00:28<00:01, 22.73it/s] 94%|█████████▍| 628/666 [00:28<00:01, 22.73it/s] 95%|█████████▍| 631/666 [00:28<00:01, 22.73it/s] 95%|█████████▌| 634/666 [00:28<00:01, 22.74it/s] 96%|█████████▌| 637/666 [00:29<00:01, 22.78it/s] 96%|█████████▌| 640/666 [00:29<00:01, 22.80it/s] 97%|█████████▋| 643/666 [00:29<00:01, 22.82it/s] 97%|█████████▋| 646/666 [00:29<00:00, 22.83it/s] 97%|█████████▋| 649/666 [00:29<00:00, 22.84it/s] 98%|█████████▊| 652/666 [00:29<00:00, 22.84it/s] 98%|█████████▊| 655/666 [00:29<00:00, 22.85it/s] 99%|█████████▉| 658/666 [00:29<00:00, 22.86it/s] 99%|█████████▉| 661/666 [00:30<00:00, 22.49it/s]100%|█████████▉| 664/666 [00:30<00:00, 22.64it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.05it/s][A
  6%|▌         | 10/167 [00:00<00:03, 50.36it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 124.51it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 162.21it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 183.67it/s][A
 61%|██████    | 102/167 [00:00<00:00, 197.22it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 206.06it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 211.24it/s][A100%|██████████| 167/167 [00:00<00:00, 171.09it/s]
2022-11-28 21:37:47,420 P9947 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:37:47,421 P9947 INFO Save best model: monitor(max): -4.497136
2022-11-28 21:37:49,846 P9947 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:33<00:00, 19.66it/s]
2022-11-28 21:37:49,887 P9947 INFO Train loss: 50.138473
2022-11-28 21:37:49,887 P9947 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:15,  4.93it/s]  1%|          | 4/666 [00:00<00:50, 13.13it/s]  1%|          | 7/666 [00:00<00:38, 17.02it/s]  2%|▏         | 10/666 [00:00<00:34, 18.99it/s]  2%|▏         | 13/666 [00:00<00:32, 20.34it/s]  2%|▏         | 16/666 [00:00<00:30, 21.23it/s]  3%|▎         | 19/666 [00:00<00:29, 21.83it/s]  3%|▎         | 22/666 [00:01<00:28, 22.23it/s]  4%|▍         | 25/666 [00:01<00:28, 22.49it/s]  4%|▍         | 28/666 [00:01<00:28, 22.68it/s]  5%|▍         | 31/666 [00:01<00:27, 22.81it/s]  5%|▌         | 34/666 [00:01<00:27, 22.90it/s]  6%|▌         | 37/666 [00:01<00:27, 22.96it/s]  6%|▌         | 40/666 [00:01<00:27, 23.01it/s]  6%|▋         | 43/666 [00:02<00:27, 23.02it/s]  7%|▋         | 46/666 [00:02<00:26, 23.04it/s]  7%|▋         | 49/666 [00:02<00:26, 23.04it/s]  8%|▊         | 52/666 [00:02<00:26, 23.06it/s]  8%|▊         | 55/666 [00:02<00:26, 23.07it/s]  9%|▊         | 58/666 [00:02<00:26, 23.08it/s]  9%|▉         | 61/666 [00:02<00:26, 23.05it/s] 10%|▉         | 64/666 [00:02<00:26, 23.05it/s] 10%|█         | 67/666 [00:03<00:25, 23.06it/s] 11%|█         | 70/666 [00:03<00:25, 23.07it/s] 11%|█         | 73/666 [00:03<00:25, 23.09it/s] 11%|█▏        | 76/666 [00:03<00:25, 23.10it/s] 12%|█▏        | 79/666 [00:03<00:25, 23.09it/s] 12%|█▏        | 82/666 [00:03<00:25, 23.09it/s] 13%|█▎        | 85/666 [00:03<00:25, 23.10it/s] 13%|█▎        | 88/666 [00:03<00:25, 23.09it/s] 14%|█▎        | 91/666 [00:04<00:24, 23.08it/s] 14%|█▍        | 94/666 [00:04<00:24, 23.07it/s] 15%|█▍        | 97/666 [00:04<00:24, 23.09it/s] 15%|█▌        | 100/666 [00:04<00:24, 23.09it/s] 15%|█▌        | 103/666 [00:04<00:24, 23.10it/s] 16%|█▌        | 106/666 [00:04<00:24, 23.10it/s] 16%|█▋        | 109/666 [00:04<00:24, 23.10it/s] 17%|█▋        | 112/666 [00:05<00:23, 23.10it/s] 17%|█▋        | 115/666 [00:05<00:23, 23.11it/s] 18%|█▊        | 118/666 [00:05<00:23, 23.09it/s] 18%|█▊        | 121/666 [00:05<00:23, 23.09it/s] 19%|█▊        | 124/666 [00:05<00:23, 23.10it/s] 19%|█▉        | 127/666 [00:05<00:23, 23.10it/s] 20%|█▉        | 130/666 [00:05<00:23, 23.09it/s] 20%|█▉        | 133/666 [00:05<00:23, 23.10it/s] 20%|██        | 136/666 [00:06<00:22, 23.10it/s] 21%|██        | 139/666 [00:06<00:22, 23.09it/s] 21%|██▏       | 142/666 [00:06<00:22, 23.09it/s] 22%|██▏       | 145/666 [00:06<00:22, 23.09it/s] 22%|██▏       | 148/666 [00:06<00:22, 23.10it/s] 23%|██▎       | 151/666 [00:06<00:22, 23.10it/s] 23%|██▎       | 154/666 [00:06<00:22, 23.10it/s] 24%|██▎       | 157/666 [00:06<00:22, 23.10it/s] 24%|██▍       | 160/666 [00:07<00:21, 23.11it/s] 24%|██▍       | 163/666 [00:07<00:21, 23.10it/s] 25%|██▍       | 166/666 [00:07<00:21, 23.10it/s] 25%|██▌       | 169/666 [00:07<00:21, 23.11it/s] 26%|██▌       | 172/666 [00:07<00:21, 23.09it/s] 26%|██▋       | 175/666 [00:07<00:21, 23.10it/s] 27%|██▋       | 178/666 [00:07<00:21, 23.11it/s] 27%|██▋       | 181/666 [00:08<00:20, 23.11it/s] 28%|██▊       | 184/666 [00:08<00:20, 23.11it/s] 28%|██▊       | 187/666 [00:08<00:20, 23.11it/s] 29%|██▊       | 190/666 [00:08<00:20, 23.10it/s] 29%|██▉       | 193/666 [00:08<00:20, 23.11it/s] 29%|██▉       | 196/666 [00:08<00:20, 23.11it/s] 30%|██▉       | 199/666 [00:08<00:20, 23.11it/s] 30%|███       | 202/666 [00:08<00:20, 23.09it/s] 31%|███       | 205/666 [00:09<00:19, 23.10it/s] 31%|███       | 208/666 [00:09<00:19, 23.10it/s] 32%|███▏      | 211/666 [00:09<00:19, 23.10it/s] 32%|███▏      | 214/666 [00:09<00:19, 23.09it/s] 33%|███▎      | 217/666 [00:09<00:19, 23.09it/s] 33%|███▎      | 220/666 [00:09<00:19, 23.10it/s] 33%|███▎      | 223/666 [00:09<00:19, 23.10it/s] 34%|███▍      | 226/666 [00:09<00:19, 23.09it/s] 34%|███▍      | 229/666 [00:10<00:18, 23.10it/s] 35%|███▍      | 232/666 [00:10<00:18, 23.10it/s] 35%|███▌      | 235/666 [00:10<00:18, 23.08it/s] 36%|███▌      | 238/666 [00:10<00:18, 23.09it/s] 36%|███▌      | 241/666 [00:10<00:18, 23.08it/s] 37%|███▋      | 244/666 [00:10<00:18, 23.08it/s] 37%|███▋      | 247/666 [00:10<00:18, 23.09it/s] 38%|███▊      | 250/666 [00:11<00:18, 23.09it/s] 38%|███▊      | 253/666 [00:11<00:17, 23.09it/s] 38%|███▊      | 256/666 [00:11<00:17, 23.09it/s] 39%|███▉      | 259/666 [00:11<00:17, 23.09it/s] 39%|███▉      | 262/666 [00:11<00:17, 23.09it/s] 40%|███▉      | 265/666 [00:11<00:17, 23.06it/s] 40%|████      | 268/666 [00:11<00:17, 23.01it/s] 41%|████      | 271/666 [00:11<00:17, 23.01it/s] 41%|████      | 274/666 [00:12<00:17, 23.03it/s] 42%|████▏     | 277/666 [00:12<00:16, 23.06it/s] 42%|████▏     | 280/666 [00:12<00:16, 23.07it/s] 42%|████▏     | 283/666 [00:12<00:16, 23.06it/s] 43%|████▎     | 286/666 [00:12<00:16, 23.06it/s] 43%|████▎     | 289/666 [00:12<00:16, 23.08it/s] 44%|████▍     | 292/666 [00:12<00:16, 23.09it/s] 44%|████▍     | 295/666 [00:12<00:16, 23.10it/s] 45%|████▍     | 298/666 [00:13<00:15, 23.09it/s] 45%|████▌     | 301/666 [00:13<00:15, 23.10it/s] 46%|████▌     | 304/666 [00:13<00:15, 23.09it/s] 46%|████▌     | 307/666 [00:13<00:15, 23.10it/s] 47%|████▋     | 310/666 [00:13<00:15, 23.10it/s] 47%|████▋     | 313/666 [00:13<00:15, 23.11it/s] 47%|████▋     | 316/666 [00:13<00:15, 23.11it/s] 48%|████▊     | 319/666 [00:13<00:15, 23.10it/s] 48%|████▊     | 322/666 [00:14<00:14, 23.10it/s] 49%|████▉     | 325/666 [00:14<00:14, 23.09it/s] 49%|████▉     | 328/666 [00:14<00:14, 23.09it/s] 50%|████▉     | 331/666 [00:14<00:14, 23.10it/s] 50%|█████     | 334/666 [00:14<00:14, 23.10it/s] 51%|█████     | 337/666 [00:14<00:14, 23.11it/s] 51%|█████     | 340/666 [00:14<00:14, 23.11it/s] 52%|█████▏    | 343/666 [00:15<00:13, 23.10it/s] 52%|█████▏    | 346/666 [00:15<00:13, 23.11it/s] 52%|█████▏    | 349/666 [00:15<00:13, 23.11it/s] 53%|█████▎    | 352/666 [00:15<00:13, 23.10it/s] 53%|█████▎    | 355/666 [00:15<00:13, 23.10it/s] 54%|█████▍    | 358/666 [00:15<00:13, 23.09it/s] 54%|█████▍    | 361/666 [00:15<00:13, 23.09it/s] 55%|█████▍    | 364/666 [00:15<00:13, 23.10it/s] 55%|█████▌    | 367/666 [00:16<00:12, 23.11it/s] 56%|█████▌    | 370/666 [00:16<00:12, 23.11it/s] 56%|█████▌    | 373/666 [00:16<00:12, 23.11it/s] 56%|█████▋    | 376/666 [00:16<00:12, 23.08it/s] 57%|█████▋    | 379/666 [00:16<00:12, 23.09it/s] 57%|█████▋    | 382/666 [00:16<00:12, 23.09it/s] 58%|█████▊    | 385/666 [00:16<00:12, 23.09it/s] 58%|█████▊    | 388/666 [00:16<00:12, 23.08it/s] 59%|█████▊    | 391/666 [00:17<00:11, 23.09it/s] 59%|█████▉    | 394/666 [00:17<00:11, 23.09it/s] 60%|█████▉    | 397/666 [00:17<00:11, 23.10it/s] 60%|██████    | 400/666 [00:17<00:11, 23.09it/s] 61%|██████    | 403/666 [00:17<00:11, 23.09it/s] 61%|██████    | 406/666 [00:17<00:11, 23.10it/s] 61%|██████▏   | 409/666 [00:17<00:11, 23.10it/s] 62%|██████▏   | 412/666 [00:18<00:10, 23.10it/s] 62%|██████▏   | 415/666 [00:18<00:10, 23.10it/s] 63%|██████▎   | 418/666 [00:18<00:10, 23.10it/s] 63%|██████▎   | 421/666 [00:18<00:10, 23.09it/s] 64%|██████▎   | 424/666 [00:18<00:10, 23.09it/s] 64%|██████▍   | 427/666 [00:18<00:10, 23.10it/s] 65%|██████▍   | 430/666 [00:18<00:10, 23.10it/s] 65%|██████▌   | 433/666 [00:18<00:10, 23.09it/s] 65%|██████▌   | 436/666 [00:19<00:09, 23.08it/s] 66%|██████▌   | 439/666 [00:19<00:09, 23.09it/s] 66%|██████▋   | 442/666 [00:19<00:09, 23.09it/s] 67%|██████▋   | 445/666 [00:19<00:09, 23.09it/s] 67%|██████▋   | 448/666 [00:19<00:09, 23.10it/s] 68%|██████▊   | 451/666 [00:19<00:09, 23.10it/s] 68%|██████▊   | 454/666 [00:19<00:09, 23.11it/s] 69%|██████▊   | 457/666 [00:19<00:09, 23.11it/s] 69%|██████▉   | 460/666 [00:20<00:08, 23.10it/s] 70%|██████▉   | 463/666 [00:20<00:08, 23.10it/s] 70%|██████▉   | 466/666 [00:20<00:08, 23.07it/s] 70%|███████   | 469/666 [00:20<00:08, 23.08it/s] 71%|███████   | 472/666 [00:20<00:08, 23.02it/s] 71%|███████▏  | 475/666 [00:20<00:08, 23.03it/s] 72%|███████▏  | 478/666 [00:20<00:08, 23.04it/s] 72%|███████▏  | 481/666 [00:21<00:08, 23.06it/s] 73%|███████▎  | 484/666 [00:21<00:07, 23.06it/s] 73%|███████▎  | 487/666 [00:21<00:07, 23.07it/s] 74%|███████▎  | 490/666 [00:21<00:07, 23.08it/s] 74%|███████▍  | 493/666 [00:21<00:07, 23.08it/s] 74%|███████▍  | 496/666 [00:21<00:07, 23.08it/s] 75%|███████▍  | 499/666 [00:21<00:07, 23.09it/s] 75%|███████▌  | 502/666 [00:21<00:07, 23.10it/s] 76%|███████▌  | 505/666 [00:22<00:06, 23.10it/s] 76%|███████▋  | 508/666 [00:22<00:06, 23.09it/s] 77%|███████▋  | 511/666 [00:22<00:06, 23.10it/s] 77%|███████▋  | 514/666 [00:22<00:06, 23.11it/s] 78%|███████▊  | 517/666 [00:22<00:06, 23.11it/s] 78%|███████▊  | 520/666 [00:22<00:06, 23.11it/s] 79%|███████▊  | 523/666 [00:22<00:06, 23.11it/s] 79%|███████▉  | 526/666 [00:22<00:06, 23.10it/s] 79%|███████▉  | 529/666 [00:23<00:05, 23.10it/s] 80%|███████▉  | 532/666 [00:23<00:05, 23.10it/s] 80%|████████  | 535/666 [00:23<00:05, 23.04it/s] 81%|████████  | 538/666 [00:23<00:05, 23.04it/s] 81%|████████  | 541/666 [00:23<00:05, 23.06it/s] 82%|████████▏ | 544/666 [00:23<00:05, 23.06it/s] 82%|████████▏ | 547/666 [00:23<00:05, 23.07it/s] 83%|████████▎ | 550/666 [00:23<00:05, 23.09it/s] 83%|████████▎ | 553/666 [00:24<00:04, 23.09it/s] 83%|████████▎ | 556/666 [00:24<00:04, 23.09it/s] 84%|████████▍ | 559/666 [00:24<00:04, 23.09it/s] 84%|████████▍ | 562/666 [00:24<00:04, 23.08it/s] 85%|████████▍ | 565/666 [00:24<00:04, 23.08it/s] 85%|████████▌ | 568/666 [00:24<00:04, 23.09it/s] 86%|████████▌ | 571/666 [00:24<00:04, 23.09it/s] 86%|████████▌ | 574/666 [00:25<00:03, 23.10it/s] 87%|████████▋ | 577/666 [00:25<00:03, 23.10it/s] 87%|████████▋ | 580/666 [00:25<00:03, 23.11it/s] 88%|████████▊ | 583/666 [00:25<00:03, 23.11it/s] 88%|████████▊ | 586/666 [00:25<00:03, 23.10it/s] 88%|████████▊ | 589/666 [00:25<00:03, 23.10it/s] 89%|████████▉ | 592/666 [00:25<00:03, 23.09it/s] 89%|████████▉ | 595/666 [00:25<00:03, 23.09it/s] 90%|████████▉ | 598/666 [00:26<00:02, 23.07it/s] 90%|█████████ | 601/666 [00:26<00:02, 23.08it/s] 91%|█████████ | 604/666 [00:26<00:02, 23.06it/s] 91%|█████████ | 607/666 [00:26<00:02, 23.07it/s] 92%|█████████▏| 610/666 [00:26<00:02, 23.07it/s] 92%|█████████▏| 613/666 [00:26<00:02, 23.08it/s] 92%|█████████▏| 616/666 [00:26<00:02, 23.08it/s] 93%|█████████▎| 619/666 [00:26<00:02, 23.08it/s] 93%|█████████▎| 622/666 [00:27<00:01, 23.09it/s] 94%|█████████▍| 625/666 [00:27<00:01, 23.10it/s] 94%|█████████▍| 628/666 [00:27<00:01, 23.09it/s] 95%|█████████▍| 631/666 [00:27<00:01, 23.08it/s] 95%|█████████▌| 634/666 [00:27<00:01, 23.07it/s] 96%|█████████▌| 637/666 [00:27<00:01, 23.08it/s] 96%|█████████▌| 640/666 [00:27<00:01, 23.08it/s] 97%|█████████▋| 643/666 [00:28<00:00, 23.09it/s] 97%|█████████▋| 646/666 [00:28<00:00, 23.09it/s] 97%|█████████▋| 649/666 [00:28<00:00, 23.09it/s] 98%|█████████▊| 652/666 [00:28<00:00, 23.10it/s] 98%|█████████▊| 655/666 [00:28<00:00, 23.10it/s] 99%|█████████▉| 658/666 [00:28<00:00, 23.10it/s] 99%|█████████▉| 661/666 [00:28<00:00, 22.74it/s]100%|█████████▉| 664/666 [00:28<00:00, 22.90it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.27it/s][A
  6%|▌         | 10/167 [00:00<00:03, 43.58it/s][A
 19%|█▉        | 32/167 [00:00<00:01, 112.53it/s][A
 33%|███▎      | 55/167 [00:00<00:00, 152.77it/s][A
 47%|████▋     | 78/167 [00:00<00:00, 176.48it/s][A
 60%|██████    | 101/167 [00:00<00:00, 191.86it/s][A
 74%|███████▍  | 124/167 [00:00<00:00, 201.80it/s][A
 88%|████████▊ | 147/167 [00:00<00:00, 208.50it/s][A100%|██████████| 167/167 [00:01<00:00, 166.34it/s]
2022-11-28 21:38:20,026 P9947 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:38:20,027 P9947 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:38:20,027 P9947 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:38:20,027 P9947 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:30<00:00, 22.06it/s]
2022-11-28 21:38:20,077 P9947 INFO Train loss: 30.971699
2022-11-28 21:38:20,077 P9947 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:11,  5.07it/s]  1%|          | 4/666 [00:00<00:48, 13.66it/s]  1%|          | 7/666 [00:00<00:37, 17.44it/s]  2%|▏         | 10/666 [00:00<00:34, 19.28it/s]  2%|▏         | 13/666 [00:00<00:31, 20.44it/s]  2%|▏         | 16/666 [00:00<00:30, 21.23it/s]  3%|▎         | 19/666 [00:00<00:29, 21.72it/s]  3%|▎         | 22/666 [00:01<00:29, 22.05it/s]  4%|▍         | 25/666 [00:01<00:28, 22.29it/s]  4%|▍         | 28/666 [00:01<00:28, 22.46it/s]  5%|▍         | 31/666 [00:01<00:28, 22.57it/s]  5%|▌         | 34/666 [00:01<00:27, 22.66it/s]  6%|▌         | 37/666 [00:01<00:27, 22.72it/s]  6%|▌         | 40/666 [00:01<00:27, 22.75it/s]  6%|▋         | 43/666 [00:02<00:27, 22.77it/s]  7%|▋         | 46/666 [00:02<00:27, 22.79it/s]  7%|▋         | 49/666 [00:02<00:27, 22.80it/s]  8%|▊         | 52/666 [00:02<00:26, 22.81it/s]  8%|▊         | 55/666 [00:02<00:26, 22.81it/s]  9%|▊         | 58/666 [00:02<00:26, 22.82it/s]  9%|▉         | 61/666 [00:02<00:26, 22.82it/s] 10%|▉         | 64/666 [00:02<00:26, 22.82it/s] 10%|█         | 67/666 [00:03<00:26, 22.82it/s] 11%|█         | 70/666 [00:03<00:26, 22.82it/s] 11%|█         | 73/666 [00:03<00:25, 22.82it/s] 11%|█▏        | 76/666 [00:03<00:25, 22.83it/s] 12%|█▏        | 79/666 [00:03<00:25, 22.83it/s] 12%|█▏        | 82/666 [00:03<00:25, 22.82it/s] 13%|█▎        | 85/666 [00:03<00:25, 22.83it/s] 13%|█▎        | 88/666 [00:04<00:25, 22.82it/s] 14%|█▎        | 91/666 [00:04<00:25, 22.82it/s] 14%|█▍        | 94/666 [00:04<00:25, 22.82it/s] 15%|█▍        | 97/666 [00:04<00:24, 22.83it/s] 15%|█▌        | 100/666 [00:04<00:24, 22.82it/s] 15%|█▌        | 103/666 [00:04<00:24, 22.83it/s] 16%|█▌        | 106/666 [00:04<00:24, 22.83it/s] 16%|█▋        | 109/666 [00:04<00:24, 22.84it/s] 17%|█▋        | 112/666 [00:05<00:24, 22.79it/s] 17%|█▋        | 115/666 [00:05<00:24, 22.79it/s] 18%|█▊        | 118/666 [00:05<00:24, 22.79it/s] 18%|█▊        | 121/666 [00:05<00:23, 22.81it/s] 19%|█▊        | 124/666 [00:05<00:23, 22.82it/s] 19%|█▉        | 127/666 [00:05<00:23, 22.82it/s] 20%|█▉        | 130/666 [00:05<00:23, 22.82it/s] 20%|█▉        | 133/666 [00:05<00:23, 22.82it/s] 20%|██        | 136/666 [00:06<00:23, 22.83it/s] 21%|██        | 139/666 [00:06<00:23, 22.83it/s] 21%|██▏       | 142/666 [00:06<00:22, 22.82it/s] 22%|██▏       | 145/666 [00:06<00:22, 22.82it/s] 22%|██▏       | 148/666 [00:06<00:22, 22.82it/s] 23%|██▎       | 151/666 [00:06<00:22, 22.82it/s] 23%|██▎       | 154/666 [00:06<00:22, 22.83it/s] 24%|██▎       | 157/666 [00:07<00:22, 22.83it/s] 24%|██▍       | 160/666 [00:07<00:22, 22.83it/s] 24%|██▍       | 163/666 [00:07<00:22, 22.84it/s] 25%|██▍       | 166/666 [00:07<00:21, 22.84it/s] 25%|██▌       | 169/666 [00:07<00:21, 22.83it/s] 26%|██▌       | 172/666 [00:07<00:21, 22.83it/s] 26%|██▋       | 175/666 [00:07<00:21, 22.83it/s] 27%|██▋       | 178/666 [00:07<00:21, 22.82it/s] 27%|██▋       | 181/666 [00:08<00:21, 22.83it/s] 28%|██▊       | 184/666 [00:08<00:21, 22.84it/s] 28%|██▊       | 187/666 [00:08<00:20, 22.84it/s] 29%|██▊       | 190/666 [00:08<00:20, 22.83it/s] 29%|██▉       | 193/666 [00:08<00:20, 22.82it/s] 29%|██▉       | 196/666 [00:08<00:20, 22.83it/s] 30%|██▉       | 199/666 [00:08<00:20, 22.83it/s] 30%|███       | 202/666 [00:09<00:20, 22.83it/s] 31%|███       | 205/666 [00:09<00:20, 22.83it/s] 31%|███       | 208/666 [00:09<00:20, 22.83it/s] 32%|███▏      | 211/666 [00:09<00:19, 22.83it/s] 32%|███▏      | 214/666 [00:09<00:19, 22.82it/s] 33%|███▎      | 217/666 [00:09<00:19, 22.83it/s] 33%|███▎      | 220/666 [00:09<00:19, 22.83it/s] 33%|███▎      | 223/666 [00:09<00:19, 22.84it/s] 34%|███▍      | 226/666 [00:10<00:19, 22.84it/s] 34%|███▍      | 229/666 [00:10<00:19, 22.83it/s] 35%|███▍      | 232/666 [00:10<00:19, 22.83it/s] 35%|███▌      | 235/666 [00:10<00:18, 22.84it/s] 36%|███▌      | 238/666 [00:10<00:18, 22.84it/s] 36%|███▌      | 241/666 [00:10<00:18, 22.84it/s] 37%|███▋      | 244/666 [00:10<00:18, 22.84it/s] 37%|███▋      | 247/666 [00:10<00:18, 22.83it/s] 38%|███▊      | 250/666 [00:11<00:18, 22.84it/s] 38%|███▊      | 253/666 [00:11<00:18, 22.84it/s] 38%|███▊      | 256/666 [00:11<00:17, 22.83it/s] 39%|███▉      | 259/666 [00:11<00:17, 22.83it/s] 39%|███▉      | 262/666 [00:11<00:17, 22.83it/s] 40%|███▉      | 265/666 [00:11<00:17, 22.83it/s] 40%|████      | 268/666 [00:11<00:17, 22.82it/s] 41%|████      | 271/666 [00:12<00:17, 22.82it/s] 41%|████      | 274/666 [00:12<00:17, 22.81it/s] 42%|████▏     | 277/666 [00:12<00:17, 22.81it/s] 42%|████▏     | 280/666 [00:12<00:16, 22.82it/s] 42%|████▏     | 283/666 [00:12<00:16, 22.82it/s] 43%|████▎     | 286/666 [00:12<00:16, 22.83it/s] 43%|████▎     | 289/666 [00:12<00:16, 22.82it/s] 44%|████▍     | 292/666 [00:12<00:16, 22.83it/s] 44%|████▍     | 295/666 [00:13<00:16, 22.83it/s] 45%|████▍     | 298/666 [00:13<00:16, 22.83it/s] 45%|████▌     | 301/666 [00:13<00:15, 22.83it/s] 46%|████▌     | 304/666 [00:13<00:15, 22.84it/s] 46%|████▌     | 307/666 [00:13<00:15, 22.83it/s] 47%|████▋     | 310/666 [00:13<00:15, 22.83it/s] 47%|████▋     | 313/666 [00:13<00:15, 22.82it/s] 47%|████▋     | 316/666 [00:14<00:15, 22.82it/s] 48%|████▊     | 319/666 [00:14<00:15, 22.82it/s] 48%|████▊     | 322/666 [00:14<00:15, 22.82it/s] 49%|████▉     | 325/666 [00:14<00:14, 22.83it/s] 49%|████▉     | 328/666 [00:14<00:14, 22.82it/s] 50%|████▉     | 331/666 [00:14<00:14, 22.83it/s] 50%|█████     | 334/666 [00:14<00:14, 22.83it/s] 51%|█████     | 337/666 [00:14<00:14, 22.84it/s] 51%|█████     | 340/666 [00:15<00:14, 22.83it/s] 52%|█████▏    | 343/666 [00:15<00:14, 22.83it/s] 52%|█████▏    | 346/666 [00:15<00:14, 22.84it/s] 52%|█████▏    | 349/666 [00:15<00:13, 22.83it/s] 53%|█████▎    | 352/666 [00:15<00:13, 22.83it/s] 53%|█████▎    | 355/666 [00:15<00:13, 22.84it/s] 54%|█████▍    | 358/666 [00:15<00:13, 22.83it/s] 54%|█████▍    | 361/666 [00:15<00:13, 22.83it/s] 55%|█████▍    | 364/666 [00:16<00:13, 22.84it/s] 55%|█████▌    | 367/666 [00:16<00:13, 22.84it/s] 56%|█████▌    | 370/666 [00:16<00:12, 22.84it/s] 56%|█████▌    | 373/666 [00:16<00:12, 22.83it/s] 56%|█████▋    | 376/666 [00:16<00:12, 22.83it/s] 57%|█████▋    | 379/666 [00:16<00:12, 22.83it/s] 57%|█████▋    | 382/666 [00:16<00:12, 22.84it/s] 58%|█████▊    | 385/666 [00:17<00:12, 22.84it/s] 58%|█████▊    | 388/666 [00:17<00:12, 22.83it/s] 59%|█████▊    | 391/666 [00:17<00:12, 22.83it/s] 59%|█████▉    | 394/666 [00:17<00:11, 22.83it/s] 60%|█████▉    | 397/666 [00:17<00:11, 22.83it/s] 60%|██████    | 400/666 [00:17<00:11, 22.83it/s] 61%|██████    | 403/666 [00:17<00:11, 22.81it/s] 61%|██████    | 406/666 [00:17<00:11, 22.82it/s] 61%|██████▏   | 409/666 [00:18<00:11, 22.83it/s] 62%|██████▏   | 412/666 [00:18<00:11, 22.82it/s] 62%|██████▏   | 415/666 [00:18<00:10, 22.83it/s] 63%|██████▎   | 418/666 [00:18<00:10, 22.83it/s] 63%|██████▎   | 421/666 [00:18<00:10, 22.83it/s] 64%|██████▎   | 424/666 [00:18<00:10, 22.83it/s] 64%|██████▍   | 427/666 [00:18<00:10, 22.84it/s] 65%|██████▍   | 430/666 [00:18<00:10, 22.83it/s] 65%|██████▌   | 433/666 [00:19<00:10, 22.83it/s] 65%|██████▌   | 436/666 [00:19<00:10, 22.83it/s] 66%|██████▌   | 439/666 [00:19<00:09, 22.83it/s] 66%|██████▋   | 442/666 [00:19<00:09, 22.83it/s] 67%|██████▋   | 445/666 [00:19<00:09, 22.84it/s] 67%|██████▋   | 448/666 [00:19<00:09, 22.84it/s] 68%|██████▊   | 451/666 [00:19<00:09, 22.83it/s] 68%|██████▊   | 454/666 [00:20<00:09, 22.82it/s] 69%|██████▊   | 457/666 [00:20<00:09, 22.81it/s] 69%|██████▉   | 460/666 [00:20<00:09, 22.82it/s] 70%|██████▉   | 463/666 [00:20<00:08, 22.82it/s] 70%|██████▉   | 466/666 [00:20<00:08, 22.83it/s] 70%|███████   | 469/666 [00:20<00:08, 22.84it/s] 71%|███████   | 472/666 [00:20<00:08, 22.84it/s] 71%|███████▏  | 475/666 [00:20<00:08, 22.83it/s] 72%|███████▏  | 478/666 [00:21<00:08, 22.83it/s] 72%|███████▏  | 481/666 [00:21<00:08, 22.82it/s] 73%|███████▎  | 484/666 [00:21<00:07, 22.82it/s] 73%|███████▎  | 487/666 [00:21<00:07, 22.83it/s] 74%|███████▎  | 490/666 [00:21<00:07, 22.83it/s] 74%|███████▍  | 493/666 [00:21<00:07, 22.83it/s] 74%|███████▍  | 496/666 [00:21<00:07, 22.82it/s] 75%|███████▍  | 499/666 [00:22<00:07, 22.81it/s] 75%|███████▌  | 502/666 [00:22<00:07, 22.82it/s] 76%|███████▌  | 505/666 [00:22<00:07, 22.82it/s] 76%|███████▋  | 508/666 [00:22<00:06, 22.83it/s] 77%|███████▋  | 511/666 [00:22<00:06, 22.83it/s] 77%|███████▋  | 514/666 [00:22<00:06, 22.83it/s] 78%|███████▊  | 517/666 [00:22<00:06, 22.81it/s] 78%|███████▊  | 520/666 [00:22<00:06, 22.80it/s] 79%|███████▊  | 523/666 [00:23<00:06, 22.80it/s] 79%|███████▉  | 526/666 [00:23<00:06, 22.81it/s] 79%|███████▉  | 529/666 [00:23<00:06, 22.81it/s] 80%|███████▉  | 532/666 [00:23<00:05, 22.82it/s] 80%|████████  | 535/666 [00:23<00:05, 22.83it/s] 81%|████████  | 538/666 [00:23<00:05, 22.82it/s] 81%|████████  | 541/666 [00:23<00:05, 22.82it/s] 82%|████████▏ | 544/666 [00:23<00:05, 22.83it/s] 82%|████████▏ | 547/666 [00:24<00:05, 22.83it/s] 83%|████████▎ | 550/666 [00:24<00:05, 22.83it/s] 83%|████████▎ | 553/666 [00:24<00:04, 22.83it/s] 83%|████████▎ | 556/666 [00:24<00:04, 22.84it/s] 84%|████████▍ | 559/666 [00:24<00:04, 22.83it/s] 84%|████████▍ | 562/666 [00:24<00:04, 22.82it/s] 85%|████████▍ | 565/666 [00:24<00:04, 22.82it/s] 85%|████████▌ | 568/666 [00:25<00:04, 22.82it/s] 86%|████████▌ | 571/666 [00:25<00:04, 22.83it/s] 86%|████████▌ | 574/666 [00:25<00:04, 22.83it/s] 87%|████████▋ | 577/666 [00:25<00:03, 22.82it/s] 87%|████████▋ | 580/666 [00:25<00:03, 22.83it/s] 88%|████████▊ | 583/666 [00:25<00:03, 22.82it/s] 88%|████████▊ | 586/666 [00:25<00:03, 22.83it/s] 88%|████████▊ | 589/666 [00:25<00:03, 22.83it/s] 89%|████████▉ | 592/666 [00:26<00:03, 22.83it/s] 89%|████████▉ | 595/666 [00:26<00:03, 22.84it/s] 90%|████████▉ | 598/666 [00:26<00:02, 22.84it/s] 90%|█████████ | 601/666 [00:26<00:02, 22.84it/s] 91%|█████████ | 604/666 [00:26<00:02, 22.83it/s] 91%|█████████ | 607/666 [00:26<00:02, 22.84it/s] 92%|█████████▏| 610/666 [00:26<00:02, 22.83it/s] 92%|█████████▏| 613/666 [00:27<00:02, 22.82it/s] 92%|█████████▏| 616/666 [00:27<00:02, 22.83it/s] 93%|█████████▎| 619/666 [00:27<00:02, 22.83it/s] 93%|█████████▎| 622/666 [00:27<00:01, 22.84it/s] 94%|█████████▍| 625/666 [00:27<00:01, 22.83it/s] 94%|█████████▍| 628/666 [00:27<00:01, 22.83it/s] 95%|█████████▍| 631/666 [00:27<00:01, 22.83it/s] 95%|█████████▌| 634/666 [00:27<00:01, 22.83it/s] 96%|█████████▌| 637/666 [00:28<00:01, 22.83it/s] 96%|█████████▌| 640/666 [00:28<00:01, 22.82it/s] 97%|█████████▋| 643/666 [00:28<00:01, 22.83it/s] 97%|█████████▋| 646/666 [00:28<00:00, 22.82it/s] 97%|█████████▋| 649/666 [00:28<00:00, 22.82it/s] 98%|█████████▊| 652/666 [00:28<00:00, 22.82it/s] 98%|█████████▊| 655/666 [00:28<00:00, 22.83it/s] 99%|█████████▉| 658/666 [00:28<00:00, 22.83it/s] 99%|█████████▉| 661/666 [00:29<00:00, 22.46it/s]100%|█████████▉| 664/666 [00:29<00:00, 22.61it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.92it/s][A
  6%|▌         | 10/167 [00:00<00:03, 52.26it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 120.10it/s][A
 32%|███▏      | 53/167 [00:00<00:00, 158.06it/s][A
 46%|████▌     | 76/167 [00:00<00:00, 180.64it/s][A
 59%|█████▉    | 99/167 [00:00<00:00, 194.28it/s][A
 73%|███████▎  | 122/167 [00:00<00:00, 203.29it/s][A
 87%|████████▋ | 145/167 [00:00<00:00, 209.07it/s][A100%|██████████| 167/167 [00:00<00:00, 169.53it/s]
2022-11-28 21:38:50,513 P9947 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:38:50,513 P9947 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:38:50,513 P9947 INFO Reduce learning rate on plateau: 0.000010
2022-11-28 21:38:50,513 P9947 INFO Early stopping at epoch=3
2022-11-28 21:38:50,513 P9947 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:30<00:00, 21.81it/s]
2022-11-28 21:38:50,567 P9947 INFO Train loss: 30.971520
2022-11-28 21:38:50,567 P9947 INFO Training finished.
2022-11-28 21:38:50,567 P9947 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_018_b16d0df3.model
2022-11-28 21:38:50,762 P9947 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:58,  5.64it/s]  2%|▏         | 10/666 [00:00<00:16, 38.70it/s]  4%|▍         | 27/666 [00:00<00:07, 85.43it/s]  7%|▋         | 49/666 [00:00<00:04, 129.54it/s] 11%|█         | 71/666 [00:00<00:03, 156.68it/s] 14%|█▍        | 93/666 [00:00<00:03, 174.62it/s] 17%|█▋        | 115/666 [00:00<00:02, 186.45it/s] 21%|██        | 137/666 [00:00<00:02, 194.56it/s] 24%|██▍       | 159/666 [00:01<00:02, 200.04it/s] 27%|██▋       | 181/666 [00:01<00:02, 203.14it/s] 30%|███       | 202/666 [00:01<00:02, 204.91it/s] 33%|███▎      | 223/666 [00:01<00:02, 205.98it/s] 37%|███▋      | 245/666 [00:01<00:02, 207.70it/s] 40%|████      | 267/666 [00:01<00:01, 208.96it/s] 43%|████▎     | 289/666 [00:01<00:01, 209.64it/s] 47%|████▋     | 311/666 [00:01<00:01, 209.81it/s] 50%|█████     | 333/666 [00:01<00:01, 210.07it/s] 53%|█████▎    | 355/666 [00:01<00:01, 210.43it/s] 57%|█████▋    | 377/666 [00:02<00:01, 210.66it/s] 60%|█████▉    | 399/666 [00:02<00:01, 210.68it/s] 63%|██████▎   | 421/666 [00:02<00:01, 210.51it/s] 67%|██████▋   | 443/666 [00:02<00:01, 209.92it/s] 70%|██████▉   | 464/666 [00:02<00:00, 209.82it/s] 73%|███████▎  | 486/666 [00:02<00:00, 210.04it/s] 76%|███████▋  | 508/666 [00:02<00:00, 209.70it/s] 79%|███████▉  | 529/666 [00:02<00:00, 207.43it/s] 83%|████████▎ | 550/666 [00:02<00:00, 207.37it/s] 86%|████████▌ | 571/666 [00:02<00:00, 207.86it/s] 89%|████████▉ | 592/666 [00:03<00:00, 207.75it/s] 92%|█████████▏| 613/666 [00:03<00:00, 207.51it/s] 95%|█████████▌| 634/666 [00:03<00:00, 207.82it/s] 98%|█████████▊| 655/666 [00:03<00:00, 207.83it/s]100%|██████████| 666/666 [00:03<00:00, 189.99it/s]
2022-11-28 21:38:54,721 P9947 INFO [Metrics] logloss: 4.992003 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:17,  9.33it/s]  6%|▌         | 10/167 [00:00<00:03, 51.88it/s] 17%|█▋        | 29/167 [00:00<00:01, 111.52it/s] 29%|██▉       | 49/167 [00:00<00:00, 143.79it/s] 41%|████▏     | 69/167 [00:00<00:00, 162.38it/s] 54%|█████▍    | 90/167 [00:00<00:00, 175.75it/s] 66%|██████▋   | 111/167 [00:00<00:00, 184.45it/s] 79%|███████▉  | 132/167 [00:00<00:00, 190.45it/s] 92%|█████████▏| 153/167 [00:00<00:00, 194.53it/s]100%|██████████| 167/167 [00:01<00:00, 158.31it/s]
2022-11-28 21:38:55,888 P9947 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:39:02,123 P11732 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "64",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_019_5747de84",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:39:02,124 P11732 INFO Set up feature encoder...
2022-11-28 21:39:02,126 P11732 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:39:02,127 P11732 INFO Loading data...
2022-11-28 21:39:02,130 P11732 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:39:02,402 P11732 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:39:02,560 P11732 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:39:02,560 P11732 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:39:02,560 P11732 INFO Loading train data done.
2022-11-28 21:39:05,259 P11732 INFO Total number of parameters: 15268036.
2022-11-28 21:39:05,259 P11732 INFO Start training: 666 batches/epoch
2022-11-28 21:39:05,259 P11732 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:39:05.596 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:11732 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:39:05.628 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:11732 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:26,  1.12s/it]  1%|          | 6/666 [00:01<01:43,  6.36it/s]  2%|▏         | 11/666 [00:01<00:53, 12.22it/s]  2%|▏         | 15/666 [00:01<00:38, 16.73it/s]  3%|▎         | 20/666 [00:01<00:28, 22.87it/s]  4%|▍         | 25/666 [00:01<00:22, 28.59it/s]  5%|▍         | 30/666 [00:01<00:18, 33.55it/s]  5%|▌         | 36/666 [00:01<00:16, 38.30it/s]  6%|▌         | 41/666 [00:01<00:15, 40.96it/s]  7%|▋         | 46/666 [00:02<00:14, 43.34it/s]  8%|▊         | 51/666 [00:02<00:13, 45.15it/s]  9%|▊         | 57/666 [00:02<00:13, 46.75it/s]  9%|▉         | 63/666 [00:02<00:12, 47.84it/s] 10%|█         | 69/666 [00:02<00:12, 48.58it/s] 11%|█▏        | 75/666 [00:02<00:12, 49.13it/s] 12%|█▏        | 81/666 [00:02<00:11, 49.48it/s] 13%|█▎        | 87/666 [00:02<00:11, 49.66it/s] 14%|█▍        | 93/666 [00:03<00:11, 49.82it/s] 15%|█▍        | 99/666 [00:03<00:11, 49.91it/s] 16%|█▌        | 105/666 [00:03<00:11, 49.97it/s] 17%|█▋        | 111/666 [00:03<00:11, 50.03it/s] 18%|█▊        | 117/666 [00:03<00:10, 50.05it/s] 18%|█▊        | 123/666 [00:03<00:10, 50.12it/s] 19%|█▉        | 129/666 [00:03<00:10, 50.17it/s] 20%|██        | 135/666 [00:03<00:10, 50.20it/s] 21%|██        | 141/666 [00:03<00:10, 50.21it/s] 22%|██▏       | 147/666 [00:04<00:10, 50.17it/s] 23%|██▎       | 153/666 [00:04<00:10, 50.17it/s] 24%|██▍       | 159/666 [00:04<00:10, 50.19it/s] 25%|██▍       | 165/666 [00:04<00:09, 50.22it/s] 26%|██▌       | 171/666 [00:04<00:09, 50.28it/s] 27%|██▋       | 177/666 [00:04<00:09, 50.26it/s] 27%|██▋       | 183/666 [00:04<00:09, 50.24it/s] 28%|██▊       | 189/666 [00:04<00:09, 50.21it/s] 29%|██▉       | 195/666 [00:05<00:09, 50.16it/s] 30%|███       | 201/666 [00:05<00:09, 50.15it/s] 31%|███       | 207/666 [00:05<00:09, 50.16it/s] 32%|███▏      | 213/666 [00:05<00:09, 50.17it/s] 33%|███▎      | 219/666 [00:05<00:08, 50.20it/s] 34%|███▍      | 225/666 [00:05<00:08, 50.23it/s] 35%|███▍      | 231/666 [00:05<00:08, 50.24it/s] 36%|███▌      | 237/666 [00:05<00:08, 50.20it/s] 36%|███▋      | 243/666 [00:05<00:08, 50.18it/s] 37%|███▋      | 249/666 [00:06<00:08, 50.05it/s] 38%|███▊      | 255/666 [00:06<00:08, 50.03it/s] 39%|███▉      | 261/666 [00:06<00:08, 50.07it/s] 40%|████      | 267/666 [00:06<00:07, 50.09it/s] 41%|████      | 273/666 [00:06<00:07, 50.09it/s] 42%|████▏     | 279/666 [00:06<00:07, 50.09it/s] 43%|████▎     | 285/666 [00:06<00:07, 50.01it/s] 44%|████▎     | 291/666 [00:06<00:07, 50.01it/s] 45%|████▍     | 297/666 [00:07<00:07, 49.98it/s] 45%|████▌     | 303/666 [00:07<00:07, 50.00it/s] 46%|████▋     | 309/666 [00:07<00:07, 49.49it/s] 47%|████▋     | 315/666 [00:07<00:07, 49.67it/s] 48%|████▊     | 321/666 [00:07<00:06, 49.79it/s] 49%|████▉     | 327/666 [00:07<00:06, 49.88it/s] 50%|█████     | 333/666 [00:07<00:06, 49.95it/s] 51%|█████     | 339/666 [00:07<00:06, 50.00it/s] 52%|█████▏    | 345/666 [00:08<00:06, 50.07it/s] 53%|█████▎    | 351/666 [00:08<00:06, 50.12it/s] 54%|█████▎    | 357/666 [00:08<00:06, 50.17it/s] 55%|█████▍    | 363/666 [00:08<00:06, 50.20it/s] 55%|█████▌    | 369/666 [00:08<00:05, 50.19it/s] 56%|█████▋    | 375/666 [00:08<00:05, 50.18it/s] 57%|█████▋    | 381/666 [00:08<00:05, 50.14it/s] 58%|█████▊    | 387/666 [00:08<00:05, 50.15it/s] 59%|█████▉    | 393/666 [00:08<00:05, 50.14it/s] 60%|█████▉    | 399/666 [00:09<00:05, 50.14it/s] 61%|██████    | 405/666 [00:09<00:05, 50.16it/s] 62%|██████▏   | 411/666 [00:09<00:05, 50.22it/s] 63%|██████▎   | 417/666 [00:09<00:04, 50.24it/s] 64%|██████▎   | 423/666 [00:09<00:04, 50.23it/s] 64%|██████▍   | 429/666 [00:09<00:04, 50.21it/s] 65%|██████▌   | 435/666 [00:09<00:04, 50.16it/s] 66%|██████▌   | 441/666 [00:09<00:04, 50.15it/s] 67%|██████▋   | 447/666 [00:10<00:04, 50.11it/s] 68%|██████▊   | 453/666 [00:10<00:04, 50.14it/s] 69%|██████▉   | 459/666 [00:10<00:04, 50.17it/s] 70%|██████▉   | 465/666 [00:10<00:04, 50.17it/s] 71%|███████   | 471/666 [00:10<00:03, 50.22it/s] 72%|███████▏  | 477/666 [00:10<00:03, 50.22it/s] 73%|███████▎  | 483/666 [00:10<00:03, 50.20it/s] 73%|███████▎  | 489/666 [00:10<00:03, 50.19it/s] 74%|███████▍  | 495/666 [00:11<00:03, 50.18it/s] 75%|███████▌  | 501/666 [00:11<00:03, 50.17it/s] 76%|███████▌  | 507/666 [00:11<00:03, 50.08it/s] 77%|███████▋  | 513/666 [00:11<00:03, 50.08it/s] 78%|███████▊  | 519/666 [00:11<00:02, 50.09it/s] 79%|███████▉  | 525/666 [00:11<00:02, 50.13it/s] 80%|███████▉  | 531/666 [00:11<00:02, 50.20it/s] 81%|████████  | 537/666 [00:11<00:02, 50.16it/s] 82%|████████▏ | 543/666 [00:11<00:02, 49.94it/s] 82%|████████▏ | 549/666 [00:12<00:02, 50.16it/s] 83%|████████▎ | 555/666 [00:12<00:02, 50.16it/s] 84%|████████▍ | 561/666 [00:12<00:02, 50.14it/s] 85%|████████▌ | 567/666 [00:12<00:01, 50.13it/s] 86%|████████▌ | 573/666 [00:12<00:01, 50.13it/s] 87%|████████▋ | 579/666 [00:12<00:01, 50.12it/s] 88%|████████▊ | 585/666 [00:12<00:01, 50.10it/s] 89%|████████▊ | 591/666 [00:12<00:01, 50.09it/s] 90%|████████▉ | 597/666 [00:13<00:01, 50.12it/s] 91%|█████████ | 603/666 [00:13<00:01, 50.17it/s] 91%|█████████▏| 609/666 [00:13<00:01, 50.20it/s] 92%|█████████▏| 615/666 [00:13<00:01, 50.22it/s] 93%|█████████▎| 621/666 [00:13<00:00, 50.20it/s] 94%|█████████▍| 627/666 [00:13<00:00, 50.17it/s] 95%|█████████▌| 633/666 [00:13<00:00, 50.16it/s] 96%|█████████▌| 639/666 [00:13<00:00, 50.16it/s] 97%|█████████▋| 645/666 [00:14<00:00, 50.17it/s] 98%|█████████▊| 651/666 [00:14<00:00, 50.19it/s] 99%|█████████▊| 657/666 [00:14<00:00, 50.22it/s]100%|█████████▉| 663/666 [00:14<00:00, 49.57it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 2/167 [00:00<00:08, 19.36it/s][A
  6%|▌         | 10/167 [00:00<00:02, 53.23it/s][A
 10%|█         | 17/167 [00:00<00:02, 59.51it/s][A
 23%|██▎       | 39/167 [00:00<00:01, 120.45it/s][A
 38%|███▊      | 63/167 [00:00<00:00, 160.81it/s][A
 52%|█████▏    | 87/167 [00:00<00:00, 184.60it/s][A
 66%|██████▋   | 111/167 [00:00<00:00, 200.28it/s][A
 81%|████████  | 135/167 [00:00<00:00, 210.57it/s][A
 95%|█████████▍| 158/167 [00:00<00:00, 215.80it/s][A100%|██████████| 167/167 [00:01<00:00, 165.65it/s]
2022-11-28 21:39:20,816 P11732 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:39:20,817 P11732 INFO Save best model: monitor(max): -10.620960
2022-11-28 21:39:21,186 P11732 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:15<00:00, 41.70it/s]
2022-11-28 21:39:21,231 P11732 INFO Train loss: 60.993805
2022-11-28 21:39:21,232 P11732 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:01,  5.49it/s]  1%|          | 6/666 [00:00<00:26, 24.70it/s]  2%|▏         | 10/666 [00:00<00:21, 30.26it/s]  2%|▏         | 15/666 [00:00<00:17, 36.72it/s]  3%|▎         | 21/666 [00:00<00:15, 41.73it/s]  4%|▍         | 27/666 [00:00<00:14, 44.72it/s]  5%|▍         | 33/666 [00:00<00:13, 46.62it/s]  6%|▌         | 39/666 [00:00<00:13, 47.87it/s]  7%|▋         | 45/666 [00:01<00:12, 48.66it/s]  8%|▊         | 51/666 [00:01<00:12, 49.21it/s]  9%|▊         | 57/666 [00:01<00:12, 49.62it/s]  9%|▉         | 63/666 [00:01<00:12, 49.85it/s] 10%|█         | 69/666 [00:01<00:11, 50.02it/s] 11%|█▏        | 75/666 [00:01<00:11, 50.18it/s] 12%|█▏        | 81/666 [00:01<00:11, 50.27it/s] 13%|█▎        | 87/666 [00:01<00:11, 50.32it/s] 14%|█▍        | 93/666 [00:02<00:11, 50.33it/s] 15%|█▍        | 99/666 [00:02<00:11, 50.41it/s] 16%|█▌        | 105/666 [00:02<00:11, 50.43it/s] 17%|█▋        | 111/666 [00:02<00:11, 50.39it/s] 18%|█▊        | 117/666 [00:02<00:10, 50.39it/s] 18%|█▊        | 123/666 [00:02<00:10, 50.46it/s] 19%|█▉        | 129/666 [00:02<00:10, 50.44it/s] 20%|██        | 135/666 [00:02<00:10, 50.42it/s] 21%|██        | 141/666 [00:02<00:10, 50.46it/s] 22%|██▏       | 147/666 [00:03<00:10, 50.48it/s] 23%|██▎       | 153/666 [00:03<00:10, 50.46it/s] 24%|██▍       | 159/666 [00:03<00:10, 50.44it/s] 25%|██▍       | 165/666 [00:03<00:09, 50.49it/s] 26%|██▌       | 171/666 [00:03<00:09, 50.49it/s] 27%|██▋       | 177/666 [00:03<00:09, 50.45it/s] 27%|██▋       | 183/666 [00:03<00:09, 50.47it/s] 28%|██▊       | 189/666 [00:03<00:09, 50.44it/s] 29%|██▉       | 195/666 [00:04<00:09, 50.40it/s] 30%|███       | 201/666 [00:04<00:09, 50.40it/s] 31%|███       | 207/666 [00:04<00:09, 50.42it/s] 32%|███▏      | 213/666 [00:04<00:08, 50.44it/s] 33%|███▎      | 219/666 [00:04<00:08, 50.43it/s] 34%|███▍      | 225/666 [00:04<00:08, 50.43it/s] 35%|███▍      | 231/666 [00:04<00:08, 50.46it/s] 36%|███▌      | 237/666 [00:04<00:08, 50.43it/s] 36%|███▋      | 243/666 [00:05<00:08, 50.42it/s] 37%|███▋      | 249/666 [00:05<00:08, 50.43it/s] 38%|███▊      | 255/666 [00:05<00:08, 50.49it/s] 39%|███▉      | 261/666 [00:05<00:08, 50.43it/s] 40%|████      | 267/666 [00:05<00:07, 50.40it/s] 41%|████      | 273/666 [00:05<00:07, 50.40it/s] 42%|████▏     | 279/666 [00:05<00:07, 50.47it/s] 43%|████▎     | 285/666 [00:05<00:07, 50.47it/s] 44%|████▎     | 291/666 [00:05<00:07, 50.45it/s] 45%|████▍     | 297/666 [00:06<00:07, 50.45it/s] 45%|████▌     | 303/666 [00:06<00:07, 50.43it/s] 46%|████▋     | 309/666 [00:06<00:07, 50.42it/s] 47%|████▋     | 315/666 [00:06<00:06, 50.41it/s] 48%|████▊     | 321/666 [00:06<00:06, 50.42it/s] 49%|████▉     | 327/666 [00:06<00:06, 50.47it/s] 50%|█████     | 333/666 [00:06<00:06, 50.48it/s] 51%|█████     | 339/666 [00:06<00:06, 50.45it/s] 52%|█████▏    | 345/666 [00:07<00:06, 50.44it/s] 53%|█████▎    | 351/666 [00:07<00:06, 50.49it/s] 54%|█████▎    | 357/666 [00:07<00:06, 50.48it/s] 55%|█████▍    | 363/666 [00:07<00:06, 50.43it/s] 55%|█████▌    | 369/666 [00:07<00:05, 50.48it/s] 56%|█████▋    | 375/666 [00:07<00:05, 50.49it/s] 57%|█████▋    | 381/666 [00:07<00:05, 50.48it/s] 58%|█████▊    | 387/666 [00:07<00:05, 50.49it/s] 59%|█████▉    | 393/666 [00:07<00:05, 50.52it/s] 60%|█████▉    | 399/666 [00:08<00:05, 50.49it/s] 61%|██████    | 405/666 [00:08<00:05, 50.51it/s] 62%|██████▏   | 411/666 [00:08<00:05, 50.55it/s] 63%|██████▎   | 417/666 [00:08<00:04, 50.51it/s] 64%|██████▎   | 423/666 [00:08<00:04, 50.51it/s] 64%|██████▍   | 429/666 [00:08<00:04, 50.54it/s] 65%|██████▌   | 435/666 [00:08<00:04, 50.52it/s] 66%|██████▌   | 441/666 [00:08<00:04, 50.47it/s] 67%|██████▋   | 447/666 [00:09<00:04, 50.51it/s] 68%|██████▊   | 453/666 [00:09<00:04, 50.51it/s] 69%|██████▉   | 459/666 [00:09<00:04, 50.50it/s] 70%|██████▉   | 465/666 [00:09<00:03, 50.51it/s] 71%|███████   | 471/666 [00:09<00:03, 50.54it/s] 72%|███████▏  | 477/666 [00:09<00:03, 50.51it/s] 73%|███████▎  | 483/666 [00:09<00:03, 50.46it/s] 73%|███████▎  | 489/666 [00:09<00:03, 50.46it/s] 74%|███████▍  | 495/666 [00:10<00:03, 50.49it/s] 75%|███████▌  | 501/666 [00:10<00:03, 50.48it/s] 76%|███████▌  | 507/666 [00:10<00:03, 50.48it/s] 77%|███████▋  | 513/666 [00:10<00:03, 50.51it/s] 78%|███████▊  | 519/666 [00:10<00:02, 50.50it/s] 79%|███████▉  | 525/666 [00:10<00:02, 50.48it/s] 80%|███████▉  | 531/666 [00:10<00:02, 50.53it/s] 81%|████████  | 537/666 [00:10<00:02, 50.40it/s] 82%|████████▏ | 543/666 [00:10<00:02, 50.44it/s] 82%|████████▏ | 549/666 [00:11<00:02, 50.44it/s] 83%|████████▎ | 555/666 [00:11<00:02, 50.43it/s] 84%|████████▍ | 561/666 [00:11<00:02, 50.39it/s] 85%|████████▌ | 567/666 [00:11<00:01, 50.37it/s] 86%|████████▌ | 573/666 [00:11<00:01, 50.34it/s] 87%|████████▋ | 579/666 [00:11<00:01, 50.30it/s] 88%|████████▊ | 585/666 [00:11<00:01, 50.39it/s] 89%|████████▊ | 591/666 [00:11<00:01, 50.40it/s] 90%|████████▉ | 597/666 [00:12<00:01, 50.39it/s] 91%|█████████ | 603/666 [00:12<00:01, 50.37it/s] 91%|█████████▏| 609/666 [00:12<00:01, 50.41it/s] 92%|█████████▏| 615/666 [00:12<00:01, 50.41it/s] 93%|█████████▎| 621/666 [00:12<00:00, 50.40it/s] 94%|█████████▍| 627/666 [00:12<00:00, 50.37it/s] 95%|█████████▌| 633/666 [00:12<00:00, 50.43it/s] 96%|█████████▌| 639/666 [00:12<00:00, 50.47it/s] 97%|█████████▋| 645/666 [00:12<00:00, 50.44it/s] 98%|█████████▊| 651/666 [00:13<00:00, 50.46it/s] 99%|█████████▊| 657/666 [00:13<00:00, 50.50it/s]100%|█████████▉| 663/666 [00:13<00:00, 49.88it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.26it/s][A
  6%|▌         | 10/167 [00:00<00:02, 53.83it/s][A
 19%|█▉        | 32/167 [00:00<00:01, 125.35it/s][A
 33%|███▎      | 55/167 [00:00<00:00, 165.22it/s][A
 47%|████▋     | 78/167 [00:00<00:00, 186.96it/s][A
 61%|██████    | 102/167 [00:00<00:00, 201.71it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 210.36it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 216.31it/s][A100%|██████████| 167/167 [00:00<00:00, 176.08it/s]
2022-11-28 21:39:35,691 P11732 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:39:35,691 P11732 INFO Monitor(max) STOP: -10.620960 !
2022-11-28 21:39:35,691 P11732 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:39:35,692 P11732 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:14<00:00, 45.90it/s]
2022-11-28 21:39:35,743 P11732 INFO Train loss: 69.027532
2022-11-28 21:39:35,743 P11732 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:48,  6.11it/s]  1%|          | 6/666 [00:00<00:24, 26.46it/s]  2%|▏         | 10/666 [00:00<00:21, 31.07it/s]  2%|▏         | 15/666 [00:00<00:17, 37.60it/s]  3%|▎         | 21/666 [00:00<00:15, 42.44it/s]  4%|▍         | 26/666 [00:00<00:14, 44.73it/s]  5%|▍         | 31/666 [00:00<00:13, 46.31it/s]  6%|▌         | 37/666 [00:00<00:13, 47.59it/s]  6%|▋         | 42/666 [00:01<00:12, 48.28it/s]  7%|▋         | 47/666 [00:01<00:12, 48.77it/s]  8%|▊         | 52/666 [00:01<00:12, 49.10it/s]  9%|▊         | 57/666 [00:01<00:12, 49.36it/s]  9%|▉         | 62/666 [00:01<00:12, 49.53it/s] 10%|█         | 68/666 [00:01<00:12, 49.69it/s] 11%|█         | 74/666 [00:01<00:11, 49.79it/s] 12%|█▏        | 79/666 [00:01<00:11, 49.84it/s] 13%|█▎        | 85/666 [00:01<00:11, 49.90it/s] 14%|█▎        | 90/666 [00:01<00:11, 49.93it/s] 14%|█▍        | 95/666 [00:02<00:11, 49.92it/s] 15%|█▌        | 100/666 [00:02<00:11, 49.94it/s] 16%|█▌        | 105/666 [00:02<00:11, 49.95it/s] 17%|█▋        | 111/666 [00:02<00:11, 49.98it/s] 18%|█▊        | 117/666 [00:02<00:10, 50.00it/s] 18%|█▊        | 123/666 [00:02<00:10, 50.01it/s] 19%|█▉        | 129/666 [00:02<00:10, 50.01it/s] 20%|██        | 135/666 [00:02<00:10, 49.99it/s] 21%|██        | 140/666 [00:02<00:10, 49.99it/s] 22%|██▏       | 146/666 [00:03<00:10, 50.00it/s] 23%|██▎       | 152/666 [00:03<00:10, 50.01it/s] 24%|██▎       | 158/666 [00:03<00:10, 49.99it/s] 24%|██▍       | 163/666 [00:03<00:10, 49.98it/s] 25%|██▌       | 168/666 [00:03<00:09, 49.98it/s] 26%|██▌       | 174/666 [00:03<00:09, 50.01it/s] 27%|██▋       | 180/666 [00:03<00:09, 50.00it/s] 28%|██▊       | 186/666 [00:03<00:09, 50.01it/s] 29%|██▉       | 192/666 [00:04<00:09, 50.00it/s] 30%|██▉       | 198/666 [00:04<00:09, 50.01it/s] 31%|███       | 204/666 [00:04<00:09, 50.00it/s] 32%|███▏      | 210/666 [00:04<00:09, 50.01it/s] 32%|███▏      | 216/666 [00:04<00:09, 49.95it/s] 33%|███▎      | 222/666 [00:04<00:08, 49.97it/s] 34%|███▍      | 228/666 [00:04<00:08, 49.99it/s] 35%|███▍      | 233/666 [00:04<00:08, 49.98it/s] 36%|███▌      | 239/666 [00:04<00:08, 50.01it/s] 37%|███▋      | 245/666 [00:05<00:08, 50.02it/s] 38%|███▊      | 251/666 [00:05<00:08, 50.01it/s] 39%|███▊      | 257/666 [00:05<00:08, 50.01it/s] 39%|███▉      | 263/666 [00:05<00:08, 50.01it/s] 40%|████      | 269/666 [00:05<00:07, 50.02it/s] 41%|████▏     | 275/666 [00:05<00:07, 49.99it/s] 42%|████▏     | 281/666 [00:05<00:07, 50.00it/s] 43%|████▎     | 287/666 [00:05<00:07, 50.01it/s] 44%|████▍     | 293/666 [00:06<00:07, 50.01it/s] 45%|████▍     | 299/666 [00:06<00:07, 50.01it/s] 46%|████▌     | 305/666 [00:06<00:07, 50.00it/s] 47%|████▋     | 311/666 [00:06<00:07, 50.00it/s] 48%|████▊     | 317/666 [00:06<00:06, 50.01it/s] 48%|████▊     | 323/666 [00:06<00:06, 50.01it/s] 49%|████▉     | 329/666 [00:06<00:06, 50.00it/s] 50%|█████     | 335/666 [00:06<00:06, 50.00it/s] 51%|█████     | 341/666 [00:06<00:06, 49.98it/s] 52%|█████▏    | 346/666 [00:07<00:06, 49.96it/s] 53%|█████▎    | 351/666 [00:07<00:06, 49.95it/s] 54%|█████▎    | 357/666 [00:07<00:06, 49.99it/s] 55%|█████▍    | 363/666 [00:07<00:06, 50.01it/s] 55%|█████▌    | 369/666 [00:07<00:05, 50.03it/s] 56%|█████▋    | 375/666 [00:07<00:05, 50.02it/s] 57%|█████▋    | 381/666 [00:07<00:05, 50.00it/s] 58%|█████▊    | 387/666 [00:07<00:05, 50.00it/s] 59%|█████▉    | 393/666 [00:08<00:05, 50.00it/s] 60%|█████▉    | 399/666 [00:08<00:05, 50.02it/s] 61%|██████    | 405/666 [00:08<00:05, 50.01it/s] 62%|██████▏   | 411/666 [00:08<00:05, 49.98it/s] 63%|██████▎   | 417/666 [00:08<00:04, 50.00it/s] 64%|██████▎   | 423/666 [00:08<00:04, 49.99it/s] 64%|██████▍   | 429/666 [00:08<00:04, 49.99it/s] 65%|██████▌   | 434/666 [00:08<00:04, 49.99it/s] 66%|██████▌   | 440/666 [00:08<00:04, 50.00it/s] 67%|██████▋   | 446/666 [00:09<00:04, 50.03it/s] 68%|██████▊   | 452/666 [00:09<00:04, 50.02it/s] 69%|██████▉   | 458/666 [00:09<00:04, 50.01it/s] 70%|██████▉   | 464/666 [00:09<00:04, 49.99it/s] 70%|███████   | 469/666 [00:09<00:03, 49.98it/s] 71%|███████   | 474/666 [00:09<00:03, 49.98it/s] 72%|███████▏  | 480/666 [00:09<00:03, 50.00it/s] 73%|███████▎  | 486/666 [00:09<00:03, 50.01it/s] 74%|███████▍  | 492/666 [00:10<00:03, 50.00it/s] 75%|███████▍  | 498/666 [00:10<00:03, 50.00it/s] 76%|███████▌  | 504/666 [00:10<00:03, 50.01it/s] 77%|███████▋  | 510/666 [00:10<00:03, 50.01it/s] 77%|███████▋  | 516/666 [00:10<00:02, 50.01it/s] 78%|███████▊  | 522/666 [00:10<00:02, 49.99it/s] 79%|███████▉  | 527/666 [00:10<00:02, 49.99it/s] 80%|███████▉  | 532/666 [00:10<00:02, 49.95it/s] 81%|████████  | 537/666 [00:10<00:02, 49.84it/s] 82%|████████▏ | 543/666 [00:11<00:02, 49.90it/s] 82%|████████▏ | 549/666 [00:11<00:02, 49.97it/s] 83%|████████▎ | 555/666 [00:11<00:02, 50.03it/s] 84%|████████▍ | 561/666 [00:11<00:02, 50.02it/s] 85%|████████▌ | 567/666 [00:11<00:01, 50.03it/s] 86%|████████▌ | 573/666 [00:11<00:01, 50.00it/s] 87%|████████▋ | 579/666 [00:11<00:01, 50.00it/s] 88%|████████▊ | 585/666 [00:11<00:01, 50.03it/s] 89%|████████▊ | 591/666 [00:11<00:01, 50.01it/s] 90%|████████▉ | 597/666 [00:12<00:01, 50.03it/s] 91%|█████████ | 603/666 [00:12<00:01, 50.03it/s] 91%|█████████▏| 609/666 [00:12<00:01, 50.01it/s] 92%|█████████▏| 615/666 [00:12<00:01, 50.02it/s] 93%|█████████▎| 621/666 [00:12<00:00, 50.01it/s] 94%|█████████▍| 627/666 [00:12<00:00, 50.02it/s] 95%|█████████▌| 633/666 [00:12<00:00, 50.02it/s] 96%|█████████▌| 639/666 [00:12<00:00, 50.01it/s] 97%|█████████▋| 645/666 [00:13<00:00, 50.01it/s] 98%|█████████▊| 651/666 [00:13<00:00, 49.97it/s] 99%|█████████▊| 657/666 [00:13<00:00, 49.99it/s] 99%|█████████▉| 662/666 [00:13<00:00, 49.24it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  2%|▏         | 3/167 [00:00<00:05, 28.39it/s][A
  7%|▋         | 11/167 [00:00<00:02, 56.82it/s][A
 20%|██        | 34/167 [00:00<00:01, 132.95it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 170.51it/s][A
 48%|████▊     | 80/167 [00:00<00:00, 190.83it/s][A
 62%|██████▏   | 103/167 [00:00<00:00, 203.75it/s][A
 75%|███████▌  | 126/167 [00:00<00:00, 212.04it/s][A
 90%|████████▉ | 150/167 [00:00<00:00, 217.91it/s][A100%|██████████| 167/167 [00:00<00:00, 178.23it/s]
2022-11-28 21:39:50,290 P11732 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:39:50,290 P11732 INFO Monitor(max) STOP: -10.620960 !
2022-11-28 21:39:50,290 P11732 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:39:50,290 P11732 INFO Early stopping at epoch=3
2022-11-28 21:39:50,291 P11732 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:14<00:00, 45.57it/s]
2022-11-28 21:39:50,339 P11732 INFO Train loss: 69.029595
2022-11-28 21:39:50,339 P11732 INFO Training finished.
2022-11-28 21:39:50,339 P11732 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_019_5747de84.model
2022-11-28 21:39:50,606 P11732 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:50,  6.01it/s]  2%|▏         | 10/666 [00:00<00:15, 42.26it/s]  5%|▍         | 33/666 [00:00<00:05, 113.77it/s]  8%|▊         | 55/666 [00:00<00:04, 151.14it/s] 12%|█▏        | 77/666 [00:00<00:03, 173.42it/s] 15%|█▍        | 99/666 [00:00<00:03, 187.93it/s] 18%|█▊        | 121/666 [00:00<00:02, 197.59it/s] 21%|██▏       | 143/666 [00:00<00:02, 203.62it/s] 25%|██▍       | 165/666 [00:00<00:02, 207.83it/s] 28%|██▊       | 187/666 [00:01<00:02, 210.53it/s] 31%|███▏      | 209/666 [00:01<00:02, 212.07it/s] 35%|███▍      | 231/666 [00:01<00:02, 213.47it/s] 38%|███▊      | 253/666 [00:01<00:01, 214.39it/s] 41%|████▏     | 275/666 [00:01<00:01, 214.81it/s] 45%|████▍     | 297/666 [00:01<00:01, 214.73it/s] 48%|████▊     | 319/666 [00:01<00:01, 214.69it/s] 51%|█████     | 341/666 [00:01<00:01, 214.87it/s] 55%|█████▍    | 363/666 [00:01<00:01, 215.14it/s] 58%|█████▊    | 385/666 [00:02<00:01, 215.34it/s] 61%|██████    | 407/666 [00:02<00:01, 215.37it/s] 64%|██████▍   | 429/666 [00:02<00:01, 215.17it/s] 68%|██████▊   | 451/666 [00:02<00:00, 215.24it/s] 71%|███████   | 473/666 [00:02<00:00, 212.07it/s] 74%|███████▍  | 495/666 [00:02<00:00, 213.11it/s] 78%|███████▊  | 517/666 [00:02<00:00, 212.59it/s] 81%|████████  | 539/666 [00:02<00:00, 191.31it/s] 84%|████████▍ | 561/666 [00:02<00:00, 198.58it/s] 87%|████████▋ | 582/666 [00:02<00:00, 201.16it/s] 91%|█████████ | 604/666 [00:03<00:00, 205.44it/s] 94%|█████████▍| 626/666 [00:03<00:00, 208.63it/s] 97%|█████████▋| 648/666 [00:03<00:00, 209.72it/s]100%|██████████| 666/666 [00:03<00:00, 195.23it/s]
2022-11-28 21:39:54,467 P11732 INFO [Metrics] logloss: 11.126093 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 2/167 [00:00<00:08, 19.05it/s]  6%|▌         | 10/167 [00:00<00:03, 50.70it/s] 19%|█▉        | 32/167 [00:00<00:01, 123.17it/s] 32%|███▏      | 54/167 [00:00<00:00, 159.07it/s] 46%|████▌     | 76/167 [00:00<00:00, 179.29it/s] 59%|█████▊    | 98/167 [00:00<00:00, 191.86it/s] 72%|███████▏  | 120/167 [00:00<00:00, 199.77it/s] 85%|████████▌ | 142/167 [00:00<00:00, 205.16it/s] 98%|█████████▊| 164/167 [00:00<00:00, 207.93it/s]100%|██████████| 167/167 [00:00<00:00, 169.03it/s]
2022-11-28 21:39:55,568 P11732 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:40:02,138 P13517 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "128",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_020_e7a51908",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:40:02,139 P13517 INFO Set up feature encoder...
2022-11-28 21:40:02,141 P13517 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:40:02,142 P13517 INFO Loading data...
2022-11-28 21:40:02,145 P13517 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:40:02,413 P13517 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:40:02,519 P13517 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:40:02,519 P13517 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:40:02,519 P13517 INFO Loading train data done.
2022-11-28 21:40:05,546 P13517 INFO Total number of parameters: 29989252.
2022-11-28 21:40:05,546 P13517 INFO Start training: 666 batches/epoch
2022-11-28 21:40:05,546 P13517 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:40:05.881 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:13517 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:40:05.912 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:13517 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:35,  1.14s/it]  1%|          | 5/666 [00:01<02:08,  5.14it/s]  1%|▏         | 9/666 [00:01<01:08,  9.63it/s]  2%|▏         | 13/666 [00:01<00:46, 14.13it/s]  3%|▎         | 17/666 [00:01<00:35, 18.41it/s]  3%|▎         | 21/666 [00:01<00:28, 22.36it/s]  4%|▍         | 25/666 [00:01<00:24, 25.68it/s]  4%|▍         | 29/666 [00:01<00:22, 28.39it/s]  5%|▍         | 33/666 [00:02<00:20, 30.51it/s]  6%|▌         | 37/666 [00:02<00:19, 32.13it/s]  6%|▌         | 41/666 [00:02<00:18, 33.32it/s]  7%|▋         | 45/666 [00:02<00:18, 34.21it/s]  7%|▋         | 49/666 [00:02<00:17, 34.82it/s]  8%|▊         | 53/666 [00:02<00:17, 35.29it/s]  9%|▊         | 57/666 [00:02<00:17, 35.60it/s]  9%|▉         | 61/666 [00:02<00:16, 35.84it/s] 10%|▉         | 65/666 [00:02<00:16, 35.53it/s] 10%|█         | 69/666 [00:03<00:16, 35.76it/s] 11%|█         | 73/666 [00:03<00:16, 35.96it/s] 12%|█▏        | 77/666 [00:03<00:16, 36.07it/s] 12%|█▏        | 81/666 [00:03<00:16, 36.17it/s] 13%|█▎        | 85/666 [00:03<00:16, 36.23it/s] 13%|█▎        | 89/666 [00:03<00:15, 36.28it/s] 14%|█▍        | 93/666 [00:03<00:15, 36.31it/s] 15%|█▍        | 97/666 [00:03<00:15, 36.32it/s] 15%|█▌        | 101/666 [00:03<00:15, 36.32it/s] 16%|█▌        | 105/666 [00:04<00:15, 36.33it/s] 16%|█▋        | 109/666 [00:04<00:15, 36.33it/s] 17%|█▋        | 113/666 [00:04<00:15, 36.34it/s] 18%|█▊        | 117/666 [00:04<00:15, 36.31it/s] 18%|█▊        | 121/666 [00:04<00:14, 36.35it/s] 19%|█▉        | 125/666 [00:04<00:14, 36.31it/s] 19%|█▉        | 129/666 [00:04<00:14, 36.33it/s] 20%|█▉        | 133/666 [00:04<00:14, 36.32it/s] 21%|██        | 137/666 [00:04<00:14, 36.35it/s] 21%|██        | 141/666 [00:05<00:14, 36.34it/s] 22%|██▏       | 145/666 [00:05<00:14, 36.34it/s] 22%|██▏       | 149/666 [00:05<00:14, 36.33it/s] 23%|██▎       | 153/666 [00:05<00:14, 36.37it/s] 24%|██▎       | 157/666 [00:05<00:14, 36.35it/s] 24%|██▍       | 161/666 [00:05<00:13, 36.37it/s] 25%|██▍       | 165/666 [00:05<00:13, 36.35it/s] 25%|██▌       | 169/666 [00:05<00:13, 36.37it/s] 26%|██▌       | 173/666 [00:05<00:13, 36.35it/s] 27%|██▋       | 177/666 [00:06<00:13, 36.36it/s] 27%|██▋       | 181/666 [00:06<00:13, 36.32it/s] 28%|██▊       | 185/666 [00:06<00:13, 36.32it/s] 28%|██▊       | 189/666 [00:06<00:13, 36.30it/s] 29%|██▉       | 193/666 [00:06<00:13, 36.30it/s] 30%|██▉       | 197/666 [00:06<00:12, 36.32it/s] 30%|███       | 201/666 [00:06<00:12, 36.32it/s] 31%|███       | 205/666 [00:06<00:12, 36.35it/s] 31%|███▏      | 209/666 [00:06<00:12, 36.33it/s] 32%|███▏      | 213/666 [00:06<00:12, 36.35it/s] 33%|███▎      | 217/666 [00:07<00:12, 36.32it/s] 33%|███▎      | 221/666 [00:07<00:12, 36.35it/s] 34%|███▍      | 225/666 [00:07<00:12, 36.32it/s] 34%|███▍      | 229/666 [00:07<00:12, 36.35it/s] 35%|███▍      | 233/666 [00:07<00:11, 36.33it/s] 36%|███▌      | 237/666 [00:07<00:11, 36.33it/s] 36%|███▌      | 241/666 [00:07<00:11, 36.31it/s] 37%|███▋      | 245/666 [00:07<00:11, 36.32it/s] 37%|███▋      | 249/666 [00:07<00:11, 36.30it/s] 38%|███▊      | 253/666 [00:08<00:11, 36.31it/s] 39%|███▊      | 257/666 [00:08<00:11, 36.30it/s] 39%|███▉      | 261/666 [00:08<00:11, 36.31it/s] 40%|███▉      | 265/666 [00:08<00:11, 36.33it/s] 40%|████      | 269/666 [00:08<00:10, 36.28it/s] 41%|████      | 273/666 [00:08<00:10, 36.32it/s] 42%|████▏     | 277/666 [00:08<00:10, 36.31it/s] 42%|████▏     | 281/666 [00:08<00:10, 36.33it/s] 43%|████▎     | 285/666 [00:08<00:10, 36.31it/s] 43%|████▎     | 289/666 [00:09<00:10, 36.32it/s] 44%|████▍     | 293/666 [00:09<00:10, 36.30it/s] 45%|████▍     | 297/666 [00:09<00:10, 36.31it/s] 45%|████▌     | 301/666 [00:09<00:10, 36.31it/s] 46%|████▌     | 305/666 [00:09<00:09, 36.27it/s] 46%|████▋     | 309/666 [00:09<00:09, 36.29it/s] 47%|████▋     | 313/666 [00:09<00:09, 36.28it/s] 48%|████▊     | 317/666 [00:09<00:09, 36.30it/s] 48%|████▊     | 321/666 [00:09<00:09, 36.29it/s] 49%|████▉     | 325/666 [00:10<00:09, 36.32it/s] 49%|████▉     | 329/666 [00:10<00:09, 36.30it/s] 50%|█████     | 333/666 [00:10<00:09, 36.32it/s] 51%|█████     | 337/666 [00:10<00:09, 36.29it/s] 51%|█████     | 341/666 [00:10<00:08, 36.30it/s] 52%|█████▏    | 345/666 [00:10<00:08, 36.31it/s] 52%|█████▏    | 349/666 [00:10<00:08, 36.31it/s] 53%|█████▎    | 353/666 [00:10<00:08, 36.32it/s] 54%|█████▎    | 357/666 [00:10<00:08, 36.31it/s] 54%|█████▍    | 361/666 [00:11<00:08, 36.32it/s] 55%|█████▍    | 365/666 [00:11<00:08, 36.29it/s] 55%|█████▌    | 369/666 [00:11<00:08, 36.32it/s] 56%|█████▌    | 373/666 [00:11<00:08, 36.29it/s] 57%|█████▋    | 377/666 [00:11<00:07, 36.30it/s] 57%|█████▋    | 381/666 [00:11<00:07, 36.29it/s] 58%|█████▊    | 385/666 [00:11<00:07, 36.29it/s] 58%|█████▊    | 389/666 [00:11<00:07, 36.30it/s] 59%|█████▉    | 393/666 [00:11<00:07, 36.31it/s] 60%|█████▉    | 397/666 [00:12<00:07, 36.32it/s] 60%|██████    | 401/666 [00:12<00:07, 36.28it/s] 61%|██████    | 405/666 [00:12<00:07, 36.31it/s] 61%|██████▏   | 409/666 [00:12<00:07, 36.29it/s] 62%|██████▏   | 413/666 [00:12<00:06, 36.31it/s] 63%|██████▎   | 417/666 [00:12<00:06, 36.30it/s] 63%|██████▎   | 421/666 [00:12<00:06, 36.31it/s] 64%|██████▍   | 425/666 [00:12<00:06, 36.30it/s] 64%|██████▍   | 429/666 [00:12<00:06, 36.32it/s] 65%|██████▌   | 433/666 [00:13<00:06, 36.30it/s] 66%|██████▌   | 437/666 [00:13<00:06, 36.25it/s] 66%|██████▌   | 441/666 [00:13<00:06, 36.29it/s] 67%|██████▋   | 445/666 [00:13<00:06, 36.25it/s] 67%|██████▋   | 449/666 [00:13<00:05, 36.28it/s] 68%|██████▊   | 453/666 [00:13<00:05, 36.29it/s] 69%|██████▊   | 457/666 [00:13<00:05, 36.28it/s] 69%|██████▉   | 461/666 [00:13<00:05, 36.29it/s] 70%|██████▉   | 465/666 [00:13<00:05, 36.29it/s] 70%|███████   | 469/666 [00:14<00:05, 36.24it/s] 71%|███████   | 473/666 [00:14<00:05, 36.32it/s] 72%|███████▏  | 477/666 [00:14<00:05, 36.45it/s] 72%|███████▏  | 481/666 [00:14<00:05, 36.56it/s] 73%|███████▎  | 485/666 [00:14<00:04, 36.65it/s] 73%|███████▎  | 489/666 [00:14<00:04, 36.72it/s] 74%|███████▍  | 493/666 [00:14<00:04, 36.76it/s] 75%|███████▍  | 497/666 [00:14<00:04, 36.77it/s] 75%|███████▌  | 501/666 [00:14<00:04, 36.79it/s] 76%|███████▌  | 505/666 [00:15<00:04, 36.81it/s] 76%|███████▋  | 509/666 [00:15<00:04, 36.80it/s] 77%|███████▋  | 513/666 [00:15<00:04, 36.80it/s] 78%|███████▊  | 517/666 [00:15<00:04, 36.81it/s] 78%|███████▊  | 521/666 [00:15<00:03, 36.83it/s] 79%|███████▉  | 525/666 [00:15<00:03, 36.83it/s] 79%|███████▉  | 529/666 [00:15<00:03, 36.84it/s] 80%|████████  | 533/666 [00:15<00:03, 36.84it/s] 81%|████████  | 537/666 [00:15<00:03, 36.85it/s] 81%|████████  | 541/666 [00:16<00:03, 36.86it/s] 82%|████████▏ | 545/666 [00:16<00:03, 36.87it/s] 82%|████████▏ | 549/666 [00:16<00:03, 36.86it/s] 83%|████████▎ | 553/666 [00:16<00:03, 36.85it/s] 84%|████████▎ | 557/666 [00:16<00:02, 36.83it/s] 84%|████████▍ | 561/666 [00:16<00:02, 36.83it/s] 85%|████████▍ | 565/666 [00:16<00:02, 36.83it/s] 85%|████████▌ | 569/666 [00:16<00:02, 36.82it/s] 86%|████████▌ | 573/666 [00:16<00:02, 36.82it/s] 87%|████████▋ | 577/666 [00:16<00:02, 36.83it/s] 87%|████████▋ | 581/666 [00:17<00:02, 36.84it/s] 88%|████████▊ | 585/666 [00:17<00:02, 36.84it/s] 88%|████████▊ | 589/666 [00:17<00:02, 36.84it/s] 89%|████████▉ | 593/666 [00:17<00:01, 36.85it/s] 90%|████████▉ | 597/666 [00:17<00:01, 36.85it/s] 90%|█████████ | 601/666 [00:17<00:01, 36.86it/s] 91%|█████████ | 605/666 [00:17<00:01, 36.86it/s] 91%|█████████▏| 609/666 [00:17<00:01, 36.86it/s] 92%|█████████▏| 613/666 [00:17<00:01, 36.85it/s] 93%|█████████▎| 617/666 [00:18<00:01, 36.86it/s] 93%|█████████▎| 621/666 [00:18<00:01, 36.85it/s] 94%|█████████▍| 625/666 [00:18<00:01, 36.84it/s] 94%|█████████▍| 629/666 [00:18<00:01, 36.85it/s] 95%|█████████▌| 633/666 [00:18<00:00, 36.84it/s] 96%|█████████▌| 637/666 [00:18<00:00, 36.84it/s] 96%|█████████▌| 641/666 [00:18<00:00, 36.84it/s] 97%|█████████▋| 645/666 [00:18<00:00, 36.85it/s] 97%|█████████▋| 649/666 [00:18<00:00, 36.85it/s] 98%|█████████▊| 653/666 [00:19<00:00, 36.86it/s] 99%|█████████▊| 657/666 [00:19<00:00, 36.87it/s] 99%|█████████▉| 661/666 [00:19<00:00, 36.21it/s]100%|█████████▉| 665/666 [00:19<00:00, 36.52it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.23it/s][A
  6%|▌         | 10/167 [00:00<00:03, 51.58it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 128.42it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 170.19it/s][A
 49%|████▊     | 81/167 [00:00<00:00, 193.58it/s][A
 63%|██████▎   | 105/167 [00:00<00:00, 208.36it/s][A
 77%|███████▋  | 129/167 [00:00<00:00, 217.33it/s][A
 92%|█████████▏| 153/167 [00:00<00:00, 223.11it/s][A100%|██████████| 167/167 [00:00<00:00, 179.28it/s]
2022-11-28 21:40:25,991 P13517 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:40:25,992 P13517 INFO Save best model: monitor(max): -4.497136
2022-11-28 21:40:27,049 P13517 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:21<00:00, 30.92it/s]
2022-11-28 21:40:27,088 P13517 INFO Train loss: 31.888222
2022-11-28 21:40:27,088 P13517 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:00,  5.52it/s]  1%|          | 5/666 [00:00<00:35, 18.42it/s]  1%|▏         | 9/666 [00:00<00:26, 24.78it/s]  2%|▏         | 13/666 [00:00<00:22, 28.41it/s]  3%|▎         | 17/666 [00:00<00:20, 30.96it/s]  3%|▎         | 21/666 [00:00<00:19, 32.55it/s]  4%|▍         | 25/666 [00:00<00:19, 33.72it/s]  4%|▍         | 29/666 [00:00<00:18, 34.49it/s]  5%|▍         | 33/666 [00:01<00:18, 35.00it/s]  6%|▌         | 37/666 [00:01<00:17, 35.40it/s]  6%|▌         | 41/666 [00:01<00:17, 35.62it/s]  7%|▋         | 45/666 [00:01<00:17, 35.80it/s]  7%|▋         | 49/666 [00:01<00:17, 35.92it/s]  8%|▊         | 53/666 [00:01<00:17, 35.98it/s]  9%|▊         | 57/666 [00:01<00:16, 36.08it/s]  9%|▉         | 61/666 [00:01<00:16, 36.11it/s] 10%|▉         | 65/666 [00:01<00:16, 36.16it/s] 10%|█         | 69/666 [00:02<00:16, 36.19it/s] 11%|█         | 73/666 [00:02<00:16, 36.18it/s] 12%|█▏        | 77/666 [00:02<00:16, 36.23it/s] 12%|█▏        | 81/666 [00:02<00:16, 36.20it/s] 13%|█▎        | 85/666 [00:02<00:16, 36.18it/s] 13%|█▎        | 89/666 [00:02<00:15, 36.22it/s] 14%|█▍        | 93/666 [00:02<00:15, 36.18it/s] 15%|█▍        | 97/666 [00:02<00:15, 36.19it/s] 15%|█▌        | 101/666 [00:02<00:15, 36.21it/s] 16%|█▌        | 105/666 [00:03<00:15, 36.18it/s] 16%|█▋        | 109/666 [00:03<00:15, 36.22it/s] 17%|█▋        | 113/666 [00:03<00:15, 36.21it/s] 18%|█▊        | 117/666 [00:03<00:15, 36.20it/s] 18%|█▊        | 121/666 [00:03<00:15, 36.23it/s] 19%|█▉        | 125/666 [00:03<00:14, 36.20it/s] 19%|█▉        | 129/666 [00:03<00:14, 36.21it/s] 20%|█▉        | 133/666 [00:03<00:14, 36.21it/s] 21%|██        | 137/666 [00:03<00:14, 36.20it/s] 21%|██        | 141/666 [00:04<00:14, 36.23it/s] 22%|██▏       | 145/666 [00:04<00:14, 36.21it/s] 22%|██▏       | 149/666 [00:04<00:14, 36.21it/s] 23%|██▎       | 153/666 [00:04<00:14, 36.22it/s] 24%|██▎       | 157/666 [00:04<00:14, 36.19it/s] 24%|██▍       | 161/666 [00:04<00:13, 36.21it/s] 25%|██▍       | 165/666 [00:04<00:13, 36.20it/s] 25%|██▌       | 169/666 [00:04<00:13, 36.15it/s] 26%|██▌       | 173/666 [00:04<00:13, 36.19it/s] 27%|██▋       | 177/666 [00:05<00:13, 36.18it/s] 27%|██▋       | 181/666 [00:05<00:13, 36.18it/s] 28%|██▊       | 185/666 [00:05<00:13, 36.22it/s] 28%|██▊       | 189/666 [00:05<00:13, 36.18it/s] 29%|██▉       | 193/666 [00:05<00:13, 36.20it/s] 30%|██▉       | 197/666 [00:05<00:12, 36.21it/s] 30%|███       | 201/666 [00:05<00:12, 36.16it/s] 31%|███       | 205/666 [00:05<00:12, 36.18it/s] 31%|███▏      | 209/666 [00:05<00:12, 36.19it/s] 32%|███▏      | 213/666 [00:06<00:12, 36.16it/s] 33%|███▎      | 217/666 [00:06<00:12, 36.20it/s] 33%|███▎      | 221/666 [00:06<00:12, 36.19it/s] 34%|███▍      | 225/666 [00:06<00:12, 36.20it/s] 34%|███▍      | 229/666 [00:06<00:12, 36.21it/s] 35%|███▍      | 233/666 [00:06<00:11, 36.19it/s] 36%|███▌      | 237/666 [00:06<00:11, 36.20it/s] 36%|███▌      | 241/666 [00:06<00:11, 36.20it/s] 37%|███▋      | 245/666 [00:06<00:11, 36.19it/s] 37%|███▋      | 249/666 [00:07<00:11, 36.21it/s] 38%|███▊      | 253/666 [00:07<00:11, 36.20it/s] 39%|███▊      | 257/666 [00:07<00:11, 36.21it/s] 39%|███▉      | 261/666 [00:07<00:11, 36.22it/s] 40%|███▉      | 265/666 [00:07<00:11, 36.19it/s] 40%|████      | 269/666 [00:07<00:10, 36.21it/s] 41%|████      | 273/666 [00:07<00:10, 36.20it/s] 42%|████▏     | 277/666 [00:07<00:10, 36.19it/s] 42%|████▏     | 281/666 [00:07<00:10, 36.22it/s] 43%|████▎     | 285/666 [00:08<00:10, 36.20it/s] 43%|████▎     | 289/666 [00:08<00:10, 36.20it/s] 44%|████▍     | 293/666 [00:08<00:10, 36.22it/s] 45%|████▍     | 297/666 [00:08<00:10, 36.17it/s] 45%|████▌     | 301/666 [00:08<00:10, 36.21it/s] 46%|████▌     | 305/666 [00:08<00:09, 36.21it/s] 46%|████▋     | 309/666 [00:08<00:09, 36.19it/s] 47%|████▋     | 313/666 [00:08<00:09, 36.23it/s] 48%|████▊     | 317/666 [00:08<00:09, 36.20it/s] 48%|████▊     | 321/666 [00:09<00:09, 36.20it/s] 49%|████▉     | 325/666 [00:09<00:09, 36.22it/s] 49%|████▉     | 329/666 [00:09<00:09, 36.19it/s] 50%|█████     | 333/666 [00:09<00:09, 36.22it/s] 51%|█████     | 337/666 [00:09<00:09, 36.20it/s] 51%|█████     | 341/666 [00:09<00:08, 36.20it/s] 52%|█████▏    | 345/666 [00:09<00:08, 36.21it/s] 52%|█████▏    | 349/666 [00:09<00:08, 36.18it/s] 53%|█████▎    | 353/666 [00:09<00:08, 36.19it/s] 54%|█████▎    | 357/666 [00:10<00:08, 36.20it/s] 54%|█████▍    | 361/666 [00:10<00:08, 36.17it/s] 55%|█████▍    | 365/666 [00:10<00:08, 36.22it/s] 55%|█████▌    | 369/666 [00:10<00:08, 36.20it/s] 56%|█████▌    | 373/666 [00:10<00:08, 36.15it/s] 57%|█████▋    | 377/666 [00:10<00:07, 36.20it/s] 57%|█████▋    | 381/666 [00:10<00:07, 36.16it/s] 58%|█████▊    | 385/666 [00:10<00:07, 36.15it/s] 58%|█████▊    | 389/666 [00:10<00:07, 36.19it/s] 59%|█████▉    | 393/666 [00:11<00:07, 36.16it/s] 60%|█████▉    | 397/666 [00:11<00:07, 36.13it/s] 60%|██████    | 401/666 [00:11<00:07, 36.15it/s] 61%|██████    | 405/666 [00:11<00:07, 36.14it/s] 61%|██████▏   | 409/666 [00:11<00:07, 36.11it/s] 62%|██████▏   | 413/666 [00:11<00:06, 36.16it/s] 63%|██████▎   | 417/666 [00:11<00:06, 36.14it/s] 63%|██████▎   | 421/666 [00:11<00:06, 36.10it/s] 64%|██████▍   | 425/666 [00:11<00:06, 36.14it/s] 64%|██████▍   | 429/666 [00:12<00:06, 36.14it/s] 65%|██████▌   | 433/666 [00:12<00:06, 36.13it/s] 66%|██████▌   | 437/666 [00:12<00:06, 36.17it/s] 66%|██████▌   | 441/666 [00:12<00:06, 36.15it/s] 67%|██████▋   | 445/666 [00:12<00:06, 36.14it/s] 67%|██████▋   | 449/666 [00:12<00:05, 36.17it/s] 68%|██████▊   | 453/666 [00:12<00:05, 36.16it/s] 69%|██████▊   | 457/666 [00:12<00:05, 36.12it/s] 69%|██████▉   | 461/666 [00:12<00:05, 36.17it/s] 70%|██████▉   | 465/666 [00:13<00:05, 36.15it/s] 70%|███████   | 469/666 [00:13<00:05, 36.11it/s] 71%|███████   | 473/666 [00:13<00:05, 36.15it/s] 72%|███████▏  | 477/666 [00:13<00:05, 36.14it/s] 72%|███████▏  | 481/666 [00:13<00:05, 36.08it/s] 73%|███████▎  | 485/666 [00:13<00:05, 36.07it/s] 73%|███████▎  | 489/666 [00:13<00:04, 36.08it/s] 74%|███████▍  | 493/666 [00:13<00:04, 36.07it/s] 75%|███████▍  | 497/666 [00:13<00:04, 36.05it/s] 75%|███████▌  | 501/666 [00:14<00:04, 36.04it/s] 76%|███████▌  | 505/666 [00:14<00:04, 36.08it/s] 76%|███████▋  | 509/666 [00:14<00:04, 36.07it/s] 77%|███████▋  | 513/666 [00:14<00:04, 36.06it/s] 78%|███████▊  | 517/666 [00:14<00:04, 36.09it/s] 78%|███████▊  | 521/666 [00:14<00:04, 36.09it/s] 79%|███████▉  | 525/666 [00:14<00:03, 36.04it/s] 79%|███████▉  | 529/666 [00:14<00:03, 36.04it/s] 80%|████████  | 533/666 [00:14<00:03, 36.06it/s] 81%|████████  | 537/666 [00:15<00:03, 35.94it/s] 81%|████████  | 541/666 [00:15<00:03, 35.99it/s] 82%|████████▏ | 545/666 [00:15<00:03, 35.97it/s] 82%|████████▏ | 549/666 [00:15<00:03, 35.97it/s] 83%|████████▎ | 553/666 [00:15<00:03, 36.06it/s] 84%|████████▎ | 557/666 [00:15<00:03, 36.04it/s] 84%|████████▍ | 561/666 [00:15<00:02, 36.01it/s] 85%|████████▍ | 565/666 [00:15<00:02, 36.02it/s] 85%|████████▌ | 569/666 [00:15<00:02, 36.07it/s] 86%|████████▌ | 573/666 [00:16<00:02, 36.04it/s] 87%|████████▋ | 577/666 [00:16<00:02, 36.03it/s] 87%|████████▋ | 581/666 [00:16<00:02, 36.05it/s] 88%|████████▊ | 585/666 [00:16<00:02, 36.07it/s] 88%|████████▊ | 589/666 [00:16<00:02, 36.03it/s] 89%|████████▉ | 593/666 [00:16<00:02, 36.02it/s] 90%|████████▉ | 597/666 [00:16<00:01, 36.02it/s] 90%|█████████ | 601/666 [00:16<00:01, 36.07it/s] 91%|█████████ | 605/666 [00:16<00:01, 36.07it/s] 91%|█████████▏| 609/666 [00:17<00:01, 36.00it/s] 92%|█████████▏| 613/666 [00:17<00:01, 36.05it/s] 93%|█████████▎| 617/666 [00:17<00:01, 36.09it/s] 93%|█████████▎| 621/666 [00:17<00:01, 36.04it/s] 94%|█████████▍| 625/666 [00:17<00:01, 36.01it/s] 94%|█████████▍| 629/666 [00:17<00:01, 36.04it/s] 95%|█████████▌| 633/666 [00:17<00:00, 36.05it/s] 96%|█████████▌| 637/666 [00:17<00:00, 36.05it/s] 96%|█████████▌| 641/666 [00:17<00:00, 36.04it/s] 97%|█████████▋| 645/666 [00:18<00:00, 36.07it/s] 97%|█████████▋| 649/666 [00:18<00:00, 36.09it/s] 98%|█████████▊| 653/666 [00:18<00:00, 36.06it/s] 99%|█████████▊| 657/666 [00:18<00:00, 36.07it/s] 99%|█████████▉| 661/666 [00:18<00:00, 35.40it/s]100%|█████████▉| 665/666 [00:18<00:00, 35.74it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.07it/s][A
  6%|▌         | 10/167 [00:00<00:03, 42.11it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 113.42it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 154.07it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 178.89it/s][A
 61%|██████    | 102/167 [00:00<00:00, 195.20it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 206.06it/s][A
 89%|████████▉ | 149/167 [00:00<00:00, 214.69it/s][A100%|██████████| 167/167 [00:00<00:00, 168.51it/s]
2022-11-28 21:40:46,801 P13517 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:40:46,801 P13517 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:40:46,801 P13517 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:40:46,802 P13517 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:19<00:00, 33.71it/s]
2022-11-28 21:40:46,849 P13517 INFO Train loss: 30.969532
2022-11-28 21:40:46,849 P13517 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:02,  5.42it/s]  1%|          | 5/666 [00:00<00:33, 19.67it/s]  1%|▏         | 9/666 [00:00<00:24, 26.32it/s]  2%|▏         | 13/666 [00:00<00:22, 29.66it/s]  3%|▎         | 17/666 [00:00<00:20, 31.90it/s]  3%|▎         | 21/666 [00:00<00:19, 33.31it/s]  4%|▍         | 25/666 [00:00<00:18, 34.27it/s]  4%|▍         | 29/666 [00:00<00:18, 34.90it/s]  5%|▍         | 33/666 [00:01<00:17, 35.33it/s]  6%|▌         | 37/666 [00:01<00:17, 35.64it/s]  6%|▌         | 41/666 [00:01<00:17, 35.83it/s]  7%|▋         | 45/666 [00:01<00:17, 36.00it/s]  7%|▋         | 49/666 [00:01<00:17, 36.09it/s]  8%|▊         | 53/666 [00:01<00:16, 36.17it/s]  9%|▊         | 57/666 [00:01<00:16, 36.21it/s]  9%|▉         | 61/666 [00:01<00:16, 36.26it/s] 10%|▉         | 65/666 [00:01<00:16, 36.25it/s] 10%|█         | 69/666 [00:02<00:16, 36.28it/s] 11%|█         | 73/666 [00:02<00:16, 36.29it/s] 12%|█▏        | 77/666 [00:02<00:16, 36.26it/s] 12%|█▏        | 81/666 [00:02<00:16, 36.27it/s] 13%|█▎        | 85/666 [00:02<00:16, 36.28it/s] 13%|█▎        | 89/666 [00:02<00:15, 36.31it/s] 14%|█▍        | 93/666 [00:02<00:15, 36.29it/s] 15%|█▍        | 97/666 [00:02<00:15, 36.33it/s] 15%|█▌        | 101/666 [00:02<00:15, 36.30it/s] 16%|█▌        | 105/666 [00:03<00:15, 36.32it/s] 16%|█▋        | 109/666 [00:03<00:15, 36.31it/s] 17%|█▋        | 113/666 [00:03<00:15, 36.32it/s] 18%|█▊        | 117/666 [00:03<00:15, 36.31it/s] 18%|█▊        | 121/666 [00:03<00:15, 36.33it/s] 19%|█▉        | 125/666 [00:03<00:14, 36.32it/s] 19%|█▉        | 129/666 [00:03<00:14, 36.31it/s] 20%|█▉        | 133/666 [00:03<00:14, 36.31it/s] 21%|██        | 137/666 [00:03<00:14, 36.29it/s] 21%|██        | 141/666 [00:04<00:14, 36.32it/s] 22%|██▏       | 145/666 [00:04<00:14, 36.28it/s] 22%|██▏       | 149/666 [00:04<00:14, 36.31it/s] 23%|██▎       | 153/666 [00:04<00:14, 36.29it/s] 24%|██▎       | 157/666 [00:04<00:14, 36.32it/s] 24%|██▍       | 161/666 [00:04<00:13, 36.32it/s] 25%|██▍       | 165/666 [00:04<00:13, 36.33it/s] 25%|██▌       | 169/666 [00:04<00:13, 36.33it/s] 26%|██▌       | 173/666 [00:04<00:13, 36.34it/s] 27%|██▋       | 177/666 [00:05<00:13, 36.32it/s] 27%|██▋       | 181/666 [00:05<00:13, 36.33it/s] 28%|██▊       | 185/666 [00:05<00:13, 36.28it/s] 28%|██▊       | 189/666 [00:05<00:13, 36.27it/s] 29%|██▉       | 193/666 [00:05<00:13, 36.32it/s] 30%|██▉       | 197/666 [00:05<00:12, 36.30it/s] 30%|███       | 201/666 [00:05<00:12, 36.33it/s] 31%|███       | 205/666 [00:05<00:12, 36.29it/s] 31%|███▏      | 209/666 [00:05<00:12, 36.30it/s] 32%|███▏      | 213/666 [00:06<00:12, 36.30it/s] 33%|███▎      | 217/666 [00:06<00:12, 36.32it/s] 33%|███▎      | 221/666 [00:06<00:12, 36.31it/s] 34%|███▍      | 225/666 [00:06<00:12, 36.32it/s] 34%|███▍      | 229/666 [00:06<00:12, 36.32it/s] 35%|███▍      | 233/666 [00:06<00:11, 36.32it/s] 36%|███▌      | 237/666 [00:06<00:11, 36.34it/s] 36%|███▌      | 241/666 [00:06<00:11, 36.33it/s] 37%|███▋      | 245/666 [00:06<00:11, 36.34it/s] 37%|███▋      | 249/666 [00:07<00:11, 36.30it/s] 38%|███▊      | 253/666 [00:07<00:11, 36.33it/s] 39%|███▊      | 257/666 [00:07<00:11, 36.29it/s] 39%|███▉      | 261/666 [00:07<00:11, 36.29it/s] 40%|███▉      | 265/666 [00:07<00:11, 36.29it/s] 40%|████      | 269/666 [00:07<00:10, 36.27it/s] 41%|████      | 273/666 [00:07<00:10, 36.29it/s] 42%|████▏     | 277/666 [00:07<00:10, 36.29it/s] 42%|████▏     | 281/666 [00:07<00:10, 36.30it/s] 43%|████▎     | 285/666 [00:08<00:10, 36.29it/s] 43%|████▎     | 289/666 [00:08<00:10, 36.32it/s] 44%|████▍     | 293/666 [00:08<00:10, 36.27it/s] 45%|████▍     | 297/666 [00:08<00:10, 36.29it/s] 45%|████▌     | 301/666 [00:08<00:10, 36.29it/s] 46%|████▌     | 305/666 [00:08<00:09, 36.29it/s] 46%|████▋     | 309/666 [00:08<00:09, 36.29it/s] 47%|████▋     | 313/666 [00:08<00:09, 36.20it/s] 48%|████▊     | 317/666 [00:08<00:09, 36.37it/s] 48%|████▊     | 321/666 [00:08<00:09, 36.49it/s] 49%|████▉     | 325/666 [00:09<00:09, 36.57it/s] 49%|████▉     | 329/666 [00:09<00:09, 36.61it/s] 50%|█████     | 333/666 [00:09<00:09, 36.68it/s] 51%|█████     | 337/666 [00:09<00:08, 36.72it/s] 51%|█████     | 341/666 [00:09<00:08, 36.76it/s] 52%|█████▏    | 345/666 [00:09<00:08, 36.78it/s] 52%|█████▏    | 349/666 [00:09<00:08, 36.77it/s] 53%|█████▎    | 353/666 [00:09<00:08, 36.78it/s] 54%|█████▎    | 357/666 [00:09<00:08, 36.80it/s] 54%|█████▍    | 361/666 [00:10<00:08, 36.80it/s] 55%|█████▍    | 365/666 [00:10<00:08, 36.82it/s] 55%|█████▌    | 369/666 [00:10<00:08, 36.83it/s] 56%|█████▌    | 373/666 [00:10<00:07, 36.83it/s] 57%|█████▋    | 377/666 [00:10<00:07, 36.81it/s] 57%|█████▋    | 381/666 [00:10<00:07, 36.81it/s] 58%|█████▊    | 385/666 [00:10<00:07, 36.83it/s] 58%|█████▊    | 389/666 [00:10<00:07, 36.84it/s] 59%|█████▉    | 393/666 [00:10<00:07, 36.83it/s] 60%|█████▉    | 397/666 [00:11<00:07, 36.83it/s] 60%|██████    | 401/666 [00:11<00:07, 36.84it/s] 61%|██████    | 405/666 [00:11<00:07, 36.83it/s] 61%|██████▏   | 409/666 [00:11<00:06, 36.84it/s] 62%|██████▏   | 413/666 [00:11<00:06, 36.85it/s] 63%|██████▎   | 417/666 [00:11<00:06, 36.86it/s] 63%|██████▎   | 421/666 [00:11<00:06, 36.87it/s] 64%|██████▍   | 425/666 [00:11<00:06, 36.87it/s] 64%|██████▍   | 429/666 [00:11<00:06, 36.88it/s] 65%|██████▌   | 433/666 [00:12<00:06, 36.87it/s] 66%|██████▌   | 437/666 [00:12<00:06, 36.87it/s] 66%|██████▌   | 441/666 [00:12<00:06, 36.85it/s] 67%|██████▋   | 445/666 [00:12<00:05, 36.85it/s] 67%|██████▋   | 449/666 [00:12<00:05, 36.85it/s] 68%|██████▊   | 453/666 [00:12<00:05, 36.85it/s] 69%|██████▊   | 457/666 [00:12<00:05, 36.85it/s] 69%|██████▉   | 461/666 [00:12<00:05, 36.86it/s] 70%|██████▉   | 465/666 [00:12<00:05, 36.86it/s] 70%|███████   | 469/666 [00:13<00:05, 36.86it/s] 71%|███████   | 473/666 [00:13<00:05, 36.86it/s] 72%|███████▏  | 477/666 [00:13<00:05, 36.88it/s] 72%|███████▏  | 481/666 [00:13<00:05, 36.87it/s] 73%|███████▎  | 485/666 [00:13<00:04, 36.88it/s] 73%|███████▎  | 489/666 [00:13<00:04, 36.87it/s] 74%|███████▍  | 493/666 [00:13<00:04, 36.88it/s] 75%|███████▍  | 497/666 [00:13<00:04, 36.88it/s] 75%|███████▌  | 501/666 [00:13<00:04, 36.85it/s] 76%|███████▌  | 505/666 [00:13<00:04, 36.85it/s] 76%|███████▋  | 509/666 [00:14<00:04, 36.86it/s] 77%|███████▋  | 513/666 [00:14<00:04, 36.86it/s] 78%|███████▊  | 517/666 [00:14<00:04, 36.85it/s] 78%|███████▊  | 521/666 [00:14<00:03, 36.85it/s] 79%|███████▉  | 525/666 [00:14<00:03, 36.86it/s] 79%|███████▉  | 529/666 [00:14<00:03, 36.86it/s] 80%|████████  | 533/666 [00:14<00:03, 36.86it/s] 81%|████████  | 537/666 [00:14<00:03, 36.79it/s] 81%|████████  | 541/666 [00:14<00:03, 36.68it/s] 82%|████████▏ | 545/666 [00:15<00:03, 36.71it/s] 82%|████████▏ | 549/666 [00:15<00:03, 36.75it/s] 83%|████████▎ | 553/666 [00:15<00:03, 36.78it/s] 84%|████████▎ | 557/666 [00:15<00:02, 36.78it/s] 84%|████████▍ | 561/666 [00:15<00:02, 36.78it/s] 85%|████████▍ | 565/666 [00:15<00:02, 36.77it/s] 85%|████████▌ | 569/666 [00:15<00:02, 36.79it/s] 86%|████████▌ | 573/666 [00:15<00:02, 36.81it/s] 87%|████████▋ | 577/666 [00:15<00:02, 36.80it/s] 87%|████████▋ | 581/666 [00:16<00:02, 36.82it/s] 88%|████████▊ | 585/666 [00:16<00:02, 36.81it/s] 88%|████████▊ | 589/666 [00:16<00:02, 36.82it/s] 89%|████████▉ | 593/666 [00:16<00:01, 36.83it/s] 90%|████████▉ | 597/666 [00:16<00:01, 36.84it/s] 90%|█████████ | 601/666 [00:16<00:01, 36.84it/s] 91%|█████████ | 605/666 [00:16<00:01, 36.86it/s] 91%|█████████▏| 609/666 [00:16<00:01, 36.86it/s] 92%|█████████▏| 613/666 [00:16<00:01, 36.86it/s] 93%|█████████▎| 617/666 [00:17<00:01, 36.84it/s] 93%|█████████▎| 621/666 [00:17<00:01, 36.83it/s] 94%|█████████▍| 625/666 [00:17<00:01, 36.79it/s] 94%|█████████▍| 629/666 [00:17<00:01, 36.81it/s] 95%|█████████▌| 633/666 [00:17<00:00, 36.82it/s] 96%|█████████▌| 637/666 [00:17<00:00, 36.83it/s] 96%|█████████▌| 641/666 [00:17<00:00, 36.81it/s] 97%|█████████▋| 645/666 [00:17<00:00, 36.81it/s] 97%|█████████▋| 649/666 [00:17<00:00, 36.81it/s] 98%|█████████▊| 653/666 [00:18<00:00, 36.83it/s] 99%|█████████▊| 657/666 [00:18<00:00, 36.84it/s] 99%|█████████▉| 661/666 [00:18<00:00, 36.16it/s]100%|█████████▉| 665/666 [00:18<00:00, 36.48it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.01it/s][A
  6%|▌         | 10/167 [00:00<00:03, 51.90it/s][A
 20%|██        | 34/167 [00:00<00:01, 131.81it/s][A
 35%|███▍      | 58/167 [00:00<00:00, 172.42it/s][A
 49%|████▉     | 82/167 [00:00<00:00, 194.55it/s][A
 63%|██████▎   | 106/167 [00:00<00:00, 208.38it/s][A
 78%|███████▊  | 130/167 [00:00<00:00, 217.78it/s][A
 92%|█████████▏| 154/167 [00:00<00:00, 223.37it/s][A100%|██████████| 167/167 [00:00<00:00, 179.63it/s]
2022-11-28 21:41:06,260 P13517 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:41:06,261 P13517 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:41:06,261 P13517 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:41:06,261 P13517 INFO Early stopping at epoch=3
2022-11-28 21:41:06,261 P13517 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:19<00:00, 34.17it/s]
2022-11-28 21:41:06,314 P13517 INFO Train loss: 30.971488
2022-11-28 21:41:06,314 P13517 INFO Training finished.
2022-11-28 21:41:06,314 P13517 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_020_e7a51908.model
2022-11-28 21:41:06,417 P13517 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:49,  6.06it/s]  2%|▏         | 10/666 [00:00<00:15, 42.76it/s]  5%|▌         | 34/666 [00:00<00:05, 117.56it/s]  9%|▊         | 58/666 [00:00<00:03, 159.20it/s] 12%|█▏        | 82/666 [00:00<00:03, 185.08it/s] 16%|█▌        | 105/666 [00:00<00:02, 198.44it/s] 19%|█▉        | 128/666 [00:00<00:02, 207.27it/s] 23%|██▎       | 151/666 [00:00<00:02, 212.72it/s] 26%|██▌       | 174/666 [00:00<00:02, 216.27it/s] 30%|██▉       | 197/666 [00:01<00:02, 219.03it/s] 33%|███▎      | 220/666 [00:01<00:02, 220.88it/s] 36%|███▋      | 243/666 [00:01<00:01, 221.81it/s] 40%|███▉      | 266/666 [00:01<00:01, 222.45it/s] 43%|████▎     | 289/666 [00:01<00:01, 221.13it/s] 47%|████▋     | 312/666 [00:01<00:01, 221.49it/s] 50%|█████     | 335/666 [00:01<00:01, 221.35it/s] 54%|█████▍    | 358/666 [00:01<00:01, 221.84it/s] 57%|█████▋    | 381/666 [00:01<00:01, 222.15it/s] 61%|██████    | 404/666 [00:02<00:01, 220.48it/s] 64%|██████▍   | 427/666 [00:02<00:01, 220.76it/s] 68%|██████▊   | 450/666 [00:02<00:00, 221.07it/s] 71%|███████   | 473/666 [00:02<00:00, 220.89it/s] 74%|███████▍  | 496/666 [00:02<00:00, 220.82it/s] 78%|███████▊  | 519/666 [00:02<00:00, 218.08it/s] 81%|████████  | 541/666 [00:02<00:00, 218.38it/s] 85%|████████▍ | 563/666 [00:02<00:00, 218.84it/s] 88%|████████▊ | 585/666 [00:02<00:00, 218.94it/s] 91%|█████████ | 607/666 [00:02<00:00, 218.93it/s] 94%|█████████▍| 629/666 [00:03<00:00, 218.77it/s] 98%|█████████▊| 651/666 [00:03<00:00, 218.53it/s]100%|██████████| 666/666 [00:03<00:00, 203.35it/s]
2022-11-28 21:41:10,144 P13517 INFO [Metrics] logloss: 4.992003 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:18,  8.85it/s]  6%|▌         | 10/167 [00:00<00:03, 50.78it/s] 16%|█▌        | 27/167 [00:00<00:01, 100.46it/s] 29%|██▉       | 49/167 [00:00<00:00, 143.01it/s] 42%|████▏     | 70/167 [00:00<00:00, 166.02it/s] 55%|█████▌    | 92/167 [00:00<00:00, 181.10it/s] 68%|██████▊   | 113/167 [00:00<00:00, 190.09it/s] 80%|████████  | 134/167 [00:00<00:00, 196.27it/s] 93%|█████████▎| 156/167 [00:00<00:00, 201.09it/s]100%|██████████| 167/167 [00:01<00:00, 160.48it/s]
2022-11-28 21:41:11,296 P13517 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:41:17,208 P15296 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "256",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_021_3f6d0677",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:41:17,210 P15296 INFO Set up feature encoder...
2022-11-28 21:41:17,212 P15296 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:41:17,213 P15296 INFO Loading data...
2022-11-28 21:41:17,217 P15296 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:41:17,601 P15296 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:41:17,728 P15296 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:41:17,729 P15296 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:41:17,729 P15296 INFO Loading train data done.
2022-11-28 21:41:21,341 P15296 INFO Total number of parameters: 59431684.
2022-11-28 21:41:21,341 P15296 INFO Start training: 666 batches/epoch
2022-11-28 21:41:21,341 P15296 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:41:21.673 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:15296 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:41:21.704 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:15296 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:20,  1.11s/it]  1%|          | 4/666 [00:01<02:44,  4.03it/s]  1%|          | 7/666 [00:01<01:31,  7.23it/s]  2%|▏         | 10/666 [00:01<01:03, 10.28it/s]  2%|▏         | 13/666 [00:01<00:50, 13.00it/s]  2%|▏         | 16/666 [00:01<00:42, 15.33it/s]  3%|▎         | 19/666 [00:01<00:37, 17.26it/s]  3%|▎         | 22/666 [00:02<00:34, 18.78it/s]  4%|▍         | 25/666 [00:02<00:32, 19.94it/s]  4%|▍         | 28/666 [00:02<00:30, 20.80it/s]  5%|▍         | 31/666 [00:02<00:29, 21.43it/s]  5%|▌         | 34/666 [00:02<00:28, 21.87it/s]  6%|▌         | 37/666 [00:02<00:28, 22.21it/s]  6%|▌         | 40/666 [00:02<00:27, 22.45it/s]  6%|▋         | 43/666 [00:02<00:27, 22.62it/s]  7%|▋         | 46/666 [00:03<00:27, 22.64it/s]  7%|▋         | 49/666 [00:03<00:27, 22.75it/s]  8%|▊         | 52/666 [00:03<00:26, 22.83it/s]  8%|▊         | 55/666 [00:03<00:26, 22.89it/s]  9%|▊         | 58/666 [00:03<00:26, 22.93it/s]  9%|▉         | 61/666 [00:03<00:26, 22.95it/s] 10%|▉         | 64/666 [00:03<00:26, 22.95it/s] 10%|█         | 67/666 [00:03<00:26, 22.96it/s] 11%|█         | 70/666 [00:04<00:25, 22.98it/s] 11%|█         | 73/666 [00:04<00:25, 22.98it/s] 11%|█▏        | 76/666 [00:04<00:25, 22.99it/s] 12%|█▏        | 79/666 [00:04<00:25, 22.97it/s] 12%|█▏        | 82/666 [00:04<00:25, 22.97it/s] 13%|█▎        | 85/666 [00:04<00:25, 22.98it/s] 13%|█▎        | 88/666 [00:04<00:25, 22.98it/s] 14%|█▎        | 91/666 [00:05<00:25, 22.98it/s] 14%|█▍        | 94/666 [00:05<00:24, 22.98it/s] 15%|█▍        | 97/666 [00:05<00:24, 22.99it/s] 15%|█▌        | 100/666 [00:05<00:24, 22.98it/s] 15%|█▌        | 103/666 [00:05<00:24, 22.98it/s] 16%|█▌        | 106/666 [00:05<00:24, 22.99it/s] 16%|█▋        | 109/666 [00:05<00:24, 23.00it/s] 17%|█▋        | 112/666 [00:05<00:24, 23.00it/s] 17%|█▋        | 115/666 [00:06<00:23, 23.00it/s] 18%|█▊        | 118/666 [00:06<00:23, 22.99it/s] 18%|█▊        | 121/666 [00:06<00:23, 22.99it/s] 19%|█▊        | 124/666 [00:06<00:23, 22.99it/s] 19%|█▉        | 127/666 [00:06<00:23, 22.99it/s] 20%|█▉        | 130/666 [00:06<00:23, 22.98it/s] 20%|█▉        | 133/666 [00:06<00:23, 22.99it/s] 20%|██        | 136/666 [00:06<00:23, 22.99it/s] 21%|██        | 139/666 [00:07<00:22, 23.00it/s] 21%|██▏       | 142/666 [00:07<00:22, 23.00it/s] 22%|██▏       | 145/666 [00:07<00:22, 23.00it/s] 22%|██▏       | 148/666 [00:07<00:22, 23.00it/s] 23%|██▎       | 151/666 [00:07<00:22, 22.99it/s] 23%|██▎       | 154/666 [00:07<00:22, 23.00it/s] 24%|██▎       | 157/666 [00:07<00:22, 23.00it/s] 24%|██▍       | 160/666 [00:08<00:22, 22.99it/s] 24%|██▍       | 163/666 [00:08<00:21, 23.00it/s] 25%|██▍       | 166/666 [00:08<00:21, 23.00it/s] 25%|██▌       | 169/666 [00:08<00:21, 23.00it/s] 26%|██▌       | 172/666 [00:08<00:21, 22.99it/s] 26%|██▋       | 175/666 [00:08<00:21, 23.00it/s] 27%|██▋       | 178/666 [00:08<00:21, 22.99it/s] 27%|██▋       | 181/666 [00:08<00:21, 22.98it/s] 28%|██▊       | 184/666 [00:09<00:20, 22.98it/s] 28%|██▊       | 187/666 [00:09<00:20, 22.99it/s] 29%|██▊       | 190/666 [00:09<00:20, 22.97it/s] 29%|██▉       | 193/666 [00:09<00:20, 22.97it/s] 29%|██▉       | 196/666 [00:09<00:20, 22.98it/s] 30%|██▉       | 199/666 [00:09<00:20, 22.98it/s] 30%|███       | 202/666 [00:09<00:20, 22.99it/s] 31%|███       | 205/666 [00:09<00:20, 23.00it/s] 31%|███       | 208/666 [00:10<00:19, 23.00it/s] 32%|███▏      | 211/666 [00:10<00:19, 23.00it/s] 32%|███▏      | 214/666 [00:10<00:19, 23.00it/s] 33%|███▎      | 217/666 [00:10<00:19, 23.00it/s] 33%|███▎      | 220/666 [00:10<00:19, 23.00it/s] 33%|███▎      | 223/666 [00:10<00:19, 23.00it/s] 34%|███▍      | 226/666 [00:10<00:19, 22.98it/s] 34%|███▍      | 229/666 [00:11<00:19, 22.98it/s] 35%|███▍      | 232/666 [00:11<00:18, 22.98it/s] 35%|███▌      | 235/666 [00:11<00:18, 22.98it/s] 36%|███▌      | 238/666 [00:11<00:18, 22.99it/s] 36%|███▌      | 241/666 [00:11<00:18, 22.99it/s] 37%|███▋      | 244/666 [00:11<00:18, 22.98it/s] 37%|███▋      | 247/666 [00:11<00:18, 22.98it/s] 38%|███▊      | 250/666 [00:11<00:18, 22.98it/s] 38%|███▊      | 253/666 [00:12<00:17, 22.99it/s] 38%|███▊      | 256/666 [00:12<00:17, 22.98it/s] 39%|███▉      | 259/666 [00:12<00:17, 22.99it/s] 39%|███▉      | 262/666 [00:12<00:17, 22.99it/s] 40%|███▉      | 265/666 [00:12<00:17, 22.99it/s] 40%|████      | 268/666 [00:12<00:17, 22.98it/s] 41%|████      | 271/666 [00:12<00:17, 22.98it/s] 41%|████      | 274/666 [00:13<00:17, 22.99it/s] 42%|████▏     | 277/666 [00:13<00:16, 22.98it/s] 42%|████▏     | 280/666 [00:13<00:16, 22.99it/s] 42%|████▏     | 283/666 [00:13<00:16, 22.99it/s] 43%|████▎     | 286/666 [00:13<00:16, 22.98it/s] 43%|████▎     | 289/666 [00:13<00:16, 22.99it/s] 44%|████▍     | 292/666 [00:13<00:16, 23.00it/s] 44%|████▍     | 295/666 [00:13<00:16, 22.99it/s] 45%|████▍     | 298/666 [00:14<00:16, 22.99it/s] 45%|████▌     | 301/666 [00:14<00:15, 22.99it/s] 46%|████▌     | 304/666 [00:14<00:15, 22.99it/s] 46%|████▌     | 307/666 [00:14<00:15, 22.99it/s] 47%|████▋     | 310/666 [00:14<00:15, 22.98it/s] 47%|████▋     | 313/666 [00:14<00:15, 22.98it/s] 47%|████▋     | 316/666 [00:14<00:15, 22.98it/s] 48%|████▊     | 319/666 [00:14<00:15, 22.97it/s] 48%|████▊     | 322/666 [00:15<00:14, 22.98it/s] 49%|████▉     | 325/666 [00:15<00:14, 22.98it/s] 49%|████▉     | 328/666 [00:15<00:14, 22.98it/s] 50%|████▉     | 331/666 [00:15<00:14, 22.98it/s] 50%|█████     | 334/666 [00:15<00:14, 22.98it/s] 51%|█████     | 337/666 [00:15<00:14, 22.97it/s] 51%|█████     | 340/666 [00:15<00:14, 22.97it/s] 52%|█████▏    | 343/666 [00:16<00:14, 22.97it/s] 52%|█████▏    | 346/666 [00:16<00:13, 22.98it/s] 52%|█████▏    | 349/666 [00:16<00:13, 22.98it/s] 53%|█████▎    | 352/666 [00:16<00:13, 22.99it/s] 53%|█████▎    | 355/666 [00:16<00:13, 22.99it/s] 54%|█████▍    | 358/666 [00:16<00:13, 22.99it/s] 54%|█████▍    | 361/666 [00:16<00:13, 23.00it/s] 55%|█████▍    | 364/666 [00:16<00:13, 23.00it/s] 55%|█████▌    | 367/666 [00:17<00:13, 22.99it/s] 56%|█████▌    | 370/666 [00:17<00:12, 22.99it/s] 56%|█████▌    | 373/666 [00:17<00:12, 22.99it/s] 56%|█████▋    | 376/666 [00:17<00:12, 23.00it/s] 57%|█████▋    | 379/666 [00:17<00:12, 22.99it/s] 57%|█████▋    | 382/666 [00:17<00:12, 22.98it/s] 58%|█████▊    | 385/666 [00:17<00:12, 22.99it/s] 58%|█████▊    | 388/666 [00:17<00:12, 22.97it/s] 59%|█████▊    | 391/666 [00:18<00:11, 22.97it/s] 59%|█████▉    | 394/666 [00:18<00:11, 22.97it/s] 60%|█████▉    | 397/666 [00:18<00:11, 22.97it/s] 60%|██████    | 400/666 [00:18<00:11, 22.97it/s] 61%|██████    | 403/666 [00:18<00:11, 22.97it/s] 61%|██████    | 406/666 [00:18<00:11, 22.97it/s] 61%|██████▏   | 409/666 [00:18<00:11, 22.98it/s] 62%|██████▏   | 412/666 [00:19<00:11, 22.98it/s] 62%|██████▏   | 415/666 [00:19<00:10, 22.98it/s] 63%|██████▎   | 418/666 [00:19<00:10, 22.98it/s] 63%|██████▎   | 421/666 [00:19<00:10, 22.98it/s] 64%|██████▎   | 424/666 [00:19<00:10, 22.98it/s] 64%|██████▍   | 427/666 [00:19<00:10, 22.98it/s] 65%|██████▍   | 430/666 [00:19<00:10, 22.98it/s] 65%|██████▌   | 433/666 [00:19<00:10, 22.98it/s] 65%|██████▌   | 436/666 [00:20<00:10, 22.99it/s] 66%|██████▌   | 439/666 [00:20<00:09, 22.98it/s] 66%|██████▋   | 442/666 [00:20<00:09, 22.99it/s] 67%|██████▋   | 445/666 [00:20<00:09, 22.99it/s] 67%|██████▋   | 448/666 [00:20<00:09, 22.99it/s] 68%|██████▊   | 451/666 [00:20<00:09, 22.99it/s] 68%|██████▊   | 454/666 [00:20<00:09, 22.99it/s] 69%|██████▊   | 457/666 [00:20<00:09, 22.99it/s] 69%|██████▉   | 460/666 [00:21<00:08, 22.99it/s] 70%|██████▉   | 463/666 [00:21<00:08, 22.98it/s] 70%|██████▉   | 466/666 [00:21<00:08, 22.98it/s] 70%|███████   | 469/666 [00:21<00:08, 22.99it/s] 71%|███████   | 472/666 [00:21<00:08, 22.94it/s] 71%|███████▏  | 475/666 [00:21<00:08, 22.95it/s] 72%|███████▏  | 478/666 [00:21<00:08, 22.97it/s] 72%|███████▏  | 481/666 [00:22<00:08, 22.97it/s] 73%|███████▎  | 484/666 [00:22<00:07, 22.97it/s] 73%|███████▎  | 487/666 [00:22<00:07, 22.97it/s] 74%|███████▎  | 490/666 [00:22<00:07, 22.97it/s] 74%|███████▍  | 493/666 [00:22<00:07, 22.97it/s] 74%|███████▍  | 496/666 [00:22<00:07, 22.98it/s] 75%|███████▍  | 499/666 [00:22<00:07, 22.98it/s] 75%|███████▌  | 502/666 [00:22<00:07, 22.98it/s] 76%|███████▌  | 505/666 [00:23<00:07, 22.98it/s] 76%|███████▋  | 508/666 [00:23<00:06, 22.98it/s] 77%|███████▋  | 511/666 [00:23<00:06, 22.98it/s] 77%|███████▋  | 514/666 [00:23<00:06, 22.99it/s] 78%|███████▊  | 517/666 [00:23<00:06, 22.99it/s] 78%|███████▊  | 520/666 [00:23<00:06, 22.99it/s] 79%|███████▊  | 523/666 [00:23<00:06, 22.98it/s] 79%|███████▉  | 526/666 [00:23<00:06, 22.98it/s] 79%|███████▉  | 529/666 [00:24<00:05, 22.99it/s] 80%|███████▉  | 532/666 [00:24<00:05, 22.99it/s] 80%|████████  | 535/666 [00:24<00:05, 22.99it/s] 81%|████████  | 538/666 [00:24<00:05, 22.99it/s] 81%|████████  | 541/666 [00:24<00:05, 22.99it/s] 82%|████████▏ | 544/666 [00:24<00:05, 22.99it/s] 82%|████████▏ | 547/666 [00:24<00:05, 22.99it/s] 83%|████████▎ | 550/666 [00:25<00:05, 22.98it/s] 83%|████████▎ | 553/666 [00:25<00:04, 22.99it/s] 83%|████████▎ | 556/666 [00:25<00:04, 22.98it/s] 84%|████████▍ | 559/666 [00:25<00:04, 22.98it/s] 84%|████████▍ | 562/666 [00:25<00:04, 22.99it/s] 85%|████████▍ | 565/666 [00:25<00:04, 22.98it/s] 85%|████████▌ | 568/666 [00:25<00:04, 22.98it/s] 86%|████████▌ | 571/666 [00:25<00:04, 22.96it/s] 86%|████████▌ | 574/666 [00:26<00:04, 22.91it/s] 87%|████████▋ | 577/666 [00:26<00:03, 22.91it/s] 87%|████████▋ | 580/666 [00:26<00:03, 22.94it/s] 88%|████████▊ | 583/666 [00:26<00:03, 22.94it/s] 88%|████████▊ | 586/666 [00:26<00:03, 22.94it/s] 88%|████████▊ | 589/666 [00:26<00:03, 22.96it/s] 89%|████████▉ | 592/666 [00:26<00:03, 22.96it/s] 89%|████████▉ | 595/666 [00:26<00:03, 22.96it/s] 90%|████████▉ | 598/666 [00:27<00:02, 22.98it/s] 90%|█████████ | 601/666 [00:27<00:02, 22.98it/s] 91%|█████████ | 604/666 [00:27<00:02, 22.99it/s] 91%|█████████ | 607/666 [00:27<00:02, 22.99it/s] 92%|█████████▏| 610/666 [00:27<00:02, 22.99it/s] 92%|█████████▏| 613/666 [00:27<00:02, 22.99it/s] 92%|█████████▏| 616/666 [00:27<00:02, 22.99it/s] 93%|█████████▎| 619/666 [00:28<00:02, 22.97it/s] 93%|█████████▎| 622/666 [00:28<00:01, 22.96it/s] 94%|█████████▍| 625/666 [00:28<00:01, 22.97it/s] 94%|█████████▍| 628/666 [00:28<00:01, 22.97it/s] 95%|█████████▍| 631/666 [00:28<00:01, 22.97it/s] 95%|█████████▌| 634/666 [00:28<00:01, 22.96it/s] 96%|█████████▌| 637/666 [00:28<00:01, 22.97it/s] 96%|█████████▌| 640/666 [00:28<00:01, 22.97it/s] 97%|█████████▋| 643/666 [00:29<00:01, 22.97it/s] 97%|█████████▋| 646/666 [00:29<00:00, 22.98it/s] 97%|█████████▋| 649/666 [00:29<00:00, 22.98it/s] 98%|█████████▊| 652/666 [00:29<00:00, 22.98it/s] 98%|█████████▊| 655/666 [00:29<00:00, 22.98it/s] 99%|█████████▉| 658/666 [00:29<00:00, 22.98it/s] 99%|█████████▉| 661/666 [00:29<00:00, 22.61it/s]100%|█████████▉| 664/666 [00:29<00:00, 22.77it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 2/167 [00:00<00:08, 19.49it/s][A
  6%|▌         | 10/167 [00:00<00:03, 51.54it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 128.68it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 165.50it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 187.13it/s][A
 61%|██████    | 102/167 [00:00<00:00, 200.14it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 208.67it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 213.35it/s][A100%|██████████| 167/167 [00:00<00:00, 175.43it/s]
2022-11-28 21:41:52,472 P15296 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:41:52,472 P15296 INFO Save best model: monitor(max): -10.620960
2022-11-28 21:41:54,855 P15296 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:33<00:00, 19.85it/s]
2022-11-28 21:41:54,890 P15296 INFO Train loss: 68.460104
2022-11-28 21:41:54,890 P15296 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:07,  5.22it/s]  1%|          | 4/666 [00:00<00:48, 13.56it/s]  1%|          | 7/666 [00:00<00:38, 17.34it/s]  2%|▏         | 10/666 [00:00<00:34, 19.29it/s]  2%|▏         | 13/666 [00:00<00:31, 20.52it/s]  2%|▏         | 16/666 [00:00<00:30, 21.32it/s]  3%|▎         | 19/666 [00:00<00:29, 21.82it/s]  3%|▎         | 22/666 [00:01<00:29, 22.15it/s]  4%|▍         | 25/666 [00:01<00:28, 22.38it/s]  4%|▍         | 28/666 [00:01<00:28, 22.54it/s]  5%|▍         | 31/666 [00:01<00:28, 22.64it/s]  5%|▌         | 34/666 [00:01<00:27, 22.74it/s]  6%|▌         | 37/666 [00:01<00:27, 22.80it/s]  6%|▌         | 40/666 [00:01<00:27, 22.85it/s]  6%|▋         | 43/666 [00:02<00:27, 22.88it/s]  7%|▋         | 46/666 [00:02<00:27, 22.89it/s]  7%|▋         | 49/666 [00:02<00:26, 22.89it/s]  8%|▊         | 52/666 [00:02<00:26, 22.90it/s]  8%|▊         | 55/666 [00:02<00:26, 22.90it/s]  9%|▊         | 58/666 [00:02<00:26, 22.92it/s]  9%|▉         | 61/666 [00:02<00:26, 22.92it/s] 10%|▉         | 64/666 [00:02<00:26, 22.93it/s] 10%|█         | 67/666 [00:03<00:26, 22.94it/s] 11%|█         | 70/666 [00:03<00:26, 22.91it/s] 11%|█         | 73/666 [00:03<00:25, 22.91it/s] 11%|█▏        | 76/666 [00:03<00:25, 22.93it/s] 12%|█▏        | 79/666 [00:03<00:25, 22.94it/s] 12%|█▏        | 82/666 [00:03<00:25, 22.94it/s] 13%|█▎        | 85/666 [00:03<00:25, 22.94it/s] 13%|█▎        | 88/666 [00:03<00:25, 22.94it/s] 14%|█▎        | 91/666 [00:04<00:25, 22.94it/s] 14%|█▍        | 94/666 [00:04<00:24, 22.95it/s] 15%|█▍        | 97/666 [00:04<00:24, 22.95it/s] 15%|█▌        | 100/666 [00:04<00:24, 22.95it/s] 15%|█▌        | 103/666 [00:04<00:24, 22.96it/s] 16%|█▌        | 106/666 [00:04<00:24, 22.97it/s] 16%|█▋        | 109/666 [00:04<00:24, 22.96it/s] 17%|█▋        | 112/666 [00:05<00:24, 22.96it/s] 17%|█▋        | 115/666 [00:05<00:23, 22.97it/s] 18%|█▊        | 118/666 [00:05<00:23, 22.96it/s] 18%|█▊        | 121/666 [00:05<00:23, 22.96it/s] 19%|█▊        | 124/666 [00:05<00:23, 22.96it/s] 19%|█▉        | 127/666 [00:05<00:23, 22.96it/s] 20%|█▉        | 130/666 [00:05<00:23, 22.98it/s] 20%|█▉        | 133/666 [00:05<00:23, 22.98it/s] 20%|██        | 136/666 [00:06<00:23, 22.97it/s] 21%|██        | 139/666 [00:06<00:22, 22.97it/s] 21%|██▏       | 142/666 [00:06<00:22, 22.96it/s] 22%|██▏       | 145/666 [00:06<00:22, 22.92it/s] 22%|██▏       | 148/666 [00:06<00:22, 22.92it/s] 23%|██▎       | 151/666 [00:06<00:22, 22.93it/s] 23%|██▎       | 154/666 [00:06<00:22, 22.94it/s] 24%|██▎       | 157/666 [00:07<00:22, 22.94it/s] 24%|██▍       | 160/666 [00:07<00:22, 22.96it/s] 24%|██▍       | 163/666 [00:07<00:21, 22.94it/s] 25%|██▍       | 166/666 [00:07<00:21, 22.94it/s] 25%|██▌       | 169/666 [00:07<00:21, 22.94it/s] 26%|██▌       | 172/666 [00:07<00:21, 22.94it/s] 26%|██▋       | 175/666 [00:07<00:21, 22.94it/s] 27%|██▋       | 178/666 [00:07<00:21, 22.95it/s] 27%|██▋       | 181/666 [00:08<00:21, 22.96it/s] 28%|██▊       | 184/666 [00:08<00:21, 22.95it/s] 28%|██▊       | 187/666 [00:08<00:20, 22.96it/s] 29%|██▊       | 190/666 [00:08<00:20, 22.96it/s] 29%|██▉       | 193/666 [00:08<00:20, 22.96it/s] 29%|██▉       | 196/666 [00:08<00:20, 22.97it/s] 30%|██▉       | 199/666 [00:08<00:20, 22.97it/s] 30%|███       | 202/666 [00:08<00:20, 22.95it/s] 31%|███       | 205/666 [00:09<00:20, 22.96it/s] 31%|███       | 208/666 [00:09<00:19, 22.94it/s] 32%|███▏      | 211/666 [00:09<00:19, 22.94it/s] 32%|███▏      | 214/666 [00:09<00:19, 22.95it/s] 33%|███▎      | 217/666 [00:09<00:19, 22.96it/s] 33%|███▎      | 220/666 [00:09<00:19, 22.96it/s] 33%|███▎      | 223/666 [00:09<00:19, 22.95it/s] 34%|███▍      | 226/666 [00:10<00:19, 22.96it/s] 34%|███▍      | 229/666 [00:10<00:19, 22.95it/s] 35%|███▍      | 232/666 [00:10<00:18, 22.94it/s] 35%|███▌      | 235/666 [00:10<00:18, 22.95it/s] 36%|███▌      | 238/666 [00:10<00:18, 22.95it/s] 36%|███▌      | 241/666 [00:10<00:18, 22.95it/s] 37%|███▋      | 244/666 [00:10<00:18, 22.96it/s] 37%|███▋      | 247/666 [00:10<00:18, 22.96it/s] 38%|███▊      | 250/666 [00:11<00:18, 22.96it/s] 38%|███▊      | 253/666 [00:11<00:17, 22.96it/s] 38%|███▊      | 256/666 [00:11<00:17, 22.96it/s] 39%|███▉      | 259/666 [00:11<00:17, 22.96it/s] 39%|███▉      | 262/666 [00:11<00:17, 22.96it/s] 40%|███▉      | 265/666 [00:11<00:17, 22.96it/s] 40%|████      | 268/666 [00:11<00:17, 22.96it/s] 41%|████      | 271/666 [00:11<00:17, 22.95it/s] 41%|████      | 274/666 [00:12<00:17, 22.94it/s] 42%|████▏     | 277/666 [00:12<00:16, 22.95it/s] 42%|████▏     | 280/666 [00:12<00:16, 22.96it/s] 42%|████▏     | 283/666 [00:12<00:16, 22.93it/s] 43%|████▎     | 286/666 [00:12<00:16, 22.89it/s] 43%|████▎     | 289/666 [00:12<00:16, 22.89it/s] 44%|████▍     | 292/666 [00:12<00:16, 22.91it/s] 44%|████▍     | 295/666 [00:13<00:16, 22.94it/s] 45%|████▍     | 298/666 [00:13<00:16, 22.93it/s] 45%|████▌     | 301/666 [00:13<00:15, 22.95it/s] 46%|████▌     | 304/666 [00:13<00:15, 22.96it/s] 46%|████▌     | 307/666 [00:13<00:15, 22.96it/s] 47%|████▋     | 310/666 [00:13<00:15, 22.96it/s] 47%|████▋     | 313/666 [00:13<00:15, 22.97it/s] 47%|████▋     | 316/666 [00:13<00:15, 22.96it/s] 48%|████▊     | 319/666 [00:14<00:15, 22.96it/s] 48%|████▊     | 322/666 [00:14<00:14, 22.97it/s] 49%|████▉     | 325/666 [00:14<00:14, 22.98it/s] 49%|████▉     | 328/666 [00:14<00:14, 22.98it/s] 50%|████▉     | 331/666 [00:14<00:14, 22.98it/s] 50%|█████     | 334/666 [00:14<00:14, 22.98it/s] 51%|█████     | 337/666 [00:14<00:14, 22.99it/s] 51%|█████     | 340/666 [00:14<00:14, 22.97it/s] 52%|█████▏    | 343/666 [00:15<00:14, 22.97it/s] 52%|█████▏    | 346/666 [00:15<00:13, 22.96it/s] 52%|█████▏    | 349/666 [00:15<00:13, 22.96it/s] 53%|█████▎    | 352/666 [00:15<00:13, 22.97it/s] 53%|█████▎    | 355/666 [00:15<00:13, 22.97it/s] 54%|█████▍    | 358/666 [00:15<00:13, 22.96it/s] 54%|█████▍    | 361/666 [00:15<00:13, 22.97it/s] 55%|█████▍    | 364/666 [00:16<00:13, 22.97it/s] 55%|█████▌    | 367/666 [00:16<00:13, 22.96it/s] 56%|█████▌    | 370/666 [00:16<00:12, 22.97it/s] 56%|█████▌    | 373/666 [00:16<00:12, 22.96it/s] 56%|█████▋    | 376/666 [00:16<00:12, 22.96it/s] 57%|█████▋    | 379/666 [00:16<00:12, 22.95it/s] 57%|█████▋    | 382/666 [00:16<00:12, 22.96it/s] 58%|█████▊    | 385/666 [00:16<00:12, 22.97it/s] 58%|█████▊    | 388/666 [00:17<00:12, 22.97it/s] 59%|█████▊    | 391/666 [00:17<00:11, 22.96it/s] 59%|█████▉    | 394/666 [00:17<00:11, 22.97it/s] 60%|█████▉    | 397/666 [00:17<00:11, 22.97it/s] 60%|██████    | 400/666 [00:17<00:11, 22.97it/s] 61%|██████    | 403/666 [00:17<00:11, 22.97it/s] 61%|██████    | 406/666 [00:17<00:11, 22.97it/s] 61%|██████▏   | 409/666 [00:17<00:11, 22.97it/s] 62%|██████▏   | 412/666 [00:18<00:11, 22.97it/s] 62%|██████▏   | 415/666 [00:18<00:10, 22.97it/s] 63%|██████▎   | 418/666 [00:18<00:10, 22.97it/s] 63%|██████▎   | 421/666 [00:18<00:10, 22.97it/s] 64%|██████▎   | 424/666 [00:18<00:10, 22.97it/s] 64%|██████▍   | 427/666 [00:18<00:10, 22.96it/s] 65%|██████▍   | 430/666 [00:18<00:10, 22.97it/s] 65%|██████▌   | 433/666 [00:19<00:10, 22.97it/s] 65%|██████▌   | 436/666 [00:19<00:10, 22.97it/s] 66%|██████▌   | 439/666 [00:19<00:09, 22.97it/s] 66%|██████▋   | 442/666 [00:19<00:09, 22.97it/s] 67%|██████▋   | 445/666 [00:19<00:09, 22.97it/s] 67%|██████▋   | 448/666 [00:19<00:09, 22.98it/s] 68%|██████▊   | 451/666 [00:19<00:09, 22.97it/s] 68%|██████▊   | 454/666 [00:19<00:09, 22.95it/s] 69%|██████▊   | 457/666 [00:20<00:09, 22.96it/s] 69%|██████▉   | 460/666 [00:20<00:08, 22.96it/s] 70%|██████▉   | 463/666 [00:20<00:08, 22.97it/s] 70%|██████▉   | 466/666 [00:20<00:08, 22.96it/s] 70%|███████   | 469/666 [00:20<00:08, 22.95it/s] 71%|███████   | 472/666 [00:20<00:08, 22.96it/s] 71%|███████▏  | 475/666 [00:20<00:08, 22.96it/s] 72%|███████▏  | 478/666 [00:20<00:08, 22.96it/s] 72%|███████▏  | 481/666 [00:21<00:08, 22.96it/s] 73%|███████▎  | 484/666 [00:21<00:07, 22.96it/s] 73%|███████▎  | 487/666 [00:21<00:07, 22.96it/s] 74%|███████▎  | 490/666 [00:21<00:07, 22.97it/s] 74%|███████▍  | 493/666 [00:21<00:07, 22.97it/s] 74%|███████▍  | 496/666 [00:21<00:07, 22.96it/s] 75%|███████▍  | 499/666 [00:21<00:07, 22.95it/s] 75%|███████▌  | 502/666 [00:22<00:07, 22.97it/s] 76%|███████▌  | 505/666 [00:22<00:07, 22.96it/s] 76%|███████▋  | 508/666 [00:22<00:06, 22.95it/s] 77%|███████▋  | 511/666 [00:22<00:06, 22.95it/s] 77%|███████▋  | 514/666 [00:22<00:06, 22.96it/s] 78%|███████▊  | 517/666 [00:22<00:06, 22.96it/s] 78%|███████▊  | 520/666 [00:22<00:06, 22.96it/s] 79%|███████▊  | 523/666 [00:22<00:06, 22.96it/s] 79%|███████▉  | 526/666 [00:23<00:06, 22.95it/s] 79%|███████▉  | 529/666 [00:23<00:05, 22.95it/s] 80%|███████▉  | 532/666 [00:23<00:05, 22.95it/s] 80%|████████  | 535/666 [00:23<00:05, 22.89it/s] 81%|████████  | 538/666 [00:23<00:05, 22.90it/s] 81%|████████  | 541/666 [00:23<00:05, 22.92it/s] 82%|████████▏ | 544/666 [00:23<00:05, 22.93it/s] 82%|████████▏ | 547/666 [00:23<00:05, 22.94it/s] 83%|████████▎ | 550/666 [00:24<00:05, 22.95it/s] 83%|████████▎ | 553/666 [00:24<00:04, 22.96it/s] 83%|████████▎ | 556/666 [00:24<00:04, 22.96it/s] 84%|████████▍ | 559/666 [00:24<00:04, 22.95it/s] 84%|████████▍ | 562/666 [00:24<00:04, 22.96it/s] 85%|████████▍ | 565/666 [00:24<00:04, 22.95it/s] 85%|████████▌ | 568/666 [00:24<00:04, 22.96it/s] 86%|████████▌ | 571/666 [00:25<00:04, 22.97it/s] 86%|████████▌ | 574/666 [00:25<00:04, 22.97it/s] 87%|████████▋ | 577/666 [00:25<00:03, 22.96it/s] 87%|████████▋ | 580/666 [00:25<00:03, 22.97it/s] 88%|████████▊ | 583/666 [00:25<00:03, 22.97it/s] 88%|████████▊ | 586/666 [00:25<00:03, 22.96it/s] 88%|████████▊ | 589/666 [00:25<00:03, 22.95it/s] 89%|████████▉ | 592/666 [00:25<00:03, 22.95it/s] 89%|████████▉ | 595/666 [00:26<00:03, 22.95it/s] 90%|████████▉ | 598/666 [00:26<00:02, 22.96it/s] 90%|█████████ | 601/666 [00:26<00:02, 22.95it/s] 91%|█████████ | 604/666 [00:26<00:02, 22.96it/s] 91%|█████████ | 607/666 [00:26<00:02, 22.95it/s] 92%|█████████▏| 610/666 [00:26<00:02, 22.95it/s] 92%|█████████▏| 613/666 [00:26<00:02, 22.96it/s] 92%|█████████▏| 616/666 [00:26<00:02, 22.97it/s] 93%|█████████▎| 619/666 [00:27<00:02, 22.97it/s] 93%|█████████▎| 622/666 [00:27<00:01, 22.98it/s] 94%|█████████▍| 625/666 [00:27<00:01, 22.96it/s] 94%|█████████▍| 628/666 [00:27<00:01, 22.95it/s] 95%|█████████▍| 631/666 [00:27<00:01, 22.96it/s] 95%|█████████▌| 634/666 [00:27<00:01, 22.96it/s] 96%|█████████▌| 637/666 [00:27<00:01, 22.96it/s] 96%|█████████▌| 640/666 [00:28<00:01, 22.97it/s] 97%|█████████▋| 643/666 [00:28<00:01, 22.95it/s] 97%|█████████▋| 646/666 [00:28<00:00, 22.95it/s] 97%|█████████▋| 649/666 [00:28<00:00, 22.96it/s] 98%|█████████▊| 652/666 [00:28<00:00, 22.97it/s] 98%|█████████▊| 655/666 [00:28<00:00, 22.96it/s] 99%|█████████▉| 658/666 [00:28<00:00, 22.96it/s] 99%|█████████▉| 661/666 [00:28<00:00, 22.66it/s]100%|█████████▉| 664/666 [00:29<00:00, 22.80it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 2/167 [00:00<00:11, 13.88it/s][A
  6%|▌         | 10/167 [00:00<00:03, 44.56it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 117.40it/s][A
 33%|███▎      | 55/167 [00:00<00:00, 154.04it/s][A
 47%|████▋     | 78/167 [00:00<00:00, 177.45it/s][A
 60%|██████    | 101/167 [00:00<00:00, 191.92it/s][A
 74%|███████▎  | 123/167 [00:00<00:00, 199.98it/s][A
 87%|████████▋ | 146/167 [00:00<00:00, 206.52it/s][A100%|██████████| 167/167 [00:01<00:00, 165.38it/s]
2022-11-28 21:42:25,188 P15296 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:42:25,189 P15296 INFO Monitor(max) STOP: -10.620960 !
2022-11-28 21:42:25,189 P15296 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:42:25,189 P15296 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:30<00:00, 21.95it/s]
2022-11-28 21:42:25,237 P15296 INFO Train loss: 69.028943
2022-11-28 21:42:25,237 P15296 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:03,  5.37it/s]  1%|          | 4/666 [00:00<00:46, 14.09it/s]  1%|          | 7/666 [00:00<00:36, 17.90it/s]  2%|▏         | 10/666 [00:00<00:33, 19.69it/s]  2%|▏         | 13/666 [00:00<00:31, 20.85it/s]  2%|▏         | 16/666 [00:00<00:30, 21.60it/s]  3%|▎         | 19/666 [00:00<00:29, 22.08it/s]  3%|▎         | 22/666 [00:01<00:28, 22.41it/s]  4%|▍         | 25/666 [00:01<00:28, 22.63it/s]  4%|▍         | 28/666 [00:01<00:28, 22.77it/s]  5%|▍         | 31/666 [00:01<00:27, 22.89it/s]  5%|▌         | 34/666 [00:01<00:27, 22.98it/s]  6%|▌         | 37/666 [00:01<00:27, 23.04it/s]  6%|▌         | 40/666 [00:01<00:27, 23.08it/s]  6%|▋         | 43/666 [00:02<00:26, 23.10it/s]  7%|▋         | 46/666 [00:02<00:26, 23.12it/s]  7%|▋         | 49/666 [00:02<00:26, 23.14it/s]  8%|▊         | 52/666 [00:02<00:26, 23.14it/s]  8%|▊         | 55/666 [00:02<00:26, 23.14it/s]  9%|▊         | 58/666 [00:02<00:26, 23.15it/s]  9%|▉         | 61/666 [00:02<00:26, 23.15it/s] 10%|▉         | 64/666 [00:02<00:26, 23.15it/s] 10%|█         | 67/666 [00:03<00:25, 23.15it/s] 11%|█         | 70/666 [00:03<00:25, 23.15it/s] 11%|█         | 73/666 [00:03<00:25, 23.15it/s] 11%|█▏        | 76/666 [00:03<00:25, 23.15it/s] 12%|█▏        | 79/666 [00:03<00:25, 23.15it/s] 12%|█▏        | 82/666 [00:03<00:25, 23.15it/s] 13%|█▎        | 85/666 [00:03<00:25, 23.16it/s] 13%|█▎        | 88/666 [00:03<00:24, 23.17it/s] 14%|█▎        | 91/666 [00:04<00:24, 23.17it/s] 14%|█▍        | 94/666 [00:04<00:24, 23.16it/s] 15%|█▍        | 97/666 [00:04<00:24, 23.14it/s] 15%|█▌        | 100/666 [00:04<00:24, 23.14it/s] 15%|█▌        | 103/666 [00:04<00:24, 23.16it/s] 16%|█▌        | 106/666 [00:04<00:24, 23.16it/s] 16%|█▋        | 109/666 [00:04<00:24, 23.15it/s] 17%|█▋        | 112/666 [00:04<00:23, 23.16it/s] 17%|█▋        | 115/666 [00:05<00:23, 23.17it/s] 18%|█▊        | 118/666 [00:05<00:23, 23.16it/s] 18%|█▊        | 121/666 [00:05<00:23, 23.16it/s] 19%|█▊        | 124/666 [00:05<00:23, 23.16it/s] 19%|█▉        | 127/666 [00:05<00:23, 23.17it/s] 20%|█▉        | 130/666 [00:05<00:23, 23.16it/s] 20%|█▉        | 133/666 [00:05<00:23, 23.16it/s] 20%|██        | 136/666 [00:06<00:22, 23.16it/s] 21%|██        | 139/666 [00:06<00:22, 23.16it/s] 21%|██▏       | 142/666 [00:06<00:22, 23.15it/s] 22%|██▏       | 145/666 [00:06<00:22, 23.15it/s] 22%|██▏       | 148/666 [00:06<00:22, 23.16it/s] 23%|██▎       | 151/666 [00:06<00:22, 23.16it/s] 23%|██▎       | 154/666 [00:06<00:22, 23.16it/s] 24%|██▎       | 157/666 [00:06<00:21, 23.17it/s] 24%|██▍       | 160/666 [00:07<00:21, 23.17it/s] 24%|██▍       | 163/666 [00:07<00:21, 23.17it/s] 25%|██▍       | 166/666 [00:07<00:21, 23.16it/s] 25%|██▌       | 169/666 [00:07<00:21, 23.16it/s] 26%|██▌       | 172/666 [00:07<00:21, 23.16it/s] 26%|██▋       | 175/666 [00:07<00:21, 23.16it/s] 27%|██▋       | 178/666 [00:07<00:21, 23.15it/s] 27%|██▋       | 181/666 [00:07<00:20, 23.15it/s] 28%|██▊       | 184/666 [00:08<00:20, 23.15it/s] 28%|██▊       | 187/666 [00:08<00:20, 23.16it/s] 29%|██▊       | 190/666 [00:08<00:20, 23.15it/s] 29%|██▉       | 193/666 [00:08<00:20, 23.16it/s] 29%|██▉       | 196/666 [00:08<00:20, 23.16it/s] 30%|██▉       | 199/666 [00:08<00:20, 23.16it/s] 30%|███       | 202/666 [00:08<00:20, 23.15it/s] 31%|███       | 205/666 [00:09<00:19, 23.15it/s] 31%|███       | 208/666 [00:09<00:19, 23.16it/s] 32%|███▏      | 211/666 [00:09<00:19, 23.16it/s] 32%|███▏      | 214/666 [00:09<00:19, 23.15it/s] 33%|███▎      | 217/666 [00:09<00:19, 23.16it/s] 33%|███▎      | 220/666 [00:09<00:19, 23.17it/s] 33%|███▎      | 223/666 [00:09<00:19, 23.16it/s] 34%|███▍      | 226/666 [00:09<00:18, 23.16it/s] 34%|███▍      | 229/666 [00:10<00:18, 23.17it/s] 35%|███▍      | 232/666 [00:10<00:18, 23.18it/s] 35%|███▌      | 235/666 [00:10<00:18, 23.18it/s] 36%|███▌      | 238/666 [00:10<00:18, 23.18it/s] 36%|███▌      | 241/666 [00:10<00:18, 23.17it/s] 37%|███▋      | 244/666 [00:10<00:18, 23.17it/s] 37%|███▋      | 247/666 [00:10<00:18, 23.16it/s] 38%|███▊      | 250/666 [00:10<00:17, 23.16it/s] 38%|███▊      | 253/666 [00:11<00:17, 23.17it/s] 38%|███▊      | 256/666 [00:11<00:17, 23.17it/s] 39%|███▉      | 259/666 [00:11<00:17, 23.15it/s] 39%|███▉      | 262/666 [00:11<00:17, 23.15it/s] 40%|███▉      | 265/666 [00:11<00:17, 23.15it/s] 40%|████      | 268/666 [00:11<00:17, 23.16it/s] 41%|████      | 271/666 [00:11<00:17, 23.15it/s] 41%|████      | 274/666 [00:11<00:16, 23.16it/s] 42%|████▏     | 277/666 [00:12<00:16, 23.16it/s] 42%|████▏     | 280/666 [00:12<00:16, 23.17it/s] 42%|████▏     | 283/666 [00:12<00:16, 23.17it/s] 43%|████▎     | 286/666 [00:12<00:16, 23.17it/s] 43%|████▎     | 289/666 [00:12<00:16, 23.16it/s] 44%|████▍     | 292/666 [00:12<00:16, 23.16it/s] 44%|████▍     | 295/666 [00:12<00:16, 23.16it/s] 45%|████▍     | 298/666 [00:13<00:15, 23.17it/s] 45%|████▌     | 301/666 [00:13<00:15, 23.16it/s] 46%|████▌     | 304/666 [00:13<00:15, 23.17it/s] 46%|████▌     | 307/666 [00:13<00:15, 23.16it/s] 47%|████▋     | 310/666 [00:13<00:15, 23.16it/s] 47%|████▋     | 313/666 [00:13<00:15, 23.16it/s] 47%|████▋     | 316/666 [00:13<00:15, 23.16it/s] 48%|████▊     | 319/666 [00:13<00:14, 23.16it/s] 48%|████▊     | 322/666 [00:14<00:14, 23.17it/s] 49%|████▉     | 325/666 [00:14<00:14, 23.16it/s] 49%|████▉     | 328/666 [00:14<00:14, 23.15it/s] 50%|████▉     | 331/666 [00:14<00:14, 23.16it/s] 50%|█████     | 334/666 [00:14<00:14, 23.17it/s] 51%|█████     | 337/666 [00:14<00:14, 23.17it/s] 51%|█████     | 340/666 [00:14<00:14, 23.17it/s] 52%|█████▏    | 343/666 [00:14<00:13, 23.18it/s] 52%|█████▏    | 346/666 [00:15<00:13, 23.17it/s] 52%|█████▏    | 349/666 [00:15<00:13, 23.17it/s] 53%|█████▎    | 352/666 [00:15<00:13, 23.17it/s] 53%|█████▎    | 355/666 [00:15<00:13, 23.17it/s] 54%|█████▍    | 358/666 [00:15<00:13, 23.17it/s] 54%|█████▍    | 361/666 [00:15<00:13, 23.16it/s] 55%|█████▍    | 364/666 [00:15<00:13, 23.17it/s] 55%|█████▌    | 367/666 [00:15<00:12, 23.17it/s] 56%|█████▌    | 370/666 [00:16<00:12, 23.18it/s] 56%|█████▌    | 373/666 [00:16<00:12, 23.18it/s] 56%|█████▋    | 376/666 [00:16<00:12, 23.17it/s] 57%|█████▋    | 379/666 [00:16<00:12, 23.17it/s] 57%|█████▋    | 382/666 [00:16<00:12, 23.17it/s] 58%|█████▊    | 385/666 [00:16<00:12, 23.17it/s] 58%|█████▊    | 388/666 [00:16<00:11, 23.17it/s] 59%|█████▊    | 391/666 [00:17<00:11, 23.16it/s] 59%|█████▉    | 394/666 [00:17<00:11, 23.16it/s] 60%|█████▉    | 397/666 [00:17<00:11, 23.16it/s] 60%|██████    | 400/666 [00:17<00:11, 23.16it/s] 61%|██████    | 403/666 [00:17<00:11, 23.16it/s] 61%|██████    | 406/666 [00:17<00:11, 23.16it/s] 61%|██████▏   | 409/666 [00:17<00:11, 23.16it/s] 62%|██████▏   | 412/666 [00:17<00:10, 23.16it/s] 62%|██████▏   | 415/666 [00:18<00:10, 23.16it/s] 63%|██████▎   | 418/666 [00:18<00:10, 23.17it/s] 63%|██████▎   | 421/666 [00:18<00:10, 23.17it/s] 64%|██████▎   | 424/666 [00:18<00:10, 23.17it/s] 64%|██████▍   | 427/666 [00:18<00:10, 23.17it/s] 65%|██████▍   | 430/666 [00:18<00:10, 23.16it/s] 65%|██████▌   | 433/666 [00:18<00:10, 23.15it/s] 65%|██████▌   | 436/666 [00:18<00:09, 23.15it/s] 66%|██████▌   | 439/666 [00:19<00:09, 23.16it/s] 66%|██████▋   | 442/666 [00:19<00:09, 23.15it/s] 67%|██████▋   | 445/666 [00:19<00:09, 23.15it/s] 67%|██████▋   | 448/666 [00:19<00:09, 23.15it/s] 68%|██████▊   | 451/666 [00:19<00:09, 23.16it/s] 68%|██████▊   | 454/666 [00:19<00:09, 23.16it/s] 69%|██████▊   | 457/666 [00:19<00:09, 23.16it/s] 69%|██████▉   | 460/666 [00:20<00:08, 23.17it/s] 70%|██████▉   | 463/666 [00:20<00:08, 23.17it/s] 70%|██████▉   | 466/666 [00:20<00:08, 23.17it/s] 70%|███████   | 469/666 [00:20<00:08, 23.17it/s] 71%|███████   | 472/666 [00:20<00:08, 23.17it/s] 71%|███████▏  | 475/666 [00:20<00:08, 23.17it/s] 72%|███████▏  | 478/666 [00:20<00:08, 23.17it/s] 72%|███████▏  | 481/666 [00:20<00:07, 23.17it/s] 73%|███████▎  | 484/666 [00:21<00:07, 23.17it/s] 73%|███████▎  | 487/666 [00:21<00:07, 23.18it/s] 74%|███████▎  | 490/666 [00:21<00:07, 23.17it/s] 74%|███████▍  | 493/666 [00:21<00:07, 23.17it/s] 74%|███████▍  | 496/666 [00:21<00:07, 23.17it/s] 75%|███████▍  | 499/666 [00:21<00:07, 23.17it/s] 75%|███████▌  | 502/666 [00:21<00:07, 23.17it/s] 76%|███████▌  | 505/666 [00:21<00:06, 23.17it/s] 76%|███████▋  | 508/666 [00:22<00:06, 23.17it/s] 77%|███████▋  | 511/666 [00:22<00:06, 23.16it/s] 77%|███████▋  | 514/666 [00:22<00:06, 23.15it/s] 78%|███████▊  | 517/666 [00:22<00:06, 23.16it/s] 78%|███████▊  | 520/666 [00:22<00:06, 23.16it/s] 79%|███████▊  | 523/666 [00:22<00:06, 23.16it/s] 79%|███████▉  | 526/666 [00:22<00:06, 23.17it/s] 79%|███████▉  | 529/666 [00:22<00:05, 23.16it/s] 80%|███████▉  | 532/666 [00:23<00:05, 23.17it/s] 80%|████████  | 535/666 [00:23<00:05, 23.16it/s] 81%|████████  | 538/666 [00:23<00:05, 23.16it/s] 81%|████████  | 541/666 [00:23<00:05, 23.15it/s] 82%|████████▏ | 544/666 [00:23<00:05, 23.15it/s] 82%|████████▏ | 547/666 [00:23<00:05, 23.16it/s] 83%|████████▎ | 550/666 [00:23<00:05, 23.16it/s] 83%|████████▎ | 553/666 [00:24<00:04, 23.17it/s] 83%|████████▎ | 556/666 [00:24<00:04, 23.17it/s] 84%|████████▍ | 559/666 [00:24<00:04, 23.17it/s] 84%|████████▍ | 562/666 [00:24<00:04, 23.16it/s] 85%|████████▍ | 565/666 [00:24<00:04, 23.16it/s] 85%|████████▌ | 568/666 [00:24<00:04, 23.16it/s] 86%|████████▌ | 571/666 [00:24<00:04, 23.16it/s] 86%|████████▌ | 574/666 [00:24<00:03, 23.16it/s] 87%|████████▋ | 577/666 [00:25<00:03, 23.15it/s] 87%|████████▋ | 580/666 [00:25<00:03, 23.15it/s] 88%|████████▊ | 583/666 [00:25<00:03, 23.15it/s] 88%|████████▊ | 586/666 [00:25<00:03, 23.16it/s] 88%|████████▊ | 589/666 [00:25<00:03, 23.16it/s] 89%|████████▉ | 592/666 [00:25<00:03, 23.16it/s] 89%|████████▉ | 595/666 [00:25<00:03, 23.17it/s] 90%|████████▉ | 598/666 [00:25<00:02, 23.16it/s] 90%|█████████ | 601/666 [00:26<00:02, 23.17it/s] 91%|█████████ | 604/666 [00:26<00:02, 23.17it/s] 91%|█████████ | 607/666 [00:26<00:02, 23.16it/s] 92%|█████████▏| 610/666 [00:26<00:02, 23.16it/s] 92%|█████████▏| 613/666 [00:26<00:02, 23.16it/s] 92%|█████████▏| 616/666 [00:26<00:02, 23.17it/s] 93%|█████████▎| 619/666 [00:26<00:02, 23.16it/s] 93%|█████████▎| 622/666 [00:27<00:01, 23.16it/s] 94%|█████████▍| 625/666 [00:27<00:01, 23.16it/s] 94%|█████████▍| 628/666 [00:27<00:01, 23.16it/s] 95%|█████████▍| 631/666 [00:27<00:01, 23.16it/s] 95%|█████████▌| 634/666 [00:27<00:01, 23.15it/s] 96%|█████████▌| 637/666 [00:27<00:01, 23.15it/s] 96%|█████████▌| 640/666 [00:27<00:01, 23.15it/s] 97%|█████████▋| 643/666 [00:27<00:00, 23.16it/s] 97%|█████████▋| 646/666 [00:28<00:00, 23.16it/s] 97%|█████████▋| 649/666 [00:28<00:00, 23.16it/s] 98%|█████████▊| 652/666 [00:28<00:00, 23.17it/s] 98%|█████████▊| 655/666 [00:28<00:00, 23.17it/s] 99%|█████████▉| 658/666 [00:28<00:00, 23.16it/s] 99%|█████████▉| 661/666 [00:28<00:00, 22.80it/s]100%|█████████▉| 664/666 [00:28<00:00, 22.96it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.43it/s][A
  6%|▌         | 10/167 [00:00<00:02, 52.60it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 120.77it/s][A
 32%|███▏      | 54/167 [00:00<00:00, 160.20it/s][A
 46%|████▌     | 77/167 [00:00<00:00, 182.83it/s][A
 60%|█████▉    | 100/167 [00:00<00:00, 196.22it/s][A
 74%|███████▎  | 123/167 [00:00<00:00, 204.68it/s][A
 87%|████████▋ | 146/167 [00:00<00:00, 209.94it/s][A100%|██████████| 167/167 [00:00<00:00, 172.85it/s]
2022-11-28 21:42:55,222 P15296 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:42:55,222 P15296 INFO Monitor(max) STOP: -10.620960 !
2022-11-28 21:42:55,222 P15296 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:42:55,222 P15296 INFO Early stopping at epoch=3
2022-11-28 21:42:55,223 P15296 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:30<00:00, 22.14it/s]
2022-11-28 21:42:55,268 P15296 INFO Train loss: 69.028527
2022-11-28 21:42:55,269 P15296 INFO Training finished.
2022-11-28 21:42:55,269 P15296 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_021_3f6d0677.model
2022-11-28 21:42:55,464 P15296 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:44,  6.38it/s]  2%|▏         | 10/666 [00:00<00:15, 43.51it/s]  5%|▍         | 33/666 [00:00<00:05, 114.36it/s]  8%|▊         | 56/666 [00:00<00:03, 153.54it/s] 12%|█▏        | 78/666 [00:00<00:03, 175.07it/s] 15%|█▌        | 100/666 [00:00<00:03, 188.48it/s] 18%|█▊        | 122/666 [00:00<00:02, 197.25it/s] 22%|██▏       | 144/666 [00:00<00:02, 203.34it/s] 25%|██▍       | 166/666 [00:00<00:02, 207.27it/s] 28%|██▊       | 188/666 [00:01<00:02, 210.00it/s] 32%|███▏      | 210/666 [00:01<00:02, 211.97it/s] 35%|███▍      | 232/666 [00:01<00:02, 211.72it/s] 38%|███▊      | 254/666 [00:01<00:01, 212.24it/s] 41%|████▏     | 276/666 [00:01<00:01, 212.85it/s] 45%|████▍     | 298/666 [00:01<00:01, 213.15it/s] 48%|████▊     | 320/666 [00:01<00:01, 213.55it/s] 51%|█████▏    | 342/666 [00:01<00:01, 213.50it/s] 55%|█████▍    | 364/666 [00:01<00:01, 213.71it/s] 58%|█████▊    | 386/666 [00:02<00:01, 213.88it/s] 61%|██████▏   | 408/666 [00:02<00:01, 213.93it/s] 65%|██████▍   | 430/666 [00:02<00:01, 213.99it/s] 68%|██████▊   | 452/666 [00:02<00:00, 214.28it/s] 71%|███████   | 474/666 [00:02<00:00, 213.57it/s] 74%|███████▍  | 496/666 [00:02<00:00, 213.56it/s] 78%|███████▊  | 518/666 [00:02<00:00, 212.85it/s] 81%|████████  | 540/666 [00:02<00:00, 212.92it/s] 84%|████████▍ | 562/666 [00:02<00:00, 212.41it/s] 88%|████████▊ | 584/666 [00:02<00:00, 212.35it/s] 91%|█████████ | 606/666 [00:03<00:00, 212.43it/s] 94%|█████████▍| 628/666 [00:03<00:00, 212.48it/s] 98%|█████████▊| 650/666 [00:03<00:00, 207.03it/s]100%|██████████| 666/666 [00:03<00:00, 196.25it/s]
2022-11-28 21:42:59,312 P15296 INFO [Metrics] logloss: 11.126093 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:19,  8.71it/s]  6%|▌         | 10/167 [00:00<00:03, 43.65it/s] 18%|█▊        | 30/167 [00:00<00:01, 103.62it/s] 30%|██▉       | 50/167 [00:00<00:00, 136.80it/s] 42%|████▏     | 70/167 [00:00<00:00, 157.64it/s] 54%|█████▍    | 90/167 [00:00<00:00, 171.13it/s] 66%|██████▌   | 110/167 [00:00<00:00, 180.09it/s] 78%|███████▊  | 131/167 [00:00<00:00, 186.99it/s] 91%|█████████ | 152/167 [00:00<00:00, 191.72it/s]100%|██████████| 167/167 [00:01<00:00, 154.27it/s]
2022-11-28 21:43:00,508 P15296 INFO [Metrics] logloss: 11.120960 - AUC: 0.500000
2022-11-28 21:43:07,321 P17075 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "64",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_022_6b0fc175",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:43:07,322 P17075 INFO Set up feature encoder...
2022-11-28 21:43:07,323 P17075 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:43:07,324 P17075 INFO Loading data...
2022-11-28 21:43:07,328 P17075 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:43:07,583 P17075 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:43:07,682 P17075 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:43:07,682 P17075 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:43:07,682 P17075 INFO Loading train data done.
2022-11-28 21:43:10,381 P17075 INFO Total number of parameters: 15268036.
2022-11-28 21:43:10,381 P17075 INFO Start training: 666 batches/epoch
2022-11-28 21:43:10,381 P17075 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:43:10.718 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:17075 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:43:10.750 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:17075 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:23,  1.12s/it]  1%|          | 6/666 [00:01<01:44,  6.34it/s]  2%|▏         | 11/666 [00:01<00:54, 12.09it/s]  2%|▏         | 15/666 [00:01<00:39, 16.47it/s]  3%|▎         | 20/666 [00:01<00:28, 22.35it/s]  4%|▍         | 25/666 [00:01<00:23, 27.67it/s]  5%|▍         | 30/666 [00:01<00:19, 32.21it/s]  5%|▌         | 35/666 [00:01<00:17, 35.95it/s]  6%|▌         | 40/666 [00:01<00:16, 38.87it/s]  7%|▋         | 45/666 [00:02<00:15, 41.13it/s]  8%|▊         | 50/666 [00:02<00:14, 42.79it/s]  8%|▊         | 55/666 [00:02<00:13, 43.98it/s]  9%|▉         | 60/666 [00:02<00:13, 44.77it/s] 10%|▉         | 65/666 [00:02<00:13, 44.12it/s] 11%|█         | 70/666 [00:02<00:13, 44.92it/s] 11%|█▏        | 75/666 [00:02<00:12, 45.52it/s] 12%|█▏        | 80/666 [00:02<00:12, 45.97it/s] 13%|█▎        | 85/666 [00:02<00:12, 46.28it/s] 14%|█▎        | 90/666 [00:03<00:12, 46.44it/s] 14%|█▍        | 95/666 [00:03<00:12, 46.63it/s] 15%|█▌        | 100/666 [00:03<00:12, 46.75it/s] 16%|█▌        | 105/666 [00:03<00:11, 46.78it/s] 17%|█▋        | 110/666 [00:03<00:11, 46.84it/s] 17%|█▋        | 115/666 [00:03<00:11, 46.88it/s] 18%|█▊        | 120/666 [00:03<00:11, 46.91it/s] 19%|█▉        | 125/666 [00:03<00:11, 46.93it/s] 20%|█▉        | 130/666 [00:03<00:11, 46.93it/s] 20%|██        | 135/666 [00:04<00:11, 46.94it/s] 21%|██        | 140/666 [00:04<00:11, 46.92it/s] 22%|██▏       | 145/666 [00:04<00:11, 46.94it/s] 23%|██▎       | 150/666 [00:04<00:10, 46.94it/s] 23%|██▎       | 155/666 [00:04<00:10, 46.95it/s] 24%|██▍       | 160/666 [00:04<00:10, 46.97it/s] 25%|██▍       | 165/666 [00:04<00:10, 46.97it/s] 26%|██▌       | 170/666 [00:04<00:10, 46.99it/s] 26%|██▋       | 175/666 [00:04<00:10, 46.99it/s] 27%|██▋       | 180/666 [00:04<00:10, 46.99it/s] 28%|██▊       | 185/666 [00:05<00:10, 47.00it/s] 29%|██▊       | 190/666 [00:05<00:10, 46.98it/s] 29%|██▉       | 195/666 [00:05<00:10, 46.98it/s] 30%|███       | 200/666 [00:05<00:09, 46.98it/s] 31%|███       | 205/666 [00:05<00:09, 46.97it/s] 32%|███▏      | 210/666 [00:05<00:09, 46.99it/s] 32%|███▏      | 215/666 [00:05<00:09, 46.99it/s] 33%|███▎      | 220/666 [00:05<00:09, 46.97it/s] 34%|███▍      | 225/666 [00:05<00:09, 46.97it/s] 35%|███▍      | 230/666 [00:06<00:09, 46.96it/s] 35%|███▌      | 235/666 [00:06<00:09, 46.98it/s] 36%|███▌      | 240/666 [00:06<00:09, 46.96it/s] 37%|███▋      | 245/666 [00:06<00:08, 46.96it/s] 38%|███▊      | 250/666 [00:06<00:08, 46.94it/s] 38%|███▊      | 255/666 [00:06<00:08, 46.92it/s] 39%|███▉      | 260/666 [00:06<00:08, 46.94it/s] 40%|███▉      | 265/666 [00:06<00:08, 46.95it/s] 41%|████      | 270/666 [00:06<00:08, 46.94it/s] 41%|████▏     | 275/666 [00:07<00:08, 46.94it/s] 42%|████▏     | 280/666 [00:07<00:08, 47.54it/s] 43%|████▎     | 286/666 [00:07<00:07, 48.48it/s] 44%|████▍     | 292/666 [00:07<00:07, 49.07it/s] 45%|████▍     | 298/666 [00:07<00:07, 49.44it/s] 46%|████▌     | 304/666 [00:07<00:07, 49.73it/s] 47%|████▋     | 310/666 [00:07<00:07, 49.96it/s] 47%|████▋     | 316/666 [00:07<00:06, 50.06it/s] 48%|████▊     | 322/666 [00:07<00:06, 50.13it/s] 49%|████▉     | 328/666 [00:08<00:06, 50.20it/s] 50%|█████     | 334/666 [00:08<00:06, 50.32it/s] 51%|█████     | 340/666 [00:08<00:06, 50.34it/s] 52%|█████▏    | 346/666 [00:08<00:06, 50.32it/s] 53%|█████▎    | 352/666 [00:08<00:06, 50.31it/s] 54%|█████▍    | 358/666 [00:08<00:06, 50.35it/s] 55%|█████▍    | 364/666 [00:08<00:05, 50.39it/s] 56%|█████▌    | 370/666 [00:08<00:05, 50.37it/s] 56%|█████▋    | 376/666 [00:09<00:05, 50.35it/s] 57%|█████▋    | 382/666 [00:09<00:05, 50.34it/s] 58%|█████▊    | 388/666 [00:09<00:05, 50.40it/s] 59%|█████▉    | 394/666 [00:09<00:05, 50.42it/s] 60%|██████    | 400/666 [00:09<00:05, 50.38it/s] 61%|██████    | 406/666 [00:09<00:05, 50.37it/s] 62%|██████▏   | 412/666 [00:09<00:05, 50.41it/s] 63%|██████▎   | 418/666 [00:09<00:04, 50.41it/s] 64%|██████▎   | 424/666 [00:09<00:04, 50.39it/s] 65%|██████▍   | 430/666 [00:10<00:04, 50.36it/s] 65%|██████▌   | 436/666 [00:10<00:04, 50.40it/s] 66%|██████▋   | 442/666 [00:10<00:04, 50.38it/s] 67%|██████▋   | 448/666 [00:10<00:04, 50.37it/s] 68%|██████▊   | 454/666 [00:10<00:04, 50.35it/s] 69%|██████▉   | 460/666 [00:10<00:04, 50.36it/s] 70%|██████▉   | 466/666 [00:10<00:03, 50.41it/s] 71%|███████   | 472/666 [00:10<00:03, 50.41it/s] 72%|███████▏  | 478/666 [00:11<00:03, 50.39it/s] 73%|███████▎  | 484/666 [00:11<00:03, 50.38it/s] 74%|███████▎  | 490/666 [00:11<00:03, 50.43it/s] 74%|███████▍  | 496/666 [00:11<00:03, 50.43it/s] 75%|███████▌  | 502/666 [00:11<00:03, 50.39it/s] 76%|███████▋  | 508/666 [00:11<00:03, 50.30it/s] 77%|███████▋  | 514/666 [00:11<00:03, 50.32it/s] 78%|███████▊  | 520/666 [00:11<00:02, 50.39it/s] 79%|███████▉  | 526/666 [00:11<00:02, 50.40it/s] 80%|███████▉  | 532/666 [00:12<00:02, 50.39it/s] 81%|████████  | 538/666 [00:12<00:02, 50.41it/s] 82%|████████▏ | 544/666 [00:12<00:02, 50.45it/s] 83%|████████▎ | 550/666 [00:12<00:02, 50.42it/s] 83%|████████▎ | 556/666 [00:12<00:02, 50.38it/s] 84%|████████▍ | 562/666 [00:12<00:02, 50.36it/s] 85%|████████▌ | 568/666 [00:12<00:01, 50.40it/s] 86%|████████▌ | 574/666 [00:12<00:01, 50.40it/s] 87%|████████▋ | 580/666 [00:13<00:01, 50.39it/s] 88%|████████▊ | 586/666 [00:13<00:01, 50.38it/s] 89%|████████▉ | 592/666 [00:13<00:01, 50.30it/s] 90%|████████▉ | 598/666 [00:13<00:01, 50.30it/s] 91%|█████████ | 604/666 [00:13<00:01, 50.31it/s] 92%|█████████▏| 610/666 [00:13<00:01, 50.28it/s] 92%|█████████▏| 616/666 [00:13<00:00, 50.26it/s] 93%|█████████▎| 622/666 [00:13<00:00, 50.21it/s] 94%|█████████▍| 628/666 [00:14<00:00, 50.17it/s] 95%|█████████▌| 634/666 [00:14<00:00, 50.14it/s] 96%|█████████▌| 640/666 [00:14<00:00, 50.14it/s] 97%|█████████▋| 646/666 [00:14<00:00, 50.15it/s] 98%|█████████▊| 652/666 [00:14<00:00, 50.18it/s] 99%|█████████▉| 658/666 [00:14<00:00, 50.23it/s]100%|█████████▉| 664/666 [00:14<00:00, 49.39it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.89it/s][A
  6%|▌         | 10/167 [00:00<00:03, 49.76it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 125.60it/s][A
 34%|███▍      | 57/167 [00:00<00:00, 166.05it/s][A
 48%|████▊     | 80/167 [00:00<00:00, 187.94it/s][A
 62%|██████▏   | 104/167 [00:00<00:00, 202.57it/s][A
 76%|███████▌  | 127/167 [00:00<00:00, 210.91it/s][A
 90%|████████▉ | 150/167 [00:00<00:00, 216.52it/s][A100%|██████████| 167/167 [00:00<00:00, 174.22it/s]
2022-11-28 21:43:26,233 P17075 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:43:26,233 P17075 INFO Save best model: monitor(max): -4.497136
2022-11-28 21:43:26,587 P17075 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:16<00:00, 41.00it/s]
2022-11-28 21:43:26,629 P17075 INFO Train loss: 38.403231
2022-11-28 21:43:26,629 P17075 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:56,  5.69it/s]  1%|          | 6/666 [00:00<00:26, 24.90it/s]  2%|▏         | 10/666 [00:00<00:21, 30.54it/s]  2%|▏         | 15/666 [00:00<00:17, 37.30it/s]  3%|▎         | 21/666 [00:00<00:15, 42.62it/s]  4%|▍         | 27/666 [00:00<00:14, 45.59it/s]  5%|▍         | 33/666 [00:00<00:13, 47.38it/s]  6%|▌         | 39/666 [00:00<00:12, 48.63it/s]  7%|▋         | 45/666 [00:01<00:12, 49.45it/s]  8%|▊         | 51/666 [00:01<00:12, 50.00it/s]  9%|▊         | 57/666 [00:01<00:12, 50.39it/s]  9%|▉         | 63/666 [00:01<00:11, 50.65it/s] 10%|█         | 69/666 [00:01<00:11, 50.84it/s] 11%|█▏        | 75/666 [00:01<00:11, 50.96it/s] 12%|█▏        | 81/666 [00:01<00:11, 51.06it/s] 13%|█▎        | 87/666 [00:01<00:11, 51.14it/s] 14%|█▍        | 93/666 [00:02<00:11, 51.18it/s] 15%|█▍        | 99/666 [00:02<00:11, 51.20it/s] 16%|█▌        | 105/666 [00:02<00:10, 51.22it/s] 17%|█▋        | 111/666 [00:02<00:10, 51.21it/s] 18%|█▊        | 117/666 [00:02<00:10, 51.22it/s] 18%|█▊        | 123/666 [00:02<00:10, 51.24it/s] 19%|█▉        | 129/666 [00:02<00:10, 51.25it/s] 20%|██        | 135/666 [00:02<00:10, 51.27it/s] 21%|██        | 141/666 [00:02<00:10, 51.27it/s] 22%|██▏       | 147/666 [00:03<00:10, 51.29it/s] 23%|██▎       | 153/666 [00:03<00:09, 51.30it/s] 24%|██▍       | 159/666 [00:03<00:09, 51.30it/s] 25%|██▍       | 165/666 [00:03<00:09, 51.30it/s] 26%|██▌       | 171/666 [00:03<00:09, 51.29it/s] 27%|██▋       | 177/666 [00:03<00:09, 51.29it/s] 27%|██▋       | 183/666 [00:03<00:09, 51.30it/s] 28%|██▊       | 189/666 [00:03<00:09, 51.31it/s] 29%|██▉       | 195/666 [00:03<00:09, 51.32it/s] 30%|███       | 201/666 [00:04<00:09, 51.34it/s] 31%|███       | 207/666 [00:04<00:08, 51.35it/s] 32%|███▏      | 213/666 [00:04<00:08, 51.34it/s] 33%|███▎      | 219/666 [00:04<00:08, 51.32it/s] 34%|███▍      | 225/666 [00:04<00:08, 51.33it/s] 35%|███▍      | 231/666 [00:04<00:08, 51.33it/s] 36%|███▌      | 237/666 [00:04<00:08, 51.31it/s] 36%|███▋      | 243/666 [00:04<00:08, 51.30it/s] 37%|███▋      | 249/666 [00:05<00:08, 51.30it/s] 38%|███▊      | 255/666 [00:05<00:08, 51.31it/s] 39%|███▉      | 261/666 [00:05<00:07, 51.33it/s] 40%|████      | 267/666 [00:05<00:07, 51.32it/s] 41%|████      | 273/666 [00:05<00:07, 51.30it/s] 42%|████▏     | 279/666 [00:05<00:07, 51.27it/s] 43%|████▎     | 285/666 [00:05<00:07, 51.23it/s] 44%|████▎     | 291/666 [00:05<00:07, 51.24it/s] 45%|████▍     | 297/666 [00:05<00:07, 51.24it/s] 45%|████▌     | 303/666 [00:06<00:07, 51.29it/s] 46%|████▋     | 309/666 [00:06<00:06, 51.31it/s] 47%|████▋     | 315/666 [00:06<00:06, 51.30it/s] 48%|████▊     | 321/666 [00:06<00:06, 51.28it/s] 49%|████▉     | 327/666 [00:06<00:06, 51.30it/s] 50%|█████     | 333/666 [00:06<00:06, 51.33it/s] 51%|█████     | 339/666 [00:06<00:06, 51.33it/s] 52%|█████▏    | 345/666 [00:06<00:06, 51.32it/s] 53%|█████▎    | 351/666 [00:07<00:06, 51.28it/s] 54%|█████▎    | 357/666 [00:07<00:06, 51.30it/s] 55%|█████▍    | 363/666 [00:07<00:05, 51.29it/s] 55%|█████▌    | 369/666 [00:07<00:05, 51.30it/s] 56%|█████▋    | 375/666 [00:07<00:05, 51.30it/s] 57%|█████▋    | 381/666 [00:07<00:05, 51.29it/s] 58%|█████▊    | 387/666 [00:07<00:05, 51.31it/s] 59%|█████▉    | 393/666 [00:07<00:05, 51.30it/s] 60%|█████▉    | 399/666 [00:07<00:05, 51.30it/s] 61%|██████    | 405/666 [00:08<00:05, 51.31it/s] 62%|██████▏   | 411/666 [00:08<00:04, 51.30it/s] 63%|██████▎   | 417/666 [00:08<00:04, 51.26it/s] 64%|██████▎   | 423/666 [00:08<00:04, 51.27it/s] 64%|██████▍   | 429/666 [00:08<00:04, 51.29it/s] 65%|██████▌   | 435/666 [00:08<00:04, 51.30it/s] 66%|██████▌   | 441/666 [00:08<00:04, 51.30it/s] 67%|██████▋   | 447/666 [00:08<00:04, 51.32it/s] 68%|██████▊   | 453/666 [00:09<00:04, 51.32it/s] 69%|██████▉   | 459/666 [00:09<00:04, 51.34it/s] 70%|██████▉   | 465/666 [00:09<00:03, 51.31it/s] 71%|███████   | 471/666 [00:09<00:03, 51.31it/s] 72%|███████▏  | 477/666 [00:09<00:03, 51.31it/s] 73%|███████▎  | 483/666 [00:09<00:03, 51.30it/s] 73%|███████▎  | 489/666 [00:09<00:03, 51.28it/s] 74%|███████▍  | 495/666 [00:09<00:03, 51.30it/s] 75%|███████▌  | 501/666 [00:09<00:03, 51.33it/s] 76%|███████▌  | 507/666 [00:10<00:03, 51.35it/s] 77%|███████▋  | 513/666 [00:10<00:02, 51.33it/s] 78%|███████▊  | 519/666 [00:10<00:02, 51.32it/s] 79%|███████▉  | 525/666 [00:10<00:02, 51.33it/s] 80%|███████▉  | 531/666 [00:10<00:02, 51.32it/s] 81%|████████  | 537/666 [00:10<00:02, 51.21it/s] 82%|████████▏ | 543/666 [00:10<00:02, 51.26it/s] 82%|████████▏ | 549/666 [00:10<00:02, 51.23it/s] 83%|████████▎ | 555/666 [00:11<00:02, 51.27it/s] 84%|████████▍ | 561/666 [00:11<00:02, 51.29it/s] 85%|████████▌ | 567/666 [00:11<00:01, 51.29it/s] 86%|████████▌ | 573/666 [00:11<00:01, 51.31it/s] 87%|████████▋ | 579/666 [00:11<00:01, 51.31it/s] 88%|████████▊ | 585/666 [00:11<00:01, 51.25it/s] 89%|████████▊ | 591/666 [00:11<00:01, 51.26it/s] 90%|████████▉ | 597/666 [00:11<00:01, 51.28it/s] 91%|█████████ | 603/666 [00:11<00:01, 51.31it/s] 91%|█████████▏| 609/666 [00:12<00:01, 51.30it/s] 92%|█████████▏| 615/666 [00:12<00:00, 51.32it/s] 93%|█████████▎| 621/666 [00:12<00:00, 51.32it/s] 94%|█████████▍| 627/666 [00:12<00:00, 51.33it/s] 95%|█████████▌| 633/666 [00:12<00:00, 51.33it/s] 96%|█████████▌| 639/666 [00:12<00:00, 51.32it/s] 97%|█████████▋| 645/666 [00:12<00:00, 51.32it/s] 98%|█████████▊| 651/666 [00:12<00:00, 51.33it/s] 99%|█████████▊| 657/666 [00:12<00:00, 51.32it/s]100%|█████████▉| 663/666 [00:13<00:00, 50.49it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.10it/s][A
  6%|▌         | 10/167 [00:00<00:03, 42.28it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 113.04it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 153.55it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 178.59it/s][A
 61%|██████    | 102/167 [00:00<00:00, 193.93it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 204.31it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 212.11it/s][A100%|██████████| 167/167 [00:01<00:00, 165.08it/s]
2022-11-28 21:43:40,931 P17075 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:43:40,932 P17075 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:43:40,932 P17075 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:43:40,932 P17075 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:14<00:00, 46.38it/s]
2022-11-28 21:43:40,988 P17075 INFO Train loss: 30.973569
2022-11-28 21:43:40,988 P17075 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:03,  5.37it/s]  1%|          | 6/666 [00:00<00:26, 24.52it/s]  2%|▏         | 10/666 [00:00<00:22, 29.72it/s]  2%|▏         | 15/666 [00:00<00:17, 36.41it/s]  3%|▎         | 21/666 [00:00<00:15, 41.50it/s]  4%|▍         | 26/666 [00:00<00:14, 43.99it/s]  5%|▍         | 31/666 [00:00<00:13, 45.73it/s]  5%|▌         | 36/666 [00:00<00:13, 46.91it/s]  6%|▌         | 41/666 [00:01<00:13, 47.71it/s]  7%|▋         | 46/666 [00:01<00:12, 48.28it/s]  8%|▊         | 51/666 [00:01<00:12, 48.71it/s]  8%|▊         | 56/666 [00:01<00:12, 48.98it/s]  9%|▉         | 61/666 [00:01<00:12, 49.13it/s] 10%|▉         | 66/666 [00:01<00:12, 49.27it/s] 11%|█         | 71/666 [00:01<00:12, 49.39it/s] 11%|█▏        | 76/666 [00:01<00:11, 49.47it/s] 12%|█▏        | 81/666 [00:01<00:11, 49.48it/s] 13%|█▎        | 86/666 [00:01<00:11, 49.46it/s] 14%|█▎        | 91/666 [00:02<00:11, 49.50it/s] 14%|█▍        | 96/666 [00:02<00:11, 49.59it/s] 15%|█▌        | 101/666 [00:02<00:11, 49.60it/s] 16%|█▌        | 106/666 [00:02<00:11, 49.58it/s] 17%|█▋        | 111/666 [00:02<00:11, 49.58it/s] 17%|█▋        | 116/666 [00:02<00:11, 49.57it/s] 18%|█▊        | 121/666 [00:02<00:10, 49.61it/s] 19%|█▉        | 126/666 [00:02<00:10, 49.69it/s] 20%|█▉        | 131/666 [00:02<00:10, 49.66it/s] 20%|██        | 136/666 [00:02<00:10, 49.60it/s] 21%|██        | 141/666 [00:03<00:10, 49.54it/s] 22%|██▏       | 146/666 [00:03<00:10, 49.57it/s] 23%|██▎       | 151/666 [00:03<00:10, 49.63it/s] 23%|██▎       | 156/666 [00:03<00:10, 49.64it/s] 24%|██▍       | 161/666 [00:03<00:10, 49.59it/s] 25%|██▍       | 166/666 [00:03<00:10, 49.59it/s] 26%|██▌       | 171/666 [00:03<00:09, 49.62it/s] 26%|██▋       | 176/666 [00:03<00:09, 49.67it/s] 27%|██▋       | 181/666 [00:03<00:09, 49.67it/s] 28%|██▊       | 186/666 [00:03<00:09, 49.68it/s] 29%|██▊       | 191/666 [00:04<00:09, 49.61it/s] 29%|██▉       | 196/666 [00:04<00:09, 49.58it/s] 30%|███       | 201/666 [00:04<00:09, 49.63it/s] 31%|███       | 206/666 [00:04<00:09, 49.59it/s] 32%|███▏      | 211/666 [00:04<00:09, 49.54it/s] 32%|███▏      | 216/666 [00:04<00:09, 49.57it/s] 33%|███▎      | 221/666 [00:04<00:08, 49.59it/s] 34%|███▍      | 226/666 [00:04<00:08, 49.64it/s] 35%|███▍      | 231/666 [00:04<00:08, 49.67it/s] 35%|███▌      | 236/666 [00:04<00:08, 49.62it/s] 36%|███▌      | 241/666 [00:05<00:08, 49.55it/s] 37%|███▋      | 246/666 [00:05<00:08, 49.59it/s] 38%|███▊      | 251/666 [00:05<00:08, 49.62it/s] 38%|███▊      | 256/666 [00:05<00:08, 49.56it/s] 39%|███▉      | 261/666 [00:05<00:08, 49.55it/s] 40%|███▉      | 266/666 [00:05<00:08, 49.50it/s] 41%|████      | 271/666 [00:05<00:07, 49.55it/s] 41%|████▏     | 276/666 [00:05<00:07, 49.59it/s] 42%|████▏     | 281/666 [00:05<00:07, 49.55it/s] 43%|████▎     | 286/666 [00:05<00:07, 49.52it/s] 44%|████▎     | 291/666 [00:06<00:07, 49.56it/s] 44%|████▍     | 296/666 [00:06<00:07, 49.58it/s] 45%|████▌     | 301/666 [00:06<00:07, 49.56it/s] 46%|████▌     | 306/666 [00:06<00:07, 49.55it/s] 47%|████▋     | 311/666 [00:06<00:07, 49.54it/s] 47%|████▋     | 316/666 [00:06<00:07, 49.59it/s] 48%|████▊     | 321/666 [00:06<00:06, 49.61it/s] 49%|████▉     | 326/666 [00:06<00:06, 49.55it/s] 50%|████▉     | 331/666 [00:06<00:06, 49.50it/s] 50%|█████     | 336/666 [00:06<00:06, 49.59it/s] 51%|█████     | 341/666 [00:07<00:06, 49.63it/s] 52%|█████▏    | 346/666 [00:07<00:06, 49.63it/s] 53%|█████▎    | 351/666 [00:07<00:06, 49.66it/s] 53%|█████▎    | 356/666 [00:07<00:06, 49.57it/s] 54%|█████▍    | 361/666 [00:07<00:06, 49.56it/s] 55%|█████▍    | 366/666 [00:07<00:06, 49.65it/s] 56%|█████▌    | 371/666 [00:07<00:05, 49.65it/s] 56%|█████▋    | 376/666 [00:07<00:05, 49.62it/s] 57%|█████▋    | 381/666 [00:07<00:05, 49.59it/s] 58%|█████▊    | 386/666 [00:07<00:05, 49.59it/s] 59%|█████▊    | 391/666 [00:08<00:05, 49.54it/s] 59%|█████▉    | 396/666 [00:08<00:05, 49.59it/s] 60%|██████    | 401/666 [00:08<00:05, 49.56it/s] 61%|██████    | 406/666 [00:08<00:05, 49.53it/s] 62%|██████▏   | 411/666 [00:08<00:05, 49.58it/s] 62%|██████▏   | 416/666 [00:08<00:05, 49.60it/s] 63%|██████▎   | 421/666 [00:08<00:04, 49.61it/s] 64%|██████▍   | 426/666 [00:08<00:04, 49.60it/s] 65%|██████▍   | 431/666 [00:08<00:04, 49.55it/s] 65%|██████▌   | 436/666 [00:08<00:04, 49.56it/s] 66%|██████▌   | 441/666 [00:09<00:04, 49.61it/s] 67%|██████▋   | 446/666 [00:09<00:04, 49.56it/s] 68%|██████▊   | 451/666 [00:09<00:04, 49.53it/s] 68%|██████▊   | 456/666 [00:09<00:04, 49.55it/s] 69%|██████▉   | 461/666 [00:09<00:04, 49.55it/s] 70%|██████▉   | 466/666 [00:09<00:04, 49.55it/s] 71%|███████   | 471/666 [00:09<00:03, 49.55it/s] 71%|███████▏  | 476/666 [00:09<00:03, 49.54it/s] 72%|███████▏  | 481/666 [00:09<00:03, 49.60it/s] 73%|███████▎  | 486/666 [00:09<00:03, 49.65it/s] 74%|███████▎  | 491/666 [00:10<00:03, 49.59it/s] 74%|███████▍  | 496/666 [00:10<00:03, 49.55it/s] 75%|███████▌  | 501/666 [00:10<00:03, 49.58it/s] 76%|███████▌  | 506/666 [00:10<00:03, 49.60it/s] 77%|███████▋  | 511/666 [00:10<00:03, 49.61it/s] 77%|███████▋  | 516/666 [00:10<00:03, 49.60it/s] 78%|███████▊  | 521/666 [00:10<00:02, 49.55it/s] 79%|███████▉  | 526/666 [00:10<00:02, 49.56it/s] 80%|███████▉  | 531/666 [00:10<00:02, 49.64it/s] 80%|████████  | 536/666 [00:11<00:02, 49.64it/s] 81%|████████  | 541/666 [00:11<00:02, 49.63it/s] 82%|████████▏ | 546/666 [00:11<00:02, 49.62it/s] 83%|████████▎ | 551/666 [00:11<00:02, 49.58it/s] 83%|████████▎ | 556/666 [00:11<00:02, 49.57it/s] 84%|████████▍ | 561/666 [00:11<00:02, 49.58it/s] 85%|████████▍ | 566/666 [00:11<00:02, 49.52it/s] 86%|████████▌ | 571/666 [00:11<00:01, 49.49it/s] 86%|████████▋ | 576/666 [00:11<00:01, 49.55it/s] 87%|████████▋ | 581/666 [00:11<00:01, 49.53it/s] 88%|████████▊ | 586/666 [00:12<00:01, 49.50it/s] 89%|████████▊ | 591/666 [00:12<00:01, 49.50it/s] 89%|████████▉ | 596/666 [00:12<00:01, 49.55it/s] 90%|█████████ | 601/666 [00:12<00:01, 49.55it/s] 91%|█████████ | 606/666 [00:12<00:01, 49.54it/s] 92%|█████████▏| 611/666 [00:12<00:01, 49.50it/s] 92%|█████████▏| 616/666 [00:12<00:01, 49.53it/s] 93%|█████████▎| 621/666 [00:12<00:00, 49.66it/s] 94%|█████████▍| 626/666 [00:12<00:00, 49.61it/s] 95%|█████████▍| 631/666 [00:12<00:00, 49.56it/s] 95%|█████████▌| 636/666 [00:13<00:00, 49.56it/s] 96%|█████████▌| 641/666 [00:13<00:00, 49.55it/s] 97%|█████████▋| 646/666 [00:13<00:00, 49.61it/s] 98%|█████████▊| 651/666 [00:13<00:00, 49.63it/s] 98%|█████████▊| 656/666 [00:13<00:00, 49.56it/s] 99%|█████████▉| 661/666 [00:13<00:00, 48.48it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  9.00it/s][A
  6%|▌         | 10/167 [00:00<00:03, 49.85it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 124.97it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 163.10it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 185.73it/s][A
 61%|██████    | 102/167 [00:00<00:00, 198.65it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 208.17it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 214.09it/s][A100%|██████████| 167/167 [00:00<00:00, 172.91it/s]
2022-11-28 21:43:55,695 P17075 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:43:55,696 P17075 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:43:55,696 P17075 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:43:55,696 P17075 INFO Early stopping at epoch=3
2022-11-28 21:43:55,696 P17075 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:14<00:00, 45.06it/s]
2022-11-28 21:43:55,748 P17075 INFO Train loss: 30.970641
2022-11-28 21:43:55,749 P17075 INFO Training finished.
2022-11-28 21:43:55,749 P17075 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_022_6b0fc175.model
2022-11-28 21:43:56,029 P17075 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:56,  5.73it/s]  2%|▏         | 10/666 [00:00<00:15, 41.34it/s]  5%|▍         | 32/666 [00:00<00:05, 108.30it/s]  8%|▊         | 54/666 [00:00<00:04, 146.78it/s] 11%|█▏        | 76/666 [00:00<00:03, 171.02it/s] 15%|█▍        | 98/666 [00:00<00:03, 186.56it/s] 18%|█▊        | 120/666 [00:00<00:02, 195.78it/s] 21%|██▏       | 142/666 [00:00<00:02, 203.03it/s] 25%|██▍       | 164/666 [00:00<00:02, 207.78it/s] 28%|██▊       | 186/666 [00:01<00:02, 210.08it/s] 31%|███       | 208/666 [00:01<00:02, 212.46it/s] 35%|███▍      | 230/666 [00:01<00:02, 214.01it/s] 38%|███▊      | 252/666 [00:01<00:01, 214.86it/s] 41%|████      | 274/666 [00:01<00:01, 215.37it/s] 44%|████▍     | 296/666 [00:01<00:01, 215.44it/s] 48%|████▊     | 318/666 [00:01<00:01, 215.46it/s] 51%|█████     | 340/666 [00:01<00:01, 215.51it/s] 54%|█████▍    | 362/666 [00:01<00:01, 215.55it/s] 58%|█████▊    | 384/666 [00:02<00:01, 215.27it/s] 61%|██████    | 406/666 [00:02<00:01, 215.49it/s] 64%|██████▍   | 428/666 [00:02<00:01, 215.52it/s] 68%|██████▊   | 450/666 [00:02<00:01, 215.62it/s] 71%|███████   | 472/666 [00:02<00:00, 214.11it/s] 74%|███████▍  | 494/666 [00:02<00:00, 214.12it/s] 77%|███████▋  | 516/666 [00:02<00:00, 211.27it/s] 81%|████████  | 538/666 [00:02<00:00, 212.42it/s] 84%|████████▍ | 560/666 [00:02<00:00, 213.27it/s] 87%|████████▋ | 582/666 [00:02<00:00, 212.79it/s] 91%|█████████ | 604/666 [00:03<00:00, 213.20it/s] 94%|█████████▍| 626/666 [00:03<00:00, 213.90it/s] 97%|█████████▋| 648/666 [00:03<00:00, 212.30it/s]100%|██████████| 666/666 [00:03<00:00, 196.59it/s]
2022-11-28 21:43:59,860 P17075 INFO [Metrics] logloss: 4.992003 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:18,  9.14it/s]  6%|▌         | 10/167 [00:00<00:03, 49.74it/s] 19%|█▉        | 32/167 [00:00<00:01, 120.97it/s] 32%|███▏      | 54/167 [00:00<00:00, 157.51it/s] 46%|████▌     | 76/167 [00:00<00:00, 178.48it/s] 59%|█████▊    | 98/167 [00:00<00:00, 191.26it/s] 72%|███████▏  | 120/167 [00:00<00:00, 200.25it/s] 86%|████████▌ | 143/167 [00:00<00:00, 207.01it/s] 99%|█████████▉| 166/167 [00:00<00:00, 211.64it/s]100%|██████████| 167/167 [00:01<00:00, 166.88it/s]
2022-11-28 21:44:00,973 P17075 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:44:07,386 P18854 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "128",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_023_f67af485",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:44:07,387 P18854 INFO Set up feature encoder...
2022-11-28 21:44:07,388 P18854 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:44:07,389 P18854 INFO Loading data...
2022-11-28 21:44:07,393 P18854 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:44:07,608 P18854 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:44:07,722 P18854 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:44:07,722 P18854 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:44:07,722 P18854 INFO Loading train data done.
2022-11-28 21:44:10,745 P18854 INFO Total number of parameters: 29989252.
2022-11-28 21:44:10,745 P18854 INFO Start training: 666 batches/epoch
2022-11-28 21:44:10,745 P18854 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:44:11.072 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:18854 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:44:11.104 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:18854 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:39,  1.14s/it]  1%|          | 5/666 [00:01<02:09,  5.09it/s]  1%|▏         | 9/666 [00:01<01:09,  9.46it/s]  2%|▏         | 13/666 [00:01<00:47, 13.78it/s]  3%|▎         | 17/666 [00:01<00:36, 17.83it/s]  3%|▎         | 21/666 [00:01<00:29, 21.54it/s]  4%|▍         | 25/666 [00:01<00:25, 24.66it/s]  4%|▍         | 29/666 [00:01<00:23, 27.17it/s]  5%|▍         | 33/666 [00:02<00:21, 29.11it/s]  6%|▌         | 37/666 [00:02<00:20, 30.60it/s]  6%|▌         | 41/666 [00:02<00:19, 31.70it/s]  7%|▋         | 45/666 [00:02<00:19, 32.49it/s]  7%|▋         | 49/666 [00:02<00:18, 33.06it/s]  8%|▊         | 53/666 [00:02<00:18, 33.48it/s]  9%|▊         | 57/666 [00:02<00:18, 33.76it/s]  9%|▉         | 61/666 [00:02<00:17, 33.96it/s] 10%|▉         | 65/666 [00:03<00:17, 34.01it/s] 10%|█         | 69/666 [00:03<00:17, 34.13it/s] 11%|█         | 73/666 [00:03<00:17, 34.23it/s] 12%|█▏        | 77/666 [00:03<00:17, 34.29it/s] 12%|█▏        | 81/666 [00:03<00:17, 34.30it/s] 13%|█▎        | 85/666 [00:03<00:16, 34.35it/s] 13%|█▎        | 89/666 [00:03<00:16, 34.39it/s] 14%|█▍        | 93/666 [00:03<00:16, 34.39it/s] 15%|█▍        | 97/666 [00:03<00:16, 34.40it/s] 15%|█▌        | 101/666 [00:04<00:16, 34.40it/s] 16%|█▌        | 105/666 [00:04<00:16, 34.39it/s] 16%|█▋        | 109/666 [00:04<00:16, 34.40it/s] 17%|█▋        | 113/666 [00:04<00:16, 34.39it/s] 18%|█▊        | 117/666 [00:04<00:15, 34.38it/s] 18%|█▊        | 121/666 [00:04<00:15, 34.39it/s] 19%|█▉        | 125/666 [00:04<00:15, 34.01it/s] 19%|█▉        | 129/666 [00:04<00:15, 34.07it/s] 20%|█▉        | 133/666 [00:05<00:15, 34.18it/s] 21%|██        | 137/666 [00:05<00:15, 34.24it/s] 21%|██        | 141/666 [00:05<00:15, 34.26it/s] 22%|██▏       | 145/666 [00:05<00:15, 34.30it/s] 22%|██▏       | 149/666 [00:05<00:14, 34.48it/s] 23%|██▎       | 153/666 [00:05<00:14, 35.02it/s] 24%|██▎       | 157/666 [00:05<00:14, 35.46it/s] 24%|██▍       | 161/666 [00:05<00:14, 35.76it/s] 25%|██▍       | 165/666 [00:05<00:13, 35.97it/s] 25%|██▌       | 169/666 [00:06<00:13, 36.13it/s] 26%|██▌       | 173/666 [00:06<00:13, 36.25it/s] 27%|██▋       | 177/666 [00:06<00:13, 36.36it/s] 27%|██▋       | 181/666 [00:06<00:13, 36.41it/s] 28%|██▊       | 185/666 [00:06<00:13, 36.44it/s] 28%|██▊       | 189/666 [00:06<00:13, 36.45it/s] 29%|██▉       | 193/666 [00:06<00:12, 36.43it/s] 30%|██▉       | 197/666 [00:06<00:12, 36.48it/s] 30%|███       | 201/666 [00:06<00:12, 36.49it/s] 31%|███       | 205/666 [00:07<00:12, 36.51it/s] 31%|███▏      | 209/666 [00:07<00:12, 36.54it/s] 32%|███▏      | 213/666 [00:07<00:12, 36.50it/s] 33%|███▎      | 217/666 [00:07<00:12, 36.53it/s] 33%|███▎      | 221/666 [00:07<00:12, 36.54it/s] 34%|███▍      | 225/666 [00:07<00:12, 36.54it/s] 34%|███▍      | 229/666 [00:07<00:11, 36.55it/s] 35%|███▍      | 233/666 [00:07<00:11, 36.54it/s] 36%|███▌      | 237/666 [00:07<00:11, 36.54it/s] 36%|███▌      | 241/666 [00:07<00:11, 36.57it/s] 37%|███▋      | 245/666 [00:08<00:11, 36.56it/s] 37%|███▋      | 249/666 [00:08<00:11, 36.54it/s] 38%|███▊      | 253/666 [00:08<00:11, 36.54it/s] 39%|███▊      | 257/666 [00:08<00:11, 36.51it/s] 39%|███▉      | 261/666 [00:08<00:11, 36.54it/s] 40%|███▉      | 265/666 [00:08<00:10, 36.56it/s] 40%|████      | 269/666 [00:08<00:10, 36.54it/s] 41%|████      | 273/666 [00:08<00:10, 36.55it/s] 42%|████▏     | 277/666 [00:08<00:10, 36.54it/s] 42%|████▏     | 281/666 [00:09<00:10, 36.53it/s] 43%|████▎     | 285/666 [00:09<00:10, 36.55it/s] 43%|████▎     | 289/666 [00:09<00:10, 36.55it/s] 44%|████▍     | 293/666 [00:09<00:10, 36.56it/s] 45%|████▍     | 297/666 [00:09<00:10, 36.56it/s] 45%|████▌     | 301/666 [00:09<00:09, 36.54it/s] 46%|████▌     | 305/666 [00:09<00:09, 36.54it/s] 46%|████▋     | 309/666 [00:09<00:09, 36.55it/s] 47%|████▋     | 313/666 [00:09<00:09, 36.53it/s] 48%|████▊     | 317/666 [00:10<00:09, 36.52it/s] 48%|████▊     | 321/666 [00:10<00:09, 36.52it/s] 49%|████▉     | 325/666 [00:10<00:09, 36.52it/s] 49%|████▉     | 329/666 [00:10<00:09, 36.54it/s] 50%|█████     | 333/666 [00:10<00:09, 36.51it/s] 51%|█████     | 337/666 [00:10<00:09, 36.53it/s] 51%|█████     | 341/666 [00:10<00:08, 36.53it/s] 52%|█████▏    | 345/666 [00:10<00:08, 36.52it/s] 52%|█████▏    | 349/666 [00:10<00:08, 36.55it/s] 53%|█████▎    | 353/666 [00:11<00:08, 36.55it/s] 54%|█████▎    | 357/666 [00:11<00:08, 36.53it/s] 54%|█████▍    | 361/666 [00:11<00:08, 36.54it/s] 55%|█████▍    | 365/666 [00:11<00:08, 36.51it/s] 55%|█████▌    | 369/666 [00:11<00:08, 36.53it/s] 56%|█████▌    | 373/666 [00:11<00:08, 36.54it/s] 57%|█████▋    | 377/666 [00:11<00:07, 36.51it/s] 57%|█████▋    | 381/666 [00:11<00:07, 36.52it/s] 58%|█████▊    | 385/666 [00:11<00:07, 36.53it/s] 58%|█████▊    | 389/666 [00:12<00:07, 36.53it/s] 59%|█████▉    | 393/666 [00:12<00:07, 36.54it/s] 60%|█████▉    | 397/666 [00:12<00:07, 36.50it/s] 60%|██████    | 401/666 [00:12<00:07, 36.53it/s] 61%|██████    | 405/666 [00:12<00:07, 36.53it/s] 61%|██████▏   | 409/666 [00:12<00:07, 36.52it/s] 62%|██████▏   | 413/666 [00:12<00:06, 36.54it/s] 63%|██████▎   | 417/666 [00:12<00:06, 36.55it/s] 63%|██████▎   | 421/666 [00:12<00:06, 36.54it/s] 64%|██████▍   | 425/666 [00:13<00:06, 36.56it/s] 64%|██████▍   | 429/666 [00:13<00:06, 36.55it/s] 65%|██████▌   | 433/666 [00:13<00:06, 36.55it/s] 66%|██████▌   | 437/666 [00:13<00:06, 36.56it/s] 66%|██████▌   | 441/666 [00:13<00:06, 36.53it/s] 67%|██████▋   | 445/666 [00:13<00:06, 36.54it/s] 67%|██████▋   | 449/666 [00:13<00:05, 36.54it/s] 68%|██████▊   | 453/666 [00:13<00:05, 36.53it/s] 69%|██████▊   | 457/666 [00:13<00:05, 36.55it/s] 69%|██████▉   | 461/666 [00:14<00:05, 36.53it/s] 70%|██████▉   | 465/666 [00:14<00:05, 36.52it/s] 70%|███████   | 469/666 [00:14<00:05, 36.52it/s] 71%|███████   | 473/666 [00:14<00:05, 36.51it/s] 72%|███████▏  | 477/666 [00:14<00:05, 36.54it/s] 72%|███████▏  | 481/666 [00:14<00:05, 36.55it/s] 73%|███████▎  | 485/666 [00:14<00:04, 36.53it/s] 73%|███████▎  | 489/666 [00:14<00:04, 36.53it/s] 74%|███████▍  | 493/666 [00:14<00:04, 36.51it/s] 75%|███████▍  | 497/666 [00:14<00:04, 36.53it/s] 75%|███████▌  | 501/666 [00:15<00:04, 36.51it/s] 76%|███████▌  | 505/666 [00:15<00:04, 36.49it/s] 76%|███████▋  | 509/666 [00:15<00:04, 36.49it/s] 77%|███████▋  | 513/666 [00:15<00:04, 36.49it/s] 78%|███████▊  | 517/666 [00:15<00:04, 36.50it/s] 78%|███████▊  | 521/666 [00:15<00:03, 36.52it/s] 79%|███████▉  | 525/666 [00:15<00:03, 36.52it/s] 79%|███████▉  | 529/666 [00:15<00:03, 36.54it/s] 80%|████████  | 533/666 [00:15<00:03, 36.53it/s] 81%|████████  | 537/666 [00:16<00:03, 36.53it/s] 81%|████████  | 541/666 [00:16<00:03, 36.49it/s] 82%|████████▏ | 545/666 [00:16<00:03, 36.52it/s] 82%|████████▏ | 549/666 [00:16<00:03, 36.52it/s] 83%|████████▎ | 553/666 [00:16<00:03, 36.53it/s] 84%|████████▎ | 557/666 [00:16<00:02, 36.47it/s] 84%|████████▍ | 561/666 [00:16<00:02, 36.47it/s] 85%|████████▍ | 565/666 [00:16<00:02, 36.46it/s] 85%|████████▌ | 569/666 [00:16<00:02, 36.49it/s] 86%|████████▌ | 573/666 [00:17<00:02, 36.49it/s] 87%|████████▋ | 577/666 [00:17<00:02, 36.51it/s] 87%|████████▋ | 581/666 [00:17<00:02, 36.52it/s] 88%|████████▊ | 585/666 [00:17<00:02, 36.51it/s] 88%|████████▊ | 589/666 [00:17<00:02, 36.53it/s] 89%|████████▉ | 593/666 [00:17<00:01, 36.54it/s] 90%|████████▉ | 597/666 [00:17<00:01, 36.53it/s] 90%|█████████ | 601/666 [00:17<00:01, 36.55it/s] 91%|█████████ | 605/666 [00:17<00:01, 36.53it/s] 91%|█████████▏| 609/666 [00:18<00:01, 36.53it/s] 92%|█████████▏| 613/666 [00:18<00:01, 36.55it/s] 93%|█████████▎| 617/666 [00:18<00:01, 36.54it/s] 93%|█████████▎| 621/666 [00:18<00:01, 36.54it/s] 94%|█████████▍| 625/666 [00:18<00:01, 36.54it/s] 94%|█████████▍| 629/666 [00:18<00:01, 36.52it/s] 95%|█████████▌| 633/666 [00:18<00:00, 36.53it/s] 96%|█████████▌| 637/666 [00:18<00:00, 36.53it/s] 96%|█████████▌| 641/666 [00:18<00:00, 36.52it/s] 97%|█████████▋| 645/666 [00:19<00:00, 36.55it/s] 97%|█████████▋| 649/666 [00:19<00:00, 36.54it/s] 98%|█████████▊| 653/666 [00:19<00:00, 36.52it/s] 99%|█████████▊| 657/666 [00:19<00:00, 36.52it/s] 99%|█████████▉| 661/666 [00:19<00:00, 35.92it/s]100%|█████████▉| 665/666 [00:19<00:00, 36.21it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.47it/s][A
  6%|▌         | 10/167 [00:00<00:03, 50.58it/s][A
 17%|█▋        | 29/167 [00:00<00:01, 108.25it/s][A
 31%|███       | 52/167 [00:00<00:00, 151.83it/s][A
 45%|████▍     | 75/167 [00:00<00:00, 176.98it/s][A
 59%|█████▊    | 98/167 [00:00<00:00, 192.45it/s][A
 72%|███████▏  | 120/167 [00:00<00:00, 201.16it/s][A
 86%|████████▌ | 143/167 [00:00<00:00, 207.92it/s][A
 99%|█████████▉| 166/167 [00:00<00:00, 213.16it/s][A100%|██████████| 167/167 [00:00<00:00, 167.59it/s]
2022-11-28 21:44:31,483 P18854 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:44:31,483 P18854 INFO Save best model: monitor(max): -4.497136
2022-11-28 21:44:32,501 P18854 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:21<00:00, 30.54it/s]
2022-11-28 21:44:32,553 P18854 INFO Train loss: 31.888214
2022-11-28 21:44:32,553 P18854 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:10,  5.09it/s]  1%|          | 5/666 [00:00<00:36, 17.98it/s]  1%|▏         | 9/666 [00:00<00:26, 24.36it/s]  2%|▏         | 13/666 [00:00<00:23, 27.91it/s]  3%|▎         | 17/666 [00:00<00:21, 30.65it/s]  3%|▎         | 21/666 [00:00<00:19, 32.46it/s]  4%|▍         | 25/666 [00:00<00:18, 33.74it/s]  4%|▍         | 29/666 [00:00<00:18, 34.58it/s]  5%|▍         | 33/666 [00:01<00:17, 35.19it/s]  6%|▌         | 37/666 [00:01<00:17, 35.62it/s]  6%|▌         | 41/666 [00:01<00:17, 35.89it/s]  7%|▋         | 45/666 [00:01<00:17, 36.10it/s]  7%|▋         | 49/666 [00:01<00:17, 36.20it/s]  8%|▊         | 53/666 [00:01<00:16, 36.29it/s]  9%|▊         | 57/666 [00:01<00:16, 36.35it/s]  9%|▉         | 61/666 [00:01<00:16, 36.40it/s] 10%|▉         | 65/666 [00:01<00:16, 36.46it/s] 10%|█         | 69/666 [00:02<00:16, 36.50it/s] 11%|█         | 73/666 [00:02<00:16, 36.51it/s] 12%|█▏        | 77/666 [00:02<00:16, 36.54it/s] 12%|█▏        | 81/666 [00:02<00:16, 36.56it/s] 13%|█▎        | 85/666 [00:02<00:15, 36.56it/s] 13%|█▎        | 89/666 [00:02<00:15, 36.56it/s] 14%|█▍        | 93/666 [00:02<00:15, 36.58it/s] 15%|█▍        | 97/666 [00:02<00:15, 36.57it/s] 15%|█▌        | 101/666 [00:02<00:15, 36.58it/s] 16%|█▌        | 105/666 [00:03<00:15, 36.57it/s] 16%|█▋        | 109/666 [00:03<00:15, 36.57it/s] 17%|█▋        | 113/666 [00:03<00:15, 36.57it/s] 18%|█▊        | 117/666 [00:03<00:15, 36.57it/s] 18%|█▊        | 121/666 [00:03<00:15, 36.33it/s] 19%|█▉        | 125/666 [00:03<00:14, 36.16it/s] 19%|█▉        | 129/666 [00:03<00:14, 36.07it/s] 20%|█▉        | 133/666 [00:03<00:14, 36.00it/s] 21%|██        | 137/666 [00:03<00:14, 35.93it/s] 21%|██        | 141/666 [00:04<00:14, 35.89it/s] 22%|██▏       | 145/666 [00:04<00:14, 35.85it/s] 22%|██▏       | 149/666 [00:04<00:14, 35.82it/s] 23%|██▎       | 153/666 [00:04<00:14, 35.81it/s] 24%|██▎       | 157/666 [00:04<00:14, 35.79it/s] 24%|██▍       | 161/666 [00:04<00:14, 35.78it/s] 25%|██▍       | 165/666 [00:04<00:14, 35.78it/s] 25%|██▌       | 169/666 [00:04<00:13, 35.76it/s] 26%|██▌       | 173/666 [00:04<00:13, 35.74it/s] 27%|██▋       | 177/666 [00:05<00:13, 35.76it/s] 27%|██▋       | 181/666 [00:05<00:13, 35.79it/s] 28%|██▊       | 185/666 [00:05<00:13, 35.84it/s] 28%|██▊       | 189/666 [00:05<00:13, 35.87it/s] 29%|██▉       | 193/666 [00:05<00:13, 35.80it/s] 30%|██▉       | 197/666 [00:05<00:13, 35.83it/s] 30%|███       | 201/666 [00:05<00:12, 35.83it/s] 31%|███       | 205/666 [00:05<00:12, 35.82it/s] 31%|███▏      | 209/666 [00:05<00:12, 35.81it/s] 32%|███▏      | 213/666 [00:06<00:12, 35.80it/s] 33%|███▎      | 217/666 [00:06<00:12, 35.79it/s] 33%|███▎      | 221/666 [00:06<00:12, 35.77it/s] 34%|███▍      | 225/666 [00:06<00:12, 35.77it/s] 34%|███▍      | 229/666 [00:06<00:12, 35.77it/s] 35%|███▍      | 233/666 [00:06<00:12, 35.76it/s] 36%|███▌      | 237/666 [00:06<00:11, 35.76it/s] 36%|███▌      | 241/666 [00:06<00:11, 35.78it/s] 37%|███▋      | 245/666 [00:06<00:11, 35.82it/s] 37%|███▋      | 249/666 [00:07<00:11, 35.85it/s] 38%|███▊      | 253/666 [00:07<00:11, 35.86it/s] 39%|███▊      | 257/666 [00:07<00:11, 35.86it/s] 39%|███▉      | 261/666 [00:07<00:11, 35.84it/s] 40%|███▉      | 265/666 [00:07<00:11, 35.76it/s] 40%|████      | 269/666 [00:07<00:11, 35.78it/s] 41%|████      | 273/666 [00:07<00:10, 35.78it/s] 42%|████▏     | 277/666 [00:07<00:10, 35.77it/s] 42%|████▏     | 281/666 [00:07<00:10, 35.76it/s] 43%|████▎     | 285/666 [00:08<00:10, 35.75it/s] 43%|████▎     | 289/666 [00:08<00:10, 35.73it/s] 44%|████▍     | 293/666 [00:08<00:10, 35.72it/s] 45%|████▍     | 297/666 [00:08<00:10, 35.72it/s] 45%|████▌     | 301/666 [00:08<00:10, 35.73it/s] 46%|████▌     | 305/666 [00:08<00:10, 35.72it/s] 46%|████▋     | 309/666 [00:08<00:09, 35.71it/s] 47%|████▋     | 313/666 [00:08<00:09, 35.73it/s] 48%|████▊     | 317/666 [00:08<00:09, 35.73it/s] 48%|████▊     | 321/666 [00:09<00:09, 35.74it/s] 49%|████▉     | 325/666 [00:09<00:09, 35.74it/s] 49%|████▉     | 329/666 [00:09<00:09, 35.66it/s] 50%|█████     | 333/666 [00:09<00:09, 35.69it/s] 51%|█████     | 337/666 [00:09<00:09, 35.66it/s] 51%|█████     | 341/666 [00:09<00:09, 35.70it/s] 52%|█████▏    | 345/666 [00:09<00:08, 35.72it/s] 52%|█████▏    | 349/666 [00:09<00:08, 35.72it/s] 53%|█████▎    | 353/666 [00:09<00:08, 35.73it/s] 54%|█████▎    | 357/666 [00:10<00:08, 35.73it/s] 54%|█████▍    | 361/666 [00:10<00:08, 35.71it/s] 55%|█████▍    | 365/666 [00:10<00:08, 35.72it/s] 55%|█████▌    | 369/666 [00:10<00:08, 35.73it/s] 56%|█████▌    | 373/666 [00:10<00:08, 35.72it/s] 57%|█████▋    | 377/666 [00:10<00:08, 35.72it/s] 57%|█████▋    | 381/666 [00:10<00:07, 35.72it/s] 58%|█████▊    | 385/666 [00:10<00:07, 35.72it/s] 58%|█████▊    | 389/666 [00:11<00:07, 35.72it/s] 59%|█████▉    | 393/666 [00:11<00:07, 35.72it/s] 60%|█████▉    | 397/666 [00:11<00:07, 35.73it/s] 60%|██████    | 401/666 [00:11<00:07, 35.73it/s] 61%|██████    | 405/666 [00:11<00:07, 35.73it/s] 61%|██████▏   | 409/666 [00:11<00:07, 35.67it/s] 62%|██████▏   | 413/666 [00:11<00:07, 35.69it/s] 63%|██████▎   | 417/666 [00:11<00:06, 35.70it/s] 63%|██████▎   | 421/666 [00:11<00:06, 35.70it/s] 64%|██████▍   | 425/666 [00:12<00:06, 35.71it/s] 64%|██████▍   | 429/666 [00:12<00:06, 35.73it/s] 65%|██████▌   | 433/666 [00:12<00:06, 35.73it/s] 66%|██████▌   | 437/666 [00:12<00:06, 35.74it/s] 66%|██████▌   | 441/666 [00:12<00:06, 35.78it/s] 67%|██████▋   | 445/666 [00:12<00:06, 35.83it/s] 67%|██████▋   | 449/666 [00:12<00:06, 35.91it/s] 68%|██████▊   | 453/666 [00:12<00:05, 35.93it/s] 69%|██████▊   | 457/666 [00:12<00:05, 35.92it/s] 69%|██████▉   | 461/666 [00:13<00:05, 35.91it/s] 70%|██████▉   | 465/666 [00:13<00:05, 35.92it/s] 70%|███████   | 469/666 [00:13<00:05, 35.96it/s] 71%|███████   | 473/666 [00:13<00:05, 35.98it/s] 72%|███████▏  | 477/666 [00:13<00:05, 35.96it/s] 72%|███████▏  | 481/666 [00:13<00:05, 35.92it/s] 73%|███████▎  | 485/666 [00:13<00:05, 35.89it/s] 73%|███████▎  | 489/666 [00:13<00:04, 35.90it/s] 74%|███████▍  | 493/666 [00:13<00:04, 35.95it/s] 75%|███████▍  | 497/666 [00:14<00:04, 35.96it/s] 75%|███████▌  | 501/666 [00:14<00:04, 35.96it/s] 76%|███████▌  | 505/666 [00:14<00:04, 35.92it/s] 76%|███████▋  | 509/666 [00:14<00:04, 35.91it/s] 77%|███████▋  | 513/666 [00:14<00:04, 35.96it/s] 78%|███████▊  | 517/666 [00:14<00:04, 35.98it/s] 78%|███████▊  | 521/666 [00:14<00:04, 35.98it/s] 79%|███████▉  | 525/666 [00:14<00:03, 35.94it/s] 79%|███████▉  | 529/666 [00:14<00:03, 35.90it/s] 80%|████████  | 533/666 [00:15<00:03, 35.86it/s] 81%|████████  | 537/666 [00:15<00:03, 35.74it/s] 81%|████████  | 541/666 [00:15<00:03, 35.75it/s] 82%|████████▏ | 545/666 [00:15<00:03, 35.76it/s] 82%|████████▏ | 549/666 [00:15<00:03, 35.79it/s] 83%|████████▎ | 553/666 [00:15<00:03, 35.82it/s] 84%|████████▎ | 557/666 [00:15<00:03, 35.90it/s] 84%|████████▍ | 561/666 [00:15<00:02, 35.93it/s] 85%|████████▍ | 565/666 [00:15<00:02, 35.91it/s] 85%|████████▌ | 569/666 [00:16<00:02, 35.90it/s] 86%|████████▌ | 573/666 [00:16<00:02, 35.90it/s] 87%|████████▋ | 577/666 [00:16<00:02, 35.92it/s] 87%|████████▋ | 581/666 [00:16<00:02, 35.96it/s] 88%|████████▊ | 585/666 [00:16<00:02, 35.97it/s] 88%|████████▊ | 589/666 [00:16<00:02, 35.93it/s] 89%|████████▉ | 593/666 [00:16<00:02, 35.90it/s] 90%|████████▉ | 597/666 [00:16<00:01, 35.88it/s] 90%|█████████ | 601/666 [00:16<00:01, 35.87it/s] 91%|█████████ | 605/666 [00:17<00:01, 35.91it/s] 91%|█████████▏| 609/666 [00:17<00:01, 35.94it/s] 92%|█████████▏| 613/666 [00:17<00:01, 35.94it/s] 93%|█████████▎| 617/666 [00:17<00:01, 35.92it/s] 93%|█████████▎| 621/666 [00:17<00:01, 35.90it/s] 94%|█████████▍| 625/666 [00:17<00:01, 35.88it/s] 94%|█████████▍| 629/666 [00:17<00:01, 35.92it/s] 95%|█████████▌| 633/666 [00:17<00:00, 35.96it/s] 96%|█████████▌| 637/666 [00:17<00:00, 35.95it/s] 96%|█████████▌| 641/666 [00:18<00:00, 35.93it/s] 97%|█████████▋| 645/666 [00:18<00:00, 35.91it/s] 97%|█████████▋| 649/666 [00:18<00:00, 35.91it/s] 98%|█████████▊| 653/666 [00:18<00:00, 35.94it/s] 99%|█████████▊| 657/666 [00:18<00:00, 35.96it/s] 99%|█████████▉| 661/666 [00:18<00:00, 35.41it/s]100%|█████████▉| 665/666 [00:18<00:00, 35.68it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:19,  8.45it/s][A
  6%|▌         | 10/167 [00:00<00:03, 44.92it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 118.15it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 158.23it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 182.48it/s][A
 61%|██████    | 102/167 [00:00<00:00, 197.38it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 205.93it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 212.64it/s][A100%|██████████| 167/167 [00:00<00:00, 167.25it/s]
2022-11-28 21:44:52,391 P18854 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:44:52,391 P18854 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:44:52,391 P18854 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:44:52,392 P18854 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:19<00:00, 33.48it/s]
2022-11-28 21:44:52,446 P18854 INFO Train loss: 30.969532
2022-11-28 21:44:52,446 P18854 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:05,  5.31it/s]  1%|          | 5/666 [00:00<00:34, 19.22it/s]  1%|▏         | 9/666 [00:00<00:25, 25.76it/s]  2%|▏         | 13/666 [00:00<00:22, 29.26it/s]  3%|▎         | 17/666 [00:00<00:20, 31.53it/s]  3%|▎         | 21/666 [00:00<00:19, 32.94it/s]  4%|▍         | 25/666 [00:00<00:18, 33.86it/s]  4%|▍         | 29/666 [00:00<00:18, 34.47it/s]  5%|▍         | 33/666 [00:01<00:18, 34.88it/s]  6%|▌         | 37/666 [00:01<00:17, 35.16it/s]  6%|▌         | 41/666 [00:01<00:17, 35.38it/s]  7%|▋         | 45/666 [00:01<00:17, 35.58it/s]  7%|▋         | 49/666 [00:01<00:17, 35.69it/s]  8%|▊         | 53/666 [00:01<00:17, 35.74it/s]  9%|▊         | 57/666 [00:01<00:17, 35.77it/s]  9%|▉         | 61/666 [00:01<00:16, 35.78it/s] 10%|▉         | 65/666 [00:01<00:16, 35.78it/s] 10%|█         | 69/666 [00:02<00:16, 35.80it/s] 11%|█         | 73/666 [00:02<00:16, 35.82it/s] 12%|█▏        | 77/666 [00:02<00:16, 35.87it/s] 12%|█▏        | 81/666 [00:02<00:16, 35.89it/s] 13%|█▎        | 85/666 [00:02<00:16, 35.90it/s] 13%|█▎        | 89/666 [00:02<00:16, 35.88it/s] 14%|█▍        | 93/666 [00:02<00:15, 35.86it/s] 15%|█▍        | 97/666 [00:02<00:15, 35.84it/s] 15%|█▌        | 101/666 [00:02<00:15, 35.84it/s] 16%|█▌        | 105/666 [00:03<00:15, 35.85it/s] 16%|█▋        | 109/666 [00:03<00:15, 35.90it/s] 17%|█▋        | 113/666 [00:03<00:15, 35.92it/s] 18%|█▊        | 117/666 [00:03<00:15, 35.90it/s] 18%|█▊        | 121/666 [00:03<00:15, 35.89it/s] 19%|█▉        | 125/666 [00:03<00:15, 35.86it/s] 19%|█▉        | 129/666 [00:03<00:14, 35.84it/s] 20%|█▉        | 133/666 [00:03<00:14, 35.83it/s] 21%|██        | 137/666 [00:03<00:14, 35.85it/s] 21%|██        | 141/666 [00:04<00:14, 35.89it/s] 22%|██▏       | 145/666 [00:04<00:14, 35.91it/s] 22%|██▏       | 149/666 [00:04<00:14, 35.92it/s] 23%|██▎       | 153/666 [00:04<00:14, 35.90it/s] 24%|██▎       | 157/666 [00:04<00:14, 35.86it/s] 24%|██▍       | 161/666 [00:04<00:14, 35.84it/s] 25%|██▍       | 165/666 [00:04<00:13, 35.84it/s] 25%|██▌       | 169/666 [00:04<00:13, 35.84it/s] 26%|██▌       | 173/666 [00:04<00:13, 35.89it/s] 27%|██▋       | 177/666 [00:05<00:13, 35.91it/s] 27%|██▋       | 181/666 [00:05<00:13, 35.91it/s] 28%|██▊       | 185/666 [00:05<00:13, 35.89it/s] 28%|██▊       | 189/666 [00:05<00:13, 35.86it/s] 29%|██▉       | 193/666 [00:05<00:13, 35.84it/s] 30%|██▉       | 197/666 [00:05<00:13, 35.84it/s] 30%|███       | 201/666 [00:05<00:12, 35.85it/s] 31%|███       | 205/666 [00:05<00:12, 35.89it/s] 31%|███▏      | 209/666 [00:05<00:12, 35.92it/s] 32%|███▏      | 213/666 [00:06<00:12, 35.92it/s] 33%|███▎      | 217/666 [00:06<00:12, 35.89it/s] 33%|███▎      | 221/666 [00:06<00:12, 35.87it/s] 34%|███▍      | 225/666 [00:06<00:12, 35.85it/s] 34%|███▍      | 229/666 [00:06<00:12, 35.89it/s] 35%|███▍      | 233/666 [00:06<00:12, 35.93it/s] 36%|███▌      | 237/666 [00:06<00:11, 35.97it/s] 36%|███▌      | 241/666 [00:06<00:11, 35.95it/s] 37%|███▋      | 245/666 [00:06<00:11, 35.93it/s] 37%|███▋      | 249/666 [00:07<00:11, 35.87it/s] 38%|███▊      | 253/666 [00:07<00:11, 35.83it/s] 39%|███▊      | 257/666 [00:07<00:11, 35.84it/s] 39%|███▉      | 261/666 [00:07<00:11, 35.87it/s] 40%|███▉      | 265/666 [00:07<00:11, 35.89it/s] 40%|████      | 269/666 [00:07<00:11, 35.90it/s] 41%|████      | 273/666 [00:07<00:10, 35.89it/s] 42%|████▏     | 277/666 [00:07<00:10, 35.85it/s] 42%|████▏     | 281/666 [00:07<00:10, 35.86it/s] 43%|████▎     | 285/666 [00:08<00:10, 35.83it/s] 43%|████▎     | 289/666 [00:08<00:10, 35.81it/s] 44%|████▍     | 293/666 [00:08<00:10, 35.83it/s] 45%|████▍     | 297/666 [00:08<00:10, 35.86it/s] 45%|████▌     | 301/666 [00:08<00:10, 35.89it/s] 46%|████▌     | 305/666 [00:08<00:10, 35.90it/s] 46%|████▋     | 309/666 [00:08<00:09, 35.87it/s] 47%|████▋     | 313/666 [00:08<00:09, 35.86it/s] 48%|████▊     | 317/666 [00:09<00:09, 35.85it/s] 48%|████▊     | 321/666 [00:09<00:09, 35.82it/s] 49%|████▉     | 325/666 [00:09<00:09, 35.83it/s] 49%|████▉     | 329/666 [00:09<00:09, 36.01it/s] 50%|█████     | 333/666 [00:09<00:09, 36.10it/s] 51%|█████     | 337/666 [00:09<00:09, 36.24it/s] 51%|█████     | 341/666 [00:09<00:08, 36.32it/s] 52%|█████▏    | 345/666 [00:09<00:08, 36.36it/s] 52%|█████▏    | 349/666 [00:09<00:08, 36.36it/s] 53%|█████▎    | 353/666 [00:09<00:08, 36.39it/s] 54%|█████▎    | 357/666 [00:10<00:08, 36.44it/s] 54%|█████▍    | 361/666 [00:10<00:08, 36.45it/s] 55%|█████▍    | 365/666 [00:10<00:08, 36.48it/s] 55%|█████▌    | 369/666 [00:10<00:08, 36.41it/s] 56%|█████▌    | 373/666 [00:10<00:08, 36.42it/s] 57%|█████▋    | 377/666 [00:10<00:07, 36.43it/s] 57%|█████▋    | 381/666 [00:10<00:07, 36.45it/s] 58%|█████▊    | 385/666 [00:10<00:07, 36.49it/s] 58%|█████▊    | 389/666 [00:10<00:07, 36.47it/s] 59%|█████▉    | 393/666 [00:11<00:07, 36.48it/s] 60%|█████▉    | 397/666 [00:11<00:07, 36.50it/s] 60%|██████    | 401/666 [00:11<00:07, 36.49it/s] 61%|██████    | 405/666 [00:11<00:07, 36.50it/s] 61%|██████▏   | 409/666 [00:11<00:07, 36.49it/s] 62%|██████▏   | 413/666 [00:11<00:06, 36.51it/s] 63%|██████▎   | 417/666 [00:11<00:06, 36.51it/s] 63%|██████▎   | 421/666 [00:11<00:06, 36.51it/s] 64%|██████▍   | 425/666 [00:11<00:06, 36.52it/s] 64%|██████▍   | 429/666 [00:12<00:06, 36.52it/s] 65%|██████▌   | 433/666 [00:12<00:06, 36.51it/s] 66%|██████▌   | 437/666 [00:12<00:06, 36.50it/s] 66%|██████▌   | 441/666 [00:12<00:06, 36.49it/s] 67%|██████▋   | 445/666 [00:12<00:06, 36.51it/s] 67%|██████▋   | 449/666 [00:12<00:05, 36.51it/s] 68%|██████▊   | 453/666 [00:12<00:05, 36.49it/s] 69%|██████▊   | 457/666 [00:12<00:05, 36.52it/s] 69%|██████▉   | 461/666 [00:12<00:05, 36.51it/s] 70%|██████▉   | 465/666 [00:13<00:05, 36.53it/s] 70%|███████   | 469/666 [00:13<00:05, 36.54it/s] 71%|███████   | 473/666 [00:13<00:05, 36.51it/s] 72%|███████▏  | 477/666 [00:13<00:05, 36.53it/s] 72%|███████▏  | 481/666 [00:13<00:05, 36.52it/s] 73%|███████▎  | 485/666 [00:13<00:04, 36.50it/s] 73%|███████▎  | 489/666 [00:13<00:04, 36.51it/s] 74%|███████▍  | 493/666 [00:13<00:04, 36.50it/s] 75%|███████▍  | 497/666 [00:13<00:04, 36.52it/s] 75%|███████▌  | 501/666 [00:14<00:04, 36.52it/s] 76%|███████▌  | 505/666 [00:14<00:04, 36.52it/s] 76%|███████▋  | 509/666 [00:14<00:04, 36.50it/s] 77%|███████▋  | 513/666 [00:14<00:04, 36.45it/s] 78%|███████▊  | 517/666 [00:14<00:04, 36.45it/s] 78%|███████▊  | 521/666 [00:14<00:03, 36.42it/s] 79%|███████▉  | 525/666 [00:14<00:03, 36.44it/s] 79%|███████▉  | 529/666 [00:14<00:03, 36.42it/s] 80%|████████  | 533/666 [00:14<00:03, 36.40it/s] 81%|████████  | 537/666 [00:15<00:03, 36.35it/s] 81%|████████  | 541/666 [00:15<00:03, 36.38it/s] 82%|████████▏ | 545/666 [00:15<00:03, 36.36it/s] 82%|████████▏ | 549/666 [00:15<00:03, 36.38it/s] 83%|████████▎ | 553/666 [00:15<00:03, 36.38it/s] 84%|████████▎ | 557/666 [00:15<00:02, 36.41it/s] 84%|████████▍ | 561/666 [00:15<00:02, 36.39it/s] 85%|████████▍ | 565/666 [00:15<00:02, 36.42it/s] 85%|████████▌ | 569/666 [00:15<00:02, 36.39it/s] 86%|████████▌ | 573/666 [00:16<00:02, 36.42it/s] 87%|████████▋ | 577/666 [00:16<00:02, 36.37it/s] 87%|████████▋ | 581/666 [00:16<00:02, 36.40it/s] 88%|████████▊ | 585/666 [00:16<00:02, 36.40it/s] 88%|████████▊ | 589/666 [00:16<00:02, 36.41it/s] 89%|████████▉ | 593/666 [00:16<00:02, 35.79it/s] 90%|████████▉ | 597/666 [00:16<00:01, 35.96it/s] 90%|█████████ | 601/666 [00:16<00:01, 36.10it/s] 91%|█████████ | 605/666 [00:16<00:01, 36.21it/s] 91%|█████████▏| 609/666 [00:17<00:01, 36.25it/s] 92%|█████████▏| 613/666 [00:17<00:01, 36.32it/s] 93%|█████████▎| 617/666 [00:17<00:01, 36.31it/s] 93%|█████████▎| 621/666 [00:17<00:01, 36.35it/s] 94%|█████████▍| 625/666 [00:17<00:01, 36.36it/s] 94%|█████████▍| 629/666 [00:17<00:01, 36.39it/s] 95%|█████████▌| 633/666 [00:17<00:00, 36.37it/s] 96%|█████████▌| 637/666 [00:17<00:00, 36.40it/s] 96%|█████████▌| 641/666 [00:17<00:00, 36.37it/s] 97%|█████████▋| 645/666 [00:18<00:00, 36.41it/s] 97%|█████████▋| 649/666 [00:18<00:00, 36.42it/s] 98%|█████████▊| 653/666 [00:18<00:00, 36.41it/s] 99%|█████████▊| 657/666 [00:18<00:00, 36.39it/s] 99%|█████████▉| 661/666 [00:18<00:00, 35.68it/s]100%|█████████▉| 665/666 [00:18<00:00, 36.00it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:18,  8.77it/s][A
  6%|▌         | 10/167 [00:00<00:03, 49.93it/s][A
 20%|██        | 34/167 [00:00<00:01, 128.29it/s][A
 35%|███▍      | 58/167 [00:00<00:00, 167.67it/s][A
 49%|████▉     | 82/167 [00:00<00:00, 190.22it/s][A
 63%|██████▎   | 106/167 [00:00<00:00, 204.10it/s][A
 77%|███████▋  | 129/167 [00:00<00:00, 211.79it/s][A
 92%|█████████▏| 153/167 [00:00<00:00, 218.13it/s][A100%|██████████| 167/167 [00:00<00:00, 172.78it/s]
2022-11-28 21:45:12,116 P18854 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:45:12,116 P18854 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:45:12,117 P18854 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:45:12,117 P18854 INFO Early stopping at epoch=3
2022-11-28 21:45:12,117 P18854 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:19<00:00, 33.71it/s]
2022-11-28 21:45:12,173 P18854 INFO Train loss: 30.971488
2022-11-28 21:45:12,173 P18854 INFO Training finished.
2022-11-28 21:45:12,173 P18854 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_023_f67af485.model
2022-11-28 21:45:12,274 P18854 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:59,  5.58it/s]  2%|▏         | 10/666 [00:00<00:16, 40.84it/s]  5%|▍         | 33/666 [00:00<00:05, 111.28it/s]  8%|▊         | 56/666 [00:00<00:04, 151.18it/s] 12%|█▏        | 79/666 [00:00<00:03, 175.90it/s] 15%|█▌        | 102/666 [00:00<00:02, 190.91it/s] 19%|█▉        | 125/666 [00:00<00:02, 200.20it/s] 22%|██▏       | 147/666 [00:00<00:02, 205.63it/s] 25%|██▌       | 169/666 [00:01<00:02, 209.57it/s] 29%|██▊       | 191/666 [00:01<00:02, 212.22it/s] 32%|███▏      | 213/666 [00:01<00:02, 214.22it/s] 35%|███▌      | 235/666 [00:01<00:02, 215.44it/s] 39%|███▊      | 257/666 [00:01<00:01, 216.34it/s] 42%|████▏     | 279/666 [00:01<00:01, 216.87it/s] 45%|████▌     | 301/666 [00:01<00:01, 216.59it/s] 48%|████▊     | 323/666 [00:01<00:01, 217.45it/s] 52%|█████▏    | 346/666 [00:01<00:01, 218.40it/s] 55%|█████▌    | 368/666 [00:01<00:01, 218.75it/s] 59%|█████▊    | 390/666 [00:02<00:01, 218.95it/s] 62%|██████▏   | 412/666 [00:02<00:01, 218.93it/s] 65%|██████▌   | 434/666 [00:02<00:01, 218.79it/s] 68%|██████▊   | 456/666 [00:02<00:00, 218.62it/s] 72%|███████▏  | 478/666 [00:02<00:00, 217.82it/s] 75%|███████▌  | 500/666 [00:02<00:00, 216.75it/s] 78%|███████▊  | 522/666 [00:02<00:00, 216.12it/s] 82%|████████▏ | 544/666 [00:02<00:00, 215.83it/s] 85%|████████▍ | 566/666 [00:02<00:00, 215.59it/s] 88%|████████▊ | 588/666 [00:02<00:00, 211.45it/s] 92%|█████████▏| 610/666 [00:03<00:00, 212.27it/s] 95%|█████████▍| 632/666 [00:03<00:00, 212.77it/s] 98%|█████████▊| 654/666 [00:03<00:00, 212.00it/s]100%|██████████| 666/666 [00:03<00:00, 197.99it/s]
2022-11-28 21:45:16,087 P18854 INFO [Metrics] logloss: 4.992003 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:20,  8.13it/s]  6%|▌         | 10/167 [00:00<00:03, 49.96it/s] 17%|█▋        | 29/167 [00:00<00:01, 109.18it/s] 30%|██▉       | 50/167 [00:00<00:00, 145.92it/s] 43%|████▎     | 71/167 [00:00<00:00, 167.04it/s] 55%|█████▌    | 92/167 [00:00<00:00, 180.10it/s] 68%|██████▊   | 113/167 [00:00<00:00, 188.43it/s] 80%|████████  | 134/167 [00:00<00:00, 193.28it/s] 93%|█████████▎| 155/167 [00:00<00:00, 197.72it/s]100%|██████████| 167/167 [00:01<00:00, 158.70it/s]
2022-11-28 21:45:17,250 P18854 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:45:22,459 P20633 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_count_encoding_b2d46040",
    "debug": "False",
    "embedding_dim": "256",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id', 'bucketed_sentiment_scores_received', 'postal_code'], 'type': 'categorical'}, {'active': True, 'dtype': 'float', 'name': ['average_stars', 'philly_reviews', 'philly_share_of_reviews', 'gender_score', 'business_stars', 'business_review_count', 'CE_postal_code', 'CE_bucketed_sentiment_scores_received'], 'type': 'numeric'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.01",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_count_encoding_024_2a861cab",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-11-28 21:45:22,461 P20633 INFO Set up feature encoder...
2022-11-28 21:45:22,462 P20633 INFO Load feature_map from json: ../data/yelp_count_encoding_b2d46040/feature_map.json
2022-11-28 21:45:22,463 P20633 INFO Loading data...
2022-11-28 21:45:22,466 P20633 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/train.h5
2022-11-28 21:45:22,726 P20633 INFO Loading data from h5: ../data/yelp_count_encoding_b2d46040/valid.h5
2022-11-28 21:45:22,828 P20633 INFO Train samples: total/681693, pos/470563, neg/211130, ratio/69.03%, blocks/1
2022-11-28 21:45:22,829 P20633 INFO Validation samples: total/170424, pos/117587, neg/52837, ratio/69.00%, blocks/1
2022-11-28 21:45:22,829 P20633 INFO Loading train data done.
2022-11-28 21:45:26,448 P20633 INFO Total number of parameters: 59431684.
2022-11-28 21:45:26,448 P20633 INFO Start training: 666 batches/epoch
2022-11-28 21:45:26,448 P20633 INFO ************ Epoch=1 start ************
  0%|          | 0/666 [00:00<?, ?it/s][2022-11-28 21:45:26.781 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:20633 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-11-28 21:45:26.813 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:20633 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/666 [00:01<12:37,  1.14s/it]  1%|          | 4/666 [00:01<02:47,  3.95it/s]  1%|          | 7/666 [00:01<01:32,  7.09it/s]  2%|▏         | 10/666 [00:01<01:04, 10.11it/s]  2%|▏         | 13/666 [00:01<00:50, 12.82it/s]  2%|▏         | 16/666 [00:01<00:42, 15.14it/s]  3%|▎         | 19/666 [00:01<00:37, 17.08it/s]  3%|▎         | 22/666 [00:02<00:34, 18.53it/s]  4%|▍         | 25/666 [00:02<00:32, 19.72it/s]  4%|▍         | 28/666 [00:02<00:30, 20.61it/s]  5%|▍         | 31/666 [00:02<00:29, 21.26it/s]  5%|▌         | 34/666 [00:02<00:29, 21.72it/s]  6%|▌         | 37/666 [00:02<00:28, 22.06it/s]  6%|▌         | 40/666 [00:02<00:28, 22.29it/s]  6%|▋         | 43/666 [00:02<00:27, 22.46it/s]  7%|▋         | 46/666 [00:03<00:27, 22.58it/s]  7%|▋         | 49/666 [00:03<00:27, 22.66it/s]  8%|▊         | 52/666 [00:03<00:27, 22.73it/s]  8%|▊         | 55/666 [00:03<00:26, 22.77it/s]  9%|▊         | 58/666 [00:03<00:26, 22.80it/s]  9%|▉         | 61/666 [00:03<00:26, 22.82it/s] 10%|▉         | 64/666 [00:03<00:26, 22.82it/s] 10%|█         | 67/666 [00:04<00:26, 22.82it/s] 11%|█         | 70/666 [00:04<00:26, 22.83it/s] 11%|█         | 73/666 [00:04<00:25, 22.84it/s] 11%|█▏        | 76/666 [00:04<00:25, 22.85it/s] 12%|█▏        | 79/666 [00:04<00:25, 22.86it/s] 12%|█▏        | 82/666 [00:04<00:25, 22.86it/s] 13%|█▎        | 85/666 [00:04<00:25, 22.85it/s] 13%|█▎        | 88/666 [00:04<00:25, 22.86it/s] 14%|█▎        | 91/666 [00:05<00:25, 22.87it/s] 14%|█▍        | 94/666 [00:05<00:25, 22.87it/s] 15%|█▍        | 97/666 [00:05<00:24, 22.88it/s] 15%|█▌        | 100/666 [00:05<00:24, 22.87it/s] 15%|█▌        | 103/666 [00:05<00:24, 22.87it/s] 16%|█▌        | 106/666 [00:05<00:24, 22.88it/s] 16%|█▋        | 109/666 [00:05<00:24, 22.86it/s] 17%|█▋        | 112/666 [00:06<00:24, 22.86it/s] 17%|█▋        | 115/666 [00:06<00:24, 22.86it/s] 18%|█▊        | 118/666 [00:06<00:23, 22.86it/s] 18%|█▊        | 121/666 [00:06<00:23, 22.87it/s] 19%|█▊        | 124/666 [00:06<00:23, 22.87it/s] 19%|█▉        | 127/666 [00:06<00:23, 22.86it/s] 20%|█▉        | 130/666 [00:06<00:23, 22.86it/s] 20%|█▉        | 133/666 [00:06<00:23, 22.84it/s] 20%|██        | 136/666 [00:07<00:23, 22.85it/s] 21%|██        | 139/666 [00:07<00:23, 22.86it/s] 21%|██▏       | 142/666 [00:07<00:22, 22.85it/s] 22%|██▏       | 145/666 [00:07<00:22, 22.84it/s] 22%|██▏       | 148/666 [00:07<00:22, 22.84it/s] 23%|██▎       | 151/666 [00:07<00:22, 22.83it/s] 23%|██▎       | 154/666 [00:07<00:22, 22.84it/s] 24%|██▎       | 157/666 [00:07<00:22, 22.85it/s] 24%|██▍       | 160/666 [00:08<00:22, 22.85it/s] 24%|██▍       | 163/666 [00:08<00:22, 22.85it/s] 25%|██▍       | 166/666 [00:08<00:21, 22.85it/s] 25%|██▌       | 169/666 [00:08<00:21, 22.86it/s] 26%|██▌       | 172/666 [00:08<00:21, 22.86it/s] 26%|██▋       | 175/666 [00:08<00:21, 22.86it/s] 27%|██▋       | 178/666 [00:08<00:21, 22.85it/s] 27%|██▋       | 181/666 [00:09<00:21, 22.86it/s] 28%|██▊       | 184/666 [00:09<00:21, 22.85it/s] 28%|██▊       | 187/666 [00:09<00:20, 22.86it/s] 29%|██▊       | 190/666 [00:09<00:20, 22.85it/s] 29%|██▉       | 193/666 [00:09<00:20, 22.84it/s] 29%|██▉       | 196/666 [00:09<00:20, 22.83it/s] 30%|██▉       | 199/666 [00:09<00:20, 22.84it/s] 30%|███       | 202/666 [00:09<00:20, 22.84it/s] 31%|███       | 205/666 [00:10<00:20, 22.84it/s] 31%|███       | 208/666 [00:10<00:20, 22.85it/s] 32%|███▏      | 211/666 [00:10<00:19, 22.83it/s] 32%|███▏      | 214/666 [00:10<00:19, 22.83it/s] 33%|███▎      | 217/666 [00:10<00:19, 22.84it/s] 33%|███▎      | 220/666 [00:10<00:19, 22.84it/s] 33%|███▎      | 223/666 [00:10<00:19, 22.85it/s] 34%|███▍      | 226/666 [00:10<00:19, 22.86it/s] 34%|███▍      | 229/666 [00:11<00:19, 22.86it/s] 35%|███▍      | 232/666 [00:11<00:18, 22.85it/s] 35%|███▌      | 235/666 [00:11<00:18, 22.85it/s] 36%|███▌      | 238/666 [00:11<00:18, 22.83it/s] 36%|███▌      | 241/666 [00:11<00:18, 22.84it/s] 37%|███▋      | 244/666 [00:11<00:18, 22.85it/s] 37%|███▋      | 247/666 [00:11<00:18, 22.84it/s] 38%|███▊      | 250/666 [00:12<00:18, 22.85it/s] 38%|███▊      | 253/666 [00:12<00:18, 22.84it/s] 38%|███▊      | 256/666 [00:12<00:17, 22.84it/s] 39%|███▉      | 259/666 [00:12<00:17, 22.84it/s] 39%|███▉      | 262/666 [00:12<00:17, 22.85it/s] 40%|███▉      | 265/666 [00:12<00:17, 22.85it/s] 40%|████      | 268/666 [00:12<00:17, 22.86it/s] 41%|████      | 271/666 [00:12<00:17, 22.85it/s] 41%|████      | 274/666 [00:13<00:17, 22.84it/s] 42%|████▏     | 277/666 [00:13<00:17, 22.84it/s] 42%|████▏     | 280/666 [00:13<00:16, 22.85it/s] 42%|████▏     | 283/666 [00:13<00:16, 22.85it/s] 43%|████▎     | 286/666 [00:13<00:16, 22.85it/s] 43%|████▎     | 289/666 [00:13<00:16, 22.85it/s] 44%|████▍     | 292/666 [00:13<00:16, 22.85it/s] 44%|████▍     | 295/666 [00:14<00:16, 22.86it/s] 45%|████▍     | 298/666 [00:14<00:16, 22.86it/s] 45%|████▌     | 301/666 [00:14<00:15, 22.86it/s] 46%|████▌     | 304/666 [00:14<00:15, 22.86it/s] 46%|████▌     | 307/666 [00:14<00:15, 22.84it/s] 47%|████▋     | 310/666 [00:14<00:15, 22.85it/s] 47%|████▋     | 313/666 [00:14<00:15, 22.85it/s] 47%|████▋     | 316/666 [00:14<00:15, 22.84it/s] 48%|████▊     | 319/666 [00:15<00:15, 22.83it/s] 48%|████▊     | 322/666 [00:15<00:15, 22.84it/s] 49%|████▉     | 325/666 [00:15<00:14, 22.84it/s] 49%|████▉     | 328/666 [00:15<00:14, 22.85it/s] 50%|████▉     | 331/666 [00:15<00:14, 22.86it/s] 50%|█████     | 334/666 [00:15<00:14, 22.83it/s] 51%|█████     | 337/666 [00:15<00:14, 22.84it/s] 51%|█████     | 340/666 [00:15<00:14, 22.85it/s] 52%|█████▏    | 343/666 [00:16<00:14, 22.85it/s] 52%|█████▏    | 346/666 [00:16<00:13, 22.86it/s] 52%|█████▏    | 349/666 [00:16<00:13, 22.86it/s] 53%|█████▎    | 352/666 [00:16<00:13, 22.85it/s] 53%|█████▎    | 355/666 [00:16<00:13, 22.84it/s] 54%|█████▍    | 358/666 [00:16<00:13, 22.84it/s] 54%|█████▍    | 361/666 [00:16<00:13, 22.85it/s] 55%|█████▍    | 364/666 [00:17<00:13, 22.85it/s] 55%|█████▌    | 367/666 [00:17<00:13, 22.85it/s] 56%|█████▌    | 370/666 [00:17<00:12, 22.85it/s] 56%|█████▌    | 373/666 [00:17<00:12, 22.85it/s] 56%|█████▋    | 376/666 [00:17<00:12, 22.84it/s] 57%|█████▋    | 379/666 [00:17<00:12, 22.85it/s] 57%|█████▋    | 382/666 [00:17<00:12, 22.85it/s] 58%|█████▊    | 385/666 [00:17<00:12, 22.86it/s] 58%|█████▊    | 388/666 [00:18<00:12, 22.85it/s] 59%|█████▊    | 391/666 [00:18<00:12, 22.85it/s] 59%|█████▉    | 394/666 [00:18<00:11, 22.85it/s] 60%|█████▉    | 397/666 [00:18<00:11, 22.86it/s] 60%|██████    | 400/666 [00:18<00:11, 22.85it/s] 61%|██████    | 403/666 [00:18<00:11, 22.84it/s] 61%|██████    | 406/666 [00:18<00:11, 22.85it/s] 61%|██████▏   | 409/666 [00:19<00:11, 22.85it/s] 62%|██████▏   | 412/666 [00:19<00:11, 22.85it/s] 62%|██████▏   | 415/666 [00:19<00:10, 22.85it/s] 63%|██████▎   | 418/666 [00:19<00:10, 22.85it/s] 63%|██████▎   | 421/666 [00:19<00:10, 22.85it/s] 64%|██████▎   | 424/666 [00:19<00:10, 22.86it/s] 64%|██████▍   | 427/666 [00:19<00:10, 22.85it/s] 65%|██████▍   | 430/666 [00:19<00:10, 22.86it/s] 65%|██████▌   | 433/666 [00:20<00:10, 22.85it/s] 65%|██████▌   | 436/666 [00:20<00:10, 22.84it/s] 66%|██████▌   | 439/666 [00:20<00:09, 22.84it/s] 66%|██████▋   | 442/666 [00:20<00:09, 22.84it/s] 67%|██████▋   | 445/666 [00:20<00:09, 22.84it/s] 67%|██████▋   | 448/666 [00:20<00:09, 22.85it/s] 68%|██████▊   | 451/666 [00:20<00:09, 22.83it/s] 68%|██████▊   | 454/666 [00:20<00:09, 22.80it/s] 69%|██████▊   | 457/666 [00:21<00:09, 22.81it/s] 69%|██████▉   | 460/666 [00:21<00:09, 22.81it/s] 70%|██████▉   | 463/666 [00:21<00:08, 22.83it/s] 70%|██████▉   | 466/666 [00:21<00:08, 22.82it/s] 70%|███████   | 469/666 [00:21<00:08, 22.83it/s] 71%|███████   | 472/666 [00:21<00:08, 22.82it/s] 71%|███████▏  | 475/666 [00:21<00:08, 22.82it/s] 72%|███████▏  | 478/666 [00:22<00:08, 22.82it/s] 72%|███████▏  | 481/666 [00:22<00:08, 22.83it/s] 73%|███████▎  | 484/666 [00:22<00:07, 22.84it/s] 73%|███████▎  | 487/666 [00:22<00:07, 22.84it/s] 74%|███████▎  | 490/666 [00:22<00:07, 22.85it/s] 74%|███████▍  | 493/666 [00:22<00:07, 22.85it/s] 74%|███████▍  | 496/666 [00:22<00:07, 22.84it/s] 75%|███████▍  | 499/666 [00:22<00:07, 22.83it/s] 75%|███████▌  | 502/666 [00:23<00:07, 22.82it/s] 76%|███████▌  | 505/666 [00:23<00:07, 22.83it/s] 76%|███████▋  | 508/666 [00:23<00:06, 22.82it/s] 77%|███████▋  | 511/666 [00:23<00:06, 22.84it/s] 77%|███████▋  | 514/666 [00:23<00:06, 22.83it/s] 78%|███████▊  | 517/666 [00:23<00:06, 22.83it/s] 78%|███████▊  | 520/666 [00:23<00:06, 22.83it/s] 79%|███████▊  | 523/666 [00:24<00:06, 22.83it/s] 79%|███████▉  | 526/666 [00:24<00:06, 22.84it/s] 79%|███████▉  | 529/666 [00:24<00:06, 22.83it/s] 80%|███████▉  | 532/666 [00:24<00:05, 22.82it/s] 80%|████████  | 535/666 [00:24<00:05, 22.83it/s] 81%|████████  | 538/666 [00:24<00:05, 22.80it/s] 81%|████████  | 541/666 [00:24<00:05, 22.77it/s] 82%|████████▏ | 544/666 [00:24<00:05, 22.82it/s] 82%|████████▏ | 547/666 [00:25<00:05, 22.82it/s] 83%|████████▎ | 550/666 [00:25<00:05, 22.83it/s] 83%|████████▎ | 553/666 [00:25<00:04, 22.84it/s] 83%|████████▎ | 556/666 [00:25<00:04, 22.85it/s] 84%|████████▍ | 559/666 [00:25<00:04, 22.84it/s] 84%|████████▍ | 562/666 [00:25<00:04, 22.84it/s] 85%|████████▍ | 565/666 [00:25<00:04, 22.84it/s] 85%|████████▌ | 568/666 [00:25<00:04, 22.84it/s] 86%|████████▌ | 571/666 [00:26<00:04, 22.83it/s] 86%|████████▌ | 574/666 [00:26<00:04, 22.84it/s] 87%|████████▋ | 577/666 [00:26<00:03, 22.82it/s] 87%|████████▋ | 580/666 [00:26<00:03, 22.80it/s] 88%|████████▊ | 583/666 [00:26<00:03, 22.81it/s] 88%|████████▊ | 586/666 [00:26<00:03, 22.81it/s] 88%|████████▊ | 589/666 [00:26<00:03, 22.81it/s] 89%|████████▉ | 592/666 [00:27<00:03, 22.82it/s] 89%|████████▉ | 595/666 [00:27<00:03, 22.81it/s] 90%|████████▉ | 598/666 [00:27<00:02, 22.82it/s] 90%|█████████ | 601/666 [00:27<00:02, 22.82it/s] 91%|█████████ | 604/666 [00:27<00:02, 22.83it/s] 91%|█████████ | 607/666 [00:27<00:02, 22.83it/s] 92%|█████████▏| 610/666 [00:27<00:02, 22.84it/s] 92%|█████████▏| 613/666 [00:27<00:02, 22.83it/s] 92%|█████████▏| 616/666 [00:28<00:02, 22.84it/s] 93%|█████████▎| 619/666 [00:28<00:02, 22.84it/s] 93%|█████████▎| 622/666 [00:28<00:01, 22.83it/s] 94%|█████████▍| 625/666 [00:28<00:01, 22.82it/s] 94%|█████████▍| 628/666 [00:28<00:01, 22.82it/s] 95%|█████████▍| 631/666 [00:28<00:01, 22.82it/s] 95%|█████████▌| 634/666 [00:28<00:01, 22.80it/s] 96%|█████████▌| 637/666 [00:28<00:01, 22.82it/s] 96%|█████████▌| 640/666 [00:29<00:01, 22.82it/s] 97%|█████████▋| 643/666 [00:29<00:01, 22.83it/s] 97%|█████████▋| 646/666 [00:29<00:00, 22.83it/s] 97%|█████████▋| 649/666 [00:29<00:00, 22.83it/s] 98%|█████████▊| 652/666 [00:29<00:00, 22.83it/s] 98%|█████████▊| 655/666 [00:29<00:00, 22.83it/s] 99%|█████████▉| 658/666 [00:29<00:00, 22.83it/s] 99%|█████████▉| 661/666 [00:30<00:00, 22.47it/s]100%|█████████▉| 664/666 [00:30<00:00, 22.62it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  2%|▏         | 3/167 [00:00<00:06, 26.31it/s][A
  6%|▌         | 10/167 [00:00<00:03, 50.49it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 127.44it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 164.58it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 184.84it/s][A
 60%|██████    | 101/167 [00:00<00:00, 196.29it/s][A
 74%|███████▍  | 124/167 [00:00<00:00, 205.09it/s][A
 88%|████████▊ | 147/167 [00:00<00:00, 210.31it/s][A100%|██████████| 167/167 [00:00<00:00, 173.47it/s]
2022-11-28 21:45:57,793 P20633 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:45:57,794 P20633 INFO Save best model: monitor(max): -4.497136
2022-11-28 21:46:00,226 P20633 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:33<00:00, 19.70it/s]
2022-11-28 21:46:00,261 P20633 INFO Train loss: 32.320848
2022-11-28 21:46:00,262 P20633 INFO ************ Epoch=1 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:07,  5.23it/s]  1%|          | 4/666 [00:00<00:48, 13.52it/s]  1%|          | 7/666 [00:00<00:38, 17.09it/s]  2%|▏         | 10/666 [00:00<00:34, 19.04it/s]  2%|▏         | 13/666 [00:00<00:32, 20.30it/s]  2%|▏         | 16/666 [00:00<00:30, 21.13it/s]  3%|▎         | 19/666 [00:00<00:29, 21.68it/s]  3%|▎         | 22/666 [00:01<00:29, 22.04it/s]  4%|▍         | 25/666 [00:01<00:28, 22.27it/s]  4%|▍         | 28/666 [00:01<00:28, 22.44it/s]  5%|▍         | 31/666 [00:01<00:28, 22.51it/s]  5%|▌         | 34/666 [00:01<00:28, 22.56it/s]  6%|▌         | 37/666 [00:01<00:27, 22.64it/s]  6%|▌         | 40/666 [00:01<00:27, 22.70it/s]  6%|▋         | 43/666 [00:02<00:27, 22.72it/s]  7%|▋         | 46/666 [00:02<00:27, 22.75it/s]  7%|▋         | 49/666 [00:02<00:27, 22.76it/s]  8%|▊         | 52/666 [00:02<00:26, 22.79it/s]  8%|▊         | 55/666 [00:02<00:26, 22.80it/s]  9%|▊         | 58/666 [00:02<00:26, 22.80it/s]  9%|▉         | 61/666 [00:02<00:26, 22.81it/s] 10%|▉         | 64/666 [00:02<00:26, 22.82it/s] 10%|█         | 67/666 [00:03<00:26, 22.82it/s] 11%|█         | 70/666 [00:03<00:26, 22.82it/s] 11%|█         | 73/666 [00:03<00:25, 22.84it/s] 11%|█▏        | 76/666 [00:03<00:25, 22.83it/s] 12%|█▏        | 79/666 [00:03<00:25, 22.83it/s] 12%|█▏        | 82/666 [00:03<00:25, 22.82it/s] 13%|█▎        | 85/666 [00:03<00:25, 22.83it/s] 13%|█▎        | 88/666 [00:04<00:25, 22.83it/s] 14%|█▎        | 91/666 [00:04<00:25, 22.84it/s] 14%|█▍        | 94/666 [00:04<00:25, 22.85it/s] 15%|█▍        | 97/666 [00:04<00:24, 22.84it/s] 15%|█▌        | 100/666 [00:04<00:24, 22.83it/s] 15%|█▌        | 103/666 [00:04<00:24, 22.83it/s] 16%|█▌        | 106/666 [00:04<00:24, 22.82it/s] 16%|█▋        | 109/666 [00:04<00:24, 22.83it/s] 17%|█▋        | 112/666 [00:05<00:24, 22.83it/s] 17%|█▋        | 115/666 [00:05<00:24, 22.84it/s] 18%|█▊        | 118/666 [00:05<00:24, 22.83it/s] 18%|█▊        | 121/666 [00:05<00:23, 22.83it/s] 19%|█▊        | 124/666 [00:05<00:23, 22.81it/s] 19%|█▉        | 127/666 [00:05<00:23, 22.82it/s] 20%|█▉        | 130/666 [00:05<00:23, 22.82it/s] 20%|█▉        | 133/666 [00:05<00:23, 22.83it/s] 20%|██        | 136/666 [00:06<00:23, 22.84it/s] 21%|██        | 139/666 [00:06<00:23, 22.84it/s] 21%|██▏       | 142/666 [00:06<00:22, 22.84it/s] 22%|██▏       | 145/666 [00:06<00:22, 22.84it/s] 22%|██▏       | 148/666 [00:06<00:22, 22.83it/s] 23%|██▎       | 151/666 [00:06<00:22, 22.83it/s] 23%|██▎       | 154/666 [00:06<00:22, 22.83it/s] 24%|██▎       | 157/666 [00:07<00:22, 22.83it/s] 24%|██▍       | 160/666 [00:07<00:22, 22.81it/s] 24%|██▍       | 163/666 [00:07<00:22, 22.81it/s] 25%|██▍       | 166/666 [00:07<00:21, 22.81it/s] 25%|██▌       | 169/666 [00:07<00:21, 22.82it/s] 26%|██▌       | 172/666 [00:07<00:21, 22.82it/s] 26%|██▋       | 175/666 [00:07<00:21, 22.82it/s] 27%|██▋       | 178/666 [00:07<00:21, 22.83it/s] 27%|██▋       | 181/666 [00:08<00:21, 22.83it/s] 28%|██▊       | 184/666 [00:08<00:21, 22.83it/s] 28%|██▊       | 187/666 [00:08<00:20, 22.83it/s] 29%|██▊       | 190/666 [00:08<00:20, 22.84it/s] 29%|██▉       | 193/666 [00:08<00:20, 22.82it/s] 29%|██▉       | 196/666 [00:08<00:20, 22.83it/s] 30%|██▉       | 199/666 [00:08<00:20, 22.84it/s] 30%|███       | 202/666 [00:09<00:20, 22.83it/s] 31%|███       | 205/666 [00:09<00:20, 22.83it/s] 31%|███       | 208/666 [00:09<00:20, 22.83it/s] 32%|███▏      | 211/666 [00:09<00:19, 22.83it/s] 32%|███▏      | 214/666 [00:09<00:19, 22.83it/s] 33%|███▎      | 217/666 [00:09<00:19, 22.84it/s] 33%|███▎      | 220/666 [00:09<00:19, 22.84it/s] 33%|███▎      | 223/666 [00:09<00:19, 22.83it/s] 34%|███▍      | 226/666 [00:10<00:19, 22.83it/s] 34%|███▍      | 229/666 [00:10<00:19, 22.82it/s] 35%|███▍      | 232/666 [00:10<00:19, 22.82it/s] 35%|███▌      | 235/666 [00:10<00:18, 22.82it/s] 36%|███▌      | 238/666 [00:10<00:18, 22.83it/s] 36%|███▌      | 241/666 [00:10<00:18, 22.82it/s] 37%|███▋      | 244/666 [00:10<00:18, 22.83it/s] 37%|███▋      | 247/666 [00:10<00:18, 22.82it/s] 38%|███▊      | 250/666 [00:11<00:18, 22.82it/s] 38%|███▊      | 253/666 [00:11<00:18, 22.82it/s] 38%|███▊      | 256/666 [00:11<00:17, 22.83it/s] 39%|███▉      | 259/666 [00:11<00:17, 22.84it/s] 39%|███▉      | 262/666 [00:11<00:17, 22.83it/s] 40%|███▉      | 265/666 [00:11<00:17, 22.82it/s] 40%|████      | 268/666 [00:11<00:17, 22.82it/s] 41%|████      | 271/666 [00:12<00:17, 22.82it/s] 41%|████      | 274/666 [00:12<00:17, 22.81it/s] 42%|████▏     | 277/666 [00:12<00:17, 22.82it/s] 42%|████▏     | 280/666 [00:12<00:16, 22.84it/s] 42%|████▏     | 283/666 [00:12<00:16, 22.84it/s] 43%|████▎     | 286/666 [00:12<00:16, 22.83it/s] 43%|████▎     | 289/666 [00:12<00:16, 22.82it/s] 44%|████▍     | 292/666 [00:12<00:16, 22.83it/s] 44%|████▍     | 295/666 [00:13<00:16, 22.83it/s] 45%|████▍     | 298/666 [00:13<00:16, 22.82it/s] 45%|████▌     | 301/666 [00:13<00:15, 22.83it/s] 46%|████▌     | 304/666 [00:13<00:15, 22.84it/s] 46%|████▌     | 307/666 [00:13<00:15, 22.82it/s] 47%|████▋     | 310/666 [00:13<00:15, 22.82it/s] 47%|████▋     | 313/666 [00:13<00:15, 22.81it/s] 47%|████▋     | 316/666 [00:14<00:15, 22.81it/s] 48%|████▊     | 319/666 [00:14<00:15, 22.82it/s] 48%|████▊     | 322/666 [00:14<00:15, 22.83it/s] 49%|████▉     | 325/666 [00:14<00:14, 22.83it/s] 49%|████▉     | 328/666 [00:14<00:14, 22.83it/s] 50%|████▉     | 331/666 [00:14<00:14, 22.82it/s] 50%|█████     | 334/666 [00:14<00:14, 22.83it/s] 51%|█████     | 337/666 [00:14<00:14, 22.83it/s] 51%|█████     | 340/666 [00:15<00:14, 22.83it/s] 52%|█████▏    | 343/666 [00:15<00:14, 22.84it/s] 52%|█████▏    | 346/666 [00:15<00:14, 22.83it/s] 52%|█████▏    | 349/666 [00:15<00:13, 22.83it/s] 53%|█████▎    | 352/666 [00:15<00:13, 22.83it/s] 53%|█████▎    | 355/666 [00:15<00:13, 22.82it/s] 54%|█████▍    | 358/666 [00:15<00:13, 22.82it/s] 54%|█████▍    | 361/666 [00:15<00:13, 22.83it/s] 55%|█████▍    | 364/666 [00:16<00:13, 22.84it/s] 55%|█████▌    | 367/666 [00:16<00:13, 22.85it/s] 56%|█████▌    | 370/666 [00:16<00:12, 22.83it/s] 56%|█████▌    | 373/666 [00:16<00:12, 22.83it/s] 56%|█████▋    | 376/666 [00:16<00:12, 22.83it/s] 57%|█████▋    | 379/666 [00:16<00:12, 22.84it/s] 57%|█████▋    | 382/666 [00:16<00:12, 22.84it/s] 58%|█████▊    | 385/666 [00:17<00:12, 22.83it/s] 58%|█████▊    | 388/666 [00:17<00:12, 22.82it/s] 59%|█████▊    | 391/666 [00:17<00:12, 22.82it/s] 59%|█████▉    | 394/666 [00:17<00:11, 22.82it/s] 60%|█████▉    | 397/666 [00:17<00:11, 22.82it/s] 60%|██████    | 400/666 [00:17<00:11, 22.79it/s] 61%|██████    | 403/666 [00:17<00:11, 22.79it/s] 61%|██████    | 406/666 [00:17<00:11, 22.80it/s] 61%|██████▏   | 409/666 [00:18<00:11, 22.82it/s] 62%|██████▏   | 412/666 [00:18<00:11, 22.81it/s] 62%|██████▏   | 415/666 [00:18<00:11, 22.81it/s] 63%|██████▎   | 418/666 [00:18<00:10, 22.81it/s] 63%|██████▎   | 421/666 [00:18<00:10, 22.81it/s] 64%|██████▎   | 424/666 [00:18<00:10, 22.81it/s] 64%|██████▍   | 427/666 [00:18<00:10, 22.82it/s] 65%|██████▍   | 430/666 [00:19<00:10, 22.82it/s] 65%|██████▌   | 433/666 [00:19<00:10, 22.83it/s] 65%|██████▌   | 436/666 [00:19<00:10, 22.82it/s] 66%|██████▌   | 439/666 [00:19<00:09, 22.83it/s] 66%|██████▋   | 442/666 [00:19<00:09, 22.83it/s] 67%|██████▋   | 445/666 [00:19<00:09, 22.83it/s] 67%|██████▋   | 448/666 [00:19<00:09, 22.82it/s] 68%|██████▊   | 451/666 [00:19<00:09, 22.83it/s] 68%|██████▊   | 454/666 [00:20<00:09, 22.84it/s] 69%|██████▊   | 457/666 [00:20<00:09, 22.84it/s] 69%|██████▉   | 460/666 [00:20<00:09, 22.84it/s] 70%|██████▉   | 463/666 [00:20<00:08, 22.83it/s] 70%|██████▉   | 466/666 [00:20<00:08, 22.83it/s] 70%|███████   | 469/666 [00:20<00:08, 22.84it/s] 71%|███████   | 472/666 [00:20<00:08, 22.83it/s] 71%|███████▏  | 475/666 [00:20<00:08, 22.83it/s] 72%|███████▏  | 478/666 [00:21<00:08, 22.82it/s] 72%|███████▏  | 481/666 [00:21<00:08, 22.82it/s] 73%|███████▎  | 484/666 [00:21<00:07, 22.82it/s] 73%|███████▎  | 487/666 [00:21<00:07, 22.82it/s] 74%|███████▎  | 490/666 [00:21<00:07, 22.83it/s] 74%|███████▍  | 493/666 [00:21<00:07, 22.84it/s] 74%|███████▍  | 496/666 [00:21<00:07, 22.83it/s] 75%|███████▍  | 499/666 [00:22<00:07, 22.83it/s] 75%|███████▌  | 502/666 [00:22<00:07, 22.83it/s] 76%|███████▌  | 505/666 [00:22<00:07, 22.83it/s] 76%|███████▋  | 508/666 [00:22<00:06, 22.84it/s] 77%|███████▋  | 511/666 [00:22<00:06, 22.86it/s] 77%|███████▋  | 514/666 [00:22<00:06, 22.84it/s] 78%|███████▊  | 517/666 [00:22<00:06, 22.83it/s] 78%|███████▊  | 520/666 [00:22<00:06, 22.82it/s] 79%|███████▊  | 523/666 [00:23<00:06, 22.82it/s] 79%|███████▉  | 526/666 [00:23<00:06, 22.82it/s] 79%|███████▉  | 529/666 [00:23<00:06, 22.83it/s] 80%|███████▉  | 532/666 [00:23<00:05, 22.83it/s] 80%|████████  | 535/666 [00:23<00:05, 22.74it/s] 81%|████████  | 538/666 [00:23<00:05, 22.75it/s] 81%|████████  | 541/666 [00:23<00:05, 22.78it/s] 82%|████████▏ | 544/666 [00:23<00:05, 22.79it/s] 82%|████████▏ | 547/666 [00:24<00:05, 22.80it/s] 83%|████████▎ | 550/666 [00:24<00:05, 22.80it/s] 83%|████████▎ | 553/666 [00:24<00:04, 22.81it/s] 83%|████████▎ | 556/666 [00:24<00:04, 22.82it/s] 84%|████████▍ | 559/666 [00:24<00:04, 22.82it/s] 84%|████████▍ | 562/666 [00:24<00:04, 22.84it/s] 85%|████████▍ | 565/666 [00:24<00:04, 22.83it/s] 85%|████████▌ | 568/666 [00:25<00:04, 22.84it/s] 86%|████████▌ | 571/666 [00:25<00:04, 22.83it/s] 86%|████████▌ | 574/666 [00:25<00:04, 22.84it/s] 87%|████████▋ | 577/666 [00:25<00:03, 22.84it/s] 87%|████████▋ | 580/666 [00:25<00:03, 22.84it/s] 88%|████████▊ | 583/666 [00:25<00:03, 22.84it/s] 88%|████████▊ | 586/666 [00:25<00:03, 22.85it/s] 88%|████████▊ | 589/666 [00:25<00:03, 22.85it/s] 89%|████████▉ | 592/666 [00:26<00:03, 22.84it/s] 89%|████████▉ | 595/666 [00:26<00:03, 22.83it/s] 90%|████████▉ | 598/666 [00:26<00:02, 22.84it/s] 90%|█████████ | 601/666 [00:26<00:02, 22.84it/s] 91%|█████████ | 604/666 [00:26<00:02, 22.84it/s] 91%|█████████ | 607/666 [00:26<00:02, 22.84it/s] 92%|█████████▏| 610/666 [00:26<00:02, 22.84it/s] 92%|█████████▏| 613/666 [00:27<00:02, 22.84it/s] 92%|█████████▏| 616/666 [00:27<00:02, 22.82it/s] 93%|█████████▎| 619/666 [00:27<00:02, 22.83it/s] 93%|█████████▎| 622/666 [00:27<00:01, 22.84it/s] 94%|█████████▍| 625/666 [00:27<00:01, 22.85it/s] 94%|█████████▍| 628/666 [00:27<00:01, 22.84it/s] 95%|█████████▍| 631/666 [00:27<00:01, 22.84it/s] 95%|█████████▌| 634/666 [00:27<00:01, 22.82it/s] 96%|█████████▌| 637/666 [00:28<00:01, 22.83it/s] 96%|█████████▌| 640/666 [00:28<00:01, 22.84it/s] 97%|█████████▋| 643/666 [00:28<00:01, 22.84it/s] 97%|█████████▋| 646/666 [00:28<00:00, 22.84it/s] 97%|█████████▋| 649/666 [00:28<00:00, 22.85it/s] 98%|█████████▊| 652/666 [00:28<00:00, 22.84it/s] 98%|█████████▊| 655/666 [00:28<00:00, 22.84it/s] 99%|█████████▉| 658/666 [00:28<00:00, 22.83it/s] 99%|█████████▉| 661/666 [00:29<00:00, 22.53it/s]100%|█████████▉| 664/666 [00:29<00:00, 22.67it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:16,  9.93it/s][A
  6%|▌         | 10/167 [00:00<00:03, 44.20it/s][A
 20%|█▉        | 33/167 [00:00<00:01, 116.07it/s][A
 34%|███▎      | 56/167 [00:00<00:00, 155.09it/s][A
 47%|████▋     | 79/167 [00:00<00:00, 178.40it/s][A
 61%|██████    | 102/167 [00:00<00:00, 193.77it/s][A
 75%|███████▍  | 125/167 [00:00<00:00, 203.77it/s][A
 89%|████████▊ | 148/167 [00:00<00:00, 210.75it/s][A100%|██████████| 167/167 [00:00<00:00, 167.97it/s]
2022-11-28 21:46:30,710 P20633 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:46:30,711 P20633 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:46:30,711 P20633 INFO Reduce learning rate on plateau: 0.001000
2022-11-28 21:46:30,711 P20633 INFO --- 666/666 batches finished ---
100%|██████████| 666/666 [00:30<00:00, 21.84it/s]
2022-11-28 21:46:30,759 P20633 INFO Train loss: 30.971630
2022-11-28 21:46:30,759 P20633 INFO ************ Epoch=2 end ************
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<02:04,  5.33it/s]  1%|          | 4/666 [00:00<00:47, 13.96it/s]  1%|          | 7/666 [00:00<00:37, 17.71it/s]  2%|▏         | 10/666 [00:00<00:33, 19.52it/s]  2%|▏         | 13/666 [00:00<00:31, 20.64it/s]  2%|▏         | 16/666 [00:00<00:30, 21.36it/s]  3%|▎         | 19/666 [00:00<00:29, 21.82it/s]  3%|▎         | 22/666 [00:01<00:29, 22.13it/s]  4%|▍         | 25/666 [00:01<00:28, 22.35it/s]  4%|▍         | 28/666 [00:01<00:28, 22.30it/s]  5%|▍         | 31/666 [00:01<00:28, 22.26it/s]  5%|▌         | 34/666 [00:01<00:28, 22.22it/s]  6%|▌         | 37/666 [00:01<00:28, 22.21it/s]  6%|▌         | 40/666 [00:01<00:28, 22.21it/s]  6%|▋         | 43/666 [00:02<00:28, 22.20it/s]  7%|▋         | 46/666 [00:02<00:27, 22.19it/s]  7%|▋         | 49/666 [00:02<00:27, 22.20it/s]  8%|▊         | 52/666 [00:02<00:27, 22.20it/s]  8%|▊         | 55/666 [00:02<00:27, 22.20it/s]  9%|▊         | 58/666 [00:02<00:27, 22.20it/s]  9%|▉         | 61/666 [00:02<00:27, 22.21it/s] 10%|▉         | 64/666 [00:02<00:27, 22.21it/s] 10%|█         | 67/666 [00:03<00:26, 22.21it/s] 11%|█         | 70/666 [00:03<00:26, 22.19it/s] 11%|█         | 73/666 [00:03<00:26, 22.19it/s] 11%|█▏        | 76/666 [00:03<00:26, 22.20it/s] 12%|█▏        | 79/666 [00:03<00:26, 22.20it/s] 12%|█▏        | 82/666 [00:03<00:26, 22.19it/s] 13%|█▎        | 85/666 [00:03<00:26, 22.19it/s] 13%|█▎        | 88/666 [00:04<00:26, 22.18it/s] 14%|█▎        | 91/666 [00:04<00:25, 22.31it/s] 14%|█▍        | 94/666 [00:04<00:25, 22.47it/s] 15%|█▍        | 97/666 [00:04<00:25, 22.57it/s] 15%|█▌        | 100/666 [00:04<00:24, 22.64it/s] 15%|█▌        | 103/666 [00:04<00:24, 22.70it/s] 16%|█▌        | 106/666 [00:04<00:24, 22.73it/s] 16%|█▋        | 109/666 [00:05<00:24, 22.75it/s] 17%|█▋        | 112/666 [00:05<00:24, 22.77it/s] 17%|█▋        | 115/666 [00:05<00:24, 22.78it/s] 18%|█▊        | 118/666 [00:05<00:24, 22.79it/s] 18%|█▊        | 121/666 [00:05<00:23, 22.79it/s] 19%|█▊        | 124/666 [00:05<00:23, 22.79it/s] 19%|█▉        | 127/666 [00:05<00:23, 22.80it/s] 20%|█▉        | 130/666 [00:05<00:23, 22.81it/s] 20%|█▉        | 133/666 [00:06<00:23, 22.81it/s] 20%|██        | 136/666 [00:06<00:23, 22.80it/s] 21%|██        | 139/666 [00:06<00:23, 22.81it/s] 21%|██▏       | 142/666 [00:06<00:22, 22.80it/s] 22%|██▏       | 145/666 [00:06<00:22, 22.81it/s] 22%|██▏       | 148/666 [00:06<00:22, 22.81it/s] 23%|██▎       | 151/666 [00:06<00:22, 22.81it/s] 23%|██▎       | 154/666 [00:06<00:22, 22.81it/s] 24%|██▎       | 157/666 [00:07<00:22, 22.81it/s] 24%|██▍       | 160/666 [00:07<00:22, 22.80it/s] 24%|██▍       | 163/666 [00:07<00:22, 22.81it/s] 25%|██▍       | 166/666 [00:07<00:21, 22.82it/s] 25%|██▌       | 169/666 [00:07<00:21, 22.82it/s] 26%|██▌       | 172/666 [00:07<00:21, 22.81it/s] 26%|██▋       | 175/666 [00:07<00:21, 22.82it/s] 27%|██▋       | 178/666 [00:08<00:21, 22.82it/s] 27%|██▋       | 181/666 [00:08<00:21, 22.81it/s] 28%|██▊       | 184/666 [00:08<00:21, 22.80it/s] 28%|██▊       | 187/666 [00:08<00:20, 22.82it/s] 29%|██▊       | 190/666 [00:08<00:20, 22.82it/s] 29%|██▉       | 193/666 [00:08<00:20, 22.81it/s] 29%|██▉       | 196/666 [00:08<00:20, 22.81it/s] 30%|██▉       | 199/666 [00:08<00:20, 22.79it/s] 30%|███       | 202/666 [00:09<00:20, 22.78it/s] 31%|███       | 205/666 [00:09<00:20, 22.78it/s] 31%|███       | 208/666 [00:09<00:20, 22.79it/s] 32%|███▏      | 211/666 [00:09<00:19, 22.80it/s] 32%|███▏      | 214/666 [00:09<00:19, 22.79it/s] 33%|███▎      | 217/666 [00:09<00:19, 22.80it/s] 33%|███▎      | 220/666 [00:09<00:19, 22.82it/s] 33%|███▎      | 223/666 [00:10<00:19, 22.82it/s] 34%|███▍      | 226/666 [00:10<00:19, 22.82it/s] 34%|███▍      | 229/666 [00:10<00:19, 22.81it/s] 35%|███▍      | 232/666 [00:10<00:19, 22.80it/s] 35%|███▌      | 235/666 [00:10<00:18, 22.79it/s] 36%|███▌      | 238/666 [00:10<00:18, 22.79it/s] 36%|███▌      | 241/666 [00:10<00:18, 22.79it/s] 37%|███▋      | 244/666 [00:10<00:18, 22.80it/s] 37%|███▋      | 247/666 [00:11<00:18, 22.71it/s] 38%|███▊      | 250/666 [00:11<00:18, 22.64it/s] 38%|███▊      | 253/666 [00:11<00:18, 22.60it/s] 38%|███▊      | 256/666 [00:11<00:18, 22.58it/s] 39%|███▉      | 259/666 [00:11<00:18, 22.55it/s] 39%|███▉      | 262/666 [00:11<00:17, 22.53it/s] 40%|███▉      | 265/666 [00:11<00:17, 22.53it/s] 40%|████      | 268/666 [00:11<00:17, 22.52it/s] 41%|████      | 271/666 [00:12<00:17, 22.51it/s] 41%|████      | 274/666 [00:12<00:17, 22.51it/s] 42%|████▏     | 277/666 [00:12<00:17, 22.50it/s] 42%|████▏     | 280/666 [00:12<00:17, 22.51it/s] 42%|████▏     | 283/666 [00:12<00:17, 22.51it/s] 43%|████▎     | 286/666 [00:12<00:16, 22.51it/s] 43%|████▎     | 289/666 [00:12<00:16, 22.51it/s] 44%|████▍     | 292/666 [00:13<00:16, 22.52it/s] 44%|████▍     | 295/666 [00:13<00:16, 22.51it/s] 45%|████▍     | 298/666 [00:13<00:16, 22.51it/s] 45%|████▌     | 301/666 [00:13<00:16, 22.52it/s] 46%|████▌     | 304/666 [00:13<00:16, 22.51it/s] 46%|████▌     | 307/666 [00:13<00:15, 22.50it/s] 47%|████▋     | 310/666 [00:13<00:15, 22.51it/s] 47%|████▋     | 313/666 [00:13<00:15, 22.51it/s] 47%|████▋     | 316/666 [00:14<00:15, 22.52it/s] 48%|████▊     | 319/666 [00:14<00:15, 22.51it/s] 48%|████▊     | 322/666 [00:14<00:15, 22.51it/s] 49%|████▉     | 325/666 [00:14<00:15, 22.51it/s] 49%|████▉     | 328/666 [00:14<00:15, 22.50it/s] 50%|████▉     | 331/666 [00:14<00:14, 22.50it/s] 50%|█████     | 334/666 [00:14<00:14, 22.50it/s] 51%|█████     | 337/666 [00:15<00:14, 22.50it/s] 51%|█████     | 340/666 [00:15<00:14, 22.51it/s] 52%|█████▏    | 343/666 [00:15<00:14, 22.51it/s] 52%|█████▏    | 346/666 [00:15<00:14, 22.58it/s] 52%|█████▏    | 349/666 [00:15<00:13, 22.65it/s] 53%|█████▎    | 352/666 [00:15<00:13, 22.70it/s] 53%|█████▎    | 355/666 [00:15<00:13, 22.73it/s] 54%|█████▍    | 358/666 [00:15<00:13, 22.75it/s] 54%|█████▍    | 361/666 [00:16<00:13, 22.76it/s] 55%|█████▍    | 364/666 [00:16<00:13, 22.77it/s] 55%|█████▌    | 367/666 [00:16<00:13, 22.79it/s] 56%|█████▌    | 370/666 [00:16<00:12, 22.79it/s] 56%|█████▌    | 373/666 [00:16<00:12, 22.79it/s] 56%|█████▋    | 376/666 [00:16<00:12, 22.80it/s] 57%|█████▋    | 379/666 [00:16<00:12, 22.80it/s] 57%|█████▋    | 382/666 [00:17<00:12, 22.80it/s] 58%|█████▊    | 385/666 [00:17<00:12, 22.81it/s] 58%|█████▊    | 388/666 [00:17<00:12, 22.81it/s] 59%|█████▊    | 391/666 [00:17<00:12, 22.81it/s] 59%|█████▉    | 394/666 [00:17<00:11, 22.81it/s] 60%|█████▉    | 397/666 [00:17<00:11, 22.82it/s] 60%|██████    | 400/666 [00:17<00:11, 22.81it/s] 61%|██████    | 403/666 [00:17<00:11, 22.82it/s] 61%|██████    | 406/666 [00:18<00:11, 22.82it/s] 61%|██████▏   | 409/666 [00:18<00:11, 22.81it/s] 62%|██████▏   | 412/666 [00:18<00:11, 22.81it/s] 62%|██████▏   | 415/666 [00:18<00:11, 22.72it/s] 63%|██████▎   | 418/666 [00:18<00:10, 22.66it/s] 63%|██████▎   | 421/666 [00:18<00:10, 22.60it/s] 64%|██████▎   | 424/666 [00:18<00:10, 22.56it/s] 64%|██████▍   | 427/666 [00:19<00:10, 22.54it/s] 65%|██████▍   | 430/666 [00:19<00:10, 22.51it/s] 65%|██████▌   | 433/666 [00:19<00:10, 22.51it/s] 65%|██████▌   | 436/666 [00:19<00:10, 22.50it/s] 66%|██████▌   | 439/666 [00:19<00:10, 22.52it/s] 66%|██████▋   | 442/666 [00:19<00:09, 22.52it/s] 67%|██████▋   | 445/666 [00:19<00:09, 22.51it/s] 67%|██████▋   | 448/666 [00:19<00:09, 22.51it/s] 68%|██████▊   | 451/666 [00:20<00:09, 22.50it/s] 68%|██████▊   | 454/666 [00:20<00:09, 22.51it/s] 69%|██████▊   | 457/666 [00:20<00:09, 22.42it/s] 69%|██████▉   | 460/666 [00:20<00:09, 22.36it/s] 70%|██████▉   | 463/666 [00:20<00:09, 22.31it/s] 70%|██████▉   | 466/666 [00:20<00:08, 22.27it/s] 70%|███████   | 469/666 [00:20<00:08, 22.26it/s] 71%|███████   | 472/666 [00:21<00:08, 22.25it/s] 71%|███████▏  | 475/666 [00:21<00:08, 22.23it/s] 72%|███████▏  | 478/666 [00:21<00:08, 22.22it/s] 72%|███████▏  | 481/666 [00:21<00:08, 22.22it/s] 73%|███████▎  | 484/666 [00:21<00:08, 22.21it/s] 73%|███████▎  | 487/666 [00:21<00:08, 22.21it/s] 74%|███████▎  | 490/666 [00:21<00:07, 22.20it/s] 74%|███████▍  | 493/666 [00:21<00:07, 22.19it/s] 74%|███████▍  | 496/666 [00:22<00:07, 22.17it/s] 75%|███████▍  | 499/666 [00:22<00:07, 22.18it/s] 75%|███████▌  | 502/666 [00:22<00:07, 22.18it/s] 76%|███████▌  | 505/666 [00:22<00:07, 22.19it/s] 76%|███████▋  | 508/666 [00:22<00:07, 22.18it/s] 77%|███████▋  | 511/666 [00:22<00:06, 22.17it/s] 77%|███████▋  | 514/666 [00:22<00:06, 22.17it/s] 78%|███████▊  | 517/666 [00:23<00:06, 22.18it/s] 78%|███████▊  | 520/666 [00:23<00:06, 22.19it/s] 79%|███████▊  | 523/666 [00:23<00:06, 22.19it/s] 79%|███████▉  | 526/666 [00:23<00:06, 22.19it/s] 79%|███████▉  | 529/666 [00:23<00:06, 22.18it/s] 80%|███████▉  | 532/666 [00:23<00:06, 22.18it/s] 80%|████████  | 535/666 [00:23<00:05, 22.20it/s] 81%|████████  | 538/666 [00:23<00:05, 22.18it/s] 81%|████████  | 541/666 [00:24<00:05, 22.18it/s] 82%|████████▏ | 544/666 [00:24<00:05, 22.10it/s] 82%|████████▏ | 547/666 [00:24<00:05, 22.12it/s] 83%|████████▎ | 550/666 [00:24<00:05, 22.14it/s] 83%|████████▎ | 553/666 [00:24<00:05, 22.16it/s] 83%|████████▎ | 556/666 [00:24<00:04, 22.16it/s] 84%|████████▍ | 559/666 [00:24<00:04, 22.17it/s] 84%|████████▍ | 562/666 [00:25<00:04, 22.18it/s] 85%|████████▍ | 565/666 [00:25<00:04, 22.17it/s] 85%|████████▌ | 568/666 [00:25<00:04, 22.17it/s] 86%|████████▌ | 571/666 [00:25<00:04, 22.18it/s] 86%|████████▌ | 574/666 [00:25<00:04, 22.19it/s] 87%|████████▋ | 577/666 [00:25<00:04, 22.18it/s] 87%|████████▋ | 580/666 [00:25<00:03, 22.19it/s] 88%|████████▊ | 583/666 [00:26<00:03, 22.18it/s] 88%|████████▊ | 586/666 [00:26<00:03, 22.18it/s] 88%|████████▊ | 589/666 [00:26<00:03, 22.19it/s] 89%|████████▉ | 592/666 [00:26<00:03, 22.19it/s] 89%|████████▉ | 595/666 [00:26<00:03, 22.20it/s] 90%|████████▉ | 598/666 [00:26<00:03, 22.20it/s] 90%|█████████ | 601/666 [00:26<00:02, 22.21it/s] 91%|█████████ | 604/666 [00:26<00:02, 22.21it/s] 91%|█████████ | 607/666 [00:27<00:02, 22.20it/s] 92%|█████████▏| 610/666 [00:27<00:02, 22.19it/s] 92%|█████████▏| 613/666 [00:27<00:02, 22.19it/s] 92%|█████████▏| 616/666 [00:27<00:02, 22.18it/s] 93%|█████████▎| 619/666 [00:27<00:02, 22.18it/s] 93%|█████████▎| 622/666 [00:27<00:01, 22.17it/s] 94%|█████████▍| 625/666 [00:27<00:01, 22.18it/s] 94%|█████████▍| 628/666 [00:28<00:01, 22.18it/s] 95%|█████████▍| 631/666 [00:28<00:01, 22.18it/s] 95%|█████████▌| 634/666 [00:28<00:01, 22.18it/s] 96%|█████████▌| 637/666 [00:28<00:01, 22.19it/s] 96%|█████████▌| 640/666 [00:28<00:01, 22.18it/s] 97%|█████████▋| 643/666 [00:28<00:01, 22.18it/s] 97%|█████████▋| 646/666 [00:28<00:00, 22.19it/s] 97%|█████████▋| 649/666 [00:29<00:00, 22.18it/s] 98%|█████████▊| 652/666 [00:29<00:00, 22.18it/s] 98%|█████████▊| 655/666 [00:29<00:00, 22.18it/s] 99%|█████████▉| 658/666 [00:29<00:00, 22.18it/s] 99%|█████████▉| 661/666 [00:29<00:00, 21.91it/s]100%|█████████▉| 664/666 [00:29<00:00, 22.04it/s]
  0%|          | 0/167 [00:00<?, ?it/s][A
  1%|          | 1/167 [00:00<00:17,  9.74it/s][A
  6%|▌         | 10/167 [00:00<00:03, 51.26it/s][A
 19%|█▊        | 31/167 [00:00<00:01, 117.14it/s][A
 31%|███       | 52/167 [00:00<00:00, 149.63it/s][A
 44%|████▎     | 73/167 [00:00<00:00, 167.65it/s][A
 56%|█████▋    | 94/167 [00:00<00:00, 179.16it/s][A
 69%|██████▉   | 115/167 [00:00<00:00, 186.59it/s][A
 81%|████████▏ | 136/167 [00:00<00:00, 191.25it/s][A
 94%|█████████▍| 157/167 [00:00<00:00, 194.28it/s][A100%|██████████| 167/167 [00:01<00:00, 160.87it/s]
2022-11-28 21:47:01,681 P20633 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
2022-11-28 21:47:01,681 P20633 INFO Monitor(max) STOP: -4.497136 !
2022-11-28 21:47:01,681 P20633 INFO Reduce learning rate on plateau: 0.000100
2022-11-28 21:47:01,681 P20633 INFO Early stopping at epoch=3
2022-11-28 21:47:01,681 P20633 INFO --- 666/666 batches finished ---
100%|█████████▉| 665/666 [00:30<00:00, 21.48it/s]
2022-11-28 21:47:01,724 P20633 INFO Train loss: 30.971480
2022-11-28 21:47:01,724 P20633 INFO Training finished.
2022-11-28 21:47:01,724 P20633 INFO Load best model: /root/w210_proj/deepfm/models/yelp_count_encoding_b2d46040/DeepFM_yelp_count_encoding_024_2a861cab.model
2022-11-28 21:47:01,921 P20633 INFO ****** Validation evaluation ******
  0%|          | 0/666 [00:00<?, ?it/s]  0%|          | 1/666 [00:00<01:45,  6.28it/s]  2%|▏         | 10/666 [00:00<00:14, 44.69it/s]  5%|▍         | 31/666 [00:00<00:05, 109.05it/s]  8%|▊         | 53/666 [00:00<00:04, 146.98it/s] 11%|█▏        | 75/666 [00:00<00:03, 169.05it/s] 15%|█▍        | 97/666 [00:00<00:03, 183.89it/s] 18%|█▊        | 119/666 [00:00<00:02, 193.43it/s] 21%|██        | 141/666 [00:00<00:02, 199.73it/s] 24%|██▍       | 162/666 [00:00<00:02, 202.54it/s] 28%|██▊       | 184/666 [00:01<00:02, 205.75it/s] 31%|███       | 206/666 [00:01<00:02, 207.91it/s] 34%|███▍      | 228/666 [00:01<00:02, 209.39it/s] 38%|███▊      | 250/666 [00:01<00:01, 210.21it/s] 41%|████      | 272/666 [00:01<00:01, 210.85it/s] 44%|████▍     | 294/666 [00:01<00:01, 211.03it/s] 47%|████▋     | 316/666 [00:01<00:01, 211.02it/s] 51%|█████     | 338/666 [00:01<00:01, 210.98it/s] 54%|█████▍    | 360/666 [00:01<00:01, 211.25it/s] 57%|█████▋    | 382/666 [00:02<00:01, 211.56it/s] 61%|██████    | 404/666 [00:02<00:01, 211.63it/s] 64%|██████▍   | 426/666 [00:02<00:01, 211.10it/s] 67%|██████▋   | 448/666 [00:02<00:01, 211.20it/s] 71%|███████   | 470/666 [00:02<00:00, 211.47it/s] 74%|███████▍  | 492/666 [00:02<00:00, 211.33it/s] 77%|███████▋  | 514/666 [00:02<00:00, 210.69it/s] 80%|████████  | 536/666 [00:02<00:00, 211.02it/s] 84%|████████▍ | 558/666 [00:02<00:00, 211.18it/s] 87%|████████▋ | 580/666 [00:02<00:00, 208.19it/s] 90%|█████████ | 601/666 [00:03<00:00, 208.40it/s] 93%|█████████▎| 622/666 [00:03<00:00, 208.62it/s] 97%|█████████▋| 643/666 [00:03<00:00, 208.93it/s]100%|█████████▉| 664/666 [00:03<00:00, 205.62it/s]100%|██████████| 666/666 [00:03<00:00, 194.53it/s]
2022-11-28 21:47:05,797 P20633 INFO [Metrics] logloss: 4.992003 - AUC: 0.500000
  0%|          | 0/167 [00:00<?, ?it/s]  1%|          | 1/167 [00:00<00:16,  9.82it/s]  6%|▌         | 10/167 [00:00<00:03, 50.63it/s] 18%|█▊        | 30/167 [00:00<00:01, 113.15it/s] 30%|██▉       | 50/167 [00:00<00:00, 144.26it/s] 42%|████▏     | 70/167 [00:00<00:00, 161.81it/s] 54%|█████▍    | 90/167 [00:00<00:00, 174.15it/s] 66%|██████▌   | 110/167 [00:00<00:00, 181.83it/s] 78%|███████▊  | 130/167 [00:00<00:00, 187.13it/s] 90%|█████████ | 151/167 [00:00<00:00, 191.43it/s]100%|██████████| 167/167 [00:01<00:00, 157.55it/s]
2022-11-28 21:47:06,968 P20633 INFO [Metrics] logloss: 4.997136 - AUC: 0.500000
