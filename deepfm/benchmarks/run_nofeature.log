Enumerate all tuner configurations done.
2022-10-22 06:56:23,123 P132 INFO {
    "batch_norm": "True",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "16",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_001_c4d8d560",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 06:56:23,126 P132 INFO Set up feature encoder...
2022-10-22 06:56:23,127 P132 INFO Reading file: ../data/train.csv
2022-10-22 06:56:32,147 P132 INFO Reading file: ../data/valid.csv
2022-10-22 06:56:33,481 P132 INFO Preprocess feature columns...
2022-10-22 06:56:33,632 P132 INFO Fit feature encoder...
2022-10-22 06:56:33,632 P132 INFO Processing column: {'active': True, 'dtype': 'str', 'name': 'user_id', 'type': 'categorical'}
2022-10-22 06:56:34,359 P132 INFO Processing column: {'active': True, 'dtype': 'str', 'name': 'business_id', 'type': 'categorical'}
2022-10-22 06:56:34,438 P132 INFO Set feature index...
2022-10-22 06:56:34,439 P132 INFO Pickle feature_encoder: ../data/yelp_no_feature_3d3ae056/feature_encoder.pkl
2022-10-22 06:56:34,619 P132 INFO Save feature_map to json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 06:56:34,628 P132 INFO Set feature encoder done.
2022-10-22 06:56:34,628 P132 INFO Transform feature columns...
2022-10-22 06:56:35,127 P132 INFO Saving data to h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 06:56:35,326 P132 INFO Preprocess feature columns...
2022-10-22 06:56:35,364 P132 INFO Transform feature columns...
2022-10-22 06:56:35,486 P132 INFO Saving data to h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 06:56:35,581 P132 INFO Transform csv data to h5 done.
2022-10-22 06:56:35,581 P132 INFO Loading data...
2022-10-22 06:56:35,588 P132 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 06:56:35,680 P132 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 06:56:35,723 P132 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 06:56:35,723 P132 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 06:56:35,723 P132 INFO Loading train data done.
2022-10-22 06:56:38,318 P132 INFO Total number of parameters: 4164232.
2022-10-22 06:56:38,318 P132 INFO Start training: 669 batches/epoch
2022-10-22 06:56:38,318 P132 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 06:56:38.629 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:132 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 06:56:38.664 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:132 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:02<24:59,  2.24s/it]  1%|▏         | 10/669 [00:02<01:58,  5.56it/s]  3%|▎         | 20/669 [00:02<00:51, 12.70it/s]  4%|▍         | 30/669 [00:02<00:30, 21.19it/s]  6%|▌         | 41/669 [00:02<00:19, 31.75it/s]  8%|▊         | 53/669 [00:02<00:13, 44.32it/s] 10%|▉         | 65/669 [00:02<00:10, 57.03it/s] 12%|█▏        | 78/669 [00:03<00:08, 70.36it/s] 14%|█▎        | 91/669 [00:03<00:07, 82.20it/s] 16%|█▌        | 104/669 [00:03<00:06, 92.22it/s] 17%|█▋        | 117/669 [00:03<00:05, 100.31it/s] 19%|█▉        | 130/669 [00:03<00:05, 106.69it/s] 21%|██▏       | 143/669 [00:03<00:04, 111.61it/s] 23%|██▎       | 156/669 [00:03<00:04, 115.16it/s] 25%|██▌       | 169/669 [00:03<00:04, 117.63it/s] 27%|██▋       | 182/669 [00:03<00:04, 119.42it/s] 29%|██▉       | 195/669 [00:03<00:03, 120.68it/s] 31%|███       | 208/669 [00:04<00:03, 121.61it/s] 33%|███▎      | 221/669 [00:04<00:03, 122.17it/s] 35%|███▍      | 234/669 [00:04<00:03, 122.77it/s] 37%|███▋      | 247/669 [00:04<00:03, 123.22it/s] 39%|███▉      | 260/669 [00:04<00:03, 123.48it/s] 41%|████      | 273/669 [00:04<00:03, 123.59it/s] 43%|████▎     | 286/669 [00:04<00:03, 123.55it/s] 45%|████▍     | 299/669 [00:04<00:02, 123.70it/s] 47%|████▋     | 312/669 [00:04<00:02, 123.80it/s] 49%|████▊     | 325/669 [00:05<00:02, 123.72it/s] 51%|█████     | 338/669 [00:05<00:02, 123.70it/s] 52%|█████▏    | 351/669 [00:05<00:02, 123.83it/s] 54%|█████▍    | 364/669 [00:05<00:02, 123.98it/s] 56%|█████▋    | 377/669 [00:05<00:02, 123.97it/s] 58%|█████▊    | 390/669 [00:05<00:02, 123.74it/s] 60%|██████    | 403/669 [00:05<00:02, 123.82it/s] 62%|██████▏   | 416/669 [00:05<00:02, 124.03it/s] 64%|██████▍   | 429/669 [00:05<00:01, 123.96it/s] 66%|██████▌   | 442/669 [00:05<00:01, 123.85it/s] 68%|██████▊   | 455/669 [00:06<00:01, 123.88it/s] 70%|██████▉   | 468/669 [00:06<00:01, 124.00it/s] 72%|███████▏  | 481/669 [00:06<00:01, 124.20it/s] 74%|███████▍  | 494/669 [00:06<00:01, 124.22it/s] 76%|███████▌  | 507/669 [00:06<00:01, 124.06it/s] 78%|███████▊  | 520/669 [00:06<00:01, 124.01it/s] 80%|███████▉  | 533/669 [00:06<00:01, 123.98it/s] 82%|████████▏ | 546/669 [00:06<00:00, 123.74it/s] 84%|████████▎ | 559/669 [00:06<00:00, 123.36it/s] 86%|████████▌ | 572/669 [00:07<00:00, 123.35it/s] 87%|████████▋ | 585/669 [00:07<00:00, 123.29it/s] 89%|████████▉ | 598/669 [00:07<00:00, 123.30it/s] 91%|█████████▏| 611/669 [00:07<00:00, 123.49it/s] 93%|█████████▎| 624/669 [00:07<00:00, 123.42it/s] 95%|█████████▌| 637/669 [00:07<00:00, 123.30it/s] 97%|█████████▋| 650/669 [00:07<00:00, 123.46it/s] 99%|█████████▉| 663/669 [00:07<00:00, 121.48it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 4/168 [00:00<00:04, 39.58it/s][A
  9%|▉         | 15/168 [00:00<00:01, 79.91it/s][A
 29%|██▉       | 49/168 [00:00<00:00, 195.61it/s][A
 49%|████▉     | 83/168 [00:00<00:00, 249.32it/s][A
 70%|██████▉   | 117/168 [00:00<00:00, 280.34it/s][A
 90%|████████▉ | 151/168 [00:00<00:00, 299.64it/s][A100%|██████████| 168/168 [00:00<00:00, 242.11it/s]
2022-10-22 06:56:46,978 P132 INFO [Metrics] logloss: 0.539504 - AUC: 0.735648
2022-10-22 06:56:46,978 P132 INFO Save best model: monitor(max): 0.196144
2022-10-22 06:56:47,117 P132 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:08<00:00, 75.83it/s] 
2022-10-22 06:56:47,144 P132 INFO Train loss: 0.562533
2022-10-22 06:56:47,144 P132 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:41,  6.58it/s]  1%|          | 7/669 [00:00<00:20, 31.69it/s]  3%|▎         | 19/669 [00:00<00:09, 65.92it/s]  5%|▍         | 32/669 [00:00<00:07, 87.46it/s]  7%|▋         | 45/669 [00:00<00:06, 99.92it/s]  9%|▊         | 58/669 [00:00<00:05, 107.73it/s] 11%|█         | 71/669 [00:00<00:05, 112.85it/s] 13%|█▎        | 84/669 [00:00<00:05, 116.29it/s] 14%|█▍        | 97/669 [00:00<00:04, 118.35it/s] 16%|█▋        | 110/669 [00:01<00:04, 119.95it/s] 18%|█▊        | 123/669 [00:01<00:04, 121.07it/s] 20%|██        | 136/669 [00:01<00:04, 121.61it/s] 22%|██▏       | 149/669 [00:01<00:04, 122.30it/s] 24%|██▍       | 162/669 [00:01<00:04, 122.77it/s] 26%|██▌       | 175/669 [00:01<00:04, 122.93it/s] 28%|██▊       | 188/669 [00:01<00:03, 123.09it/s] 30%|███       | 201/669 [00:01<00:03, 123.20it/s] 32%|███▏      | 214/669 [00:01<00:03, 123.14it/s] 34%|███▍      | 227/669 [00:02<00:03, 123.17it/s] 36%|███▌      | 240/669 [00:02<00:03, 123.15it/s] 38%|███▊      | 253/669 [00:02<00:03, 122.87it/s] 40%|███▉      | 266/669 [00:02<00:03, 123.16it/s] 42%|████▏     | 279/669 [00:02<00:03, 123.23it/s] 44%|████▎     | 292/669 [00:02<00:03, 123.40it/s] 46%|████▌     | 305/669 [00:02<00:02, 123.71it/s] 48%|████▊     | 318/669 [00:02<00:02, 123.86it/s] 49%|████▉     | 331/669 [00:02<00:02, 123.93it/s] 51%|█████▏    | 344/669 [00:02<00:02, 123.88it/s] 53%|█████▎    | 357/669 [00:03<00:02, 123.89it/s] 55%|█████▌    | 370/669 [00:03<00:02, 124.01it/s] 57%|█████▋    | 383/669 [00:03<00:02, 124.03it/s] 59%|█████▉    | 396/669 [00:03<00:02, 124.05it/s] 61%|██████    | 409/669 [00:03<00:02, 123.93it/s] 63%|██████▎   | 422/669 [00:03<00:01, 123.91it/s] 65%|██████▌   | 435/669 [00:03<00:01, 124.06it/s] 67%|██████▋   | 448/669 [00:03<00:01, 124.06it/s] 69%|██████▉   | 461/669 [00:03<00:01, 124.02it/s] 71%|███████   | 474/669 [00:04<00:01, 123.87it/s] 73%|███████▎  | 487/669 [00:04<00:01, 123.92it/s] 75%|███████▍  | 500/669 [00:04<00:01, 123.92it/s] 77%|███████▋  | 513/669 [00:04<00:01, 123.47it/s] 79%|███████▊  | 526/669 [00:04<00:01, 123.22it/s] 81%|████████  | 539/669 [00:04<00:01, 123.27it/s] 83%|████████▎ | 552/669 [00:04<00:00, 123.37it/s] 84%|████████▍ | 565/669 [00:04<00:00, 123.68it/s] 86%|████████▋ | 578/669 [00:04<00:00, 123.82it/s] 88%|████████▊ | 591/669 [00:04<00:00, 123.77it/s] 90%|█████████ | 604/669 [00:05<00:00, 123.70it/s] 92%|█████████▏| 617/669 [00:05<00:00, 123.83it/s] 94%|█████████▍| 630/669 [00:05<00:00, 123.92it/s] 96%|█████████▌| 643/669 [00:05<00:00, 123.95it/s] 98%|█████████▊| 656/669 [00:05<00:00, 123.81it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:07, 23.16it/s][A
  9%|▉         | 15/168 [00:00<00:02, 72.84it/s][A
 29%|██▉       | 49/168 [00:00<00:00, 185.97it/s][A
 49%|████▉     | 83/168 [00:00<00:00, 243.14it/s][A
 70%|███████   | 118/168 [00:00<00:00, 278.20it/s][A
 91%|█████████ | 153/168 [00:00<00:00, 299.75it/s][A100%|██████████| 168/168 [00:00<00:00, 235.43it/s]
2022-10-22 06:56:53,618 P132 INFO [Metrics] logloss: 0.564318 - AUC: 0.720003
2022-10-22 06:56:53,619 P132 INFO Monitor(max) STOP: 0.155685 !
2022-10-22 06:56:53,619 P132 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 06:56:53,619 P132 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 35.94it/s] 100%|██████████| 669/669 [00:06<00:00, 102.78it/s]
2022-10-22 06:56:53,654 P132 INFO Train loss: 0.440240
2022-10-22 06:56:53,654 P132 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:41,  6.56it/s]  1%|          | 5/669 [00:00<00:30, 22.13it/s]  3%|▎         | 18/669 [00:00<00:10, 64.59it/s]  5%|▍         | 31/669 [00:00<00:07, 87.25it/s]  7%|▋         | 44/669 [00:00<00:06, 100.63it/s]  9%|▊         | 57/669 [00:00<00:05, 108.91it/s] 10%|█         | 70/669 [00:00<00:05, 114.07it/s] 12%|█▏        | 83/669 [00:00<00:04, 117.30it/s] 14%|█▍        | 96/669 [00:00<00:04, 119.75it/s] 16%|█▋        | 109/669 [00:01<00:04, 121.28it/s] 18%|█▊        | 122/669 [00:01<00:04, 122.48it/s] 20%|██        | 135/669 [00:01<00:04, 123.20it/s] 22%|██▏       | 148/669 [00:01<00:04, 123.77it/s] 24%|██▍       | 161/669 [00:01<00:04, 124.24it/s] 26%|██▌       | 174/669 [00:01<00:03, 124.57it/s] 28%|██▊       | 187/669 [00:01<00:03, 124.67it/s] 30%|██▉       | 200/669 [00:01<00:03, 124.81it/s] 32%|███▏      | 213/669 [00:01<00:03, 124.91it/s] 34%|███▍      | 226/669 [00:02<00:03, 124.89it/s] 36%|███▌      | 239/669 [00:02<00:03, 124.95it/s] 38%|███▊      | 252/669 [00:02<00:03, 124.95it/s] 40%|███▉      | 265/669 [00:02<00:03, 124.86it/s] 42%|████▏     | 278/669 [00:02<00:03, 124.90it/s] 43%|████▎     | 291/669 [00:02<00:03, 124.92it/s] 45%|████▌     | 304/669 [00:02<00:02, 124.92it/s] 47%|████▋     | 317/669 [00:02<00:02, 125.02it/s] 49%|████▉     | 330/669 [00:02<00:02, 124.86it/s] 51%|█████▏    | 343/669 [00:02<00:02, 124.87it/s] 53%|█████▎    | 356/669 [00:03<00:02, 124.95it/s] 55%|█████▌    | 369/669 [00:03<00:02, 124.97it/s] 57%|█████▋    | 382/669 [00:03<00:02, 124.98it/s] 59%|█████▉    | 395/669 [00:03<00:02, 124.98it/s] 61%|██████    | 408/669 [00:03<00:02, 125.05it/s] 63%|██████▎   | 421/669 [00:03<00:01, 124.79it/s] 65%|██████▍   | 434/669 [00:03<00:01, 124.97it/s] 67%|██████▋   | 447/669 [00:03<00:01, 124.94it/s] 69%|██████▉   | 460/669 [00:03<00:01, 125.06it/s] 71%|███████   | 473/669 [00:03<00:01, 125.11it/s] 73%|███████▎  | 486/669 [00:04<00:01, 125.12it/s] 75%|███████▍  | 499/669 [00:04<00:01, 124.99it/s] 77%|███████▋  | 512/669 [00:04<00:01, 124.96it/s] 78%|███████▊  | 525/669 [00:04<00:01, 125.01it/s] 80%|████████  | 538/669 [00:04<00:01, 114.35it/s] 82%|████████▏ | 551/669 [00:04<00:01, 117.27it/s] 84%|████████▍ | 564/669 [00:04<00:00, 119.07it/s] 86%|████████▌ | 577/669 [00:04<00:00, 120.59it/s] 88%|████████▊ | 590/669 [00:04<00:00, 121.62it/s] 90%|█████████ | 603/669 [00:05<00:00, 122.39it/s] 92%|█████████▏| 616/669 [00:05<00:00, 123.00it/s] 94%|█████████▍| 629/669 [00:05<00:00, 123.66it/s] 96%|█████████▌| 642/669 [00:05<00:00, 124.09it/s] 98%|█████████▊| 655/669 [00:05<00:00, 124.35it/s]100%|█████████▉| 668/669 [00:05<00:00, 122.88it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 29.68it/s][A
  7%|▋         | 12/168 [00:00<00:02, 64.40it/s][A
 27%|██▋       | 45/168 [00:00<00:00, 183.20it/s][A
 46%|████▋     | 78/168 [00:00<00:00, 239.46it/s][A
 66%|██████▌   | 111/168 [00:00<00:00, 269.55it/s][A
 86%|████████▌ | 144/168 [00:00<00:00, 288.89it/s][A100%|██████████| 168/168 [00:00<00:00, 235.34it/s]
2022-10-22 06:57:00,115 P132 INFO [Metrics] logloss: 0.711996 - AUC: 0.702049
2022-10-22 06:57:00,116 P132 INFO Monitor(max) STOP: -0.009947 !
2022-10-22 06:57:00,116 P132 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 06:57:00,116 P132 INFO Early stopping at epoch=3
2022-10-22 06:57:00,116 P132 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:06<00:00, 102.81it/s]
2022-10-22 06:57:00,152 P132 INFO Train loss: 0.268607
2022-10-22 06:57:00,152 P132 INFO Training finished.
2022-10-22 06:57:00,153 P132 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_001_c4d8d560.model
2022-10-22 06:57:00,170 P132 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:38,  6.76it/s]  1%|▏         | 9/669 [00:00<00:15, 42.27it/s]  6%|▋         | 42/669 [00:00<00:03, 160.06it/s] 11%|█▏        | 76/669 [00:00<00:02, 224.20it/s] 16%|█▋        | 110/669 [00:00<00:02, 261.68it/s] 22%|██▏       | 144/669 [00:00<00:01, 284.88it/s] 26%|██▋       | 177/669 [00:00<00:01, 298.73it/s] 32%|███▏      | 211/669 [00:00<00:01, 309.02it/s] 37%|███▋      | 245/669 [00:00<00:01, 315.67it/s] 42%|████▏     | 279/669 [00:01<00:01, 320.45it/s] 47%|████▋     | 313/669 [00:01<00:01, 323.55it/s] 52%|█████▏    | 347/669 [00:01<00:00, 325.70it/s] 57%|█████▋    | 380/669 [00:01<00:00, 326.35it/s] 62%|██████▏   | 413/669 [00:01<00:00, 327.11it/s] 67%|██████▋   | 446/669 [00:01<00:00, 327.80it/s] 72%|███████▏  | 479/669 [00:01<00:00, 322.53it/s] 77%|███████▋  | 512/669 [00:01<00:00, 323.18it/s] 81%|████████▏ | 545/669 [00:01<00:00, 286.12it/s] 87%|████████▋ | 579/669 [00:02<00:00, 298.52it/s] 92%|█████████▏| 613/669 [00:02<00:00, 308.16it/s] 97%|█████████▋| 647/669 [00:02<00:00, 315.25it/s]100%|██████████| 669/669 [00:02<00:00, 285.94it/s]
2022-10-22 06:57:03,087 P132 INFO [Metrics] logloss: 0.462677 - AUC: 0.838497
  0%|          | 0/168 [00:00<?, ?it/s]  2%|▏         | 3/168 [00:00<00:09, 16.89it/s]  8%|▊         | 13/168 [00:00<00:02, 53.72it/s] 28%|██▊       | 47/168 [00:00<00:00, 163.38it/s] 48%|████▊     | 81/168 [00:00<00:00, 225.29it/s] 68%|██████▊   | 115/168 [00:00<00:00, 261.80it/s] 89%|████████▊ | 149/168 [00:00<00:00, 286.68it/s]100%|██████████| 168/168 [00:00<00:00, 216.99it/s]
2022-10-22 06:57:04,002 P132 INFO [Metrics] logloss: 0.539504 - AUC: 0.735648
2022-10-22 06:57:04,068 P132 INFO ******** Test evaluation ********
2022-10-22 06:57:04,068 P132 INFO Loading data...
2022-10-22 06:57:04,069 P132 INFO Loading test data done.
2022-10-22 06:57:08,024 P1932 INFO {
    "batch_norm": "True",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "8",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_002_5894b0e3",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 06:57:08,026 P1932 INFO Set up feature encoder...
2022-10-22 06:57:08,027 P1932 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 06:57:08,028 P1932 INFO Loading data...
2022-10-22 06:57:08,035 P1932 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 06:57:08,142 P1932 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 06:57:08,183 P1932 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 06:57:08,183 P1932 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 06:57:08,183 P1932 INFO Loading train data done.
2022-10-22 06:57:10,663 P1932 INFO Total number of parameters: 2356688.
2022-10-22 06:57:10,664 P1932 INFO Start training: 669 batches/epoch
2022-10-22 06:57:10,664 P1932 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 06:57:10.995 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:1932 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 06:57:11.027 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:1932 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<17:47,  1.60s/it]  2%|▏         | 11/669 [00:01<01:15,  8.75it/s]  3%|▎         | 22/669 [00:01<00:35, 18.28it/s]  5%|▍         | 33/669 [00:01<00:21, 29.53it/s]  7%|▋         | 45/669 [00:02<00:14, 42.85it/s]  9%|▊         | 57/669 [00:02<00:10, 56.02it/s] 10%|█         | 70/669 [00:02<00:08, 69.78it/s] 12%|█▏        | 83/669 [00:02<00:07, 81.94it/s] 14%|█▍        | 96/669 [00:02<00:06, 92.55it/s] 16%|█▋        | 109/669 [00:02<00:05, 101.18it/s] 18%|█▊        | 122/669 [00:02<00:05, 108.14it/s] 20%|██        | 135/669 [00:02<00:04, 113.39it/s] 22%|██▏       | 148/669 [00:02<00:04, 117.49it/s] 24%|██▍       | 161/669 [00:02<00:04, 120.52it/s] 26%|██▌       | 174/669 [00:03<00:04, 122.79it/s] 28%|██▊       | 187/669 [00:03<00:03, 124.31it/s] 30%|██▉       | 200/669 [00:03<00:03, 125.45it/s] 32%|███▏      | 213/669 [00:03<00:03, 126.42it/s] 34%|███▍      | 226/669 [00:03<00:03, 127.03it/s] 36%|███▌      | 239/669 [00:03<00:03, 127.53it/s] 38%|███▊      | 252/669 [00:03<00:03, 127.89it/s] 40%|███▉      | 265/669 [00:03<00:03, 128.21it/s] 42%|████▏     | 278/669 [00:03<00:03, 128.61it/s] 43%|████▎     | 291/669 [00:04<00:02, 128.67it/s] 45%|████▌     | 304/669 [00:04<00:02, 128.78it/s] 47%|████▋     | 317/669 [00:04<00:02, 128.75it/s] 49%|████▉     | 330/669 [00:04<00:02, 128.89it/s] 51%|█████▏    | 343/669 [00:04<00:02, 128.96it/s] 53%|█████▎    | 356/669 [00:04<00:02, 128.93it/s] 55%|█████▌    | 369/669 [00:04<00:02, 128.81it/s] 57%|█████▋    | 382/669 [00:04<00:02, 128.77it/s] 59%|█████▉    | 395/669 [00:04<00:02, 128.59it/s] 61%|██████    | 408/669 [00:04<00:02, 128.71it/s] 63%|██████▎   | 421/669 [00:05<00:01, 128.74it/s] 65%|██████▍   | 434/669 [00:05<00:01, 128.75it/s] 67%|██████▋   | 447/669 [00:05<00:01, 128.86it/s] 69%|██████▉   | 460/669 [00:05<00:01, 128.93it/s] 71%|███████   | 473/669 [00:05<00:01, 128.87it/s] 73%|███████▎  | 486/669 [00:05<00:01, 128.85it/s] 75%|███████▍  | 499/669 [00:05<00:01, 128.87it/s] 77%|███████▋  | 512/669 [00:05<00:01, 128.77it/s] 78%|███████▊  | 525/669 [00:05<00:01, 128.57it/s] 80%|████████  | 538/669 [00:05<00:01, 128.45it/s] 82%|████████▏ | 551/669 [00:06<00:00, 118.56it/s] 84%|████████▍ | 564/669 [00:06<00:00, 121.72it/s] 86%|████████▌ | 577/669 [00:06<00:00, 123.62it/s] 88%|████████▊ | 590/669 [00:06<00:00, 125.13it/s] 90%|█████████ | 603/669 [00:06<00:00, 126.17it/s] 92%|█████████▏| 616/669 [00:06<00:00, 126.97it/s] 94%|█████████▍| 629/669 [00:06<00:00, 127.46it/s] 96%|█████████▌| 642/669 [00:06<00:00, 127.76it/s] 98%|█████████▊| 655/669 [00:06<00:00, 128.10it/s]100%|█████████▉| 668/669 [00:06<00:00, 126.42it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.89it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 96.35it/s][A
 31%|███       | 52/168 [00:00<00:00, 194.27it/s][A
 52%|█████▏    | 87/168 [00:00<00:00, 250.86it/s][A
 73%|███████▎  | 122/168 [00:00<00:00, 282.93it/s][A
 93%|█████████▎| 157/168 [00:00<00:00, 303.73it/s][A100%|██████████| 168/168 [00:00<00:00, 240.94it/s]
2022-10-22 06:57:18,475 P1932 INFO [Metrics] logloss: 0.543729 - AUC: 0.729113
2022-10-22 06:57:18,476 P1932 INFO Save best model: monitor(max): 0.185384
2022-10-22 06:57:18,593 P1932 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 84.07it/s] 
2022-10-22 06:57:18,623 P1932 INFO Train loss: 0.565076
2022-10-22 06:57:18,624 P1932 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:45,  6.31it/s]  2%|▏         | 14/669 [00:00<00:10, 63.79it/s]  3%|▎         | 22/669 [00:00<00:10, 63.25it/s]  5%|▌         | 35/669 [00:00<00:07, 84.70it/s]  7%|▋         | 48/669 [00:00<00:06, 98.07it/s]  9%|▉         | 61/669 [00:00<00:05, 107.33it/s] 11%|█         | 75/669 [00:00<00:05, 115.07it/s] 13%|█▎        | 89/669 [00:00<00:04, 120.60it/s] 15%|█▌        | 103/669 [00:01<00:04, 124.58it/s] 17%|█▋        | 117/669 [00:01<00:04, 127.55it/s] 20%|█▉        | 131/669 [00:01<00:04, 129.60it/s] 22%|██▏       | 145/669 [00:01<00:03, 131.10it/s] 24%|██▍       | 159/669 [00:01<00:03, 132.04it/s] 26%|██▌       | 173/669 [00:01<00:03, 132.74it/s] 28%|██▊       | 187/669 [00:01<00:03, 133.21it/s] 30%|███       | 201/669 [00:01<00:03, 133.63it/s] 32%|███▏      | 215/669 [00:01<00:03, 133.91it/s] 34%|███▍      | 229/669 [00:01<00:03, 133.80it/s] 36%|███▋      | 243/669 [00:02<00:03, 133.93it/s] 38%|███▊      | 257/669 [00:02<00:03, 134.11it/s] 41%|████      | 271/669 [00:02<00:02, 134.14it/s] 43%|████▎     | 285/669 [00:02<00:02, 134.27it/s] 45%|████▍     | 299/669 [00:02<00:02, 134.30it/s] 47%|████▋     | 313/669 [00:02<00:02, 134.37it/s] 49%|████▉     | 327/669 [00:02<00:02, 134.33it/s] 51%|█████     | 341/669 [00:02<00:02, 134.27it/s] 53%|█████▎    | 355/669 [00:02<00:02, 134.24it/s] 55%|█████▌    | 369/669 [00:02<00:02, 134.20it/s] 57%|█████▋    | 383/669 [00:03<00:02, 134.22it/s] 59%|█████▉    | 397/669 [00:03<00:02, 134.23it/s] 61%|██████▏   | 411/669 [00:03<00:01, 134.26it/s] 64%|██████▎   | 425/669 [00:03<00:01, 134.27it/s] 66%|██████▌   | 439/669 [00:03<00:01, 134.31it/s] 68%|██████▊   | 453/669 [00:03<00:01, 134.23it/s] 70%|██████▉   | 467/669 [00:03<00:01, 134.35it/s] 72%|███████▏  | 481/669 [00:03<00:01, 134.31it/s] 74%|███████▍  | 495/669 [00:03<00:01, 134.29it/s] 76%|███████▌  | 509/669 [00:04<00:01, 134.27it/s] 78%|███████▊  | 523/669 [00:04<00:01, 134.14it/s] 80%|████████  | 537/669 [00:04<00:00, 134.14it/s] 82%|████████▏ | 551/669 [00:04<00:00, 122.90it/s] 84%|████████▍ | 565/669 [00:04<00:00, 126.02it/s] 87%|████████▋ | 579/669 [00:04<00:00, 128.13it/s] 89%|████████▊ | 593/669 [00:04<00:00, 129.88it/s] 91%|█████████ | 607/669 [00:04<00:00, 131.12it/s] 93%|█████████▎| 621/669 [00:04<00:00, 132.08it/s] 95%|█████████▍| 635/669 [00:05<00:00, 132.88it/s] 97%|█████████▋| 649/669 [00:05<00:00, 133.19it/s] 99%|█████████▉| 663/669 [00:05<00:00, 131.04it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:07, 22.50it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 88.52it/s][A
 30%|███       | 51/168 [00:00<00:00, 182.16it/s][A
 51%|█████     | 86/168 [00:00<00:00, 242.30it/s][A
 72%|███████▏  | 121/168 [00:00<00:00, 278.45it/s][A
 93%|█████████▎| 156/168 [00:00<00:00, 301.08it/s][A100%|██████████| 168/168 [00:00<00:00, 232.73it/s]
2022-10-22 06:57:24,753 P1932 INFO [Metrics] logloss: 0.560277 - AUC: 0.724526
2022-10-22 06:57:24,754 P1932 INFO Monitor(max) STOP: 0.164249 !
2022-10-22 06:57:24,754 P1932 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 06:57:24,754 P1932 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 108.41it/s]
2022-10-22 06:57:24,795 P1932 INFO Train loss: 0.449085
2022-10-22 06:57:24,795 P1932 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:46,  6.25it/s]  2%|▏         | 15/669 [00:00<00:09, 67.93it/s]  4%|▎         | 24/669 [00:00<00:09, 68.56it/s]  6%|▌         | 38/669 [00:00<00:06, 91.97it/s]  8%|▊         | 52/669 [00:00<00:05, 106.50it/s] 10%|▉         | 66/669 [00:00<00:05, 115.76it/s] 12%|█▏        | 80/669 [00:00<00:04, 121.83it/s] 14%|█▍        | 94/669 [00:00<00:04, 126.11it/s] 16%|█▌        | 108/669 [00:01<00:04, 128.87it/s] 18%|█▊        | 122/669 [00:01<00:04, 130.88it/s] 20%|██        | 136/669 [00:01<00:04, 132.22it/s] 22%|██▏       | 150/669 [00:01<00:03, 133.22it/s] 25%|██▍       | 164/669 [00:01<00:03, 133.99it/s] 27%|██▋       | 178/669 [00:01<00:03, 134.35it/s] 29%|██▊       | 192/669 [00:01<00:03, 134.75it/s] 31%|███       | 206/669 [00:01<00:03, 134.89it/s] 33%|███▎      | 220/669 [00:01<00:03, 135.13it/s] 35%|███▍      | 234/669 [00:01<00:03, 135.27it/s] 37%|███▋      | 248/669 [00:02<00:03, 135.40it/s] 39%|███▉      | 262/669 [00:02<00:03, 135.36it/s] 41%|████▏     | 276/669 [00:02<00:02, 135.33it/s] 43%|████▎     | 290/669 [00:02<00:02, 135.34it/s] 45%|████▌     | 304/669 [00:02<00:02, 135.35it/s] 48%|████▊     | 318/669 [00:02<00:02, 135.37it/s] 50%|████▉     | 332/669 [00:02<00:02, 135.47it/s] 52%|█████▏    | 346/669 [00:02<00:02, 135.59it/s] 54%|█████▍    | 360/669 [00:02<00:02, 135.54it/s] 56%|█████▌    | 374/669 [00:02<00:02, 135.48it/s] 58%|█████▊    | 388/669 [00:03<00:02, 135.56it/s] 60%|██████    | 402/669 [00:03<00:01, 135.41it/s] 62%|██████▏   | 416/669 [00:03<00:01, 135.58it/s] 64%|██████▍   | 430/669 [00:03<00:01, 135.53it/s] 66%|██████▋   | 444/669 [00:03<00:01, 135.42it/s] 68%|██████▊   | 458/669 [00:03<00:01, 135.37it/s] 71%|███████   | 472/669 [00:03<00:01, 135.53it/s] 73%|███████▎  | 486/669 [00:03<00:01, 135.68it/s] 75%|███████▍  | 500/669 [00:03<00:01, 135.54it/s] 77%|███████▋  | 514/669 [00:04<00:01, 135.49it/s] 79%|███████▉  | 528/669 [00:04<00:01, 135.51it/s] 81%|████████  | 542/669 [00:04<00:00, 135.51it/s] 83%|████████▎ | 556/669 [00:04<00:00, 135.49it/s] 85%|████████▌ | 570/669 [00:04<00:00, 135.46it/s] 87%|████████▋ | 584/669 [00:04<00:00, 135.58it/s] 89%|████████▉ | 598/669 [00:04<00:00, 135.60it/s] 91%|█████████▏| 612/669 [00:04<00:00, 135.65it/s] 94%|█████████▎| 626/669 [00:04<00:00, 135.71it/s] 96%|█████████▌| 640/669 [00:04<00:00, 135.62it/s] 98%|█████████▊| 654/669 [00:05<00:00, 135.58it/s]100%|█████████▉| 668/669 [00:05<00:00, 133.66it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 28.71it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 96.56it/s][A
 31%|███       | 52/168 [00:00<00:00, 195.62it/s][A
 51%|█████     | 86/168 [00:00<00:00, 250.02it/s][A
 72%|███████▏  | 121/168 [00:00<00:00, 283.06it/s][A
 93%|█████████▎| 156/168 [00:00<00:00, 302.96it/s][A100%|██████████| 168/168 [00:00<00:00, 240.70it/s]
2022-10-22 06:57:30,790 P1932 INFO [Metrics] logloss: 0.679086 - AUC: 0.705502
2022-10-22 06:57:30,790 P1932 INFO Monitor(max) STOP: 0.026416 !
2022-10-22 06:57:30,790 P1932 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 06:57:30,790 P1932 INFO Early stopping at epoch=3
2022-10-22 06:57:30,790 P1932 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:06<00:00, 110.77it/s]
2022-10-22 06:57:30,827 P1932 INFO Train loss: 0.323737
2022-10-22 06:57:30,827 P1932 INFO Training finished.
2022-10-22 06:57:30,827 P1932 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_002_5894b0e3.model
2022-10-22 06:57:30,919 P1932 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:41,  6.60it/s]  3%|▎         | 19/669 [00:00<00:08, 77.58it/s]  7%|▋         | 45/669 [00:00<00:04, 144.73it/s] 12%|█▏        | 80/669 [00:00<00:02, 215.25it/s] 17%|█▋        | 115/669 [00:00<00:02, 258.65it/s] 22%|██▏       | 150/669 [00:00<00:01, 286.80it/s] 28%|██▊       | 185/669 [00:00<00:01, 306.11it/s] 33%|███▎      | 220/669 [00:00<00:01, 316.96it/s] 38%|███▊      | 255/669 [00:00<00:01, 325.55it/s] 43%|████▎     | 290/669 [00:01<00:01, 332.49it/s] 49%|████▊     | 325/669 [00:01<00:01, 337.49it/s] 54%|█████▎    | 359/669 [00:01<00:00, 335.51it/s] 59%|█████▊    | 393/669 [00:01<00:00, 327.45it/s] 64%|██████▎   | 426/669 [00:01<00:00, 319.65it/s] 69%|██████▊   | 459/669 [00:01<00:00, 313.63it/s] 73%|███████▎  | 491/669 [00:01<00:00, 312.57it/s] 78%|███████▊  | 523/669 [00:01<00:00, 310.70it/s] 83%|████████▎ | 555/669 [00:01<00:00, 310.66it/s] 88%|████████▊ | 587/669 [00:02<00:00, 306.61it/s] 93%|█████████▎| 619/669 [00:02<00:00, 307.71it/s] 97%|█████████▋| 650/669 [00:02<00:00, 306.61it/s]100%|██████████| 669/669 [00:02<00:00, 284.12it/s]
2022-10-22 06:57:33,857 P1932 INFO [Metrics] logloss: 0.468721 - AUC: 0.837734
  0%|          | 0/168 [00:00<?, ?it/s]  1%|          | 2/168 [00:00<00:08, 18.99it/s] 11%|█▏        | 19/168 [00:00<00:01, 89.99it/s] 32%|███▏      | 53/168 [00:00<00:00, 192.31it/s] 52%|█████▏    | 88/168 [00:00<00:00, 248.79it/s] 73%|███████▎  | 123/168 [00:00<00:00, 282.01it/s] 94%|█████████▍| 158/168 [00:00<00:00, 302.97it/s]100%|██████████| 168/168 [00:00<00:00, 236.66it/s]
2022-10-22 06:57:34,705 P1932 INFO [Metrics] logloss: 0.543729 - AUC: 0.729113
2022-10-22 06:57:34,770 P1932 INFO ******** Test evaluation ********
2022-10-22 06:57:34,770 P1932 INFO Loading data...
2022-10-22 06:57:34,772 P1932 INFO Loading test data done.
2022-10-22 06:57:38,033 P3721 INFO {
    "batch_norm": "True",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "16",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_003_872d8bf1",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 06:57:38,035 P3721 INFO Set up feature encoder...
2022-10-22 06:57:38,035 P3721 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 06:57:38,036 P3721 INFO Loading data...
2022-10-22 06:57:38,040 P3721 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 06:57:38,143 P3721 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 06:57:38,180 P3721 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 06:57:38,181 P3721 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 06:57:38,181 P3721 INFO Loading train data done.
2022-10-22 06:57:40,694 P3721 INFO Total number of parameters: 4164232.
2022-10-22 06:57:40,694 P3721 INFO Start training: 669 batches/epoch
2022-10-22 06:57:40,694 P3721 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 06:57:41.023 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:3721 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 06:57:41.055 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:3721 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<18:09,  1.63s/it]  1%|▏         | 10/669 [00:01<01:24,  7.76it/s]  3%|▎         | 20/669 [00:01<00:38, 17.07it/s]  4%|▍         | 27/669 [00:01<00:27, 23.08it/s]  6%|▌         | 38/669 [00:02<00:17, 35.78it/s]  7%|▋         | 49/669 [00:02<00:12, 48.35it/s]  9%|▉         | 61/669 [00:02<00:09, 61.89it/s] 11%|█         | 73/669 [00:02<00:08, 74.05it/s] 13%|█▎        | 86/669 [00:02<00:06, 85.80it/s] 15%|█▍        | 99/669 [00:02<00:05, 95.22it/s] 17%|█▋        | 112/669 [00:02<00:05, 102.48it/s] 19%|█▊        | 125/669 [00:02<00:05, 107.82it/s] 21%|██        | 138/669 [00:02<00:04, 111.90it/s] 23%|██▎       | 151/669 [00:03<00:04, 114.90it/s] 25%|██▍       | 164/669 [00:03<00:04, 117.20it/s] 26%|██▋       | 177/669 [00:03<00:04, 118.60it/s] 28%|██▊       | 190/669 [00:03<00:04, 119.67it/s] 30%|███       | 203/669 [00:03<00:03, 120.42it/s] 32%|███▏      | 216/669 [00:03<00:03, 120.90it/s] 34%|███▍      | 229/669 [00:03<00:03, 121.24it/s] 36%|███▌      | 242/669 [00:03<00:03, 121.43it/s] 38%|███▊      | 255/669 [00:03<00:03, 121.44it/s] 40%|████      | 268/669 [00:03<00:03, 121.56it/s] 42%|████▏     | 281/669 [00:04<00:03, 121.69it/s] 44%|████▍     | 294/669 [00:04<00:03, 121.66it/s] 46%|████▌     | 307/669 [00:04<00:02, 121.65it/s] 48%|████▊     | 320/669 [00:04<00:02, 121.52it/s] 50%|████▉     | 333/669 [00:04<00:02, 121.56it/s] 52%|█████▏    | 346/669 [00:04<00:02, 121.46it/s] 54%|█████▎    | 359/669 [00:04<00:02, 121.49it/s] 56%|█████▌    | 372/669 [00:04<00:02, 121.60it/s] 58%|█████▊    | 385/669 [00:04<00:02, 121.52it/s] 59%|█████▉    | 398/669 [00:05<00:02, 121.58it/s] 61%|██████▏   | 411/669 [00:05<00:02, 121.63it/s] 63%|██████▎   | 424/669 [00:05<00:02, 121.61it/s] 65%|██████▌   | 437/669 [00:05<00:01, 121.64it/s] 67%|██████▋   | 450/669 [00:05<00:01, 121.63it/s] 69%|██████▉   | 463/669 [00:05<00:01, 121.66it/s] 71%|███████   | 476/669 [00:05<00:01, 121.71it/s] 73%|███████▎  | 489/669 [00:05<00:01, 121.58it/s] 75%|███████▌  | 502/669 [00:05<00:01, 121.36it/s] 77%|███████▋  | 515/669 [00:06<00:01, 121.37it/s] 79%|███████▉  | 528/669 [00:06<00:01, 121.45it/s] 81%|████████  | 541/669 [00:06<00:01, 121.49it/s] 83%|████████▎ | 554/669 [00:06<00:01, 112.15it/s] 85%|████████▍ | 567/669 [00:06<00:00, 114.67it/s] 87%|████████▋ | 580/669 [00:06<00:00, 116.58it/s] 89%|████████▊ | 593/669 [00:06<00:00, 118.10it/s] 91%|█████████ | 606/669 [00:06<00:00, 119.14it/s] 93%|█████████▎| 619/669 [00:06<00:00, 119.86it/s] 94%|█████████▍| 632/669 [00:07<00:00, 120.25it/s] 96%|█████████▋| 645/669 [00:07<00:00, 120.61it/s] 98%|█████████▊| 658/669 [00:07<00:00, 120.95it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.68it/s][A
 11%|█         | 18/168 [00:00<00:01, 83.82it/s][A
 15%|█▌        | 26/168 [00:00<00:01, 82.16it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 156.36it/s][A
 52%|█████▏    | 88/168 [00:00<00:00, 214.21it/s][A
 72%|███████▏  | 121/168 [00:00<00:00, 249.89it/s][A
 92%|█████████▏| 154/168 [00:00<00:00, 272.27it/s][A100%|██████████| 168/168 [00:00<00:00, 199.89it/s]
2022-10-22 06:57:48,999 P3721 INFO [Metrics] logloss: 0.540330 - AUC: 0.735822
2022-10-22 06:57:48,999 P3721 INFO Save best model: monitor(max): 0.195492
2022-10-22 06:57:49,153 P3721 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:08<00:00, 78.84it/s] 
2022-10-22 06:57:49,181 P3721 INFO Train loss: 0.563807
2022-10-22 06:57:49,182 P3721 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:44,  6.40it/s]  2%|▏         | 14/669 [00:00<00:10, 63.45it/s]  3%|▎         | 22/669 [00:00<00:10, 63.00it/s]  5%|▌         | 35/669 [00:00<00:07, 83.70it/s]  7%|▋         | 47/669 [00:00<00:06, 94.96it/s]  9%|▉         | 59/669 [00:00<00:05, 102.54it/s] 11%|█         | 72/669 [00:00<00:05, 108.47it/s] 13%|█▎        | 85/669 [00:00<00:05, 112.38it/s] 15%|█▍        | 98/669 [00:01<00:04, 115.06it/s] 17%|█▋        | 111/669 [00:01<00:04, 116.84it/s] 19%|█▊        | 124/669 [00:01<00:04, 118.14it/s] 20%|██        | 137/669 [00:01<00:04, 119.08it/s] 22%|██▏       | 150/669 [00:01<00:04, 119.71it/s] 24%|██▍       | 163/669 [00:01<00:04, 120.03it/s] 26%|██▋       | 176/669 [00:01<00:04, 120.46it/s] 28%|██▊       | 189/669 [00:01<00:03, 120.61it/s] 30%|███       | 202/669 [00:01<00:03, 120.73it/s] 32%|███▏      | 215/669 [00:01<00:03, 120.89it/s] 34%|███▍      | 228/669 [00:02<00:03, 120.92it/s] 36%|███▌      | 241/669 [00:02<00:03, 121.00it/s] 38%|███▊      | 254/669 [00:02<00:03, 120.95it/s] 40%|███▉      | 267/669 [00:02<00:03, 120.79it/s] 42%|████▏     | 280/669 [00:02<00:03, 120.86it/s] 44%|████▍     | 293/669 [00:02<00:03, 120.86it/s] 46%|████▌     | 306/669 [00:02<00:03, 120.88it/s] 48%|████▊     | 319/669 [00:02<00:02, 120.78it/s] 50%|████▉     | 332/669 [00:02<00:02, 120.69it/s] 52%|█████▏    | 345/669 [00:03<00:02, 120.73it/s] 54%|█████▎    | 358/669 [00:03<00:02, 120.73it/s] 55%|█████▌    | 371/669 [00:03<00:02, 120.91it/s] 57%|█████▋    | 384/669 [00:03<00:02, 121.06it/s] 59%|█████▉    | 397/669 [00:03<00:02, 121.05it/s] 61%|██████▏   | 410/669 [00:03<00:02, 121.03it/s] 63%|██████▎   | 423/669 [00:03<00:02, 121.00it/s] 65%|██████▌   | 436/669 [00:03<00:01, 121.07it/s] 67%|██████▋   | 449/669 [00:03<00:01, 121.06it/s] 69%|██████▉   | 462/669 [00:04<00:01, 121.04it/s] 71%|███████   | 475/669 [00:04<00:01, 120.99it/s] 73%|███████▎  | 488/669 [00:04<00:01, 121.08it/s] 75%|███████▍  | 501/669 [00:04<00:01, 121.01it/s] 77%|███████▋  | 514/669 [00:04<00:01, 121.05it/s] 79%|███████▉  | 527/669 [00:04<00:01, 121.10it/s] 81%|████████  | 540/669 [00:04<00:01, 121.04it/s] 83%|████████▎ | 553/669 [00:04<00:01, 112.29it/s] 85%|████████▍ | 566/669 [00:04<00:00, 114.75it/s] 87%|████████▋ | 579/669 [00:05<00:00, 116.53it/s] 88%|████████▊ | 592/669 [00:05<00:00, 117.80it/s] 90%|█████████ | 605/669 [00:05<00:00, 118.74it/s] 92%|█████████▏| 618/669 [00:05<00:00, 119.47it/s] 94%|█████████▍| 631/669 [00:05<00:00, 120.09it/s] 96%|█████████▋| 644/669 [00:05<00:00, 120.44it/s] 98%|█████████▊| 657/669 [00:05<00:00, 120.58it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:11, 14.87it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 82.14it/s][A
 31%|███       | 52/168 [00:00<00:00, 177.45it/s][A
 51%|█████     | 85/168 [00:00<00:00, 230.09it/s][A
 70%|███████   | 118/168 [00:00<00:00, 261.79it/s][A
 90%|████████▉ | 151/168 [00:00<00:00, 282.77it/s][A100%|██████████| 168/168 [00:00<00:00, 219.32it/s]
2022-10-22 06:57:55,860 P3721 INFO [Metrics] logloss: 0.563039 - AUC: 0.719561
2022-10-22 06:57:55,860 P3721 INFO Monitor(max) STOP: 0.156522 !
2022-10-22 06:57:55,860 P3721 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 06:57:55,861 P3721 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 99.61it/s] 
2022-10-22 06:57:55,899 P3721 INFO Train loss: 0.441180
2022-10-22 06:57:55,899 P3721 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:46,  6.28it/s]  2%|▏         | 13/669 [00:00<00:10, 59.91it/s]  3%|▎         | 21/669 [00:00<00:10, 62.12it/s]  5%|▌         | 34/669 [00:00<00:07, 83.31it/s]  7%|▋         | 47/669 [00:00<00:06, 95.91it/s]  9%|▉         | 59/669 [00:00<00:05, 103.23it/s] 11%|█         | 72/669 [00:00<00:05, 108.89it/s] 13%|█▎        | 85/669 [00:00<00:05, 112.83it/s] 15%|█▍        | 98/669 [00:01<00:04, 115.34it/s] 17%|█▋        | 111/669 [00:01<00:04, 117.15it/s] 19%|█▊        | 124/669 [00:01<00:04, 118.24it/s] 20%|██        | 137/669 [00:01<00:04, 118.95it/s] 22%|██▏       | 150/669 [00:01<00:04, 119.47it/s] 24%|██▍       | 163/669 [00:01<00:04, 119.91it/s] 26%|██▋       | 176/669 [00:01<00:04, 120.27it/s] 28%|██▊       | 189/669 [00:01<00:03, 120.53it/s] 30%|███       | 202/669 [00:01<00:03, 120.74it/s] 32%|███▏      | 215/669 [00:01<00:03, 120.84it/s] 34%|███▍      | 228/669 [00:02<00:03, 120.91it/s] 36%|███▌      | 241/669 [00:02<00:03, 120.80it/s] 38%|███▊      | 254/669 [00:02<00:03, 120.72it/s] 40%|███▉      | 267/669 [00:02<00:03, 120.51it/s] 42%|████▏     | 280/669 [00:02<00:03, 120.51it/s] 44%|████▍     | 293/669 [00:02<00:03, 120.59it/s] 46%|████▌     | 306/669 [00:02<00:03, 120.51it/s] 48%|████▊     | 319/669 [00:02<00:02, 120.42it/s] 50%|████▉     | 332/669 [00:02<00:02, 120.56it/s] 52%|█████▏    | 345/669 [00:03<00:02, 120.55it/s] 54%|█████▎    | 358/669 [00:03<00:02, 120.54it/s] 55%|█████▌    | 371/669 [00:03<00:02, 120.52it/s] 57%|█████▋    | 384/669 [00:03<00:02, 120.71it/s] 59%|█████▉    | 397/669 [00:03<00:02, 120.94it/s] 61%|██████▏   | 410/669 [00:03<00:02, 121.17it/s] 63%|██████▎   | 423/669 [00:03<00:02, 121.18it/s] 65%|██████▌   | 436/669 [00:03<00:01, 121.24it/s] 67%|██████▋   | 449/669 [00:03<00:01, 121.36it/s] 69%|██████▉   | 462/669 [00:04<00:01, 121.43it/s] 71%|███████   | 475/669 [00:04<00:01, 121.43it/s] 73%|███████▎  | 488/669 [00:04<00:01, 121.44it/s] 75%|███████▍  | 501/669 [00:04<00:01, 121.52it/s] 77%|███████▋  | 514/669 [00:04<00:01, 121.52it/s] 79%|███████▉  | 527/669 [00:04<00:01, 121.46it/s] 81%|████████  | 540/669 [00:04<00:01, 121.28it/s] 83%|████████▎ | 553/669 [00:04<00:00, 121.18it/s] 85%|████████▍ | 566/669 [00:04<00:00, 121.15it/s] 87%|████████▋ | 579/669 [00:04<00:00, 121.13it/s] 88%|████████▊ | 592/669 [00:05<00:00, 121.22it/s] 90%|█████████ | 605/669 [00:05<00:00, 121.25it/s] 92%|█████████▏| 618/669 [00:05<00:00, 121.21it/s] 94%|█████████▍| 631/669 [00:05<00:00, 121.11it/s] 96%|█████████▋| 644/669 [00:05<00:00, 121.15it/s] 98%|█████████▊| 657/669 [00:05<00:00, 121.00it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.77it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 95.95it/s][A
 29%|██▉       | 49/168 [00:00<00:00, 182.95it/s][A
 49%|████▉     | 82/168 [00:00<00:00, 235.91it/s][A
 68%|██████▊   | 114/168 [00:00<00:00, 264.68it/s][A
 87%|████████▋ | 146/168 [00:00<00:00, 282.50it/s][A100%|██████████| 168/168 [00:00<00:00, 228.15it/s]
2022-10-22 06:58:02,522 P3721 INFO [Metrics] logloss: 0.713828 - AUC: 0.700957
2022-10-22 06:58:02,523 P3721 INFO Monitor(max) STOP: -0.012871 !
2022-10-22 06:58:02,523 P3721 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 06:58:02,523 P3721 INFO Early stopping at epoch=3
2022-10-22 06:58:02,523 P3721 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:06<00:00, 100.25it/s]
2022-10-22 06:58:02,563 P3721 INFO Train loss: 0.270052
2022-10-22 06:58:02,563 P3721 INFO Training finished.
2022-10-22 06:58:02,563 P3721 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_003_872d8bf1.model
2022-10-22 06:58:02,580 P3721 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:43,  6.48it/s]  3%|▎         | 19/669 [00:00<00:08, 79.98it/s]  8%|▊         | 52/669 [00:00<00:03, 173.12it/s] 13%|█▎        | 85/669 [00:00<00:02, 227.78it/s] 18%|█▊        | 118/669 [00:00<00:02, 261.74it/s] 23%|██▎       | 151/669 [00:00<00:01, 283.53it/s] 28%|██▊       | 184/669 [00:00<00:01, 295.90it/s] 32%|███▏      | 217/669 [00:00<00:01, 306.31it/s] 37%|███▋      | 250/669 [00:00<00:01, 313.24it/s] 42%|████▏     | 283/669 [00:01<00:01, 317.51it/s] 47%|████▋     | 316/669 [00:01<00:01, 320.58it/s] 52%|█████▏    | 349/669 [00:01<00:00, 320.91it/s] 57%|█████▋    | 382/669 [00:01<00:00, 323.22it/s] 62%|██████▏   | 415/669 [00:01<00:00, 324.76it/s] 67%|██████▋   | 448/669 [00:01<00:00, 326.21it/s] 72%|███████▏  | 481/669 [00:01<00:00, 318.23it/s] 77%|███████▋  | 513/669 [00:01<00:00, 311.82it/s] 81%|████████▏ | 545/669 [00:01<00:00, 307.50it/s] 86%|████████▌ | 576/669 [00:02<00:00, 304.61it/s] 91%|█████████ | 607/669 [00:02<00:00, 302.56it/s] 95%|█████████▌| 638/669 [00:02<00:00, 301.17it/s]100%|██████████| 669/669 [00:02<00:00, 288.80it/s]100%|██████████| 669/669 [00:02<00:00, 280.21it/s]
2022-10-22 06:58:05,545 P3721 INFO [Metrics] logloss: 0.458991 - AUC: 0.841284
  0%|          | 0/168 [00:00<?, ?it/s]  2%|▏         | 4/168 [00:00<00:04, 39.04it/s] 11%|█▏        | 19/168 [00:00<00:01, 94.04it/s] 30%|███       | 51/168 [00:00<00:00, 190.19it/s] 50%|█████     | 84/168 [00:00<00:00, 241.50it/s] 70%|██████▉   | 117/168 [00:00<00:00, 270.74it/s] 89%|████████▉ | 150/168 [00:00<00:00, 288.64it/s]100%|██████████| 168/168 [00:00<00:00, 232.22it/s]
2022-10-22 06:58:06,407 P3721 INFO [Metrics] logloss: 0.540330 - AUC: 0.735822
2022-10-22 06:58:06,493 P3721 INFO ******** Test evaluation ********
2022-10-22 06:58:06,493 P3721 INFO Loading data...
2022-10-22 06:58:06,494 P3721 INFO Loading test data done.
2022-10-22 06:58:13,085 P5501 INFO {
    "batch_norm": "True",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "8",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_004_75d98b21",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 06:58:13,087 P5501 INFO Set up feature encoder...
2022-10-22 06:58:13,087 P5501 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 06:58:13,089 P5501 INFO Loading data...
2022-10-22 06:58:13,092 P5501 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 06:58:13,195 P5501 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 06:58:13,230 P5501 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 06:58:13,230 P5501 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 06:58:13,230 P5501 INFO Loading train data done.
2022-10-22 06:58:15,679 P5501 INFO Total number of parameters: 2356688.
2022-10-22 06:58:15,679 P5501 INFO Start training: 669 batches/epoch
2022-10-22 06:58:15,679 P5501 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 06:58:16.019 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:5501 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 06:58:16.051 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:5501 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<18:15,  1.64s/it]  2%|▏         | 12/669 [00:01<01:10,  9.32it/s]  3%|▎         | 22/669 [00:01<00:36, 17.65it/s]  5%|▌         | 34/669 [00:02<00:21, 29.90it/s]  7%|▋         | 46/669 [00:02<00:14, 42.86it/s]  9%|▊         | 58/669 [00:02<00:10, 55.70it/s] 11%|█         | 71/669 [00:02<00:08, 69.31it/s] 13%|█▎        | 84/669 [00:02<00:07, 81.35it/s] 14%|█▍        | 97/669 [00:02<00:06, 91.88it/s] 16%|█▋        | 110/669 [00:02<00:05, 100.55it/s] 18%|█▊        | 123/669 [00:02<00:05, 107.55it/s] 20%|██        | 136/669 [00:02<00:04, 112.98it/s] 22%|██▏       | 149/669 [00:02<00:04, 117.10it/s] 24%|██▍       | 162/669 [00:03<00:04, 120.27it/s] 26%|██▌       | 175/669 [00:03<00:04, 122.58it/s] 28%|██▊       | 188/669 [00:03<00:03, 124.10it/s] 30%|███       | 201/669 [00:03<00:03, 125.29it/s] 32%|███▏      | 214/669 [00:03<00:03, 126.18it/s] 34%|███▍      | 227/669 [00:03<00:03, 126.78it/s] 36%|███▌      | 240/669 [00:03<00:03, 127.32it/s] 38%|███▊      | 253/669 [00:03<00:03, 127.55it/s] 40%|███▉      | 266/669 [00:03<00:03, 127.80it/s] 42%|████▏     | 279/669 [00:03<00:03, 127.97it/s] 44%|████▎     | 292/669 [00:04<00:02, 127.90it/s] 46%|████▌     | 305/669 [00:04<00:02, 128.00it/s] 48%|████▊     | 318/669 [00:04<00:02, 128.02it/s] 49%|████▉     | 331/669 [00:04<00:02, 128.05it/s] 51%|█████▏    | 344/669 [00:04<00:02, 128.15it/s] 53%|█████▎    | 357/669 [00:04<00:02, 128.17it/s] 55%|█████▌    | 370/669 [00:04<00:02, 128.04it/s] 57%|█████▋    | 383/669 [00:04<00:02, 128.15it/s] 59%|█████▉    | 396/669 [00:04<00:02, 128.16it/s] 61%|██████    | 409/669 [00:04<00:02, 128.02it/s] 63%|██████▎   | 422/669 [00:05<00:01, 128.14it/s] 65%|██████▌   | 435/669 [00:05<00:01, 128.14it/s] 67%|██████▋   | 448/669 [00:05<00:01, 128.12it/s] 69%|██████▉   | 461/669 [00:05<00:01, 128.25it/s] 71%|███████   | 474/669 [00:05<00:01, 128.14it/s] 73%|███████▎  | 487/669 [00:05<00:01, 128.17it/s] 75%|███████▍  | 500/669 [00:05<00:01, 128.28it/s] 77%|███████▋  | 513/669 [00:05<00:01, 128.14it/s] 79%|███████▊  | 526/669 [00:05<00:01, 128.17it/s] 81%|████████  | 539/669 [00:05<00:01, 128.21it/s] 83%|████████▎ | 552/669 [00:06<00:00, 119.92it/s] 84%|████████▍ | 565/669 [00:06<00:00, 122.21it/s] 86%|████████▋ | 578/669 [00:06<00:00, 123.89it/s] 88%|████████▊ | 591/669 [00:06<00:00, 125.08it/s] 90%|█████████ | 604/669 [00:06<00:00, 126.12it/s] 92%|█████████▏| 617/669 [00:06<00:00, 126.72it/s] 94%|█████████▍| 630/669 [00:06<00:00, 126.99it/s] 96%|█████████▌| 643/669 [00:06<00:00, 127.32it/s] 98%|█████████▊| 656/669 [00:06<00:00, 127.56it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:06, 25.77it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 88.21it/s][A
 29%|██▉       | 49/168 [00:00<00:00, 173.87it/s][A
 47%|████▋     | 79/168 [00:00<00:00, 218.69it/s][A
 65%|██████▍   | 109/168 [00:00<00:00, 245.59it/s][A
 83%|████████▎ | 139/168 [00:00<00:00, 262.64it/s][A100%|██████████| 168/168 [00:00<00:00, 213.88it/s]
2022-10-22 06:58:23,634 P5501 INFO [Metrics] logloss: 0.543824 - AUC: 0.727937
2022-10-22 06:58:23,634 P5501 INFO Save best model: monitor(max): 0.184113
2022-10-22 06:58:23,751 P5501 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:08<00:00, 31.28it/s] 100%|██████████| 669/669 [00:08<00:00, 82.53it/s]
2022-10-22 06:58:23,788 P5501 INFO Train loss: 0.565893
2022-10-22 06:58:23,788 P5501 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:51,  5.98it/s]  2%|▏         | 14/669 [00:00<00:10, 61.92it/s]  3%|▎         | 22/669 [00:00<00:10, 63.01it/s]  5%|▌         | 35/669 [00:00<00:07, 85.04it/s]  7%|▋         | 48/669 [00:00<00:06, 98.06it/s]  9%|▉         | 61/669 [00:00<00:05, 105.97it/s] 11%|█         | 74/669 [00:00<00:05, 111.70it/s] 13%|█▎        | 87/669 [00:00<00:05, 115.78it/s] 15%|█▍        | 100/669 [00:01<00:04, 118.80it/s] 17%|█▋        | 113/669 [00:01<00:04, 120.70it/s] 19%|█▉        | 126/669 [00:01<00:04, 122.23it/s] 21%|██        | 139/669 [00:01<00:04, 123.23it/s] 23%|██▎       | 152/669 [00:01<00:04, 123.66it/s] 25%|██▍       | 165/669 [00:01<00:04, 124.12it/s] 27%|██▋       | 178/669 [00:01<00:03, 124.44it/s] 29%|██▊       | 191/669 [00:01<00:03, 124.63it/s] 30%|███       | 204/669 [00:01<00:03, 124.90it/s] 32%|███▏      | 217/669 [00:01<00:03, 125.30it/s] 34%|███▍      | 230/669 [00:02<00:03, 125.58it/s] 36%|███▋      | 243/669 [00:02<00:03, 125.67it/s] 38%|███▊      | 256/669 [00:02<00:03, 125.67it/s] 40%|████      | 269/669 [00:02<00:03, 125.56it/s] 42%|████▏     | 282/669 [00:02<00:03, 125.69it/s] 44%|████▍     | 295/669 [00:02<00:02, 125.83it/s] 46%|████▌     | 308/669 [00:02<00:02, 125.97it/s] 48%|████▊     | 321/669 [00:02<00:02, 125.94it/s] 50%|████▉     | 334/669 [00:02<00:02, 125.90it/s] 52%|█████▏    | 347/669 [00:02<00:02, 125.79it/s] 54%|█████▍    | 360/669 [00:03<00:02, 125.90it/s] 56%|█████▌    | 373/669 [00:03<00:02, 126.13it/s] 58%|█████▊    | 386/669 [00:03<00:02, 126.10it/s] 60%|█████▉    | 399/669 [00:03<00:02, 126.15it/s] 62%|██████▏   | 412/669 [00:03<00:02, 126.19it/s] 64%|██████▎   | 425/669 [00:03<00:01, 126.21it/s] 65%|██████▌   | 438/669 [00:03<00:01, 126.35it/s] 67%|██████▋   | 451/669 [00:03<00:01, 126.51it/s] 69%|██████▉   | 464/669 [00:03<00:01, 126.64it/s] 71%|███████▏  | 477/669 [00:04<00:01, 126.54it/s] 73%|███████▎  | 490/669 [00:04<00:01, 126.71it/s] 75%|███████▌  | 503/669 [00:04<00:01, 126.73it/s] 77%|███████▋  | 516/669 [00:04<00:01, 126.64it/s] 79%|███████▉  | 529/669 [00:04<00:01, 126.68it/s] 81%|████████  | 542/669 [00:04<00:01, 126.60it/s] 83%|████████▎ | 555/669 [00:04<00:00, 116.71it/s] 85%|████████▍ | 568/669 [00:04<00:00, 119.35it/s] 87%|████████▋ | 581/669 [00:04<00:00, 121.62it/s] 89%|████████▉ | 594/669 [00:04<00:00, 123.07it/s] 91%|█████████ | 607/669 [00:05<00:00, 123.95it/s] 93%|█████████▎| 620/669 [00:05<00:00, 124.85it/s] 95%|█████████▍| 633/669 [00:05<00:00, 125.18it/s] 97%|█████████▋| 646/669 [00:05<00:00, 125.57it/s] 99%|█████████▊| 659/669 [00:05<00:00, 125.93it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:16,  9.97it/s][A
 11%|█         | 18/168 [00:00<00:02, 72.18it/s][A
 16%|█▌        | 27/168 [00:00<00:01, 78.19it/s][A
 36%|███▋      | 61/168 [00:00<00:00, 166.40it/s][A
 56%|█████▌    | 94/168 [00:00<00:00, 219.10it/s][A
 76%|███████▌  | 128/168 [00:00<00:00, 255.39it/s][A
 96%|█████████▌| 161/168 [00:00<00:00, 278.53it/s][A100%|██████████| 168/168 [00:00<00:00, 198.36it/s]
2022-10-22 06:58:30,338 P5501 INFO [Metrics] logloss: 0.562368 - AUC: 0.721005
2022-10-22 06:58:30,338 P5501 INFO Monitor(max) STOP: 0.158636 !
2022-10-22 06:58:30,338 P5501 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 06:58:30,339 P5501 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 101.47it/s]
2022-10-22 06:58:30,382 P5501 INFO Train loss: 0.453899
2022-10-22 06:58:30,382 P5501 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:44,  6.41it/s]  2%|▏         | 13/669 [00:00<00:10, 59.77it/s]  3%|▎         | 21/669 [00:00<00:10, 61.38it/s]  5%|▍         | 33/669 [00:00<00:07, 80.73it/s]  7%|▋         | 45/669 [00:00<00:06, 93.16it/s]  9%|▊         | 58/669 [00:00<00:05, 102.89it/s] 11%|█         | 71/669 [00:00<00:05, 109.54it/s] 13%|█▎        | 84/669 [00:00<00:05, 114.36it/s] 14%|█▍        | 97/669 [00:01<00:04, 117.87it/s] 16%|█▋        | 110/669 [00:01<00:04, 120.26it/s] 18%|█▊        | 123/669 [00:01<00:04, 121.81it/s] 20%|██        | 136/669 [00:01<00:04, 123.17it/s] 22%|██▏       | 149/669 [00:01<00:04, 124.31it/s] 24%|██▍       | 162/669 [00:01<00:04, 125.09it/s] 26%|██▌       | 175/669 [00:01<00:03, 125.53it/s] 28%|██▊       | 188/669 [00:01<00:03, 126.15it/s] 30%|███       | 201/669 [00:01<00:03, 126.47it/s] 32%|███▏      | 214/669 [00:01<00:03, 126.97it/s] 34%|███▍      | 227/669 [00:02<00:03, 127.01it/s] 36%|███▌      | 240/669 [00:02<00:03, 127.13it/s] 38%|███▊      | 253/669 [00:02<00:03, 127.00it/s] 40%|███▉      | 266/669 [00:02<00:03, 126.91it/s] 42%|████▏     | 279/669 [00:02<00:03, 127.03it/s] 44%|████▎     | 292/669 [00:02<00:02, 127.09it/s] 46%|████▌     | 305/669 [00:02<00:02, 127.14it/s] 48%|████▊     | 318/669 [00:02<00:02, 127.22it/s] 49%|████▉     | 331/669 [00:02<00:02, 127.27it/s] 51%|█████▏    | 344/669 [00:02<00:02, 127.17it/s] 53%|█████▎    | 357/669 [00:03<00:02, 127.28it/s] 55%|█████▌    | 370/669 [00:03<00:02, 127.17it/s] 57%|█████▋    | 383/669 [00:03<00:02, 127.23it/s] 59%|█████▉    | 396/669 [00:03<00:02, 127.27it/s] 61%|██████    | 409/669 [00:03<00:02, 127.42it/s] 63%|██████▎   | 422/669 [00:03<00:01, 127.49it/s] 65%|██████▌   | 435/669 [00:03<00:01, 127.51it/s] 67%|██████▋   | 448/669 [00:03<00:01, 127.28it/s] 69%|██████▉   | 461/669 [00:03<00:01, 127.36it/s] 71%|███████   | 474/669 [00:03<00:01, 127.42it/s] 73%|███████▎  | 487/669 [00:04<00:01, 127.53it/s] 75%|███████▍  | 500/669 [00:04<00:01, 127.43it/s] 77%|███████▋  | 513/669 [00:04<00:01, 127.42it/s] 79%|███████▊  | 526/669 [00:04<00:01, 127.23it/s] 81%|████████  | 539/669 [00:04<00:01, 127.27it/s] 83%|████████▎ | 552/669 [00:04<00:00, 127.08it/s] 84%|████████▍ | 565/669 [00:04<00:00, 127.02it/s] 86%|████████▋ | 578/669 [00:04<00:00, 127.17it/s] 88%|████████▊ | 591/669 [00:04<00:00, 127.01it/s] 90%|█████████ | 604/669 [00:04<00:00, 127.22it/s] 92%|█████████▏| 617/669 [00:05<00:00, 127.22it/s] 94%|█████████▍| 630/669 [00:05<00:00, 127.30it/s] 96%|█████████▌| 643/669 [00:05<00:00, 127.21it/s] 98%|█████████▊| 656/669 [00:05<00:00, 127.23it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 27.63it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 91.38it/s][A
 31%|███       | 52/168 [00:00<00:00, 191.22it/s][A
 51%|█████     | 86/168 [00:00<00:00, 244.29it/s][A
 71%|███████▏  | 120/168 [00:00<00:00, 275.95it/s][A
 92%|█████████▏| 154/168 [00:00<00:00, 294.57it/s][A100%|██████████| 168/168 [00:00<00:00, 229.51it/s]
2022-10-22 06:58:36,765 P5501 INFO [Metrics] logloss: 0.678026 - AUC: 0.706543
2022-10-22 06:58:36,765 P5501 INFO Monitor(max) STOP: 0.028517 !
2022-10-22 06:58:36,765 P5501 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 06:58:36,766 P5501 INFO Early stopping at epoch=3
2022-10-22 06:58:36,766 P5501 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:06<00:00, 103.94it/s]
2022-10-22 06:58:36,810 P5501 INFO Train loss: 0.330038
2022-10-22 06:58:36,810 P5501 INFO Training finished.
2022-10-22 06:58:36,810 P5501 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_004_75d98b21.model
2022-10-22 06:58:36,885 P5501 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:47,  6.24it/s]  3%|▎         | 19/669 [00:00<00:08, 77.42it/s]  8%|▊         | 52/669 [00:00<00:03, 171.19it/s] 13%|█▎        | 86/669 [00:00<00:02, 228.61it/s] 18%|█▊        | 120/669 [00:00<00:02, 263.90it/s] 23%|██▎       | 154/669 [00:00<00:01, 287.05it/s] 28%|██▊       | 188/669 [00:00<00:01, 302.09it/s] 33%|███▎      | 220/669 [00:00<00:01, 305.06it/s] 38%|███▊      | 252/669 [00:01<00:01, 302.76it/s] 42%|████▏     | 283/669 [00:01<00:01, 298.83it/s] 47%|████▋     | 314/669 [00:01<00:01, 298.69it/s] 52%|█████▏    | 345/669 [00:01<00:01, 298.24it/s] 56%|█████▌    | 375/669 [00:01<00:00, 298.59it/s] 61%|██████    | 405/669 [00:01<00:00, 298.96it/s] 65%|██████▌   | 435/669 [00:01<00:00, 299.11it/s] 70%|██████▉   | 465/669 [00:01<00:00, 299.25it/s] 74%|███████▍  | 495/669 [00:01<00:00, 299.33it/s] 79%|███████▊  | 526/669 [00:01<00:00, 299.65it/s] 83%|████████▎ | 557/669 [00:02<00:00, 300.00it/s] 88%|████████▊ | 588/669 [00:02<00:00, 300.48it/s] 93%|█████████▎| 619/669 [00:02<00:00, 300.95it/s] 97%|█████████▋| 650/669 [00:02<00:00, 301.33it/s]100%|██████████| 669/669 [00:02<00:00, 273.37it/s]
2022-10-22 06:58:39,905 P5501 INFO [Metrics] logloss: 0.471646 - AUC: 0.830331
  0%|          | 0/168 [00:00<?, ?it/s]  1%|          | 2/168 [00:00<00:08, 19.81it/s] 11%|█▏        | 19/168 [00:00<00:01, 94.42it/s] 30%|███       | 51/168 [00:00<00:00, 188.37it/s] 50%|█████     | 84/168 [00:00<00:00, 241.01it/s] 70%|██████▉   | 117/168 [00:00<00:00, 271.98it/s] 90%|████████▉ | 151/168 [00:00<00:00, 291.64it/s]100%|██████████| 168/168 [00:00<00:00, 233.39it/s]
2022-10-22 06:58:40,764 P5501 INFO [Metrics] logloss: 0.543824 - AUC: 0.727937
2022-10-22 06:58:40,834 P5501 INFO ******** Test evaluation ********
2022-10-22 06:58:40,834 P5501 INFO Loading data...
2022-10-22 06:58:40,836 P5501 INFO Loading test data done.
2022-10-22 06:58:43,103 P7280 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "16",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_005_4e6db415",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 06:58:43,105 P7280 INFO Set up feature encoder...
2022-10-22 06:58:43,106 P7280 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 06:58:43,107 P7280 INFO Loading data...
2022-10-22 06:58:43,110 P7280 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 06:58:43,226 P7280 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 06:58:43,264 P7280 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 06:58:43,264 P7280 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 06:58:43,265 P7280 INFO Loading train data done.
2022-10-22 06:58:45,764 P7280 INFO Total number of parameters: 4161832.
2022-10-22 06:58:45,765 P7280 INFO Start training: 669 batches/epoch
2022-10-22 06:58:45,765 P7280 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 06:58:46.092 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:7280 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 06:58:46.123 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:7280 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<12:21,  1.11s/it]  2%|▏         | 14/669 [00:01<00:41, 15.62it/s]  3%|▎         | 22/669 [00:01<00:27, 23.68it/s]  5%|▌         | 36/669 [00:01<00:15, 41.99it/s]  7%|▋         | 50/669 [00:01<00:10, 59.52it/s] 10%|▉         | 64/669 [00:01<00:07, 76.07it/s] 12%|█▏        | 78/669 [00:01<00:06, 90.64it/s] 14%|█▍        | 93/669 [00:01<00:05, 104.27it/s] 16%|█▌        | 108/669 [00:01<00:04, 115.00it/s] 18%|█▊        | 123/669 [00:02<00:04, 123.43it/s] 21%|██        | 138/669 [00:02<00:04, 129.79it/s] 23%|██▎       | 153/669 [00:02<00:03, 134.65it/s] 25%|██▌       | 168/669 [00:02<00:03, 138.20it/s] 27%|██▋       | 183/669 [00:02<00:03, 140.80it/s] 30%|██▉       | 198/669 [00:02<00:03, 142.65it/s] 32%|███▏      | 213/669 [00:02<00:03, 144.07it/s] 34%|███▍      | 228/669 [00:02<00:03, 145.07it/s] 36%|███▋      | 243/669 [00:02<00:02, 145.74it/s] 39%|███▊      | 258/669 [00:02<00:02, 146.09it/s] 41%|████      | 273/669 [00:03<00:02, 146.40it/s] 43%|████▎     | 288/669 [00:03<00:02, 146.64it/s] 45%|████▌     | 303/669 [00:03<00:02, 146.74it/s] 48%|████▊     | 318/669 [00:03<00:02, 146.74it/s] 50%|████▉     | 333/669 [00:03<00:02, 146.91it/s] 52%|█████▏    | 348/669 [00:03<00:02, 147.04it/s] 54%|█████▍    | 363/669 [00:03<00:02, 147.11it/s] 57%|█████▋    | 378/669 [00:03<00:01, 147.07it/s] 59%|█████▊    | 393/669 [00:03<00:01, 147.11it/s] 61%|██████    | 408/669 [00:04<00:01, 146.89it/s] 63%|██████▎   | 423/669 [00:04<00:01, 146.89it/s] 65%|██████▌   | 438/669 [00:04<00:01, 146.90it/s] 68%|██████▊   | 453/669 [00:04<00:01, 146.93it/s] 70%|██████▉   | 468/669 [00:04<00:01, 146.93it/s] 72%|███████▏  | 483/669 [00:04<00:01, 147.01it/s] 74%|███████▍  | 498/669 [00:04<00:01, 147.06it/s] 77%|███████▋  | 513/669 [00:04<00:01, 147.06it/s] 79%|███████▉  | 528/669 [00:04<00:00, 147.12it/s] 81%|████████  | 543/669 [00:04<00:00, 147.24it/s] 83%|████████▎ | 558/669 [00:05<00:00, 134.89it/s] 86%|████████▌ | 574/669 [00:05<00:00, 139.73it/s] 88%|████████▊ | 590/669 [00:05<00:00, 143.26it/s] 91%|█████████ | 606/669 [00:05<00:00, 145.83it/s] 93%|█████████▎| 622/669 [00:05<00:00, 147.62it/s] 95%|█████████▌| 638/669 [00:05<00:00, 148.87it/s] 98%|█████████▊| 654/669 [00:05<00:00, 149.92it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  3%|▎         | 5/168 [00:00<00:03, 49.56it/s][A
 12%|█▏        | 20/168 [00:00<00:01, 96.04it/s][A
 35%|███▍      | 58/168 [00:00<00:00, 214.70it/s][A
 57%|█████▋    | 96/168 [00:00<00:00, 274.47it/s][A
 80%|███████▉  | 134/168 [00:00<00:00, 309.63it/s][A100%|██████████| 168/168 [00:00<00:00, 256.26it/s]
2022-10-22 06:58:52,347 P7280 INFO [Metrics] logloss: 0.533254 - AUC: 0.743556
2022-10-22 06:58:52,347 P7280 INFO Save best model: monitor(max): 0.210301
2022-10-22 06:58:52,494 P7280 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 98.98it/s] 
2022-10-22 06:58:52,526 P7280 INFO Train loss: 0.551983
2022-10-22 06:58:52,526 P7280 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:36,  6.90it/s]  2%|▏         | 16/669 [00:00<00:08, 76.77it/s]  4%|▎         | 25/669 [00:00<00:08, 73.91it/s]  6%|▌         | 40/669 [00:00<00:06, 99.66it/s]  8%|▊         | 55/669 [00:00<00:05, 115.54it/s] 10%|█         | 70/669 [00:00<00:04, 125.93it/s] 13%|█▎        | 85/669 [00:00<00:04, 132.77it/s] 15%|█▍        | 100/669 [00:00<00:04, 137.32it/s] 17%|█▋        | 115/669 [00:00<00:03, 140.52it/s] 19%|█▉        | 130/669 [00:01<00:03, 142.72it/s] 22%|██▏       | 145/669 [00:01<00:03, 144.34it/s] 24%|██▍       | 160/669 [00:01<00:03, 145.46it/s] 26%|██▌       | 175/669 [00:01<00:03, 146.21it/s] 28%|██▊       | 190/669 [00:01<00:03, 146.82it/s] 31%|███       | 205/669 [00:01<00:03, 147.25it/s] 33%|███▎      | 220/669 [00:01<00:03, 147.40it/s] 35%|███▌      | 235/669 [00:01<00:02, 147.44it/s] 37%|███▋      | 250/669 [00:01<00:02, 147.64it/s] 40%|███▉      | 265/669 [00:01<00:02, 147.74it/s] 42%|████▏     | 280/669 [00:02<00:02, 147.76it/s] 44%|████▍     | 295/669 [00:02<00:02, 147.77it/s] 46%|████▋     | 310/669 [00:02<00:02, 147.72it/s] 49%|████▊     | 325/669 [00:02<00:02, 147.72it/s] 51%|█████     | 340/669 [00:02<00:02, 147.72it/s] 53%|█████▎    | 355/669 [00:02<00:02, 147.52it/s] 55%|█████▌    | 370/669 [00:02<00:02, 147.49it/s] 58%|█████▊    | 385/669 [00:02<00:01, 147.53it/s] 60%|█████▉    | 400/669 [00:02<00:01, 147.58it/s] 62%|██████▏   | 415/669 [00:03<00:01, 147.60it/s] 64%|██████▍   | 430/669 [00:03<00:01, 147.64it/s] 67%|██████▋   | 445/669 [00:03<00:01, 147.72it/s] 69%|██████▉   | 460/669 [00:03<00:01, 147.68it/s] 71%|███████   | 475/669 [00:03<00:01, 147.76it/s] 73%|███████▎  | 490/669 [00:03<00:01, 147.76it/s] 75%|███████▌  | 505/669 [00:03<00:01, 147.80it/s] 78%|███████▊  | 520/669 [00:03<00:01, 147.78it/s] 80%|███████▉  | 535/669 [00:03<00:00, 147.53it/s] 82%|████████▏ | 550/669 [00:03<00:00, 132.29it/s] 84%|████████▍ | 565/669 [00:04<00:00, 135.84it/s] 87%|████████▋ | 580/669 [00:04<00:00, 138.81it/s] 89%|████████▉ | 595/669 [00:04<00:00, 141.05it/s] 91%|█████████ | 610/669 [00:04<00:00, 142.47it/s] 93%|█████████▎| 625/669 [00:04<00:00, 143.48it/s] 96%|█████████▌| 640/669 [00:04<00:00, 144.36it/s] 98%|█████████▊| 655/669 [00:04<00:00, 145.16it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:11, 14.58it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 88.33it/s][A
 32%|███▏      | 53/168 [00:00<00:00, 189.27it/s][A
 54%|█████▎    | 90/168 [00:00<00:00, 254.04it/s][A
 76%|███████▌  | 127/168 [00:00<00:00, 292.68it/s][A
 98%|█████████▊| 165/168 [00:00<00:00, 319.17it/s][A100%|██████████| 168/168 [00:00<00:00, 237.64it/s]
2022-10-22 06:58:58,159 P7280 INFO [Metrics] logloss: 0.565864 - AUC: 0.708482
2022-10-22 06:58:58,159 P7280 INFO Monitor(max) STOP: 0.142617 !
2022-10-22 06:58:58,160 P7280 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 06:58:58,160 P7280 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:05<00:00, 117.87it/s]
2022-10-22 06:58:58,202 P7280 INFO Train loss: 0.428579
2022-10-22 06:58:58,203 P7280 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:41,  6.59it/s]  3%|▎         | 17/669 [00:00<00:08, 78.47it/s]  4%|▍         | 27/669 [00:00<00:08, 78.30it/s]  6%|▋         | 43/669 [00:00<00:06, 104.13it/s]  9%|▉         | 59/669 [00:00<00:05, 120.04it/s] 11%|█         | 75/669 [00:00<00:04, 130.24it/s] 14%|█▎        | 91/669 [00:00<00:04, 137.11it/s] 16%|█▌        | 107/669 [00:00<00:03, 141.72it/s] 18%|█▊        | 123/669 [00:01<00:03, 144.88it/s] 21%|██        | 139/669 [00:01<00:03, 146.93it/s] 23%|██▎       | 155/669 [00:01<00:03, 148.14it/s] 25%|██▌       | 170/669 [00:01<00:03, 147.41it/s] 28%|██▊       | 185/669 [00:01<00:03, 147.00it/s] 30%|██▉       | 200/669 [00:01<00:03, 146.61it/s] 32%|███▏      | 215/669 [00:01<00:03, 146.42it/s] 34%|███▍      | 230/669 [00:01<00:03, 146.28it/s] 37%|███▋      | 245/669 [00:01<00:02, 146.20it/s] 39%|███▉      | 260/669 [00:01<00:02, 146.00it/s] 41%|████      | 275/669 [00:02<00:02, 146.03it/s] 43%|████▎     | 290/669 [00:02<00:02, 145.91it/s] 46%|████▌     | 305/669 [00:02<00:02, 145.92it/s] 48%|████▊     | 320/669 [00:02<00:02, 145.83it/s] 50%|█████     | 335/669 [00:02<00:02, 145.89it/s] 52%|█████▏    | 350/669 [00:02<00:02, 145.84it/s] 55%|█████▍    | 365/669 [00:02<00:02, 145.90it/s] 57%|█████▋    | 380/669 [00:02<00:01, 145.90it/s] 59%|█████▉    | 395/669 [00:02<00:01, 145.81it/s] 61%|██████▏   | 410/669 [00:02<00:01, 145.94it/s] 64%|██████▎   | 425/669 [00:03<00:01, 145.86it/s] 66%|██████▌   | 440/669 [00:03<00:01, 145.85it/s] 68%|██████▊   | 455/669 [00:03<00:01, 145.81it/s] 70%|███████   | 470/669 [00:03<00:01, 145.84it/s] 72%|███████▏  | 485/669 [00:03<00:01, 145.88it/s] 75%|███████▍  | 500/669 [00:03<00:01, 145.97it/s] 77%|███████▋  | 515/669 [00:03<00:01, 145.89it/s] 79%|███████▉  | 530/669 [00:03<00:00, 145.86it/s] 81%|████████▏ | 545/669 [00:03<00:00, 145.94it/s] 84%|████████▎ | 560/669 [00:04<00:00, 145.96it/s] 86%|████████▌ | 575/669 [00:04<00:00, 145.89it/s] 88%|████████▊ | 590/669 [00:04<00:00, 145.90it/s] 90%|█████████ | 605/669 [00:04<00:00, 145.92it/s] 93%|█████████▎| 620/669 [00:04<00:00, 146.00it/s] 95%|█████████▍| 635/669 [00:04<00:00, 145.97it/s] 97%|█████████▋| 650/669 [00:04<00:00, 146.05it/s] 99%|█████████▉| 665/669 [00:04<00:00, 143.52it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 29.67it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 98.34it/s][A
 34%|███▍      | 57/168 [00:00<00:00, 219.02it/s][A
 56%|█████▌    | 94/168 [00:00<00:00, 276.10it/s][A
 79%|███████▊  | 132/168 [00:00<00:00, 311.59it/s][A100%|██████████| 168/168 [00:00<00:00, 257.40it/s]
2022-10-22 06:59:03,752 P7280 INFO [Metrics] logloss: 0.659156 - AUC: 0.700531
2022-10-22 06:59:03,752 P7280 INFO Monitor(max) STOP: 0.041375 !
2022-10-22 06:59:03,752 P7280 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 06:59:03,752 P7280 INFO Early stopping at epoch=3
2022-10-22 06:59:03,753 P7280 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:05<00:00, 119.56it/s]
2022-10-22 06:59:03,790 P7280 INFO Train loss: 0.371453
2022-10-22 06:59:03,791 P7280 INFO Training finished.
2022-10-22 06:59:03,791 P7280 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_005_4e6db415.model
2022-10-22 06:59:03,810 P7280 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:34,  7.04it/s]  3%|▎         | 19/669 [00:00<00:07, 83.25it/s]  8%|▊         | 56/669 [00:00<00:03, 192.73it/s] 14%|█▍        | 93/669 [00:00<00:02, 253.56it/s] 19%|█▉        | 130/669 [00:00<00:01, 290.62it/s] 25%|██▍       | 167/669 [00:00<00:01, 314.35it/s] 30%|███       | 204/669 [00:00<00:01, 330.66it/s] 36%|███▌      | 241/669 [00:00<00:01, 340.46it/s] 41%|████▏     | 277/669 [00:00<00:01, 344.72it/s] 47%|████▋     | 313/669 [00:01<00:01, 346.93it/s] 52%|█████▏    | 349/669 [00:01<00:00, 349.69it/s] 58%|█████▊    | 385/669 [00:01<00:00, 349.71it/s] 63%|██████▎   | 421/669 [00:01<00:00, 352.05it/s] 68%|██████▊   | 457/669 [00:01<00:00, 352.56it/s] 74%|███████▎  | 493/669 [00:01<00:00, 353.18it/s] 79%|███████▉  | 529/669 [00:01<00:00, 353.86it/s] 84%|████████▍ | 565/669 [00:01<00:00, 354.44it/s] 90%|████████▉ | 601/669 [00:01<00:00, 354.99it/s] 95%|█████████▌| 637/669 [00:01<00:00, 355.21it/s]100%|██████████| 669/669 [00:02<00:00, 314.32it/s]
2022-10-22 06:59:06,523 P7280 INFO [Metrics] logloss: 0.464105 - AUC: 0.835809
  0%|          | 0/168 [00:00<?, ?it/s]  2%|▏         | 3/168 [00:00<00:05, 28.98it/s] 11%|█▏        | 19/168 [00:00<00:01, 93.67it/s] 33%|███▎      | 55/168 [00:00<00:00, 206.77it/s] 55%|█████▍    | 92/168 [00:00<00:00, 266.27it/s] 77%|███████▋  | 129/168 [00:00<00:00, 299.84it/s] 99%|█████████▉| 166/168 [00:00<00:00, 321.48it/s]100%|██████████| 168/168 [00:00<00:00, 249.06it/s]
2022-10-22 06:59:07,337 P7280 INFO [Metrics] logloss: 0.533254 - AUC: 0.743556
2022-10-22 06:59:07,416 P7280 INFO ******** Test evaluation ********
2022-10-22 06:59:07,416 P7280 INFO Loading data...
2022-10-22 06:59:07,417 P7280 INFO Loading test data done.
2022-10-22 06:59:13,068 P9059 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "8",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_006_b4d6abb6",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 06:59:13,070 P9059 INFO Set up feature encoder...
2022-10-22 06:59:13,070 P9059 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 06:59:13,071 P9059 INFO Loading data...
2022-10-22 06:59:13,075 P9059 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 06:59:13,183 P9059 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 06:59:13,216 P9059 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 06:59:13,216 P9059 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 06:59:13,216 P9059 INFO Loading train data done.
2022-10-22 06:59:15,672 P9059 INFO Total number of parameters: 2354288.
2022-10-22 06:59:15,673 P9059 INFO Start training: 669 batches/epoch
2022-10-22 06:59:15,673 P9059 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 06:59:16.003 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:9059 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 06:59:16.035 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:9059 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<12:06,  1.09s/it]  2%|▏         | 16/669 [00:01<00:36, 17.94it/s]  4%|▎         | 24/669 [00:01<00:24, 25.91it/s]  6%|▌         | 39/669 [00:01<00:13, 45.80it/s]  8%|▊         | 54/669 [00:01<00:09, 64.81it/s] 10%|█         | 69/669 [00:01<00:07, 82.12it/s] 13%|█▎        | 85/669 [00:01<00:05, 98.73it/s] 15%|█▌        | 101/669 [00:01<00:05, 112.36it/s] 17%|█▋        | 117/669 [00:01<00:04, 123.68it/s] 20%|█▉        | 133/669 [00:02<00:04, 132.42it/s] 22%|██▏       | 149/669 [00:02<00:03, 139.47it/s] 25%|██▍       | 165/669 [00:02<00:03, 144.77it/s] 27%|██▋       | 181/669 [00:02<00:03, 148.73it/s] 29%|██▉       | 197/669 [00:02<00:03, 151.45it/s] 32%|███▏      | 213/669 [00:02<00:02, 153.60it/s] 34%|███▍      | 229/669 [00:02<00:02, 155.20it/s] 37%|███▋      | 245/669 [00:02<00:02, 156.27it/s] 39%|███▉      | 261/669 [00:02<00:02, 156.82it/s] 41%|████▏     | 277/669 [00:02<00:02, 157.28it/s] 44%|████▍     | 293/669 [00:03<00:02, 157.65it/s] 46%|████▌     | 309/669 [00:03<00:02, 157.87it/s] 49%|████▊     | 325/669 [00:03<00:02, 157.81it/s] 51%|█████     | 341/669 [00:03<00:02, 156.93it/s] 53%|█████▎    | 357/669 [00:03<00:01, 156.61it/s] 56%|█████▌    | 373/669 [00:03<00:01, 156.26it/s] 58%|█████▊    | 389/669 [00:03<00:01, 155.96it/s] 61%|██████    | 405/669 [00:03<00:01, 155.85it/s] 63%|██████▎   | 421/669 [00:03<00:01, 155.84it/s] 65%|██████▌   | 437/669 [00:03<00:01, 155.81it/s] 68%|██████▊   | 453/669 [00:04<00:01, 155.87it/s] 70%|███████   | 469/669 [00:04<00:01, 156.18it/s] 72%|███████▏  | 485/669 [00:04<00:01, 156.37it/s] 75%|███████▍  | 501/669 [00:04<00:01, 156.43it/s] 77%|███████▋  | 517/669 [00:04<00:00, 156.28it/s] 80%|███████▉  | 533/669 [00:04<00:00, 156.42it/s] 82%|████████▏ | 549/669 [00:04<00:00, 143.05it/s] 84%|████████▍ | 565/669 [00:04<00:00, 146.72it/s] 87%|████████▋ | 581/669 [00:04<00:00, 149.32it/s] 89%|████████▉ | 597/669 [00:05<00:00, 151.37it/s] 92%|█████████▏| 613/669 [00:05<00:00, 152.70it/s] 94%|█████████▍| 629/669 [00:05<00:00, 153.80it/s] 96%|█████████▋| 645/669 [00:05<00:00, 154.43it/s] 99%|█████████▉| 661/669 [00:05<00:00, 154.94it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 28.78it/s][A
 12%|█▏        | 20/168 [00:00<00:01, 101.20it/s][A
 34%|███▍      | 57/168 [00:00<00:00, 216.07it/s][A
 57%|█████▋    | 95/168 [00:00<00:00, 276.49it/s][A
 79%|███████▉  | 133/168 [00:00<00:00, 311.17it/s][A100%|██████████| 168/168 [00:00<00:00, 256.74it/s]
2022-10-22 06:59:21,971 P9059 INFO [Metrics] logloss: 0.534174 - AUC: 0.742810
2022-10-22 06:59:21,971 P9059 INFO Save best model: monitor(max): 0.208636
2022-10-22 06:59:22,088 P9059 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 103.78it/s]
2022-10-22 06:59:22,122 P9059 INFO Train loss: 0.552431
2022-10-22 06:59:22,122 P9059 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:38,  6.80it/s]  3%|▎         | 17/669 [00:00<00:08, 80.48it/s]  4%|▍         | 27/669 [00:00<00:08, 79.14it/s]  6%|▋         | 43/669 [00:00<00:05, 105.45it/s]  9%|▉         | 59/669 [00:00<00:05, 121.73it/s] 11%|█         | 75/669 [00:00<00:04, 133.56it/s] 14%|█▎        | 91/669 [00:00<00:04, 141.68it/s] 16%|█▌        | 108/669 [00:00<00:03, 148.23it/s] 19%|█▊        | 125/669 [00:00<00:03, 152.97it/s] 21%|██        | 142/669 [00:01<00:03, 156.44it/s] 24%|██▍       | 159/669 [00:01<00:03, 158.88it/s] 26%|██▋       | 176/669 [00:01<00:03, 160.57it/s] 29%|██▉       | 193/669 [00:01<00:02, 161.95it/s] 31%|███▏      | 210/669 [00:01<00:02, 162.81it/s] 34%|███▍      | 227/669 [00:01<00:02, 163.54it/s] 36%|███▋      | 244/669 [00:01<00:02, 163.91it/s] 39%|███▉      | 261/669 [00:01<00:02, 164.37it/s] 42%|████▏     | 278/669 [00:01<00:02, 164.53it/s] 44%|████▍     | 295/669 [00:02<00:02, 164.66it/s] 47%|████▋     | 312/669 [00:02<00:02, 164.83it/s] 49%|████▉     | 329/669 [00:02<00:02, 165.03it/s] 52%|█████▏    | 346/669 [00:02<00:01, 165.07it/s] 54%|█████▍    | 363/669 [00:02<00:01, 165.10it/s] 57%|█████▋    | 380/669 [00:02<00:01, 165.05it/s] 59%|█████▉    | 397/669 [00:02<00:01, 165.14it/s] 62%|██████▏   | 414/669 [00:02<00:01, 165.21it/s] 64%|██████▍   | 431/669 [00:02<00:01, 165.23it/s] 67%|██████▋   | 448/669 [00:02<00:01, 165.35it/s] 70%|██████▉   | 465/669 [00:03<00:01, 165.32it/s] 72%|███████▏  | 482/669 [00:03<00:01, 165.35it/s] 75%|███████▍  | 499/669 [00:03<00:01, 165.49it/s] 77%|███████▋  | 516/669 [00:03<00:00, 165.33it/s] 80%|███████▉  | 533/669 [00:03<00:00, 165.42it/s] 82%|████████▏ | 550/669 [00:03<00:00, 150.76it/s] 85%|████████▍ | 567/669 [00:03<00:00, 154.67it/s] 87%|████████▋ | 584/669 [00:03<00:00, 157.80it/s] 90%|████████▉ | 601/669 [00:03<00:00, 159.94it/s] 92%|█████████▏| 618/669 [00:04<00:00, 161.56it/s] 95%|█████████▍| 635/669 [00:04<00:00, 162.81it/s] 97%|█████████▋| 652/669 [00:04<00:00, 163.48it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:07, 22.03it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 84.31it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 193.78it/s][A
 55%|█████▍    | 92/168 [00:00<00:00, 255.39it/s][A
 77%|███████▋  | 129/168 [00:00<00:00, 291.75it/s][A
 99%|█████████▉| 167/168 [00:00<00:00, 317.28it/s][A100%|██████████| 168/168 [00:00<00:00, 236.97it/s]
2022-10-22 06:59:27,299 P9059 INFO [Metrics] logloss: 0.548555 - AUC: 0.731809
2022-10-22 06:59:27,300 P9059 INFO Monitor(max) STOP: 0.183254 !
2022-10-22 06:59:27,300 P9059 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 06:59:27,300 P9059 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:05<00:00, 47.25it/s] 100%|██████████| 669/669 [00:05<00:00, 128.30it/s]
2022-10-22 06:59:27,337 P9059 INFO Train loss: 0.446457
2022-10-22 06:59:27,337 P9059 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:38,  6.75it/s]  3%|▎         | 18/669 [00:00<00:07, 84.88it/s]  4%|▍         | 28/669 [00:00<00:07, 81.45it/s]  7%|▋         | 44/669 [00:00<00:05, 107.82it/s]  9%|▉         | 60/669 [00:00<00:04, 124.22it/s] 12%|█▏        | 77/669 [00:00<00:04, 136.21it/s] 14%|█▍        | 94/669 [00:00<00:03, 144.40it/s] 17%|█▋        | 111/669 [00:00<00:03, 150.17it/s] 19%|█▉        | 128/669 [00:01<00:03, 154.20it/s] 22%|██▏       | 145/669 [00:01<00:03, 157.01it/s] 24%|██▍       | 162/669 [00:01<00:03, 159.10it/s] 27%|██▋       | 179/669 [00:01<00:03, 160.54it/s] 29%|██▉       | 196/669 [00:01<00:02, 161.53it/s] 32%|███▏      | 213/669 [00:01<00:02, 162.19it/s] 34%|███▍      | 230/669 [00:01<00:02, 162.68it/s] 37%|███▋      | 247/669 [00:01<00:02, 163.07it/s] 39%|███▉      | 264/669 [00:01<00:02, 163.30it/s] 42%|████▏     | 281/669 [00:01<00:02, 163.57it/s] 45%|████▍     | 298/669 [00:02<00:02, 163.77it/s] 47%|████▋     | 315/669 [00:02<00:02, 163.88it/s] 50%|████▉     | 332/669 [00:02<00:02, 163.86it/s] 52%|█████▏    | 349/669 [00:02<00:01, 163.94it/s] 55%|█████▍    | 366/669 [00:02<00:01, 163.95it/s] 57%|█████▋    | 383/669 [00:02<00:01, 164.00it/s] 60%|█████▉    | 400/669 [00:02<00:01, 164.03it/s] 62%|██████▏   | 417/669 [00:02<00:01, 164.09it/s] 65%|██████▍   | 434/669 [00:02<00:01, 164.08it/s] 67%|██████▋   | 451/669 [00:02<00:01, 163.96it/s] 70%|██████▉   | 468/669 [00:03<00:01, 163.36it/s] 72%|███████▏  | 485/669 [00:03<00:01, 163.60it/s] 75%|███████▌  | 502/669 [00:03<00:01, 163.69it/s] 78%|███████▊  | 519/669 [00:03<00:00, 163.75it/s] 80%|████████  | 536/669 [00:03<00:00, 163.94it/s] 83%|████████▎ | 553/669 [00:03<00:00, 164.05it/s] 85%|████████▌ | 570/669 [00:03<00:00, 163.99it/s] 88%|████████▊ | 587/669 [00:03<00:00, 164.01it/s] 90%|█████████ | 604/669 [00:03<00:00, 164.05it/s] 93%|█████████▎| 621/669 [00:04<00:00, 164.08it/s] 95%|█████████▌| 638/669 [00:04<00:00, 164.01it/s] 98%|█████████▊| 655/669 [00:04<00:00, 164.02it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 4/168 [00:00<00:04, 39.77it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 94.22it/s][A
 33%|███▎      | 56/168 [00:00<00:00, 212.66it/s][A
 56%|█████▌    | 94/168 [00:00<00:00, 274.78it/s][A
 78%|███████▊  | 131/168 [00:00<00:00, 306.57it/s][A100%|██████████| 168/168 [00:00<00:00, 252.49it/s]
2022-10-22 06:59:32,448 P9059 INFO [Metrics] logloss: 0.645509 - AUC: 0.705703
2022-10-22 06:59:32,448 P9059 INFO Monitor(max) STOP: 0.060194 !
2022-10-22 06:59:32,448 P9059 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 06:59:32,448 P9059 INFO Early stopping at epoch=3
2022-10-22 06:59:32,449 P9059 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:05<00:00, 129.71it/s]
2022-10-22 06:59:32,488 P9059 INFO Train loss: 0.376300
2022-10-22 06:59:32,488 P9059 INFO Training finished.
2022-10-22 06:59:32,488 P9059 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_006_b4d6abb6.model
2022-10-22 06:59:32,560 P9059 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:36,  6.89it/s]  3%|▎         | 19/669 [00:00<00:07, 81.44it/s]  8%|▊         | 56/669 [00:00<00:03, 191.20it/s] 14%|█▍        | 94/669 [00:00<00:02, 256.32it/s] 19%|█▉        | 128/669 [00:00<00:01, 284.02it/s] 24%|██▍       | 162/669 [00:00<00:01, 299.47it/s] 29%|██▉       | 196/669 [00:00<00:01, 310.27it/s] 34%|███▍      | 230/669 [00:00<00:01, 317.49it/s] 39%|███▉      | 264/669 [00:00<00:01, 322.43it/s] 45%|████▍     | 298/669 [00:01<00:01, 325.76it/s] 50%|████▉     | 332/669 [00:01<00:01, 328.29it/s] 55%|█████▍    | 366/669 [00:01<00:00, 329.81it/s] 60%|█████▉    | 400/669 [00:01<00:00, 330.92it/s] 65%|██████▍   | 434/669 [00:01<00:00, 328.40it/s] 70%|██████▉   | 468/669 [00:01<00:00, 329.86it/s] 75%|███████▌  | 502/669 [00:01<00:00, 330.59it/s] 80%|████████  | 536/669 [00:01<00:00, 331.13it/s] 85%|████████▌ | 570/669 [00:01<00:00, 331.49it/s] 90%|█████████ | 604/669 [00:02<00:00, 331.33it/s] 95%|█████████▌| 638/669 [00:02<00:00, 331.37it/s]100%|██████████| 669/669 [00:02<00:00, 297.24it/s]
2022-10-22 06:59:35,392 P9059 INFO [Metrics] logloss: 0.460404 - AUC: 0.839602
  0%|          | 0/168 [00:00<?, ?it/s]  1%|          | 1/168 [00:00<00:17,  9.74it/s] 11%|█▏        | 19/168 [00:00<00:01, 92.54it/s] 32%|███▏      | 54/168 [00:00<00:00, 197.78it/s] 54%|█████▎    | 90/168 [00:00<00:00, 256.29it/s] 74%|███████▍  | 125/168 [00:00<00:00, 287.78it/s] 96%|█████████▌| 161/168 [00:00<00:00, 309.58it/s]100%|██████████| 168/168 [00:00<00:00, 241.24it/s]
2022-10-22 06:59:36,228 P9059 INFO [Metrics] logloss: 0.534174 - AUC: 0.742810
2022-10-22 06:59:36,304 P9059 INFO ******** Test evaluation ********
2022-10-22 06:59:36,304 P9059 INFO Loading data...
2022-10-22 06:59:36,305 P9059 INFO Loading test data done.
2022-10-22 06:59:43,161 P10844 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "16",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_007_ea6736dc",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 06:59:43,163 P10844 INFO Set up feature encoder...
2022-10-22 06:59:43,163 P10844 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 06:59:43,167 P10844 INFO Loading data...
2022-10-22 06:59:43,170 P10844 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 06:59:43,268 P10844 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 06:59:43,305 P10844 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 06:59:43,305 P10844 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 06:59:43,305 P10844 INFO Loading train data done.
2022-10-22 06:59:45,850 P10844 INFO Total number of parameters: 4161832.
2022-10-22 06:59:45,850 P10844 INFO Start training: 669 batches/epoch
2022-10-22 06:59:45,850 P10844 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 06:59:46.195 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:10844 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 06:59:46.227 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:10844 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<12:50,  1.15s/it]  2%|▏         | 14/669 [00:01<00:43, 15.01it/s]  3%|▎         | 22/669 [00:01<00:28, 22.84it/s]  5%|▌         | 35/669 [00:01<00:16, 39.47it/s]  7%|▋         | 48/669 [00:01<00:11, 55.92it/s]  9%|▉         | 61/669 [00:01<00:08, 71.14it/s] 11%|█         | 75/669 [00:01<00:06, 85.75it/s] 13%|█▎        | 89/669 [00:01<00:05, 97.99it/s] 15%|█▌        | 103/669 [00:02<00:05, 107.90it/s] 17%|█▋        | 117/669 [00:02<00:04, 115.56it/s] 20%|█▉        | 131/669 [00:02<00:04, 121.50it/s] 22%|██▏       | 145/669 [00:02<00:04, 125.94it/s] 24%|██▍       | 159/669 [00:02<00:03, 129.32it/s] 26%|██▌       | 173/669 [00:02<00:03, 131.84it/s] 28%|██▊       | 187/669 [00:02<00:03, 133.73it/s] 30%|███       | 201/669 [00:02<00:03, 135.06it/s] 32%|███▏      | 215/669 [00:02<00:03, 136.09it/s] 34%|███▍      | 229/669 [00:02<00:03, 136.78it/s] 36%|███▋      | 243/669 [00:03<00:03, 137.36it/s] 38%|███▊      | 257/669 [00:03<00:02, 137.61it/s] 41%|████      | 271/669 [00:03<00:02, 137.86it/s] 43%|████▎     | 285/669 [00:03<00:02, 137.88it/s] 45%|████▍     | 299/669 [00:03<00:02, 137.99it/s] 47%|████▋     | 313/669 [00:03<00:02, 137.94it/s] 49%|████▉     | 327/669 [00:03<00:02, 138.01it/s] 51%|█████     | 341/669 [00:03<00:02, 138.15it/s] 53%|█████▎    | 355/669 [00:03<00:02, 138.15it/s] 55%|█████▌    | 369/669 [00:03<00:02, 138.09it/s] 57%|█████▋    | 383/669 [00:04<00:02, 138.04it/s] 59%|█████▉    | 397/669 [00:04<00:01, 138.17it/s] 61%|██████▏   | 411/669 [00:04<00:01, 138.08it/s] 64%|██████▎   | 425/669 [00:04<00:01, 137.92it/s] 66%|██████▌   | 439/669 [00:04<00:01, 137.77it/s] 68%|██████▊   | 453/669 [00:04<00:01, 137.79it/s] 70%|██████▉   | 467/669 [00:04<00:01, 137.83it/s] 72%|███████▏  | 481/669 [00:04<00:01, 138.04it/s] 74%|███████▍  | 495/669 [00:04<00:01, 137.97it/s] 76%|███████▌  | 509/669 [00:04<00:01, 137.89it/s] 78%|███████▊  | 523/669 [00:05<00:01, 137.89it/s] 80%|████████  | 537/669 [00:05<00:00, 137.93it/s] 82%|████████▏ | 551/669 [00:05<00:00, 124.49it/s] 84%|████████▍ | 565/669 [00:05<00:00, 128.26it/s] 87%|████████▋ | 579/669 [00:05<00:00, 130.67it/s] 89%|████████▊ | 593/669 [00:05<00:00, 132.72it/s] 91%|█████████ | 607/669 [00:05<00:00, 134.23it/s] 93%|█████████▎| 621/669 [00:05<00:00, 135.29it/s] 95%|█████████▍| 635/669 [00:05<00:00, 135.69it/s] 97%|█████████▋| 649/669 [00:06<00:00, 136.03it/s] 99%|█████████▉| 663/669 [00:06<00:00, 134.57it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.74it/s][A
 12%|█▏        | 20/168 [00:00<00:01, 84.20it/s][A
 31%|███       | 52/168 [00:00<00:00, 172.54it/s][A
 50%|█████     | 84/168 [00:00<00:00, 223.13it/s][A
 69%|██████▉   | 116/168 [00:00<00:00, 255.14it/s][A
 90%|████████▉ | 151/168 [00:00<00:00, 284.08it/s][A100%|██████████| 168/168 [00:00<00:00, 224.37it/s]
2022-10-22 06:59:52,892 P10844 INFO [Metrics] logloss: 0.533178 - AUC: 0.743600
2022-10-22 06:59:52,892 P10844 INFO Save best model: monitor(max): 0.210421
2022-10-22 06:59:53,038 P10844 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 92.61it/s] 
2022-10-22 06:59:53,077 P10844 INFO Train loss: 0.552043
2022-10-22 06:59:53,077 P10844 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:43,  6.47it/s]  2%|▏         | 15/669 [00:00<00:09, 69.75it/s]  4%|▎         | 24/669 [00:00<00:09, 69.90it/s]  6%|▌         | 38/669 [00:00<00:06, 93.59it/s]  8%|▊         | 52/669 [00:00<00:05, 108.18it/s] 10%|▉         | 66/669 [00:00<00:05, 117.58it/s] 12%|█▏        | 80/669 [00:00<00:04, 123.99it/s] 14%|█▍        | 94/669 [00:00<00:04, 128.41it/s] 16%|█▌        | 108/669 [00:00<00:04, 131.40it/s] 18%|█▊        | 122/669 [00:01<00:04, 133.52it/s] 20%|██        | 136/669 [00:01<00:03, 134.88it/s] 22%|██▏       | 150/669 [00:01<00:03, 135.45it/s] 25%|██▍       | 164/669 [00:01<00:03, 135.88it/s] 27%|██▋       | 178/669 [00:01<00:03, 136.37it/s] 29%|██▊       | 192/669 [00:01<00:03, 136.88it/s] 31%|███       | 206/669 [00:01<00:03, 137.02it/s] 33%|███▎      | 220/669 [00:01<00:03, 137.15it/s] 35%|███▍      | 234/669 [00:01<00:03, 137.27it/s] 37%|███▋      | 248/669 [00:02<00:03, 137.49it/s] 39%|███▉      | 262/669 [00:02<00:02, 137.72it/s] 41%|████▏     | 276/669 [00:02<00:02, 137.52it/s] 43%|████▎     | 290/669 [00:02<00:02, 137.56it/s] 45%|████▌     | 304/669 [00:02<00:02, 137.74it/s] 48%|████▊     | 318/669 [00:02<00:02, 137.50it/s] 50%|████▉     | 332/669 [00:02<00:02, 137.48it/s] 52%|█████▏    | 346/669 [00:02<00:02, 137.38it/s] 54%|█████▍    | 360/669 [00:02<00:02, 137.37it/s] 56%|█████▌    | 374/669 [00:02<00:02, 137.39it/s] 58%|█████▊    | 388/669 [00:03<00:02, 137.04it/s] 60%|██████    | 402/669 [00:03<00:01, 137.14it/s] 62%|██████▏   | 416/669 [00:03<00:01, 137.16it/s] 64%|██████▍   | 430/669 [00:03<00:01, 137.05it/s] 66%|██████▋   | 444/669 [00:03<00:01, 136.67it/s] 68%|██████▊   | 458/669 [00:03<00:01, 136.77it/s] 71%|███████   | 472/669 [00:03<00:01, 137.25it/s] 73%|███████▎  | 486/669 [00:03<00:01, 137.58it/s] 75%|███████▍  | 500/669 [00:03<00:01, 137.78it/s] 77%|███████▋  | 514/669 [00:03<00:01, 137.52it/s] 79%|███████▉  | 528/669 [00:04<00:01, 137.27it/s] 81%|████████  | 542/669 [00:04<00:00, 137.00it/s] 83%|████████▎ | 556/669 [00:04<00:00, 124.32it/s] 85%|████████▌ | 570/669 [00:04<00:00, 127.68it/s] 87%|████████▋ | 584/669 [00:04<00:00, 130.40it/s] 89%|████████▉ | 598/669 [00:04<00:00, 132.63it/s] 91%|█████████▏| 612/669 [00:04<00:00, 134.17it/s] 94%|█████████▎| 626/669 [00:04<00:00, 135.26it/s] 96%|█████████▌| 640/669 [00:04<00:00, 135.92it/s] 98%|█████████▊| 654/669 [00:05<00:00, 136.12it/s]100%|█████████▉| 668/669 [00:05<00:00, 134.02it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:07, 21.52it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 81.24it/s][A
 28%|██▊       | 47/168 [00:00<00:00, 158.22it/s][A
 49%|████▉     | 83/168 [00:00<00:00, 228.06it/s][A
 71%|███████   | 119/168 [00:00<00:00, 270.34it/s][A
 92%|█████████▏| 155/168 [00:00<00:00, 297.57it/s][A100%|██████████| 168/168 [00:00<00:00, 222.95it/s]
2022-10-22 06:59:59,089 P10844 INFO [Metrics] logloss: 0.553450 - AUC: 0.727230
2022-10-22 06:59:59,090 P10844 INFO Monitor(max) STOP: 0.173779 !
2022-10-22 06:59:59,090 P10844 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 06:59:59,090 P10844 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 110.54it/s]
2022-10-22 06:59:59,130 P10844 INFO Train loss: 0.426003
2022-10-22 06:59:59,130 P10844 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:41,  6.59it/s]  2%|▏         | 15/669 [00:00<00:09, 70.86it/s]  4%|▎         | 24/669 [00:00<00:09, 70.36it/s]  6%|▌         | 39/669 [00:00<00:06, 95.82it/s]  8%|▊         | 54/669 [00:00<00:05, 110.89it/s] 10%|█         | 69/669 [00:00<00:04, 120.53it/s] 13%|█▎        | 84/669 [00:00<00:04, 126.75it/s] 15%|█▍        | 99/669 [00:00<00:04, 131.07it/s] 17%|█▋        | 114/669 [00:01<00:04, 133.97it/s] 19%|█▉        | 129/669 [00:01<00:03, 135.97it/s] 22%|██▏       | 144/669 [00:01<00:03, 137.32it/s] 24%|██▍       | 159/669 [00:01<00:03, 138.23it/s] 26%|██▌       | 173/669 [00:01<00:03, 138.71it/s] 28%|██▊       | 188/669 [00:01<00:03, 139.17it/s] 30%|███       | 203/669 [00:01<00:03, 139.48it/s] 32%|███▏      | 217/669 [00:01<00:03, 139.61it/s] 35%|███▍      | 232/669 [00:01<00:03, 139.83it/s] 37%|███▋      | 247/669 [00:01<00:03, 139.89it/s] 39%|███▉      | 261/669 [00:02<00:02, 139.91it/s] 41%|████▏     | 276/669 [00:02<00:02, 139.97it/s] 43%|████▎     | 291/669 [00:02<00:02, 140.08it/s] 46%|████▌     | 306/669 [00:02<00:02, 139.90it/s] 48%|████▊     | 320/669 [00:02<00:02, 139.83it/s] 50%|████▉     | 334/669 [00:02<00:02, 139.80it/s] 52%|█████▏    | 349/669 [00:02<00:02, 139.91it/s] 54%|█████▍    | 363/669 [00:02<00:02, 139.31it/s] 56%|█████▋    | 377/669 [00:02<00:02, 139.40it/s] 58%|█████▊    | 391/669 [00:03<00:01, 139.31it/s] 61%|██████    | 406/669 [00:03<00:01, 139.54it/s] 63%|██████▎   | 420/669 [00:03<00:01, 139.62it/s] 65%|██████▌   | 435/669 [00:03<00:01, 139.81it/s] 67%|██████▋   | 449/669 [00:03<00:01, 139.78it/s] 69%|██████▉   | 464/669 [00:03<00:01, 139.90it/s] 72%|███████▏  | 479/669 [00:03<00:01, 140.01it/s] 74%|███████▍  | 494/669 [00:03<00:01, 140.10it/s] 76%|███████▌  | 509/669 [00:03<00:01, 140.06it/s] 78%|███████▊  | 524/669 [00:03<00:01, 140.18it/s] 81%|████████  | 539/669 [00:04<00:00, 140.26it/s] 83%|████████▎ | 554/669 [00:04<00:00, 140.32it/s] 85%|████████▌ | 569/669 [00:04<00:00, 140.30it/s] 87%|████████▋ | 584/669 [00:04<00:00, 140.37it/s] 90%|████████▉ | 599/669 [00:04<00:00, 140.35it/s] 92%|█████████▏| 614/669 [00:04<00:00, 140.40it/s] 94%|█████████▍| 629/669 [00:04<00:00, 140.43it/s] 96%|█████████▋| 644/669 [00:04<00:00, 140.43it/s] 99%|█████████▊| 659/669 [00:04<00:00, 140.48it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.56it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 96.64it/s][A
 31%|███       | 52/168 [00:00<00:00, 196.34it/s][A
 52%|█████▏    | 88/168 [00:00<00:00, 257.16it/s][A
 73%|███████▎  | 123/168 [00:00<00:00, 288.36it/s][A
 95%|█████████▍| 159/168 [00:00<00:00, 309.40it/s][A100%|██████████| 168/168 [00:00<00:00, 244.15it/s]
2022-10-22 07:00:04,945 P10844 INFO [Metrics] logloss: 0.654697 - AUC: 0.708053
2022-10-22 07:00:04,945 P10844 INFO Monitor(max) STOP: 0.053355 !
2022-10-22 07:00:04,945 P10844 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 07:00:04,945 P10844 INFO Early stopping at epoch=3
2022-10-22 07:00:04,945 P10844 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:05<00:00, 114.01it/s]
2022-10-22 07:00:04,990 P10844 INFO Train loss: 0.378133
2022-10-22 07:00:04,990 P10844 INFO Training finished.
2022-10-22 07:00:04,990 P10844 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_007_ea6736dc.model
2022-10-22 07:00:05,007 P10844 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:40,  6.64it/s]  3%|▎         | 19/669 [00:00<00:08, 79.93it/s]  8%|▊         | 54/669 [00:00<00:03, 181.41it/s] 13%|█▎        | 89/669 [00:00<00:02, 240.19it/s] 19%|█▊        | 124/669 [00:00<00:01, 275.09it/s] 24%|██▍       | 159/669 [00:00<00:01, 298.90it/s] 29%|██▉       | 194/669 [00:00<00:01, 314.05it/s] 34%|███▍      | 230/669 [00:00<00:01, 325.55it/s] 40%|███▉      | 265/669 [00:00<00:01, 332.40it/s] 45%|████▍     | 300/669 [00:01<00:01, 337.38it/s] 50%|█████     | 335/669 [00:01<00:00, 338.43it/s] 55%|█████▌    | 370/669 [00:01<00:00, 338.47it/s] 61%|██████    | 405/669 [00:01<00:00, 340.99it/s] 66%|██████▌   | 440/669 [00:01<00:00, 343.09it/s] 71%|███████   | 475/669 [00:01<00:00, 343.79it/s] 76%|███████▌  | 510/669 [00:01<00:00, 344.15it/s] 81%|████████▏ | 545/669 [00:01<00:00, 344.30it/s] 87%|████████▋ | 580/669 [00:01<00:00, 340.80it/s] 92%|█████████▏| 615/669 [00:02<00:00, 332.48it/s] 97%|█████████▋| 649/669 [00:02<00:00, 327.77it/s]100%|██████████| 669/669 [00:02<00:00, 299.61it/s]
2022-10-22 07:00:07,825 P10844 INFO [Metrics] logloss: 0.464246 - AUC: 0.835583
  0%|          | 0/168 [00:00<?, ?it/s]  1%|          | 2/168 [00:00<00:08, 19.97it/s] 11%|█▏        | 19/168 [00:00<00:01, 93.75it/s] 32%|███▏      | 54/168 [00:00<00:00, 199.53it/s] 53%|█████▎    | 89/168 [00:00<00:00, 254.09it/s] 73%|███████▎  | 123/168 [00:00<00:00, 282.93it/s] 94%|█████████▍| 158/168 [00:00<00:00, 304.58it/s]100%|██████████| 168/168 [00:00<00:00, 241.78it/s]
2022-10-22 07:00:08,664 P10844 INFO [Metrics] logloss: 0.533178 - AUC: 0.743600
2022-10-22 07:00:08,731 P10844 INFO ******** Test evaluation ********
2022-10-22 07:00:08,731 P10844 INFO Loading data...
2022-10-22 07:00:08,732 P10844 INFO Loading test data done.
2022-10-22 07:00:13,232 P12623 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "8",
    "embedding_regularizer": "0",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_008_97e72897",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 07:00:13,234 P12623 INFO Set up feature encoder...
2022-10-22 07:00:13,234 P12623 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 07:00:13,235 P12623 INFO Loading data...
2022-10-22 07:00:13,238 P12623 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 07:00:13,340 P12623 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 07:00:13,381 P12623 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 07:00:13,382 P12623 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 07:00:13,382 P12623 INFO Loading train data done.
2022-10-22 07:00:15,826 P12623 INFO Total number of parameters: 2354288.
2022-10-22 07:00:15,826 P12623 INFO Start training: 669 batches/epoch
2022-10-22 07:00:15,826 P12623 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 07:00:16.166 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:12623 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 07:00:16.198 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:12623 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<12:23,  1.11s/it]  2%|▏         | 14/669 [00:01<00:42, 15.54it/s]  3%|▎         | 22/669 [00:01<00:27, 23.74it/s]  5%|▌         | 36/669 [00:01<00:14, 42.41it/s]  7%|▋         | 50/669 [00:01<00:10, 60.58it/s] 10%|▉         | 64/669 [00:01<00:07, 77.30it/s] 12%|█▏        | 79/669 [00:01<00:06, 93.49it/s] 14%|█▍        | 94/669 [00:01<00:05, 106.89it/s] 16%|█▋        | 109/669 [00:01<00:04, 117.95it/s] 19%|█▊        | 125/669 [00:02<00:04, 127.11it/s] 21%|██        | 141/669 [00:02<00:03, 134.10it/s] 23%|██▎       | 157/669 [00:02<00:03, 139.37it/s] 26%|██▌       | 173/669 [00:02<00:03, 143.13it/s] 28%|██▊       | 189/669 [00:02<00:03, 145.93it/s] 31%|███       | 205/669 [00:02<00:03, 147.78it/s] 33%|███▎      | 221/669 [00:02<00:03, 149.23it/s] 35%|███▌      | 237/669 [00:02<00:02, 150.24it/s] 38%|███▊      | 253/669 [00:02<00:02, 150.92it/s] 40%|████      | 269/669 [00:02<00:02, 151.39it/s] 43%|████▎     | 285/669 [00:03<00:02, 151.86it/s] 45%|████▍     | 301/669 [00:03<00:02, 152.11it/s] 47%|████▋     | 317/669 [00:03<00:02, 152.25it/s] 50%|████▉     | 333/669 [00:03<00:02, 152.45it/s] 52%|█████▏    | 349/669 [00:03<00:02, 152.53it/s] 55%|█████▍    | 365/669 [00:03<00:01, 152.49it/s] 57%|█████▋    | 381/669 [00:03<00:01, 152.41it/s] 59%|█████▉    | 397/669 [00:03<00:01, 152.54it/s] 62%|██████▏   | 413/669 [00:03<00:01, 152.63it/s] 64%|██████▍   | 429/669 [00:04<00:01, 152.63it/s] 67%|██████▋   | 445/669 [00:04<00:01, 152.55it/s] 69%|██████▉   | 461/669 [00:04<00:01, 152.66it/s] 71%|███████▏  | 477/669 [00:04<00:01, 152.60it/s] 74%|███████▎  | 493/669 [00:04<00:01, 152.58it/s] 76%|███████▌  | 509/669 [00:04<00:01, 152.47it/s] 78%|███████▊  | 525/669 [00:04<00:00, 152.47it/s] 81%|████████  | 541/669 [00:04<00:00, 152.44it/s] 83%|████████▎ | 557/669 [00:04<00:00, 139.06it/s] 86%|████████▌ | 573/669 [00:05<00:00, 142.64it/s] 88%|████████▊ | 589/669 [00:05<00:00, 145.34it/s] 90%|█████████ | 605/669 [00:05<00:00, 147.33it/s] 93%|█████████▎| 621/669 [00:05<00:00, 148.95it/s] 95%|█████████▌| 637/669 [00:05<00:00, 150.09it/s] 98%|█████████▊| 653/669 [00:05<00:00, 150.92it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:16,  9.89it/s][A
 12%|█▏        | 20/168 [00:00<00:01, 101.81it/s][A
 32%|███▏      | 53/168 [00:00<00:00, 197.48it/s][A
 54%|█████▎    | 90/168 [00:00<00:00, 260.40it/s][A
 76%|███████▌  | 127/168 [00:00<00:00, 296.56it/s][A
 97%|█████████▋| 163/168 [00:00<00:00, 316.93it/s][A100%|██████████| 168/168 [00:00<00:00, 244.35it/s]
2022-10-22 07:00:22,314 P12623 INFO [Metrics] logloss: 0.534298 - AUC: 0.742757
2022-10-22 07:00:22,314 P12623 INFO Save best model: monitor(max): 0.208459
2022-10-22 07:00:22,421 P12623 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 41.35it/s] 100%|██████████| 669/669 [00:06<00:00, 100.93it/s]
2022-10-22 07:00:22,457 P12623 INFO Train loss: 0.552566
2022-10-22 07:00:22,457 P12623 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:41,  6.57it/s]  2%|▏         | 16/669 [00:00<00:08, 74.35it/s]  4%|▎         | 25/669 [00:00<00:08, 73.16it/s]  6%|▌         | 40/669 [00:00<00:06, 98.09it/s]  8%|▊         | 55/669 [00:00<00:05, 113.48it/s] 10%|█         | 70/669 [00:00<00:04, 124.30it/s] 13%|█▎        | 85/669 [00:00<00:04, 131.84it/s] 15%|█▍        | 100/669 [00:00<00:04, 137.25it/s] 17%|█▋        | 116/669 [00:01<00:03, 141.45it/s] 20%|█▉        | 132/669 [00:01<00:03, 144.46it/s] 22%|██▏       | 148/669 [00:01<00:03, 146.64it/s] 25%|██▍       | 164/669 [00:01<00:03, 148.17it/s] 27%|██▋       | 180/669 [00:01<00:03, 149.26it/s] 29%|██▉       | 196/669 [00:01<00:03, 150.16it/s] 32%|███▏      | 212/669 [00:01<00:03, 150.73it/s] 34%|███▍      | 228/669 [00:01<00:02, 151.06it/s] 36%|███▋      | 244/669 [00:01<00:02, 151.26it/s] 39%|███▉      | 260/669 [00:01<00:02, 151.54it/s] 41%|████▏     | 276/669 [00:02<00:02, 151.82it/s] 44%|████▎     | 292/669 [00:02<00:02, 151.96it/s] 46%|████▌     | 308/669 [00:02<00:02, 152.20it/s] 48%|████▊     | 324/669 [00:02<00:02, 152.21it/s] 51%|█████     | 340/669 [00:02<00:02, 152.12it/s] 53%|█████▎    | 356/669 [00:02<00:02, 152.15it/s] 56%|█████▌    | 372/669 [00:02<00:01, 152.17it/s] 58%|█████▊    | 388/669 [00:02<00:01, 152.17it/s] 60%|██████    | 404/669 [00:02<00:01, 152.15it/s] 63%|██████▎   | 420/669 [00:02<00:01, 152.17it/s] 65%|██████▌   | 436/669 [00:03<00:01, 152.25it/s] 68%|██████▊   | 452/669 [00:03<00:01, 152.25it/s] 70%|██████▉   | 468/669 [00:03<00:01, 152.31it/s] 72%|███████▏  | 484/669 [00:03<00:01, 152.11it/s] 75%|███████▍  | 500/669 [00:03<00:01, 152.24it/s] 77%|███████▋  | 516/669 [00:03<00:01, 152.27it/s] 80%|███████▉  | 532/669 [00:03<00:00, 152.35it/s] 82%|████████▏ | 548/669 [00:03<00:00, 139.17it/s] 84%|████████▍ | 564/669 [00:03<00:00, 144.31it/s] 87%|████████▋ | 580/669 [00:04<00:00, 148.07it/s] 89%|████████▉ | 596/669 [00:04<00:00, 150.79it/s] 91%|█████████▏| 612/669 [00:04<00:00, 152.82it/s] 94%|█████████▍| 628/669 [00:04<00:00, 154.45it/s] 96%|█████████▋| 644/669 [00:04<00:00, 155.55it/s] 99%|█████████▊| 660/669 [00:04<00:00, 156.42it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:06, 24.57it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 83.42it/s][A
 30%|███       | 51/168 [00:00<00:00, 176.35it/s][A
 52%|█████▏    | 88/168 [00:00<00:00, 245.88it/s][A
 74%|███████▍  | 125/168 [00:00<00:00, 286.03it/s][A
 96%|█████████▋| 162/168 [00:00<00:00, 312.49it/s][A100%|██████████| 168/168 [00:00<00:00, 236.51it/s]
2022-10-22 07:00:27,949 P12623 INFO [Metrics] logloss: 0.550061 - AUC: 0.729349
2022-10-22 07:00:27,950 P12623 INFO Monitor(max) STOP: 0.179288 !
2022-10-22 07:00:27,950 P12623 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 07:00:27,950 P12623 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:05<00:00, 120.96it/s]
2022-10-22 07:00:27,989 P12623 INFO Train loss: 0.440581
2022-10-22 07:00:27,989 P12623 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:36,  6.90it/s]  2%|▏         | 16/669 [00:00<00:08, 77.41it/s]  4%|▎         | 25/669 [00:00<00:08, 74.14it/s]  6%|▌         | 40/669 [00:00<00:06, 100.37it/s]  8%|▊         | 56/669 [00:00<00:05, 117.64it/s] 11%|█         | 72/669 [00:00<00:04, 128.42it/s] 13%|█▎        | 88/669 [00:00<00:04, 135.55it/s] 16%|█▌        | 104/669 [00:00<00:04, 140.38it/s] 18%|█▊        | 120/669 [00:01<00:03, 143.58it/s] 20%|██        | 135/669 [00:01<00:03, 145.44it/s] 23%|██▎       | 151/669 [00:01<00:03, 147.15it/s] 25%|██▍       | 167/669 [00:01<00:03, 148.33it/s] 27%|██▋       | 183/669 [00:01<00:03, 148.96it/s] 30%|██▉       | 198/669 [00:01<00:03, 149.07it/s] 32%|███▏      | 214/669 [00:01<00:03, 149.60it/s] 34%|███▍      | 230/669 [00:01<00:02, 150.08it/s] 37%|███▋      | 246/669 [00:01<00:02, 150.39it/s] 39%|███▉      | 262/669 [00:01<00:02, 150.52it/s] 42%|████▏     | 278/669 [00:02<00:02, 150.66it/s] 44%|████▍     | 294/669 [00:02<00:02, 150.73it/s] 46%|████▋     | 310/669 [00:02<00:02, 150.80it/s] 49%|████▊     | 326/669 [00:02<00:02, 150.80it/s] 51%|█████     | 342/669 [00:02<00:02, 150.87it/s] 54%|█████▎    | 358/669 [00:02<00:02, 150.84it/s] 56%|█████▌    | 374/669 [00:02<00:01, 150.91it/s] 58%|█████▊    | 390/669 [00:02<00:01, 150.88it/s] 61%|██████    | 406/669 [00:02<00:01, 150.82it/s] 63%|██████▎   | 422/669 [00:03<00:01, 150.67it/s] 65%|██████▌   | 438/669 [00:03<00:01, 150.53it/s] 68%|██████▊   | 454/669 [00:03<00:01, 150.45it/s] 70%|███████   | 470/669 [00:03<00:01, 150.45it/s] 73%|███████▎  | 486/669 [00:03<00:01, 150.30it/s] 75%|███████▌  | 502/669 [00:03<00:01, 150.20it/s] 77%|███████▋  | 518/669 [00:03<00:01, 150.12it/s] 80%|███████▉  | 534/669 [00:03<00:00, 149.91it/s] 82%|████████▏ | 549/669 [00:03<00:00, 149.88it/s] 84%|████████▍ | 565/669 [00:03<00:00, 149.94it/s] 87%|████████▋ | 580/669 [00:04<00:00, 149.84it/s] 89%|████████▉ | 596/669 [00:04<00:00, 150.03it/s] 91%|█████████▏| 612/669 [00:04<00:00, 150.17it/s] 94%|█████████▍| 628/669 [00:04<00:00, 150.15it/s] 96%|█████████▋| 644/669 [00:04<00:00, 150.08it/s] 99%|█████████▊| 660/669 [00:04<00:00, 150.16it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 27.85it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 97.51it/s][A
 30%|███       | 51/168 [00:00<00:00, 193.94it/s][A
 52%|█████▏    | 87/168 [00:00<00:00, 255.61it/s][A
 73%|███████▎  | 123/168 [00:00<00:00, 291.73it/s][A
 95%|█████████▍| 159/168 [00:00<00:00, 312.82it/s][A100%|██████████| 168/168 [00:00<00:00, 242.16it/s]
2022-10-22 07:00:33,482 P12623 INFO [Metrics] logloss: 0.624481 - AUC: 0.701775
2022-10-22 07:00:33,482 P12623 INFO Monitor(max) STOP: 0.077294 !
2022-10-22 07:00:33,482 P12623 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 07:00:33,482 P12623 INFO Early stopping at epoch=3
2022-10-22 07:00:33,482 P12623 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:05<00:00, 120.61it/s]
2022-10-22 07:00:33,528 P12623 INFO Train loss: 0.387033
2022-10-22 07:00:33,529 P12623 INFO Training finished.
2022-10-22 07:00:33,529 P12623 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_008_97e72897.model
2022-10-22 07:00:33,620 P12623 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:49,  6.12it/s]  3%|▎         | 19/669 [00:00<00:08, 77.75it/s]  8%|▊         | 55/669 [00:00<00:03, 181.76it/s] 14%|█▎        | 91/669 [00:00<00:02, 243.13it/s] 19%|█▉        | 128/669 [00:00<00:01, 282.57it/s] 25%|██▍       | 164/669 [00:00<00:01, 306.92it/s] 30%|███       | 201/669 [00:00<00:01, 324.47it/s] 35%|███▌      | 237/669 [00:00<00:01, 335.30it/s] 41%|████      | 274/669 [00:00<00:01, 342.99it/s] 46%|████▋     | 310/669 [00:01<00:01, 347.84it/s] 52%|█████▏    | 346/669 [00:01<00:00, 351.20it/s] 57%|█████▋    | 382/669 [00:01<00:00, 353.18it/s] 62%|██████▏   | 418/669 [00:01<00:00, 351.12it/s] 68%|██████▊   | 454/669 [00:01<00:00, 352.49it/s] 73%|███████▎  | 490/669 [00:01<00:00, 353.44it/s] 79%|███████▊  | 526/669 [00:01<00:00, 354.46it/s] 84%|████████▍ | 562/669 [00:01<00:00, 355.25it/s] 89%|████████▉ | 598/669 [00:01<00:00, 355.61it/s] 95%|█████████▍| 634/669 [00:02<00:00, 356.00it/s]100%|██████████| 669/669 [00:02<00:00, 307.87it/s]
2022-10-22 07:00:36,367 P12623 INFO [Metrics] logloss: 0.460570 - AUC: 0.839072
  0%|          | 0/168 [00:00<?, ?it/s]  2%|▏         | 3/168 [00:00<00:05, 27.84it/s] 11%|█▏        | 19/168 [00:00<00:01, 92.36it/s] 32%|███▏      | 54/168 [00:00<00:00, 200.20it/s] 54%|█████▎    | 90/168 [00:00<00:00, 258.37it/s] 74%|███████▍  | 125/168 [00:00<00:00, 290.16it/s] 95%|█████████▌| 160/168 [00:00<00:00, 308.31it/s]100%|██████████| 168/168 [00:00<00:00, 240.09it/s]
2022-10-22 07:00:37,207 P12623 INFO [Metrics] logloss: 0.534298 - AUC: 0.742757
2022-10-22 07:00:37,280 P12623 INFO ******** Test evaluation ********
2022-10-22 07:00:37,280 P12623 INFO Loading data...
2022-10-22 07:00:37,281 P12623 INFO Loading test data done.
2022-10-22 07:00:43,160 P14408 INFO {
    "batch_norm": "True",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_009_819baa8d",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 07:00:43,162 P14408 INFO Set up feature encoder...
2022-10-22 07:00:43,163 P14408 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 07:00:43,164 P14408 INFO Loading data...
2022-10-22 07:00:43,167 P14408 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 07:00:43,259 P14408 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 07:00:43,294 P14408 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 07:00:43,294 P14408 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 07:00:43,294 P14408 INFO Loading train data done.
2022-10-22 07:00:45,773 P14408 INFO Total number of parameters: 4164232.
2022-10-22 07:00:45,773 P14408 INFO Start training: 669 batches/epoch
2022-10-22 07:00:45,773 P14408 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 07:00:46.101 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:14408 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 07:00:46.132 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:14408 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<17:55,  1.61s/it]  1%|▏         | 10/669 [00:01<01:23,  7.90it/s]  3%|▎         | 20/669 [00:01<00:37, 17.38it/s]  4%|▍         | 28/669 [00:01<00:26, 24.32it/s]  6%|▌         | 39/669 [00:02<00:17, 36.69it/s]  7%|▋         | 50/669 [00:02<00:12, 48.79it/s]  9%|▉         | 61/669 [00:02<00:10, 60.58it/s] 11%|█         | 72/669 [00:02<00:08, 71.29it/s] 12%|█▏        | 83/669 [00:02<00:07, 79.96it/s] 14%|█▍        | 95/669 [00:02<00:06, 88.61it/s] 16%|█▌        | 107/669 [00:02<00:05, 95.09it/s] 18%|█▊        | 119/669 [00:02<00:05, 99.87it/s] 20%|█▉        | 131/669 [00:02<00:05, 103.29it/s] 21%|██▏       | 143/669 [00:03<00:04, 106.09it/s] 23%|██▎       | 155/669 [00:03<00:04, 107.94it/s] 25%|██▍       | 167/669 [00:03<00:04, 109.24it/s] 27%|██▋       | 179/669 [00:03<00:04, 110.13it/s] 29%|██▊       | 191/669 [00:03<00:04, 110.73it/s] 30%|███       | 203/669 [00:03<00:04, 111.27it/s] 32%|███▏      | 215/669 [00:03<00:04, 111.61it/s] 34%|███▍      | 227/669 [00:03<00:03, 111.79it/s] 36%|███▌      | 239/669 [00:03<00:03, 111.86it/s] 38%|███▊      | 251/669 [00:03<00:03, 111.99it/s] 39%|███▉      | 263/669 [00:04<00:03, 112.07it/s] 41%|████      | 275/669 [00:04<00:03, 112.16it/s] 43%|████▎     | 287/669 [00:04<00:03, 112.17it/s] 45%|████▍     | 299/669 [00:04<00:03, 112.16it/s] 46%|████▋     | 311/669 [00:04<00:03, 112.24it/s] 48%|████▊     | 323/669 [00:04<00:03, 112.30it/s] 50%|█████     | 335/669 [00:04<00:02, 112.38it/s] 52%|█████▏    | 347/669 [00:04<00:02, 112.21it/s] 54%|█████▎    | 359/669 [00:04<00:02, 112.24it/s] 55%|█████▌    | 371/669 [00:05<00:02, 112.25it/s] 57%|█████▋    | 383/669 [00:05<00:02, 112.05it/s] 59%|█████▉    | 395/669 [00:05<00:02, 112.07it/s] 61%|██████    | 407/669 [00:05<00:02, 111.99it/s] 63%|██████▎   | 419/669 [00:05<00:02, 111.99it/s] 64%|██████▍   | 431/669 [00:05<00:02, 111.95it/s] 66%|██████▌   | 443/669 [00:05<00:02, 111.87it/s] 68%|██████▊   | 455/669 [00:05<00:01, 111.63it/s] 70%|██████▉   | 467/669 [00:05<00:01, 111.69it/s] 72%|███████▏  | 479/669 [00:06<00:01, 111.84it/s] 73%|███████▎  | 491/669 [00:06<00:01, 112.01it/s] 75%|███████▌  | 503/669 [00:06<00:01, 112.05it/s] 77%|███████▋  | 515/669 [00:06<00:01, 111.98it/s] 79%|███████▉  | 527/669 [00:06<00:01, 112.08it/s] 81%|████████  | 539/669 [00:06<00:01, 112.14it/s] 82%|████████▏ | 551/669 [00:06<00:01, 104.88it/s] 84%|████████▍ | 563/669 [00:06<00:00, 106.93it/s] 86%|████████▌ | 575/669 [00:06<00:00, 108.27it/s] 88%|████████▊ | 587/669 [00:06<00:00, 109.39it/s] 90%|████████▉ | 599/669 [00:07<00:00, 110.08it/s] 91%|█████████▏| 611/669 [00:07<00:00, 110.64it/s] 93%|█████████▎| 623/669 [00:07<00:00, 111.03it/s] 95%|█████████▍| 635/669 [00:07<00:00, 111.21it/s] 97%|█████████▋| 647/669 [00:07<00:00, 111.34it/s] 99%|█████████▊| 659/669 [00:07<00:00, 111.36it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:18,  9.25it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 88.96it/s][A
 32%|███▏      | 53/168 [00:00<00:00, 188.57it/s][A
 52%|█████▏    | 87/168 [00:00<00:00, 242.63it/s][A
 72%|███████▏  | 121/168 [00:00<00:00, 274.88it/s][A
 92%|█████████▏| 154/168 [00:00<00:00, 291.30it/s][A100%|██████████| 168/168 [00:00<00:00, 227.04it/s]
2022-10-22 07:00:54,386 P14408 INFO [Metrics] logloss: 0.554982 - AUC: 0.712701
2022-10-22 07:00:54,386 P14408 INFO Save best model: monitor(max): 0.157719
2022-10-22 07:00:54,567 P14408 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:08<00:00, 75.77it/s] 
2022-10-22 07:00:54,605 P14408 INFO Train loss: 0.709629
2022-10-22 07:00:54,605 P14408 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:49,  6.07it/s]  2%|▏         | 13/669 [00:00<00:11, 56.89it/s]  3%|▎         | 20/669 [00:00<00:11, 57.49it/s]  5%|▍         | 32/669 [00:00<00:08, 76.92it/s]  7%|▋         | 44/669 [00:00<00:07, 88.73it/s]  8%|▊         | 56/669 [00:00<00:06, 96.36it/s] 10%|█         | 68/669 [00:00<00:05, 101.40it/s] 12%|█▏        | 80/669 [00:00<00:05, 104.81it/s] 14%|█▍        | 92/669 [00:01<00:05, 107.10it/s] 16%|█▌        | 104/669 [00:01<00:05, 108.60it/s] 17%|█▋        | 116/669 [00:01<00:05, 109.67it/s] 19%|█▉        | 128/669 [00:01<00:04, 110.45it/s] 21%|██        | 140/669 [00:01<00:04, 110.86it/s] 23%|██▎       | 152/669 [00:01<00:04, 111.23it/s] 25%|██▍       | 164/669 [00:01<00:04, 111.46it/s] 26%|██▋       | 176/669 [00:01<00:04, 111.62it/s] 28%|██▊       | 188/669 [00:01<00:04, 111.72it/s] 30%|██▉       | 200/669 [00:01<00:04, 111.66it/s] 32%|███▏      | 212/669 [00:02<00:04, 111.67it/s] 33%|███▎      | 224/669 [00:02<00:03, 111.65it/s] 35%|███▌      | 236/669 [00:02<00:03, 111.46it/s] 37%|███▋      | 248/669 [00:02<00:03, 111.39it/s] 39%|███▉      | 260/669 [00:02<00:03, 111.42it/s] 41%|████      | 272/669 [00:02<00:03, 111.49it/s] 42%|████▏     | 284/669 [00:02<00:03, 111.48it/s] 44%|████▍     | 296/669 [00:02<00:03, 111.44it/s] 46%|████▌     | 308/669 [00:02<00:03, 111.44it/s] 48%|████▊     | 320/669 [00:03<00:03, 111.65it/s] 50%|████▉     | 332/669 [00:03<00:03, 111.77it/s] 51%|█████▏    | 344/669 [00:03<00:02, 111.76it/s] 53%|█████▎    | 356/669 [00:03<00:02, 111.76it/s] 55%|█████▌    | 368/669 [00:03<00:02, 111.87it/s] 57%|█████▋    | 380/669 [00:03<00:02, 111.91it/s] 59%|█████▊    | 392/669 [00:03<00:02, 112.05it/s] 60%|██████    | 404/669 [00:03<00:02, 112.07it/s] 62%|██████▏   | 416/669 [00:03<00:02, 112.06it/s] 64%|██████▍   | 428/669 [00:04<00:02, 112.04it/s] 66%|██████▌   | 440/669 [00:04<00:02, 112.02it/s] 68%|██████▊   | 452/669 [00:04<00:01, 111.94it/s] 69%|██████▉   | 464/669 [00:04<00:01, 111.77it/s] 71%|███████   | 476/669 [00:04<00:01, 111.26it/s] 73%|███████▎  | 488/669 [00:04<00:01, 111.33it/s] 75%|███████▍  | 500/669 [00:04<00:01, 111.20it/s] 77%|███████▋  | 512/669 [00:04<00:01, 110.94it/s] 78%|███████▊  | 524/669 [00:04<00:01, 110.86it/s] 80%|████████  | 536/669 [00:05<00:01, 110.80it/s] 82%|████████▏ | 548/669 [00:05<00:01, 102.31it/s] 84%|████████▎ | 560/669 [00:05<00:01, 104.57it/s] 85%|████████▌ | 571/669 [00:05<00:00, 105.92it/s] 87%|████████▋ | 582/669 [00:05<00:00, 106.93it/s] 89%|████████▊ | 593/669 [00:05<00:00, 107.65it/s] 90%|█████████ | 604/669 [00:05<00:00, 108.13it/s] 92%|█████████▏| 616/669 [00:05<00:00, 108.64it/s] 94%|█████████▎| 627/669 [00:05<00:00, 108.98it/s] 95%|█████████▌| 638/669 [00:05<00:00, 109.09it/s] 97%|█████████▋| 649/669 [00:06<00:00, 109.22it/s] 99%|█████████▊| 660/669 [00:06<00:00, 109.35it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.92it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 87.42it/s][A
 29%|██▉       | 49/168 [00:00<00:00, 173.24it/s][A
 49%|████▉     | 83/168 [00:00<00:00, 232.87it/s][A
 70%|██████▉   | 117/168 [00:00<00:00, 267.97it/s][A
 90%|████████▉ | 151/168 [00:00<00:00, 289.81it/s][A100%|██████████| 168/168 [00:00<00:00, 226.69it/s]
2022-10-22 07:01:01,743 P14408 INFO [Metrics] logloss: 0.552382 - AUC: 0.715255
2022-10-22 07:01:01,743 P14408 INFO Save best model: monitor(max): 0.162873
2022-10-22 07:01:01,909 P14408 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 90.96it/s] 
2022-10-22 07:01:01,960 P14408 INFO Train loss: 0.704030
2022-10-22 07:01:01,960 P14408 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:47,  6.22it/s]  2%|▏         | 13/669 [00:00<00:11, 57.88it/s]  3%|▎         | 20/669 [00:00<00:11, 56.92it/s]  5%|▍         | 32/669 [00:00<00:08, 76.49it/s]  7%|▋         | 44/669 [00:00<00:07, 88.47it/s]  8%|▊         | 56/669 [00:00<00:06, 96.23it/s] 10%|█         | 68/669 [00:00<00:05, 101.33it/s] 12%|█▏        | 80/669 [00:00<00:05, 104.74it/s] 14%|█▍        | 92/669 [00:01<00:05, 107.11it/s] 16%|█▌        | 104/669 [00:01<00:05, 108.77it/s] 17%|█▋        | 116/669 [00:01<00:05, 109.95it/s] 19%|█▉        | 128/669 [00:01<00:04, 110.67it/s] 21%|██        | 140/669 [00:01<00:04, 111.15it/s] 23%|██▎       | 152/669 [00:01<00:04, 111.56it/s] 25%|██▍       | 164/669 [00:01<00:04, 111.74it/s] 26%|██▋       | 176/669 [00:01<00:04, 111.82it/s] 28%|██▊       | 188/669 [00:01<00:04, 111.88it/s] 30%|██▉       | 200/669 [00:01<00:04, 111.99it/s] 32%|███▏      | 212/669 [00:02<00:04, 112.14it/s] 33%|███▎      | 224/669 [00:02<00:03, 112.24it/s] 35%|███▌      | 236/669 [00:02<00:03, 112.28it/s] 37%|███▋      | 248/669 [00:02<00:03, 112.29it/s] 39%|███▉      | 260/669 [00:02<00:03, 112.23it/s] 41%|████      | 272/669 [00:02<00:03, 112.33it/s] 42%|████▏     | 284/669 [00:02<00:03, 112.37it/s] 44%|████▍     | 296/669 [00:02<00:03, 112.36it/s] 46%|████▌     | 308/669 [00:02<00:03, 112.34it/s] 48%|████▊     | 320/669 [00:03<00:03, 112.35it/s] 50%|████▉     | 332/669 [00:03<00:03, 112.23it/s] 51%|█████▏    | 344/669 [00:03<00:02, 112.11it/s] 53%|█████▎    | 356/669 [00:03<00:02, 112.18it/s] 55%|█████▌    | 368/669 [00:03<00:02, 112.28it/s] 57%|█████▋    | 380/669 [00:03<00:02, 112.27it/s] 59%|█████▊    | 392/669 [00:03<00:02, 112.16it/s] 60%|██████    | 404/669 [00:03<00:02, 112.29it/s] 62%|██████▏   | 416/669 [00:03<00:02, 112.25it/s] 64%|██████▍   | 428/669 [00:04<00:02, 112.21it/s] 66%|██████▌   | 440/669 [00:04<00:02, 112.19it/s] 68%|██████▊   | 452/669 [00:04<00:01, 112.19it/s] 69%|██████▉   | 464/669 [00:04<00:01, 112.22it/s] 71%|███████   | 476/669 [00:04<00:01, 112.30it/s] 73%|███████▎  | 488/669 [00:04<00:01, 112.18it/s] 75%|███████▍  | 500/669 [00:04<00:01, 111.78it/s] 77%|███████▋  | 512/669 [00:04<00:01, 112.08it/s] 78%|███████▊  | 524/669 [00:04<00:01, 112.34it/s] 80%|████████  | 536/669 [00:04<00:01, 112.47it/s] 82%|████████▏ | 548/669 [00:05<00:01, 112.63it/s] 84%|████████▎ | 560/669 [00:05<00:00, 112.63it/s] 86%|████████▌ | 572/669 [00:05<00:00, 112.66it/s] 87%|████████▋ | 584/669 [00:05<00:00, 112.78it/s] 89%|████████▉ | 596/669 [00:05<00:00, 112.84it/s] 91%|█████████ | 608/669 [00:05<00:00, 112.72it/s] 93%|█████████▎| 620/669 [00:05<00:00, 112.76it/s] 94%|█████████▍| 632/669 [00:05<00:00, 112.84it/s] 96%|█████████▋| 644/669 [00:05<00:00, 112.85it/s] 98%|█████████▊| 656/669 [00:06<00:00, 112.66it/s]100%|█████████▉| 668/669 [00:06<00:00, 110.87it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:16,  9.98it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 93.12it/s][A
 31%|███       | 52/168 [00:00<00:00, 189.78it/s][A
 51%|█████     | 86/168 [00:00<00:00, 243.00it/s][A
 71%|███████   | 119/168 [00:00<00:00, 272.48it/s][A
 91%|█████████ | 153/168 [00:00<00:00, 292.63it/s][A100%|██████████| 168/168 [00:00<00:00, 230.64it/s]
2022-10-22 07:01:09,001 P14408 INFO [Metrics] logloss: 0.554426 - AUC: 0.714373
2022-10-22 07:01:09,001 P14408 INFO Monitor(max) STOP: 0.159947 !
2022-10-22 07:01:09,001 P14408 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 07:01:09,001 P14408 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 94.42it/s] 
2022-10-22 07:01:09,046 P14408 INFO Train loss: 0.828506
2022-10-22 07:01:09,047 P14408 INFO ************ Epoch=3 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:50,  6.03it/s]  2%|▏         | 11/669 [00:00<00:13, 49.24it/s]  3%|▎         | 19/669 [00:00<00:12, 53.88it/s]  4%|▍         | 29/669 [00:00<00:09, 69.12it/s]  6%|▌         | 40/669 [00:00<00:07, 79.73it/s]  8%|▊         | 51/669 [00:00<00:07, 86.42it/s]  9%|▉         | 62/669 [00:00<00:06, 90.80it/s] 11%|█         | 73/669 [00:00<00:06, 93.73it/s] 13%|█▎        | 84/669 [00:01<00:06, 95.74it/s] 14%|█▍        | 94/669 [00:01<00:05, 96.91it/s] 16%|█▌        | 104/669 [00:01<00:05, 97.79it/s] 17%|█▋        | 115/669 [00:01<00:05, 98.49it/s] 19%|█▉        | 126/669 [00:01<00:05, 98.98it/s] 20%|██        | 137/669 [00:01<00:05, 99.36it/s] 22%|██▏       | 147/669 [00:01<00:05, 99.51it/s] 23%|██▎       | 157/669 [00:01<00:05, 99.59it/s] 25%|██▌       | 168/669 [00:01<00:05, 99.69it/s] 27%|██▋       | 179/669 [00:02<00:04, 99.81it/s] 28%|██▊       | 190/669 [00:02<00:04, 99.94it/s] 30%|███       | 201/669 [00:02<00:04, 100.04it/s] 32%|███▏      | 212/669 [00:02<00:04, 100.05it/s] 33%|███▎      | 223/669 [00:02<00:04, 99.94it/s]  35%|███▍      | 234/669 [00:02<00:04, 99.95it/s] 36%|███▋      | 244/669 [00:02<00:04, 99.92it/s] 38%|███▊      | 254/669 [00:02<00:04, 99.95it/s] 40%|███▉      | 265/669 [00:02<00:04, 100.00it/s] 41%|████▏     | 276/669 [00:02<00:03, 100.02it/s] 43%|████▎     | 287/669 [00:03<00:03, 99.98it/s]  45%|████▍     | 298/669 [00:03<00:03, 100.02it/s] 46%|████▌     | 309/669 [00:03<00:03, 100.11it/s] 48%|████▊     | 320/669 [00:03<00:03, 100.20it/s] 49%|████▉     | 331/669 [00:03<00:03, 100.31it/s] 51%|█████     | 342/669 [00:03<00:03, 100.34it/s] 53%|█████▎    | 353/669 [00:03<00:03, 100.25it/s] 54%|█████▍    | 364/669 [00:03<00:03, 100.26it/s] 56%|█████▌    | 375/669 [00:03<00:02, 100.21it/s] 58%|█████▊    | 386/669 [00:04<00:02, 100.17it/s] 59%|█████▉    | 397/669 [00:04<00:02, 100.21it/s] 61%|██████    | 408/669 [00:04<00:02, 100.29it/s] 63%|██████▎   | 419/669 [00:04<00:02, 100.34it/s] 64%|██████▍   | 430/669 [00:04<00:02, 100.34it/s] 66%|██████▌   | 441/669 [00:04<00:02, 100.22it/s] 68%|██████▊   | 452/669 [00:04<00:02, 100.19it/s] 69%|██████▉   | 463/669 [00:04<00:02, 100.23it/s] 71%|███████   | 474/669 [00:04<00:01, 100.31it/s] 72%|███████▏  | 485/669 [00:05<00:01, 100.36it/s] 74%|███████▍  | 496/669 [00:05<00:01, 100.32it/s] 76%|███████▌  | 507/669 [00:05<00:01, 100.27it/s] 77%|███████▋  | 518/669 [00:05<00:01, 100.21it/s] 79%|███████▉  | 529/669 [00:05<00:01, 100.23it/s] 81%|████████  | 540/669 [00:05<00:01, 100.31it/s] 82%|████████▏ | 551/669 [00:05<00:01, 100.42it/s] 84%|████████▍ | 562/669 [00:05<00:01, 100.37it/s] 86%|████████▌ | 573/669 [00:05<00:00, 100.33it/s] 87%|████████▋ | 584/669 [00:06<00:00, 100.37it/s] 89%|████████▉ | 595/669 [00:06<00:00, 100.35it/s] 91%|█████████ | 606/669 [00:06<00:00, 100.40it/s] 92%|█████████▏| 617/669 [00:06<00:00, 100.40it/s] 94%|█████████▍| 628/669 [00:06<00:00, 100.38it/s] 96%|█████████▌| 639/669 [00:06<00:00, 100.36it/s] 97%|█████████▋| 650/669 [00:06<00:00, 100.45it/s] 99%|█████████▉| 661/669 [00:06<00:00, 100.34it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.90it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 85.93it/s][A
 31%|███       | 52/168 [00:00<00:00, 182.74it/s][A
 51%|█████     | 86/168 [00:00<00:00, 237.92it/s][A
 71%|███████▏  | 120/168 [00:00<00:00, 269.67it/s][A
 91%|█████████ | 153/168 [00:00<00:00, 288.16it/s][A100%|██████████| 168/168 [00:00<00:00, 226.31it/s]
2022-10-22 07:01:16,821 P14408 INFO [Metrics] logloss: 0.571153 - AUC: 0.723124
2022-10-22 07:01:16,822 P14408 INFO Monitor(max) STOP: 0.151971 !
2022-10-22 07:01:16,822 P14408 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 07:01:16,822 P14408 INFO Early stopping at epoch=4
2022-10-22 07:01:16,822 P14408 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:07<00:00, 85.40it/s] 
2022-10-22 07:01:16,869 P14408 INFO Train loss: 0.618631
2022-10-22 07:01:16,869 P14408 INFO Training finished.
2022-10-22 07:01:16,869 P14408 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_009_819baa8d.model
2022-10-22 07:01:16,887 P14408 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:43,  6.43it/s]  3%|▎         | 19/669 [00:00<00:08, 76.74it/s]  8%|▊         | 53/669 [00:00<00:03, 173.37it/s] 13%|█▎        | 87/669 [00:00<00:02, 229.47it/s] 18%|█▊        | 121/669 [00:00<00:02, 264.56it/s] 23%|██▎       | 155/669 [00:00<00:01, 288.43it/s] 28%|██▊       | 190/669 [00:00<00:01, 304.72it/s] 34%|███▎      | 225/669 [00:00<00:01, 315.98it/s] 39%|███▊      | 259/669 [00:01<00:01, 323.16it/s] 44%|████▍     | 294/669 [00:01<00:01, 328.80it/s] 49%|████▉     | 328/669 [00:01<00:01, 328.93it/s] 54%|█████▍    | 363/669 [00:01<00:00, 332.98it/s] 59%|█████▉    | 398/669 [00:01<00:00, 335.53it/s] 65%|██████▍   | 433/669 [00:01<00:00, 337.17it/s] 70%|██████▉   | 468/669 [00:01<00:00, 338.44it/s] 75%|███████▌  | 503/669 [00:01<00:00, 338.97it/s] 80%|████████  | 538/669 [00:01<00:00, 339.67it/s] 86%|████████▌ | 573/669 [00:01<00:00, 339.80it/s] 91%|█████████ | 608/669 [00:02<00:00, 340.16it/s] 96%|█████████▌| 643/669 [00:02<00:00, 340.18it/s]100%|██████████| 669/669 [00:02<00:00, 294.07it/s]
2022-10-22 07:01:19,739 P14408 INFO [Metrics] logloss: 0.518446 - AUC: 0.769852
  0%|          | 0/168 [00:00<?, ?it/s]  1%|          | 1/168 [00:00<00:18,  9.28it/s] 11%|█▏        | 19/168 [00:00<00:01, 93.44it/s] 30%|███       | 51/168 [00:00<00:00, 186.98it/s] 51%|█████     | 85/168 [00:00<00:00, 242.51it/s] 71%|███████   | 119/168 [00:00<00:00, 275.21it/s] 90%|█████████ | 152/168 [00:00<00:00, 292.10it/s]100%|██████████| 168/168 [00:00<00:00, 228.55it/s]
2022-10-22 07:01:20,612 P14408 INFO [Metrics] logloss: 0.552382 - AUC: 0.715255
2022-10-22 07:01:20,676 P14408 INFO ******** Test evaluation ********
2022-10-22 07:01:20,676 P14408 INFO Loading data...
2022-10-22 07:01:20,677 P14408 INFO Loading test data done.
2022-10-22 07:01:23,233 P16589 INFO {
    "batch_norm": "True",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "8",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_010_94bf40f2",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 07:01:23,235 P16589 INFO Set up feature encoder...
2022-10-22 07:01:23,235 P16589 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 07:01:23,236 P16589 INFO Loading data...
2022-10-22 07:01:23,239 P16589 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 07:01:23,340 P16589 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 07:01:23,379 P16589 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 07:01:23,379 P16589 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 07:01:23,379 P16589 INFO Loading train data done.
2022-10-22 07:01:25,824 P16589 INFO Total number of parameters: 2356688.
2022-10-22 07:01:25,824 P16589 INFO Start training: 669 batches/epoch
2022-10-22 07:01:25,824 P16589 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 07:01:26.152 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:16589 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 07:01:26.184 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:16589 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<17:57,  1.61s/it]  2%|▏         | 11/669 [00:01<01:15,  8.67it/s]  3%|▎         | 21/669 [00:01<00:35, 18.08it/s]  4%|▍         | 29/669 [00:01<00:25, 25.05it/s]  6%|▌         | 40/669 [00:02<00:16, 37.66it/s]  8%|▊         | 51/669 [00:02<00:12, 50.16it/s]  9%|▉         | 62/669 [00:02<00:09, 61.93it/s] 11%|█         | 74/669 [00:02<00:08, 73.49it/s] 13%|█▎        | 86/669 [00:02<00:07, 83.26it/s] 15%|█▍        | 98/669 [00:02<00:06, 91.29it/s] 16%|█▋        | 110/669 [00:02<00:05, 97.49it/s] 18%|█▊        | 122/669 [00:02<00:05, 102.35it/s] 20%|██        | 134/669 [00:02<00:05, 105.69it/s] 22%|██▏       | 146/669 [00:02<00:04, 108.36it/s] 24%|██▎       | 158/669 [00:03<00:04, 110.43it/s] 25%|██▌       | 170/669 [00:03<00:04, 111.78it/s] 27%|██▋       | 182/669 [00:03<00:04, 112.85it/s] 29%|██▉       | 194/669 [00:03<00:04, 113.32it/s] 31%|███       | 206/669 [00:03<00:04, 114.00it/s] 33%|███▎      | 218/669 [00:03<00:03, 114.49it/s] 34%|███▍      | 230/669 [00:03<00:03, 114.89it/s] 36%|███▌      | 242/669 [00:03<00:03, 115.21it/s] 38%|███▊      | 254/669 [00:03<00:03, 115.17it/s] 40%|███▉      | 266/669 [00:04<00:03, 115.48it/s] 42%|████▏     | 278/669 [00:04<00:03, 115.73it/s] 43%|████▎     | 290/669 [00:04<00:03, 115.81it/s] 45%|████▌     | 302/669 [00:04<00:03, 115.89it/s] 47%|████▋     | 314/669 [00:04<00:03, 115.84it/s] 49%|████▊     | 326/669 [00:04<00:02, 115.73it/s] 51%|█████     | 338/669 [00:04<00:02, 115.97it/s] 52%|█████▏    | 350/669 [00:04<00:02, 116.13it/s] 54%|█████▍    | 362/669 [00:04<00:02, 116.23it/s] 56%|█████▌    | 374/669 [00:04<00:02, 116.28it/s] 58%|█████▊    | 386/669 [00:05<00:02, 116.06it/s] 59%|█████▉    | 398/669 [00:05<00:02, 116.18it/s] 61%|██████▏   | 410/669 [00:05<00:02, 116.23it/s] 63%|██████▎   | 422/669 [00:05<00:02, 116.16it/s] 65%|██████▍   | 434/669 [00:05<00:02, 116.17it/s] 67%|██████▋   | 446/669 [00:05<00:01, 115.93it/s] 68%|██████▊   | 458/669 [00:05<00:01, 115.88it/s] 70%|███████   | 470/669 [00:05<00:01, 115.69it/s] 72%|███████▏  | 482/669 [00:05<00:01, 115.89it/s] 74%|███████▍  | 494/669 [00:06<00:01, 115.99it/s] 76%|███████▌  | 506/669 [00:06<00:01, 115.75it/s] 77%|███████▋  | 518/669 [00:06<00:01, 115.88it/s] 79%|███████▉  | 530/669 [00:06<00:01, 115.98it/s] 81%|████████  | 542/669 [00:06<00:01, 115.96it/s] 83%|████████▎ | 554/669 [00:06<00:01, 108.46it/s] 85%|████████▍ | 566/669 [00:06<00:00, 110.54it/s] 86%|████████▋ | 578/669 [00:06<00:00, 111.83it/s] 88%|████████▊ | 590/669 [00:06<00:00, 113.03it/s] 90%|████████▉ | 602/669 [00:06<00:00, 113.94it/s] 92%|█████████▏| 614/669 [00:07<00:00, 114.62it/s] 94%|█████████▎| 626/669 [00:07<00:00, 114.99it/s] 95%|█████████▌| 638/669 [00:07<00:00, 114.94it/s] 97%|█████████▋| 650/669 [00:07<00:00, 115.28it/s] 99%|█████████▉| 662/669 [00:07<00:00, 115.42it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:18,  9.19it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 93.86it/s][A
 31%|███       | 52/168 [00:00<00:00, 191.11it/s][A
 51%|█████     | 86/168 [00:00<00:00, 246.31it/s][A
 72%|███████▏  | 121/168 [00:00<00:00, 280.59it/s][A
 93%|█████████▎| 156/168 [00:00<00:00, 301.85it/s][A100%|██████████| 168/168 [00:00<00:00, 234.80it/s]
2022-10-22 07:01:34,223 P16589 INFO [Metrics] logloss: 0.552590 - AUC: 0.715350
2022-10-22 07:01:34,223 P16589 INFO Save best model: monitor(max): 0.162760
2022-10-22 07:01:34,326 P16589 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:08<00:00, 78.38it/s] 
2022-10-22 07:01:34,362 P16589 INFO Train loss: 0.671169
2022-10-22 07:01:34,362 P16589 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:49,  6.12it/s]  2%|▏         | 13/669 [00:00<00:11, 57.56it/s]  3%|▎         | 20/669 [00:00<00:11, 57.86it/s]  5%|▍         | 32/669 [00:00<00:08, 77.87it/s]  7%|▋         | 44/669 [00:00<00:06, 90.12it/s]  8%|▊         | 56/669 [00:00<00:06, 98.13it/s] 10%|█         | 68/669 [00:00<00:05, 104.66it/s] 12%|█▏        | 81/669 [00:00<00:05, 109.65it/s] 14%|█▍        | 94/669 [00:01<00:05, 113.48it/s] 16%|█▌        | 107/669 [00:01<00:04, 116.10it/s] 18%|█▊        | 120/669 [00:01<00:04, 117.88it/s] 20%|█▉        | 133/669 [00:01<00:04, 119.64it/s] 22%|██▏       | 146/669 [00:01<00:04, 120.49it/s] 24%|██▍       | 159/669 [00:01<00:04, 121.15it/s] 26%|██▌       | 172/669 [00:01<00:04, 121.54it/s] 28%|██▊       | 185/669 [00:01<00:03, 122.13it/s] 30%|██▉       | 198/669 [00:01<00:03, 122.41it/s] 32%|███▏      | 211/669 [00:01<00:03, 122.44it/s] 33%|███▎      | 224/669 [00:02<00:03, 122.65it/s] 35%|███▌      | 237/669 [00:02<00:03, 122.43it/s] 37%|███▋      | 250/669 [00:02<00:03, 122.56it/s] 39%|███▉      | 263/669 [00:02<00:03, 122.60it/s] 41%|████▏     | 276/669 [00:02<00:03, 122.91it/s] 43%|████▎     | 289/669 [00:02<00:03, 122.68it/s] 45%|████▌     | 302/669 [00:02<00:02, 122.84it/s] 47%|████▋     | 315/669 [00:02<00:02, 122.84it/s] 49%|████▉     | 328/669 [00:02<00:02, 122.91it/s] 51%|█████     | 341/669 [00:03<00:02, 122.79it/s] 53%|█████▎    | 354/669 [00:03<00:02, 122.77it/s] 55%|█████▍    | 367/669 [00:03<00:02, 122.59it/s] 57%|█████▋    | 380/669 [00:03<00:02, 122.77it/s] 59%|█████▊    | 393/669 [00:03<00:02, 122.69it/s] 61%|██████    | 406/669 [00:03<00:02, 122.75it/s] 63%|██████▎   | 419/669 [00:03<00:02, 122.70it/s] 65%|██████▍   | 432/669 [00:03<00:01, 122.80it/s] 67%|██████▋   | 445/669 [00:03<00:01, 122.94it/s] 68%|██████▊   | 458/669 [00:03<00:01, 122.70it/s] 70%|███████   | 471/669 [00:04<00:01, 122.82it/s] 72%|███████▏  | 484/669 [00:04<00:01, 122.65it/s] 74%|███████▍  | 497/669 [00:04<00:01, 122.35it/s] 76%|███████▌  | 510/669 [00:04<00:01, 122.00it/s] 78%|███████▊  | 523/669 [00:04<00:01, 120.84it/s] 80%|████████  | 536/669 [00:04<00:01, 119.97it/s] 82%|████████▏ | 549/669 [00:04<00:01, 109.96it/s] 84%|████████▍ | 561/669 [00:04<00:00, 110.80it/s] 86%|████████▌ | 573/669 [00:04<00:00, 111.08it/s] 87%|████████▋ | 585/669 [00:05<00:00, 111.41it/s] 89%|████████▉ | 597/669 [00:05<00:00, 112.99it/s] 91%|█████████ | 609/669 [00:05<00:00, 114.19it/s] 93%|█████████▎| 621/669 [00:05<00:00, 115.06it/s] 95%|█████████▍| 633/669 [00:05<00:00, 115.72it/s] 96%|█████████▋| 645/669 [00:05<00:00, 116.18it/s] 98%|█████████▊| 657/669 [00:05<00:00, 116.39it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.59it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 82.76it/s][A
 32%|███▏      | 54/168 [00:00<00:00, 185.43it/s][A
 53%|█████▎    | 89/168 [00:00<00:00, 241.83it/s][A
 74%|███████▍  | 124/168 [00:00<00:00, 276.65it/s][A
 95%|█████████▍| 159/168 [00:00<00:00, 299.52it/s][A100%|██████████| 168/168 [00:00<00:00, 227.47it/s]
2022-10-22 07:01:41,052 P16589 INFO [Metrics] logloss: 0.551270 - AUC: 0.718637
2022-10-22 07:01:41,052 P16589 INFO Save best model: monitor(max): 0.167367
2022-10-22 07:01:41,200 P16589 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 29.23it/s] 100%|██████████| 669/669 [00:06<00:00, 97.07it/s]
2022-10-22 07:01:41,255 P16589 INFO Train loss: 0.722087
2022-10-22 07:01:41,255 P16589 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:52,  5.95it/s]  2%|▏         | 13/669 [00:00<00:11, 56.68it/s]  3%|▎         | 20/669 [00:00<00:11, 56.97it/s]  5%|▍         | 32/669 [00:00<00:08, 77.15it/s]  7%|▋         | 44/669 [00:00<00:06, 89.70it/s]  8%|▊         | 56/669 [00:00<00:06, 97.79it/s] 10%|█         | 68/669 [00:00<00:05, 102.96it/s] 12%|█▏        | 80/669 [00:00<00:05, 106.50it/s] 14%|█▍        | 92/669 [00:01<00:05, 108.94it/s] 16%|█▌        | 104/669 [00:01<00:05, 110.77it/s] 17%|█▋        | 116/669 [00:01<00:04, 112.04it/s] 19%|█▉        | 128/669 [00:01<00:04, 112.82it/s] 21%|██        | 140/669 [00:01<00:04, 113.25it/s] 23%|██▎       | 152/669 [00:01<00:04, 113.70it/s] 25%|██▍       | 164/669 [00:01<00:04, 114.00it/s] 26%|██▋       | 176/669 [00:01<00:04, 114.04it/s] 28%|██▊       | 188/669 [00:01<00:04, 114.20it/s] 30%|██▉       | 200/669 [00:01<00:04, 114.11it/s] 32%|███▏      | 212/669 [00:02<00:03, 114.39it/s] 33%|███▎      | 224/669 [00:02<00:03, 114.33it/s] 35%|███▌      | 236/669 [00:02<00:03, 114.32it/s] 37%|███▋      | 248/669 [00:02<00:03, 114.43it/s] 39%|███▉      | 260/669 [00:02<00:03, 114.42it/s] 41%|████      | 272/669 [00:02<00:03, 114.40it/s] 42%|████▏     | 284/669 [00:02<00:03, 114.53it/s] 44%|████▍     | 296/669 [00:02<00:03, 114.37it/s] 46%|████▌     | 308/669 [00:02<00:03, 114.50it/s] 48%|████▊     | 320/669 [00:03<00:03, 114.56it/s] 50%|████▉     | 332/669 [00:03<00:02, 114.59it/s] 51%|█████▏    | 344/669 [00:03<00:02, 114.63it/s] 53%|█████▎    | 356/669 [00:03<00:02, 114.64it/s] 55%|█████▌    | 368/669 [00:03<00:02, 114.66it/s] 57%|█████▋    | 380/669 [00:03<00:02, 114.55it/s] 59%|█████▊    | 392/669 [00:03<00:02, 114.62it/s] 60%|██████    | 404/669 [00:03<00:02, 114.76it/s] 62%|██████▏   | 416/669 [00:03<00:02, 114.66it/s] 64%|██████▍   | 428/669 [00:03<00:02, 114.56it/s] 66%|██████▌   | 440/669 [00:04<00:01, 114.60it/s] 68%|██████▊   | 452/669 [00:04<00:01, 114.55it/s] 69%|██████▉   | 464/669 [00:04<00:01, 114.58it/s] 71%|███████   | 476/669 [00:04<00:01, 114.52it/s] 73%|███████▎  | 488/669 [00:04<00:01, 114.57it/s] 75%|███████▍  | 500/669 [00:04<00:01, 114.39it/s] 77%|███████▋  | 512/669 [00:04<00:01, 114.40it/s] 78%|███████▊  | 524/669 [00:04<00:01, 114.54it/s] 80%|████████  | 536/669 [00:04<00:01, 114.53it/s] 82%|████████▏ | 548/669 [00:05<00:01, 114.45it/s] 84%|████████▎ | 560/669 [00:05<00:00, 114.48it/s] 86%|████████▌ | 572/669 [00:05<00:00, 114.35it/s] 87%|████████▋ | 584/669 [00:05<00:00, 114.07it/s] 89%|████████▉ | 596/669 [00:05<00:00, 114.22it/s] 91%|█████████ | 608/669 [00:05<00:00, 114.31it/s] 93%|█████████▎| 620/669 [00:05<00:00, 114.30it/s] 94%|█████████▍| 632/669 [00:05<00:00, 113.94it/s] 96%|█████████▋| 644/669 [00:05<00:00, 114.06it/s] 98%|█████████▊| 656/669 [00:05<00:00, 114.05it/s]100%|█████████▉| 668/669 [00:06<00:00, 112.48it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:18,  9.00it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 95.56it/s][A
 30%|███       | 51/168 [00:00<00:00, 189.16it/s][A
 51%|█████     | 86/168 [00:00<00:00, 248.74it/s][A
 72%|███████▏  | 121/168 [00:00<00:00, 283.27it/s][A
 93%|█████████▎| 156/168 [00:00<00:00, 303.71it/s][A100%|██████████| 168/168 [00:00<00:00, 234.34it/s]
2022-10-22 07:01:48,179 P16589 INFO [Metrics] logloss: 0.556581 - AUC: 0.710537
2022-10-22 07:01:48,180 P16589 INFO Monitor(max) STOP: 0.153956 !
2022-10-22 07:01:48,180 P16589 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 07:01:48,180 P16589 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 95.93it/s] 
2022-10-22 07:01:48,229 P16589 INFO Train loss: 0.835461
2022-10-22 07:01:48,230 P16589 INFO ************ Epoch=3 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:51,  5.99it/s]  2%|▏         | 12/669 [00:00<00:12, 53.59it/s]  3%|▎         | 19/669 [00:00<00:11, 56.75it/s]  4%|▍         | 30/669 [00:00<00:08, 74.44it/s]  6%|▌         | 41/669 [00:00<00:07, 86.07it/s]  8%|▊         | 52/669 [00:00<00:06, 93.67it/s] 10%|▉         | 64/669 [00:00<00:06, 99.73it/s] 11%|█▏        | 76/669 [00:00<00:05, 104.15it/s] 13%|█▎        | 88/669 [00:01<00:05, 107.36it/s] 15%|█▍        | 100/669 [00:01<00:05, 109.83it/s] 17%|█▋        | 112/669 [00:01<00:04, 111.76it/s] 19%|█▊        | 124/669 [00:01<00:04, 113.05it/s] 20%|██        | 136/669 [00:01<00:04, 114.05it/s] 22%|██▏       | 148/669 [00:01<00:04, 114.87it/s] 24%|██▍       | 160/669 [00:01<00:04, 115.42it/s] 26%|██▌       | 172/669 [00:01<00:04, 115.78it/s] 28%|██▊       | 184/669 [00:01<00:04, 116.15it/s] 29%|██▉       | 196/669 [00:01<00:04, 116.40it/s] 31%|███       | 208/669 [00:02<00:03, 116.33it/s] 33%|███▎      | 220/669 [00:02<00:03, 116.37it/s] 35%|███▍      | 232/669 [00:02<00:03, 116.53it/s] 36%|███▋      | 244/669 [00:02<00:03, 116.65it/s] 38%|███▊      | 256/669 [00:02<00:03, 116.78it/s] 40%|████      | 268/669 [00:02<00:03, 116.74it/s] 42%|████▏     | 280/669 [00:02<00:03, 116.77it/s] 44%|████▎     | 292/669 [00:02<00:03, 116.76it/s] 45%|████▌     | 304/669 [00:02<00:03, 116.80it/s] 47%|████▋     | 316/669 [00:02<00:03, 116.73it/s] 49%|████▉     | 328/669 [00:03<00:02, 116.62it/s] 51%|█████     | 340/669 [00:03<00:02, 116.51it/s] 53%|█████▎    | 352/669 [00:03<00:02, 116.25it/s] 54%|█████▍    | 364/669 [00:03<00:02, 115.84it/s] 56%|█████▌    | 376/669 [00:03<00:02, 116.03it/s] 58%|█████▊    | 388/669 [00:03<00:02, 116.20it/s] 60%|█████▉    | 400/669 [00:03<00:02, 116.28it/s] 62%|██████▏   | 412/669 [00:03<00:02, 116.35it/s] 63%|██████▎   | 424/669 [00:03<00:02, 116.57it/s] 65%|██████▌   | 436/669 [00:03<00:01, 116.70it/s] 67%|██████▋   | 448/669 [00:04<00:01, 116.82it/s] 69%|██████▉   | 460/669 [00:04<00:01, 116.82it/s] 71%|███████   | 472/669 [00:04<00:01, 116.71it/s] 72%|███████▏  | 484/669 [00:04<00:01, 116.72it/s] 74%|███████▍  | 496/669 [00:04<00:01, 116.69it/s] 76%|███████▌  | 508/669 [00:04<00:01, 116.63it/s] 78%|███████▊  | 520/669 [00:04<00:01, 116.75it/s] 80%|███████▉  | 532/669 [00:04<00:01, 116.85it/s] 81%|████████▏ | 544/669 [00:04<00:01, 116.83it/s] 83%|████████▎ | 556/669 [00:05<00:00, 116.89it/s] 85%|████████▍ | 568/669 [00:05<00:00, 116.92it/s] 87%|████████▋ | 580/669 [00:05<00:00, 116.87it/s] 88%|████████▊ | 592/669 [00:05<00:00, 116.78it/s] 90%|█████████ | 604/669 [00:05<00:00, 116.74it/s] 92%|█████████▏| 616/669 [00:05<00:00, 116.77it/s] 94%|█████████▍| 628/669 [00:05<00:00, 116.66it/s] 96%|█████████▌| 640/669 [00:05<00:00, 116.50it/s] 97%|█████████▋| 652/669 [00:05<00:00, 116.51it/s] 99%|█████████▉| 664/669 [00:05<00:00, 114.58it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.34it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 92.06it/s][A
 27%|██▋       | 46/168 [00:00<00:00, 163.97it/s][A
 48%|████▊     | 81/168 [00:00<00:00, 231.49it/s][A
 69%|██████▉   | 116/168 [00:00<00:00, 271.28it/s][A
 90%|████████▉ | 151/168 [00:00<00:00, 295.22it/s][A100%|██████████| 168/168 [00:00<00:00, 226.09it/s]
2022-10-22 07:01:55,101 P16589 INFO [Metrics] logloss: 0.570836 - AUC: 0.718767
2022-10-22 07:01:55,101 P16589 INFO Monitor(max) STOP: 0.147930 !
2022-10-22 07:01:55,102 P16589 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 07:01:55,102 P16589 INFO Early stopping at epoch=4
2022-10-22 07:01:55,102 P16589 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:06<00:00, 96.55it/s] 
2022-10-22 07:01:55,149 P16589 INFO Train loss: 0.801912
2022-10-22 07:01:55,149 P16589 INFO Training finished.
2022-10-22 07:01:55,149 P16589 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_010_94bf40f2.model
2022-10-22 07:01:55,248 P16589 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:54,  5.81it/s]  3%|▎         | 19/669 [00:00<00:08, 74.25it/s]  8%|▊         | 53/669 [00:00<00:03, 170.42it/s] 13%|█▎        | 88/669 [00:00<00:02, 229.85it/s] 18%|█▊        | 122/669 [00:00<00:02, 265.04it/s] 23%|██▎       | 157/669 [00:00<00:01, 289.50it/s] 29%|██▊       | 191/669 [00:00<00:01, 302.94it/s] 34%|███▎      | 225/669 [00:00<00:01, 312.26it/s] 39%|███▊      | 259/669 [00:01<00:01, 318.70it/s] 44%|████▍     | 293/669 [00:01<00:01, 323.58it/s] 49%|████▊     | 326/669 [00:01<00:01, 323.77it/s] 54%|█████▎    | 359/669 [00:01<00:00, 321.94it/s] 59%|█████▊    | 392/669 [00:01<00:00, 324.06it/s] 64%|██████▎   | 425/669 [00:01<00:00, 325.51it/s] 68%|██████▊   | 458/669 [00:01<00:00, 326.50it/s] 73%|███████▎  | 491/669 [00:01<00:00, 320.78it/s] 78%|███████▊  | 524/669 [00:01<00:00, 318.35it/s] 83%|████████▎ | 556/669 [00:01<00:00, 317.01it/s] 88%|████████▊ | 588/669 [00:02<00:00, 316.05it/s] 93%|█████████▎| 620/669 [00:02<00:00, 315.31it/s] 97%|█████████▋| 652/669 [00:02<00:00, 314.85it/s]100%|██████████| 669/669 [00:02<00:00, 284.79it/s]
2022-10-22 07:01:58,172 P16589 INFO [Metrics] logloss: 0.503758 - AUC: 0.792268
  0%|          | 0/168 [00:00<?, ?it/s]  1%|          | 1/168 [00:00<00:17,  9.63it/s] 11%|█▏        | 19/168 [00:00<00:01, 95.60it/s] 32%|███▏      | 54/168 [00:00<00:00, 200.99it/s] 54%|█████▎    | 90/168 [00:00<00:00, 258.64it/s] 75%|███████▌  | 126/168 [00:00<00:00, 291.49it/s] 96%|█████████▌| 161/168 [00:00<00:00, 309.81it/s]100%|██████████| 168/168 [00:00<00:00, 241.53it/s]
2022-10-22 07:01:59,006 P16589 INFO [Metrics] logloss: 0.551270 - AUC: 0.718637
2022-10-22 07:01:59,064 P16589 INFO ******** Test evaluation ********
2022-10-22 07:01:59,064 P16589 INFO Loading data...
2022-10-22 07:01:59,065 P16589 INFO Loading test data done.
2022-10-22 07:02:03,285 P18776 INFO {
    "batch_norm": "True",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_011_5fe39b7b",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 07:02:03,287 P18776 INFO Set up feature encoder...
2022-10-22 07:02:03,287 P18776 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 07:02:03,288 P18776 INFO Loading data...
2022-10-22 07:02:03,291 P18776 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 07:02:03,390 P18776 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 07:02:03,426 P18776 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 07:02:03,426 P18776 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 07:02:03,426 P18776 INFO Loading train data done.
2022-10-22 07:02:05,950 P18776 INFO Total number of parameters: 4164232.
2022-10-22 07:02:05,950 P18776 INFO Start training: 669 batches/epoch
2022-10-22 07:02:05,950 P18776 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 07:02:06.291 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:18776 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 07:02:06.324 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:18776 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<18:35,  1.67s/it]  1%|▏         | 10/669 [00:01<01:26,  7.59it/s]  3%|▎         | 19/669 [00:01<00:41, 15.75it/s]  4%|▍         | 26/669 [00:02<00:29, 21.76it/s]  5%|▌         | 36/669 [00:02<00:19, 32.72it/s]  7%|▋         | 46/669 [00:02<00:14, 43.61it/s]  8%|▊         | 56/669 [00:02<00:11, 53.79it/s] 10%|▉         | 66/669 [00:02<00:09, 63.13it/s] 11%|█▏        | 76/669 [00:02<00:08, 71.10it/s] 13%|█▎        | 86/669 [00:02<00:07, 77.88it/s] 14%|█▍        | 96/669 [00:02<00:06, 83.16it/s] 16%|█▌        | 106/669 [00:02<00:06, 87.38it/s] 17%|█▋        | 116/669 [00:02<00:06, 90.50it/s] 19%|█▉        | 127/669 [00:03<00:05, 94.69it/s] 21%|██        | 138/669 [00:03<00:05, 98.84it/s] 22%|██▏       | 149/669 [00:03<00:05, 101.97it/s] 24%|██▍       | 160/669 [00:03<00:04, 104.20it/s] 26%|██▌       | 171/669 [00:03<00:04, 105.80it/s] 27%|██▋       | 182/669 [00:03<00:04, 106.90it/s] 29%|██▉       | 193/669 [00:03<00:04, 107.58it/s] 30%|███       | 204/669 [00:03<00:04, 108.16it/s] 32%|███▏      | 215/669 [00:03<00:04, 108.54it/s] 34%|███▍      | 226/669 [00:03<00:04, 108.76it/s] 35%|███▌      | 237/669 [00:04<00:03, 108.96it/s] 37%|███▋      | 248/669 [00:04<00:03, 109.12it/s] 39%|███▊      | 259/669 [00:04<00:03, 109.15it/s] 40%|████      | 270/669 [00:04<00:03, 109.33it/s] 42%|████▏     | 281/669 [00:04<00:03, 109.37it/s] 44%|████▎     | 292/669 [00:04<00:03, 109.37it/s] 45%|████▌     | 303/669 [00:04<00:03, 109.46it/s] 47%|████▋     | 314/669 [00:04<00:03, 109.43it/s] 49%|████▊     | 325/669 [00:04<00:03, 109.45it/s] 50%|█████     | 336/669 [00:04<00:03, 109.53it/s] 52%|█████▏    | 347/669 [00:05<00:02, 109.50it/s] 54%|█████▎    | 358/669 [00:05<00:02, 109.48it/s] 55%|█████▌    | 369/669 [00:05<00:02, 109.52it/s] 57%|█████▋    | 380/669 [00:05<00:02, 109.45it/s] 58%|█████▊    | 391/669 [00:05<00:02, 109.51it/s] 60%|██████    | 402/669 [00:05<00:02, 109.53it/s] 62%|██████▏   | 413/669 [00:05<00:02, 109.56it/s] 63%|██████▎   | 424/669 [00:05<00:02, 109.49it/s] 65%|██████▌   | 435/669 [00:05<00:02, 109.52it/s] 67%|██████▋   | 446/669 [00:05<00:02, 109.44it/s] 68%|██████▊   | 457/669 [00:06<00:01, 109.49it/s] 70%|██████▉   | 468/669 [00:06<00:01, 109.48it/s] 72%|███████▏  | 479/669 [00:06<00:01, 109.54it/s] 73%|███████▎  | 490/669 [00:06<00:01, 109.47it/s] 75%|███████▍  | 501/669 [00:06<00:01, 109.48it/s] 77%|███████▋  | 512/669 [00:06<00:01, 109.40it/s] 78%|███████▊  | 523/669 [00:06<00:01, 109.47it/s] 80%|███████▉  | 534/669 [00:06<00:01, 109.41it/s] 81%|████████▏ | 545/669 [00:06<00:01, 108.82it/s] 83%|████████▎ | 556/669 [00:07<00:01, 102.92it/s] 85%|████████▍ | 567/669 [00:07<00:00, 104.59it/s] 86%|████████▋ | 578/669 [00:07<00:00, 105.80it/s] 88%|████████▊ | 589/669 [00:07<00:00, 106.78it/s] 90%|████████▉ | 600/669 [00:07<00:00, 107.49it/s] 91%|█████████▏| 611/669 [00:07<00:00, 107.97it/s] 93%|█████████▎| 622/669 [00:07<00:00, 108.38it/s] 95%|█████████▍| 633/669 [00:07<00:00, 108.47it/s] 96%|█████████▋| 644/669 [00:07<00:00, 108.64it/s] 98%|█████████▊| 655/669 [00:07<00:00, 108.69it/s]100%|█████████▉| 666/669 [00:08<00:00, 107.03it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.67it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 90.32it/s][A
 31%|███       | 52/168 [00:00<00:00, 186.91it/s][A
 51%|█████     | 85/168 [00:00<00:00, 238.96it/s][A
 71%|███████   | 119/168 [00:00<00:00, 271.07it/s][A
 91%|█████████ | 153/168 [00:00<00:00, 290.81it/s][A100%|██████████| 168/168 [00:00<00:00, 227.03it/s]
2022-10-22 07:02:14,875 P18776 INFO [Metrics] logloss: 0.554375 - AUC: 0.714666
2022-10-22 07:02:14,875 P18776 INFO Save best model: monitor(max): 0.160291
2022-10-22 07:02:15,018 P18776 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:09<00:00, 73.41it/s] 
2022-10-22 07:02:15,066 P18776 INFO Train loss: 0.705707
2022-10-22 07:02:15,066 P18776 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:48,  6.15it/s]  2%|▏         | 12/669 [00:00<00:12, 54.22it/s]  3%|▎         | 19/669 [00:00<00:11, 55.67it/s]  4%|▍         | 30/669 [00:00<00:08, 73.96it/s]  6%|▌         | 41/669 [00:00<00:07, 85.44it/s]  8%|▊         | 52/669 [00:00<00:06, 92.88it/s]  9%|▉         | 63/669 [00:00<00:06, 97.83it/s] 11%|█         | 74/669 [00:00<00:05, 101.21it/s] 13%|█▎        | 85/669 [00:00<00:05, 103.58it/s] 14%|█▍        | 96/669 [00:01<00:05, 105.27it/s] 16%|█▌        | 107/669 [00:01<00:05, 106.40it/s] 18%|█▊        | 118/669 [00:01<00:05, 107.27it/s] 19%|█▉        | 129/669 [00:01<00:05, 107.84it/s] 21%|██        | 140/669 [00:01<00:04, 108.03it/s] 23%|██▎       | 151/669 [00:01<00:04, 108.15it/s] 24%|██▍       | 162/669 [00:01<00:04, 108.45it/s] 26%|██▌       | 173/669 [00:01<00:04, 108.65it/s] 28%|██▊       | 184/669 [00:01<00:04, 108.82it/s] 29%|██▉       | 195/669 [00:02<00:04, 108.79it/s] 31%|███       | 206/669 [00:02<00:04, 108.93it/s] 32%|███▏      | 217/669 [00:02<00:04, 108.98it/s] 34%|███▍      | 228/669 [00:02<00:04, 108.90it/s] 36%|███▌      | 239/669 [00:02<00:03, 108.90it/s] 37%|███▋      | 250/669 [00:02<00:03, 108.98it/s] 39%|███▉      | 261/669 [00:02<00:03, 109.03it/s] 41%|████      | 272/669 [00:02<00:03, 108.99it/s] 42%|████▏     | 283/669 [00:02<00:03, 108.97it/s] 44%|████▍     | 294/669 [00:02<00:03, 108.99it/s] 46%|████▌     | 305/669 [00:03<00:03, 108.92it/s] 47%|████▋     | 316/669 [00:03<00:03, 108.93it/s] 49%|████▉     | 327/669 [00:03<00:03, 109.05it/s] 51%|█████     | 338/669 [00:03<00:03, 109.04it/s] 52%|█████▏    | 349/669 [00:03<00:02, 109.03it/s] 54%|█████▍    | 360/669 [00:03<00:02, 109.07it/s] 55%|█████▌    | 371/669 [00:03<00:02, 109.15it/s] 57%|█████▋    | 382/669 [00:03<00:02, 109.08it/s] 59%|█████▊    | 393/669 [00:03<00:02, 109.16it/s] 60%|██████    | 404/669 [00:03<00:02, 109.16it/s] 62%|██████▏   | 415/669 [00:04<00:02, 109.07it/s] 64%|██████▎   | 426/669 [00:04<00:02, 109.12it/s] 65%|██████▌   | 437/669 [00:04<00:02, 109.20it/s] 67%|██████▋   | 448/669 [00:04<00:02, 109.09it/s] 69%|██████▊   | 459/669 [00:04<00:01, 109.06it/s] 70%|███████   | 470/669 [00:04<00:01, 109.09it/s] 72%|███████▏  | 481/669 [00:04<00:01, 109.08it/s] 74%|███████▎  | 492/669 [00:04<00:01, 109.09it/s] 75%|███████▌  | 503/669 [00:04<00:01, 109.05it/s] 77%|███████▋  | 514/669 [00:04<00:01, 108.96it/s] 78%|███████▊  | 525/669 [00:05<00:01, 108.82it/s] 80%|████████  | 536/669 [00:05<00:01, 108.61it/s] 82%|████████▏ | 547/669 [00:05<00:01, 100.92it/s] 83%|████████▎ | 558/669 [00:05<00:01, 103.16it/s] 85%|████████▌ | 569/669 [00:05<00:00, 104.82it/s] 87%|████████▋ | 580/669 [00:05<00:00, 106.00it/s] 88%|████████▊ | 591/669 [00:05<00:00, 106.83it/s] 90%|████████▉ | 602/669 [00:05<00:00, 107.35it/s] 92%|█████████▏| 613/669 [00:05<00:00, 107.85it/s] 93%|█████████▎| 624/669 [00:05<00:00, 108.16it/s] 95%|█████████▍| 635/669 [00:06<00:00, 108.28it/s] 97%|█████████▋| 646/669 [00:06<00:00, 108.40it/s] 98%|█████████▊| 657/669 [00:06<00:00, 108.47it/s]100%|█████████▉| 668/669 [00:06<00:00, 106.66it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.40it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 75.30it/s][A
 31%|███       | 52/168 [00:00<00:00, 166.77it/s][A
 51%|█████     | 85/168 [00:00<00:00, 221.40it/s][A
 70%|███████   | 118/168 [00:00<00:00, 256.27it/s][A
 90%|████████▉ | 151/168 [00:00<00:00, 277.86it/s][A100%|██████████| 168/168 [00:00<00:00, 212.65it/s]
2022-10-22 07:02:22,378 P18776 INFO [Metrics] logloss: 0.553752 - AUC: 0.717348
2022-10-22 07:02:22,379 P18776 INFO Save best model: monitor(max): 0.163596
2022-10-22 07:02:22,554 P18776 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 88.80it/s] 
2022-10-22 07:02:22,600 P18776 INFO Train loss: 0.715261
2022-10-22 07:02:22,600 P18776 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:51,  5.99it/s]  2%|▏         | 12/669 [00:00<00:12, 53.38it/s]  3%|▎         | 19/669 [00:00<00:11, 55.33it/s]  4%|▍         | 30/669 [00:00<00:08, 73.63it/s]  6%|▌         | 41/669 [00:00<00:07, 85.17it/s]  8%|▊         | 52/669 [00:00<00:06, 92.74it/s]  9%|▉         | 63/669 [00:00<00:06, 97.85it/s] 11%|█         | 74/669 [00:00<00:05, 101.30it/s] 13%|█▎        | 85/669 [00:00<00:05, 103.76it/s] 14%|█▍        | 96/669 [00:01<00:05, 105.44it/s] 16%|█▌        | 107/669 [00:01<00:05, 106.60it/s] 18%|█▊        | 118/669 [00:01<00:05, 107.44it/s] 19%|█▉        | 129/669 [00:01<00:05, 107.93it/s] 21%|██        | 140/669 [00:01<00:04, 108.31it/s] 23%|██▎       | 151/669 [00:01<00:04, 108.59it/s] 24%|██▍       | 162/669 [00:01<00:04, 108.82it/s] 26%|██▌       | 173/669 [00:01<00:04, 108.97it/s] 28%|██▊       | 184/669 [00:01<00:04, 109.11it/s] 29%|██▉       | 195/669 [00:02<00:04, 109.10it/s] 31%|███       | 206/669 [00:02<00:04, 109.14it/s] 32%|███▏      | 217/669 [00:02<00:04, 109.18it/s] 34%|███▍      | 228/669 [00:02<00:04, 109.12it/s] 36%|███▌      | 239/669 [00:02<00:03, 109.20it/s] 37%|███▋      | 250/669 [00:02<00:03, 109.22it/s] 39%|███▉      | 261/669 [00:02<00:03, 109.08it/s] 41%|████      | 272/669 [00:02<00:03, 109.03it/s] 42%|████▏     | 283/669 [00:02<00:03, 109.03it/s] 44%|████▍     | 294/669 [00:02<00:03, 109.10it/s] 46%|████▌     | 305/669 [00:03<00:03, 109.13it/s] 47%|████▋     | 316/669 [00:03<00:03, 109.14it/s] 49%|████▉     | 327/669 [00:03<00:03, 109.12it/s] 51%|█████     | 338/669 [00:03<00:03, 109.15it/s] 52%|█████▏    | 349/669 [00:03<00:02, 109.13it/s] 54%|█████▍    | 360/669 [00:03<00:02, 109.16it/s] 55%|█████▌    | 371/669 [00:03<00:02, 109.16it/s] 57%|█████▋    | 382/669 [00:03<00:02, 109.15it/s] 59%|█████▊    | 393/669 [00:03<00:02, 109.13it/s] 60%|██████    | 404/669 [00:03<00:02, 109.16it/s] 62%|██████▏   | 415/669 [00:04<00:02, 109.11it/s] 64%|██████▎   | 426/669 [00:04<00:02, 109.10it/s] 65%|██████▌   | 437/669 [00:04<00:02, 109.05it/s] 67%|██████▋   | 448/669 [00:04<00:02, 108.99it/s] 69%|██████▊   | 459/669 [00:04<00:01, 109.04it/s] 70%|███████   | 470/669 [00:04<00:01, 109.14it/s] 72%|███████▏  | 481/669 [00:04<00:01, 109.20it/s] 74%|███████▎  | 492/669 [00:04<00:01, 109.13it/s] 75%|███████▌  | 503/669 [00:04<00:01, 109.10it/s] 77%|███████▋  | 514/669 [00:04<00:01, 109.13it/s] 78%|███████▊  | 525/669 [00:05<00:01, 109.16it/s] 80%|████████  | 536/669 [00:05<00:01, 109.24it/s] 82%|████████▏ | 547/669 [00:05<00:01, 109.21it/s] 83%|████████▎ | 558/669 [00:05<00:01, 109.13it/s] 85%|████████▌ | 569/669 [00:05<00:00, 109.06it/s] 87%|████████▋ | 580/669 [00:05<00:00, 109.15it/s] 88%|████████▊ | 591/669 [00:05<00:00, 109.16it/s] 90%|████████▉ | 602/669 [00:05<00:00, 109.14it/s] 92%|█████████▏| 613/669 [00:05<00:00, 109.19it/s] 93%|█████████▎| 624/669 [00:05<00:00, 109.18it/s] 95%|█████████▍| 635/669 [00:06<00:00, 109.09it/s] 97%|█████████▋| 646/669 [00:06<00:00, 109.17it/s] 98%|█████████▊| 657/669 [00:06<00:00, 109.11it/s]100%|█████████▉| 668/669 [00:06<00:00, 107.42it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.92it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 91.62it/s][A
 30%|███       | 51/168 [00:00<00:00, 184.80it/s][A
 49%|████▉     | 83/168 [00:00<00:00, 233.80it/s][A
 68%|██████▊   | 115/168 [00:00<00:00, 263.06it/s][A
 88%|████████▊ | 147/168 [00:00<00:00, 280.02it/s][A100%|██████████| 168/168 [00:00<00:00, 221.90it/s]
2022-10-22 07:02:29,848 P18776 INFO [Metrics] logloss: 0.550206 - AUC: 0.719205
2022-10-22 07:02:29,848 P18776 INFO Save best model: monitor(max): 0.168999
2022-10-22 07:02:30,019 P18776 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 89.59it/s] 
2022-10-22 07:02:30,068 P18776 INFO Train loss: 0.838755
2022-10-22 07:02:30,069 P18776 INFO ************ Epoch=3 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:58,  5.62it/s]  2%|▏         | 12/669 [00:00<00:12, 51.91it/s]  3%|▎         | 19/669 [00:00<00:11, 54.72it/s]  4%|▍         | 30/669 [00:00<00:08, 73.27it/s]  6%|▌         | 41/669 [00:00<00:07, 84.97it/s]  8%|▊         | 52/669 [00:00<00:06, 92.72it/s]  9%|▉         | 63/669 [00:00<00:06, 97.94it/s] 11%|█         | 74/669 [00:00<00:05, 101.52it/s] 13%|█▎        | 85/669 [00:01<00:05, 103.94it/s] 14%|█▍        | 96/669 [00:01<00:05, 105.59it/s] 16%|█▌        | 107/669 [00:01<00:05, 106.76it/s] 18%|█▊        | 118/669 [00:01<00:05, 107.48it/s] 19%|█▉        | 129/669 [00:01<00:04, 108.04it/s] 21%|██        | 140/669 [00:01<00:04, 108.38it/s] 23%|██▎       | 151/669 [00:01<00:04, 108.68it/s] 24%|██▍       | 162/669 [00:01<00:04, 108.87it/s] 26%|██▌       | 173/669 [00:01<00:04, 109.07it/s] 28%|██▊       | 184/669 [00:01<00:04, 109.21it/s] 29%|██▉       | 195/669 [00:02<00:04, 109.20it/s] 31%|███       | 206/669 [00:02<00:04, 109.15it/s] 32%|███▏      | 217/669 [00:02<00:04, 109.25it/s] 34%|███▍      | 228/669 [00:02<00:04, 109.24it/s] 36%|███▌      | 239/669 [00:02<00:03, 109.27it/s] 37%|███▋      | 250/669 [00:02<00:03, 109.34it/s] 39%|███▉      | 261/669 [00:02<00:03, 109.39it/s] 41%|████      | 272/669 [00:02<00:03, 109.44it/s] 42%|████▏     | 283/669 [00:02<00:03, 109.44it/s] 44%|████▍     | 294/669 [00:02<00:03, 109.35it/s] 46%|████▌     | 305/669 [00:03<00:03, 109.40it/s] 47%|████▋     | 316/669 [00:03<00:03, 109.40it/s] 49%|████▉     | 327/669 [00:03<00:03, 109.39it/s] 51%|█████     | 338/669 [00:03<00:03, 109.23it/s] 52%|█████▏    | 349/669 [00:03<00:02, 109.14it/s] 54%|█████▍    | 360/669 [00:03<00:02, 109.26it/s] 55%|█████▌    | 371/669 [00:03<00:02, 109.37it/s] 57%|█████▋    | 382/669 [00:03<00:02, 109.40it/s] 59%|█████▊    | 393/669 [00:03<00:02, 109.37it/s] 60%|██████    | 404/669 [00:03<00:02, 109.43it/s] 62%|██████▏   | 415/669 [00:04<00:02, 109.39it/s] 64%|██████▎   | 426/669 [00:04<00:02, 109.41it/s] 65%|██████▌   | 437/669 [00:04<00:02, 109.49it/s] 67%|██████▋   | 448/669 [00:04<00:02, 109.45it/s] 69%|██████▊   | 459/669 [00:04<00:01, 109.47it/s] 70%|███████   | 470/669 [00:04<00:01, 109.44it/s] 72%|███████▏  | 481/669 [00:04<00:01, 109.41it/s] 74%|███████▎  | 492/669 [00:04<00:01, 109.49it/s] 75%|███████▌  | 503/669 [00:04<00:01, 109.52it/s] 77%|███████▋  | 514/669 [00:04<00:01, 109.52it/s] 78%|███████▊  | 525/669 [00:05<00:01, 109.51it/s] 80%|████████  | 536/669 [00:05<00:01, 109.44it/s] 82%|████████▏ | 547/669 [00:05<00:01, 109.43it/s] 83%|████████▎ | 558/669 [00:05<00:01, 109.34it/s] 85%|████████▌ | 569/669 [00:05<00:00, 109.45it/s] 87%|████████▋ | 580/669 [00:05<00:00, 109.43it/s] 88%|████████▊ | 591/669 [00:05<00:00, 109.40it/s] 90%|████████▉ | 602/669 [00:05<00:00, 109.43it/s] 92%|█████████▏| 613/669 [00:05<00:00, 109.48it/s] 93%|█████████▎| 624/669 [00:05<00:00, 109.45it/s] 95%|█████████▍| 635/669 [00:06<00:00, 109.49it/s] 97%|█████████▋| 646/669 [00:06<00:00, 109.46it/s] 98%|█████████▊| 657/669 [00:06<00:00, 109.39it/s]100%|█████████▉| 668/669 [00:06<00:00, 107.76it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.60it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 91.09it/s][A
 31%|███       | 52/168 [00:00<00:00, 188.72it/s][A
 51%|█████     | 86/168 [00:00<00:00, 242.19it/s][A
 71%|███████▏  | 120/168 [00:00<00:00, 273.88it/s][A
 92%|█████████▏| 154/168 [00:00<00:00, 293.63it/s][A100%|██████████| 168/168 [00:00<00:00, 229.47it/s]
2022-10-22 07:02:37,284 P18776 INFO [Metrics] logloss: 0.553876 - AUC: 0.713163
2022-10-22 07:02:37,284 P18776 INFO Monitor(max) STOP: 0.159287 !
2022-10-22 07:02:37,284 P18776 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 07:02:37,285 P18776 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 92.15it/s] 
2022-10-22 07:02:37,330 P18776 INFO Train loss: 0.975773
2022-10-22 07:02:37,330 P18776 INFO ************ Epoch=4 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:47,  6.19it/s]  2%|▏         | 12/669 [00:00<00:11, 54.90it/s]  3%|▎         | 19/669 [00:00<00:11, 55.81it/s]  4%|▍         | 30/669 [00:00<00:08, 74.18it/s]  6%|▌         | 41/669 [00:00<00:07, 85.73it/s]  8%|▊         | 52/669 [00:00<00:06, 93.16it/s]  9%|▉         | 63/669 [00:00<00:06, 98.16it/s] 11%|█         | 74/669 [00:00<00:05, 101.59it/s] 13%|█▎        | 85/669 [00:00<00:05, 103.95it/s] 14%|█▍        | 96/669 [00:01<00:05, 105.58it/s] 16%|█▌        | 107/669 [00:01<00:05, 106.68it/s] 18%|█▊        | 118/669 [00:01<00:05, 107.43it/s] 19%|█▉        | 129/669 [00:01<00:05, 107.94it/s] 21%|██        | 140/669 [00:01<00:04, 108.39it/s] 23%|██▎       | 151/669 [00:01<00:04, 108.70it/s] 24%|██▍       | 162/669 [00:01<00:04, 108.89it/s] 26%|██▌       | 173/669 [00:01<00:04, 109.05it/s] 28%|██▊       | 184/669 [00:01<00:04, 109.08it/s] 29%|██▉       | 195/669 [00:01<00:04, 109.15it/s] 31%|███       | 206/669 [00:02<00:04, 109.24it/s] 32%|███▏      | 217/669 [00:02<00:04, 109.28it/s] 34%|███▍      | 228/669 [00:02<00:04, 109.25it/s] 36%|███▌      | 239/669 [00:02<00:03, 109.21it/s] 37%|███▋      | 250/669 [00:02<00:03, 109.24it/s] 39%|███▉      | 261/669 [00:02<00:03, 109.11it/s] 41%|████      | 272/669 [00:02<00:03, 108.98it/s] 42%|████▏     | 283/669 [00:02<00:03, 108.84it/s] 44%|████▍     | 294/669 [00:02<00:03, 108.82it/s] 46%|████▌     | 305/669 [00:03<00:03, 108.81it/s] 47%|████▋     | 316/669 [00:03<00:03, 108.74it/s] 49%|████▉     | 327/669 [00:03<00:03, 108.79it/s] 51%|█████     | 338/669 [00:03<00:03, 108.83it/s] 52%|█████▏    | 349/669 [00:03<00:02, 108.77it/s] 54%|█████▍    | 360/669 [00:03<00:02, 108.69it/s] 55%|█████▌    | 371/669 [00:03<00:02, 108.67it/s] 57%|█████▋    | 382/669 [00:03<00:02, 108.69it/s] 59%|█████▊    | 393/669 [00:03<00:02, 108.74it/s] 60%|██████    | 404/669 [00:03<00:02, 108.76it/s] 62%|██████▏   | 415/669 [00:04<00:02, 108.82it/s] 64%|██████▎   | 426/669 [00:04<00:02, 108.81it/s] 65%|██████▌   | 437/669 [00:04<00:02, 108.70it/s] 67%|██████▋   | 448/669 [00:04<00:02, 108.39it/s] 69%|██████▊   | 459/669 [00:04<00:01, 108.13it/s] 70%|███████   | 470/669 [00:04<00:01, 108.09it/s] 72%|███████▏  | 481/669 [00:04<00:01, 108.25it/s] 74%|███████▎  | 492/669 [00:04<00:01, 108.41it/s] 75%|███████▌  | 503/669 [00:04<00:01, 108.47it/s] 77%|███████▋  | 514/669 [00:04<00:01, 108.60it/s] 78%|███████▊  | 525/669 [00:05<00:01, 108.63it/s] 80%|████████  | 536/669 [00:05<00:01, 108.65it/s] 82%|████████▏ | 547/669 [00:05<00:01, 108.66it/s] 83%|████████▎ | 558/669 [00:05<00:01, 108.62it/s] 85%|████████▌ | 569/669 [00:05<00:00, 108.49it/s] 87%|████████▋ | 580/669 [00:05<00:00, 108.59it/s] 88%|████████▊ | 591/669 [00:05<00:00, 108.61it/s] 90%|████████▉ | 602/669 [00:05<00:00, 108.65it/s] 92%|█████████▏| 613/669 [00:05<00:00, 108.62it/s] 93%|█████████▎| 624/669 [00:05<00:00, 108.49it/s] 95%|█████████▍| 635/669 [00:06<00:00, 108.57it/s] 97%|█████████▋| 646/669 [00:06<00:00, 108.61it/s] 98%|█████████▊| 657/669 [00:06<00:00, 108.60it/s]100%|█████████▉| 668/669 [00:06<00:00, 106.96it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.83it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 91.34it/s][A
 31%|███       | 52/168 [00:00<00:00, 188.38it/s][A
 51%|█████     | 85/168 [00:00<00:00, 238.79it/s][A
 70%|███████   | 118/168 [00:00<00:00, 269.69it/s][A
 90%|████████▉ | 151/168 [00:00<00:00, 288.80it/s][A100%|██████████| 168/168 [00:00<00:00, 226.64it/s]
2022-10-22 07:02:44,573 P18776 INFO [Metrics] logloss: 0.571596 - AUC: 0.719633
2022-10-22 07:02:44,574 P18776 INFO Monitor(max) STOP: 0.148037 !
2022-10-22 07:02:44,574 P18776 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 07:02:44,574 P18776 INFO Early stopping at epoch=5
2022-10-22 07:02:44,574 P18776 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:07<00:00, 91.64it/s] 
2022-10-22 07:02:44,620 P18776 INFO Train loss: 0.921608
2022-10-22 07:02:44,620 P18776 INFO Training finished.
2022-10-22 07:02:44,620 P18776 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_011_5fe39b7b.model
2022-10-22 07:02:44,638 P18776 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:44,  6.42it/s]  3%|▎         | 19/669 [00:00<00:08, 78.01it/s]  8%|▊         | 51/669 [00:00<00:03, 167.69it/s] 13%|█▎        | 84/669 [00:00<00:02, 222.12it/s] 17%|█▋        | 117/669 [00:00<00:02, 255.71it/s] 22%|██▏       | 149/669 [00:00<00:01, 275.33it/s] 27%|██▋       | 182/669 [00:00<00:01, 290.26it/s] 32%|███▏      | 215/669 [00:00<00:01, 300.24it/s] 37%|███▋      | 248/669 [00:01<00:01, 306.69it/s] 42%|████▏     | 281/669 [00:01<00:01, 311.54it/s] 47%|████▋     | 314/669 [00:01<00:01, 314.83it/s] 52%|█████▏    | 347/669 [00:01<00:01, 317.21it/s] 57%|█████▋    | 380/669 [00:01<00:00, 318.52it/s] 62%|██████▏   | 413/669 [00:01<00:00, 319.64it/s] 67%|██████▋   | 446/669 [00:01<00:00, 320.44it/s] 72%|███████▏  | 479/669 [00:01<00:00, 320.84it/s] 77%|███████▋  | 512/669 [00:01<00:00, 320.38it/s] 81%|████████▏ | 545/669 [00:01<00:00, 317.31it/s] 86%|████████▌ | 577/669 [00:02<00:00, 312.43it/s] 91%|█████████ | 609/669 [00:02<00:00, 312.54it/s] 96%|█████████▌| 641/669 [00:02<00:00, 312.44it/s]100%|██████████| 669/669 [00:02<00:00, 280.18it/s]
2022-10-22 07:02:47,607 P18776 INFO [Metrics] logloss: 0.510343 - AUC: 0.780610
  0%|          | 0/168 [00:00<?, ?it/s]  1%|          | 1/168 [00:00<00:18,  8.99it/s] 11%|█▏        | 19/168 [00:00<00:01, 92.17it/s] 30%|██▉       | 50/168 [00:00<00:00, 181.16it/s] 49%|████▉     | 83/168 [00:00<00:00, 234.74it/s] 69%|██████▉   | 116/168 [00:00<00:00, 265.99it/s] 88%|████████▊ | 148/168 [00:00<00:00, 283.51it/s]100%|██████████| 168/168 [00:00<00:00, 220.56it/s]
2022-10-22 07:02:48,508 P18776 INFO [Metrics] logloss: 0.550206 - AUC: 0.719205
2022-10-22 07:02:48,579 P18776 INFO ******** Test evaluation ********
2022-10-22 07:02:48,579 P18776 INFO Loading data...
2022-10-22 07:02:48,580 P18776 INFO Loading test data done.
2022-10-22 07:02:53,368 P21365 INFO {
    "batch_norm": "True",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "8",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_012_ad4e16bc",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 07:02:53,369 P21365 INFO Set up feature encoder...
2022-10-22 07:02:53,370 P21365 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 07:02:53,371 P21365 INFO Loading data...
2022-10-22 07:02:53,375 P21365 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 07:02:53,476 P21365 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 07:02:53,512 P21365 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 07:02:53,512 P21365 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 07:02:53,512 P21365 INFO Loading train data done.
2022-10-22 07:02:55,962 P21365 INFO Total number of parameters: 2356688.
2022-10-22 07:02:55,962 P21365 INFO Start training: 669 batches/epoch
2022-10-22 07:02:55,962 P21365 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 07:02:56.293 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:21365 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 07:02:56.324 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:21365 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<18:07,  1.63s/it]  1%|▏         | 10/669 [00:01<01:24,  7.78it/s]  3%|▎         | 20/669 [00:01<00:37, 17.19it/s]  4%|▍         | 28/669 [00:01<00:26, 24.10it/s]  6%|▌         | 39/669 [00:02<00:17, 36.43it/s]  7%|▋         | 50/669 [00:02<00:12, 48.48it/s]  9%|▉         | 61/669 [00:02<00:10, 59.95it/s] 11%|█         | 72/669 [00:02<00:08, 70.34it/s] 12%|█▏        | 83/669 [00:02<00:07, 79.51it/s] 14%|█▍        | 94/669 [00:02<00:06, 87.03it/s] 16%|█▌        | 106/669 [00:02<00:06, 93.56it/s] 18%|█▊        | 118/669 [00:02<00:05, 98.56it/s] 19%|█▉        | 130/669 [00:02<00:05, 102.22it/s] 21%|██        | 142/669 [00:03<00:05, 104.83it/s] 23%|██▎       | 154/669 [00:03<00:04, 106.74it/s] 25%|██▍       | 166/669 [00:03<00:04, 108.17it/s] 27%|██▋       | 178/669 [00:03<00:04, 109.19it/s] 28%|██▊       | 190/669 [00:03<00:04, 110.01it/s] 30%|███       | 202/669 [00:03<00:04, 110.54it/s] 32%|███▏      | 214/669 [00:03<00:04, 111.03it/s] 34%|███▍      | 226/669 [00:03<00:03, 111.34it/s] 36%|███▌      | 238/669 [00:03<00:03, 111.40it/s] 37%|███▋      | 250/669 [00:03<00:03, 111.52it/s] 39%|███▉      | 262/669 [00:04<00:03, 111.66it/s] 41%|████      | 274/669 [00:04<00:03, 111.73it/s] 43%|████▎     | 286/669 [00:04<00:03, 111.73it/s] 45%|████▍     | 298/669 [00:04<00:03, 111.83it/s] 46%|████▋     | 310/669 [00:04<00:03, 111.82it/s] 48%|████▊     | 322/669 [00:04<00:03, 111.79it/s] 50%|████▉     | 334/669 [00:04<00:02, 111.75it/s] 52%|█████▏    | 346/669 [00:04<00:02, 111.76it/s] 54%|█████▎    | 358/669 [00:04<00:02, 111.77it/s] 55%|█████▌    | 370/669 [00:05<00:02, 111.83it/s] 57%|█████▋    | 382/669 [00:05<00:02, 111.77it/s] 59%|█████▉    | 394/669 [00:05<00:02, 111.71it/s] 61%|██████    | 406/669 [00:05<00:02, 111.85it/s] 62%|██████▏   | 418/669 [00:05<00:02, 111.69it/s] 64%|██████▍   | 430/669 [00:05<00:02, 111.45it/s] 66%|██████▌   | 442/669 [00:05<00:02, 111.52it/s] 68%|██████▊   | 454/669 [00:05<00:01, 111.50it/s] 70%|██████▉   | 466/669 [00:05<00:01, 111.66it/s] 71%|███████▏  | 478/669 [00:06<00:01, 111.78it/s] 73%|███████▎  | 490/669 [00:06<00:01, 111.82it/s] 75%|███████▌  | 502/669 [00:06<00:01, 111.80it/s] 77%|███████▋  | 514/669 [00:06<00:01, 111.71it/s] 79%|███████▊  | 526/669 [00:06<00:01, 111.85it/s] 80%|████████  | 538/669 [00:06<00:01, 111.98it/s] 82%|████████▏ | 550/669 [00:06<00:01, 103.45it/s] 84%|████████▍ | 562/669 [00:06<00:00, 107.25it/s] 86%|████████▌ | 574/669 [00:06<00:00, 109.97it/s] 88%|████████▊ | 586/669 [00:07<00:00, 112.02it/s] 89%|████████▉ | 598/669 [00:07<00:00, 113.80it/s] 91%|█████████ | 610/669 [00:07<00:00, 115.00it/s] 93%|█████████▎| 622/669 [00:07<00:00, 115.92it/s] 95%|█████████▍| 634/669 [00:07<00:00, 116.57it/s] 97%|█████████▋| 646/669 [00:07<00:00, 116.98it/s] 98%|█████████▊| 658/669 [00:07<00:00, 117.33it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.78it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 92.88it/s][A
 30%|██▉       | 50/168 [00:00<00:00, 182.31it/s][A
 49%|████▉     | 83/168 [00:00<00:00, 234.97it/s][A
 69%|██████▉   | 116/168 [00:00<00:00, 267.47it/s][A
 89%|████████▊ | 149/168 [00:00<00:00, 287.79it/s][A100%|██████████| 168/168 [00:00<00:00, 227.14it/s]
2022-10-22 07:03:04,569 P21365 INFO [Metrics] logloss: 0.561457 - AUC: 0.706266
2022-10-22 07:03:04,570 P21365 INFO Save best model: monitor(max): 0.144809
2022-10-22 07:03:04,675 P21365 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:08<00:00, 76.41it/s] 
2022-10-22 07:03:04,720 P21365 INFO Train loss: 0.671347
2022-10-22 07:03:04,720 P21365 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:58,  5.66it/s]  2%|▏         | 13/669 [00:00<00:11, 55.07it/s]  3%|▎         | 20/669 [00:00<00:11, 56.66it/s]  5%|▍         | 32/669 [00:00<00:08, 76.29it/s]  7%|▋         | 44/669 [00:00<00:07, 88.52it/s]  8%|▊         | 56/669 [00:00<00:06, 96.46it/s] 10%|█         | 68/669 [00:00<00:05, 101.65it/s] 12%|█▏        | 80/669 [00:00<00:05, 105.22it/s] 14%|█▍        | 92/669 [00:01<00:05, 107.51it/s] 16%|█▌        | 104/669 [00:01<00:05, 109.10it/s] 17%|█▋        | 116/669 [00:01<00:05, 110.08it/s] 19%|█▉        | 128/669 [00:01<00:04, 110.83it/s] 21%|██        | 140/669 [00:01<00:04, 111.35it/s] 23%|██▎       | 152/669 [00:01<00:04, 111.80it/s] 25%|██▍       | 164/669 [00:01<00:04, 112.08it/s] 26%|██▋       | 176/669 [00:01<00:04, 112.04it/s] 28%|██▊       | 188/669 [00:01<00:04, 111.92it/s] 30%|██▉       | 200/669 [00:02<00:04, 112.04it/s] 32%|███▏      | 212/669 [00:02<00:04, 112.31it/s] 33%|███▎      | 224/669 [00:02<00:03, 112.40it/s] 35%|███▌      | 236/669 [00:02<00:03, 112.43it/s] 37%|███▋      | 248/669 [00:02<00:03, 112.58it/s] 39%|███▉      | 260/669 [00:02<00:03, 112.66it/s] 41%|████      | 272/669 [00:02<00:03, 112.59it/s] 42%|████▏     | 284/669 [00:02<00:03, 112.57it/s] 44%|████▍     | 296/669 [00:02<00:03, 112.50it/s] 46%|████▌     | 308/669 [00:02<00:03, 112.57it/s] 48%|████▊     | 320/669 [00:03<00:03, 112.55it/s] 50%|████▉     | 332/669 [00:03<00:02, 112.54it/s] 51%|█████▏    | 344/669 [00:03<00:02, 112.50it/s] 53%|█████▎    | 356/669 [00:03<00:02, 112.53it/s] 55%|█████▌    | 368/669 [00:03<00:02, 112.58it/s] 57%|█████▋    | 380/669 [00:03<00:02, 112.60it/s] 59%|█████▊    | 392/669 [00:03<00:02, 112.67it/s] 60%|██████    | 404/669 [00:03<00:02, 112.71it/s] 62%|██████▏   | 416/669 [00:03<00:02, 112.56it/s] 64%|██████▍   | 428/669 [00:04<00:02, 112.54it/s] 66%|██████▌   | 440/669 [00:04<00:02, 112.62it/s] 68%|██████▊   | 452/669 [00:04<00:01, 112.38it/s] 69%|██████▉   | 464/669 [00:04<00:01, 112.35it/s] 71%|███████   | 476/669 [00:04<00:01, 112.34it/s] 73%|███████▎  | 488/669 [00:04<00:01, 112.27it/s] 75%|███████▍  | 500/669 [00:04<00:01, 112.31it/s] 77%|███████▋  | 512/669 [00:04<00:01, 112.28it/s] 78%|███████▊  | 524/669 [00:04<00:01, 112.28it/s] 80%|████████  | 536/669 [00:04<00:01, 112.29it/s] 82%|████████▏ | 548/669 [00:05<00:01, 104.12it/s] 84%|████████▎ | 560/669 [00:05<00:01, 106.61it/s] 86%|████████▌ | 572/669 [00:05<00:00, 108.27it/s] 87%|████████▋ | 584/669 [00:05<00:00, 109.40it/s] 89%|████████▉ | 596/669 [00:05<00:00, 110.18it/s] 91%|█████████ | 608/669 [00:05<00:00, 110.73it/s] 93%|█████████▎| 620/669 [00:05<00:00, 111.13it/s] 94%|█████████▍| 632/669 [00:05<00:00, 111.31it/s] 96%|█████████▋| 644/669 [00:05<00:00, 111.41it/s] 98%|█████████▊| 656/669 [00:06<00:00, 111.51it/s]100%|█████████▉| 668/669 [00:06<00:00, 110.01it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:18,  8.79it/s][A
 10%|▉         | 16/168 [00:00<00:01, 85.97it/s][A
 15%|█▍        | 25/168 [00:00<00:01, 86.23it/s][A
 35%|███▍      | 58/168 [00:00<00:00, 178.51it/s][A
 55%|█████▍    | 92/168 [00:00<00:00, 233.10it/s][A
 74%|███████▍  | 125/168 [00:00<00:00, 265.24it/s][A
 95%|█████████▍| 159/168 [00:00<00:00, 286.71it/s][A100%|██████████| 168/168 [00:00<00:00, 207.80it/s]
2022-10-22 07:03:11,875 P21365 INFO [Metrics] logloss: 0.553096 - AUC: 0.718158
2022-10-22 07:03:11,875 P21365 INFO Save best model: monitor(max): 0.165062
2022-10-22 07:03:12,009 P21365 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 91.14it/s] 
2022-10-22 07:03:12,061 P21365 INFO Train loss: 0.716853
2022-10-22 07:03:12,062 P21365 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:57,  5.70it/s]  2%|▏         | 12/669 [00:00<00:12, 51.98it/s]  3%|▎         | 19/669 [00:00<00:12, 54.13it/s]  4%|▍         | 30/669 [00:00<00:08, 72.60it/s]  6%|▋         | 42/669 [00:00<00:07, 85.56it/s]  8%|▊         | 54/669 [00:00<00:06, 94.51it/s] 10%|▉         | 66/669 [00:00<00:06, 100.01it/s] 12%|█▏        | 78/669 [00:00<00:05, 104.08it/s] 13%|█▎        | 90/669 [00:01<00:05, 107.70it/s] 15%|█▌        | 102/669 [00:01<00:05, 110.26it/s] 17%|█▋        | 114/669 [00:01<00:04, 111.94it/s] 19%|█▉        | 126/669 [00:01<00:04, 113.81it/s] 21%|██        | 138/669 [00:01<00:04, 115.17it/s] 22%|██▏       | 150/669 [00:01<00:04, 116.25it/s] 24%|██▍       | 162/669 [00:01<00:04, 116.92it/s] 26%|██▌       | 174/669 [00:01<00:04, 117.48it/s] 28%|██▊       | 186/669 [00:01<00:04, 117.64it/s] 30%|██▉       | 198/669 [00:01<00:04, 117.72it/s] 31%|███▏      | 210/669 [00:02<00:03, 117.94it/s] 33%|███▎      | 222/669 [00:02<00:03, 118.18it/s] 35%|███▍      | 234/669 [00:02<00:03, 118.35it/s] 37%|███▋      | 246/669 [00:02<00:03, 118.44it/s] 39%|███▊      | 258/669 [00:02<00:03, 118.62it/s] 40%|████      | 270/669 [00:02<00:03, 118.65it/s] 42%|████▏     | 282/669 [00:02<00:03, 118.31it/s] 44%|████▍     | 294/669 [00:02<00:03, 118.37it/s] 46%|████▌     | 306/669 [00:02<00:03, 118.32it/s] 48%|████▊     | 318/669 [00:02<00:02, 118.15it/s] 49%|████▉     | 330/669 [00:03<00:02, 118.24it/s] 51%|█████     | 342/669 [00:03<00:02, 118.21it/s] 53%|█████▎    | 354/669 [00:03<00:02, 118.28it/s] 55%|█████▍    | 366/669 [00:03<00:02, 118.45it/s] 57%|█████▋    | 378/669 [00:03<00:02, 118.42it/s] 58%|█████▊    | 390/669 [00:03<00:02, 118.44it/s] 60%|██████    | 402/669 [00:03<00:02, 118.56it/s] 62%|██████▏   | 414/669 [00:03<00:02, 118.60it/s] 64%|██████▎   | 426/669 [00:03<00:02, 118.33it/s] 65%|██████▌   | 438/669 [00:03<00:01, 118.17it/s] 67%|██████▋   | 450/669 [00:04<00:01, 118.26it/s] 69%|██████▉   | 462/669 [00:04<00:01, 118.18it/s] 71%|███████   | 474/669 [00:04<00:01, 118.25it/s] 73%|███████▎  | 486/669 [00:04<00:01, 118.42it/s] 74%|███████▍  | 498/669 [00:04<00:01, 118.55it/s] 76%|███████▌  | 510/669 [00:04<00:01, 118.43it/s] 78%|███████▊  | 522/669 [00:04<00:01, 118.58it/s] 80%|███████▉  | 534/669 [00:04<00:01, 118.70it/s] 82%|████████▏ | 546/669 [00:04<00:01, 118.73it/s] 83%|████████▎ | 558/669 [00:04<00:00, 118.74it/s] 85%|████████▌ | 570/669 [00:05<00:00, 118.60it/s] 87%|████████▋ | 582/669 [00:05<00:00, 118.71it/s] 89%|████████▉ | 594/669 [00:05<00:00, 118.73it/s] 91%|█████████ | 606/669 [00:05<00:00, 118.76it/s] 92%|█████████▏| 618/669 [00:05<00:00, 118.71it/s] 94%|█████████▍| 630/669 [00:05<00:00, 118.68it/s] 96%|█████████▌| 642/669 [00:05<00:00, 118.62it/s] 98%|█████████▊| 654/669 [00:05<00:00, 118.75it/s]100%|█████████▉| 666/669 [00:05<00:00, 116.64it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:16,  9.97it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 90.42it/s][A
 31%|███       | 52/168 [00:00<00:00, 188.10it/s][A
 51%|█████     | 85/168 [00:00<00:00, 239.59it/s][A
 71%|███████   | 119/168 [00:00<00:00, 272.05it/s][A
 91%|█████████ | 153/168 [00:00<00:00, 292.28it/s][A100%|██████████| 168/168 [00:00<00:00, 228.42it/s]
2022-10-22 07:03:18,867 P21365 INFO [Metrics] logloss: 0.568732 - AUC: 0.699830
2022-10-22 07:03:18,868 P21365 INFO Monitor(max) STOP: 0.131098 !
2022-10-22 07:03:18,868 P21365 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 07:03:18,868 P21365 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 97.62it/s] 
2022-10-22 07:03:18,916 P21365 INFO Train loss: 0.844030
2022-10-22 07:03:18,916 P21365 INFO ************ Epoch=3 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:52,  5.96it/s]  2%|▏         | 13/669 [00:00<00:11, 56.26it/s]  3%|▎         | 20/669 [00:00<00:11, 56.51it/s]  5%|▍         | 32/669 [00:00<00:08, 76.08it/s]  7%|▋         | 44/669 [00:00<00:07, 88.11it/s]  8%|▊         | 56/669 [00:00<00:06, 95.94it/s] 10%|█         | 68/669 [00:00<00:05, 101.04it/s] 12%|█▏        | 80/669 [00:00<00:05, 104.37it/s] 14%|█▍        | 92/669 [00:01<00:05, 106.61it/s] 16%|█▌        | 104/669 [00:01<00:05, 108.06it/s] 17%|█▋        | 116/669 [00:01<00:05, 109.00it/s] 19%|█▉        | 128/669 [00:01<00:04, 109.80it/s] 21%|██        | 140/669 [00:01<00:04, 110.34it/s] 23%|██▎       | 152/669 [00:01<00:04, 110.77it/s] 25%|██▍       | 164/669 [00:01<00:04, 111.15it/s] 26%|██▋       | 176/669 [00:01<00:04, 111.41it/s] 28%|██▊       | 188/669 [00:01<00:04, 111.43it/s] 30%|██▉       | 200/669 [00:02<00:04, 111.57it/s] 32%|███▏      | 212/669 [00:02<00:04, 111.53it/s] 33%|███▎      | 224/669 [00:02<00:03, 111.63it/s] 35%|███▌      | 236/669 [00:02<00:03, 111.60it/s] 37%|███▋      | 248/669 [00:02<00:03, 111.69it/s] 39%|███▉      | 260/669 [00:02<00:03, 111.63it/s] 41%|████      | 272/669 [00:02<00:03, 111.31it/s] 42%|████▏     | 284/669 [00:02<00:03, 111.46it/s] 44%|████▍     | 296/669 [00:02<00:03, 111.62it/s] 46%|████▌     | 308/669 [00:02<00:03, 111.80it/s] 48%|████▊     | 320/669 [00:03<00:03, 111.94it/s] 50%|████▉     | 332/669 [00:03<00:03, 112.10it/s] 51%|█████▏    | 344/669 [00:03<00:02, 112.19it/s] 53%|█████▎    | 356/669 [00:03<00:02, 112.14it/s] 55%|█████▌    | 368/669 [00:03<00:02, 112.16it/s] 57%|█████▋    | 380/669 [00:03<00:02, 112.15it/s] 59%|█████▊    | 392/669 [00:03<00:02, 112.21it/s] 60%|██████    | 404/669 [00:03<00:02, 112.13it/s] 62%|██████▏   | 416/669 [00:03<00:02, 112.05it/s] 64%|██████▍   | 428/669 [00:04<00:02, 112.14it/s] 66%|██████▌   | 440/669 [00:04<00:02, 112.15it/s] 68%|██████▊   | 452/669 [00:04<00:01, 112.07it/s] 69%|██████▉   | 464/669 [00:04<00:01, 112.05it/s] 71%|███████   | 476/669 [00:04<00:01, 112.00it/s] 73%|███████▎  | 488/669 [00:04<00:01, 112.07it/s] 75%|███████▍  | 500/669 [00:04<00:01, 112.16it/s] 77%|███████▋  | 512/669 [00:04<00:01, 112.26it/s] 78%|███████▊  | 524/669 [00:04<00:01, 112.25it/s] 80%|████████  | 536/669 [00:05<00:01, 112.18it/s] 82%|████████▏ | 548/669 [00:05<00:01, 112.22it/s] 84%|████████▎ | 560/669 [00:05<00:00, 112.27it/s] 86%|████████▌ | 572/669 [00:05<00:00, 112.30it/s] 87%|████████▋ | 584/669 [00:05<00:00, 112.26it/s] 89%|████████▉ | 596/669 [00:05<00:00, 112.21it/s] 91%|█████████ | 608/669 [00:05<00:00, 112.28it/s] 93%|█████████▎| 620/669 [00:05<00:00, 112.32it/s] 94%|█████████▍| 632/669 [00:05<00:00, 112.32it/s] 96%|█████████▋| 644/669 [00:05<00:00, 112.15it/s] 98%|█████████▊| 656/669 [00:06<00:00, 112.11it/s]100%|█████████▉| 668/669 [00:06<00:00, 110.41it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:18,  8.96it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 91.34it/s][A
 32%|███▏      | 53/168 [00:00<00:00, 191.32it/s][A
 52%|█████▏    | 87/168 [00:00<00:00, 243.52it/s][A
 72%|███████▏  | 121/168 [00:00<00:00, 275.51it/s][A
 92%|█████████▏| 155/168 [00:00<00:00, 296.26it/s][A100%|██████████| 168/168 [00:00<00:00, 228.22it/s]
2022-10-22 07:03:25,993 P21365 INFO [Metrics] logloss: 0.577149 - AUC: 0.714923
2022-10-22 07:03:25,993 P21365 INFO Monitor(max) STOP: 0.137774 !
2022-10-22 07:03:25,994 P21365 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 07:03:25,994 P21365 INFO Early stopping at epoch=4
2022-10-22 07:03:25,994 P21365 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:07<00:00, 93.69it/s] 
2022-10-22 07:03:26,047 P21365 INFO Train loss: 0.796271
2022-10-22 07:03:26,047 P21365 INFO Training finished.
2022-10-22 07:03:26,047 P21365 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_012_ad4e16bc.model
2022-10-22 07:03:26,148 P21365 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:54,  5.81it/s]  3%|▎         | 19/669 [00:00<00:08, 73.91it/s]  8%|▊         | 52/669 [00:00<00:03, 166.22it/s] 13%|█▎        | 86/669 [00:00<00:02, 223.40it/s] 18%|█▊        | 120/669 [00:00<00:02, 259.74it/s] 23%|██▎       | 154/669 [00:00<00:01, 283.68it/s] 28%|██▊       | 188/669 [00:00<00:01, 299.67it/s] 33%|███▎      | 221/669 [00:00<00:01, 308.25it/s] 38%|███▊      | 255/669 [00:01<00:01, 316.17it/s] 43%|████▎     | 289/669 [00:01<00:01, 321.91it/s] 48%|████▊     | 323/669 [00:01<00:01, 325.53it/s] 53%|█████▎    | 357/669 [00:01<00:00, 328.19it/s] 58%|█████▊    | 391/669 [00:01<00:00, 329.95it/s] 64%|██████▎   | 425/669 [00:01<00:00, 331.23it/s] 69%|██████▊   | 459/669 [00:01<00:00, 332.13it/s] 74%|███████▎  | 493/669 [00:01<00:00, 332.73it/s] 79%|███████▉  | 527/669 [00:01<00:00, 333.26it/s] 84%|████████▍ | 561/669 [00:01<00:00, 333.34it/s] 89%|████████▉ | 595/669 [00:02<00:00, 332.99it/s] 94%|█████████▍| 629/669 [00:02<00:00, 333.02it/s] 99%|█████████▉| 663/669 [00:02<00:00, 323.45it/s]100%|██████████| 669/669 [00:02<00:00, 289.89it/s]
2022-10-22 07:03:29,034 P21365 INFO [Metrics] logloss: 0.506070 - AUC: 0.790148
  0%|          | 0/168 [00:00<?, ?it/s]  1%|          | 1/168 [00:00<00:16,  9.91it/s] 11%|█▏        | 19/168 [00:00<00:01, 90.74it/s] 31%|███       | 52/168 [00:00<00:00, 187.60it/s] 51%|█████     | 86/168 [00:00<00:00, 241.27it/s] 71%|███████▏  | 120/168 [00:00<00:00, 273.23it/s] 92%|█████████▏| 154/168 [00:00<00:00, 293.18it/s]100%|██████████| 168/168 [00:00<00:00, 225.95it/s]
2022-10-22 07:03:29,916 P21365 INFO [Metrics] logloss: 0.553096 - AUC: 0.718158
2022-10-22 07:03:29,994 P21365 INFO ******** Test evaluation ********
2022-10-22 07:03:29,995 P21365 INFO Loading data...
2022-10-22 07:03:29,996 P21365 INFO Loading test data done.
2022-10-22 07:03:33,387 P23548 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_013_14edc303",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 07:03:33,389 P23548 INFO Set up feature encoder...
2022-10-22 07:03:33,389 P23548 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 07:03:33,390 P23548 INFO Loading data...
2022-10-22 07:03:33,394 P23548 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 07:03:33,499 P23548 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 07:03:33,535 P23548 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 07:03:33,535 P23548 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 07:03:33,535 P23548 INFO Loading train data done.
2022-10-22 07:03:36,067 P23548 INFO Total number of parameters: 4161832.
2022-10-22 07:03:36,067 P23548 INFO Start training: 669 batches/epoch
2022-10-22 07:03:36,067 P23548 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 07:03:36.405 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:23548 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 07:03:36.438 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:23548 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<12:25,  1.12s/it]  2%|▏         | 13/669 [00:01<00:45, 14.36it/s]  3%|▎         | 22/669 [00:01<00:27, 23.47it/s]  5%|▌         | 34/669 [00:01<00:16, 38.64it/s]  7%|▋         | 47/669 [00:01<00:11, 54.65it/s]  9%|▉         | 60/669 [00:01<00:08, 69.31it/s] 11%|█         | 73/669 [00:01<00:07, 82.11it/s] 13%|█▎        | 86/669 [00:01<00:06, 93.10it/s] 15%|█▍        | 99/669 [00:01<00:05, 102.00it/s] 17%|█▋        | 112/669 [00:02<00:05, 108.84it/s] 19%|█▊        | 125/669 [00:02<00:04, 114.11it/s] 21%|██        | 138/669 [00:02<00:04, 117.88it/s] 23%|██▎       | 151/669 [00:02<00:04, 120.87it/s] 25%|██▍       | 164/669 [00:02<00:04, 122.98it/s] 26%|██▋       | 177/669 [00:02<00:03, 124.53it/s] 28%|██▊       | 190/669 [00:02<00:03, 125.59it/s] 30%|███       | 203/669 [00:02<00:03, 126.36it/s] 32%|███▏      | 216/669 [00:02<00:03, 126.85it/s] 34%|███▍      | 229/669 [00:03<00:03, 127.27it/s] 36%|███▌      | 242/669 [00:03<00:03, 127.39it/s] 38%|███▊      | 255/669 [00:03<00:03, 127.57it/s] 40%|████      | 268/669 [00:03<00:03, 127.82it/s] 42%|████▏     | 281/669 [00:03<00:03, 127.95it/s] 44%|████▍     | 294/669 [00:03<00:02, 128.06it/s] 46%|████▌     | 307/669 [00:03<00:02, 128.19it/s] 48%|████▊     | 320/669 [00:03<00:02, 128.15it/s] 50%|████▉     | 333/669 [00:03<00:02, 128.15it/s] 52%|█████▏    | 346/669 [00:03<00:02, 127.89it/s] 54%|█████▎    | 359/669 [00:04<00:02, 127.83it/s] 56%|█████▌    | 372/669 [00:04<00:02, 127.68it/s] 58%|█████▊    | 385/669 [00:04<00:02, 127.68it/s] 59%|█████▉    | 398/669 [00:04<00:02, 127.67it/s] 61%|██████▏   | 411/669 [00:04<00:02, 127.53it/s] 63%|██████▎   | 424/669 [00:04<00:01, 127.31it/s] 65%|██████▌   | 437/669 [00:04<00:01, 127.40it/s] 67%|██████▋   | 450/669 [00:04<00:01, 127.27it/s] 69%|██████▉   | 463/669 [00:04<00:01, 127.38it/s] 71%|███████   | 476/669 [00:04<00:01, 127.09it/s] 73%|███████▎  | 489/669 [00:05<00:01, 126.87it/s] 75%|███████▌  | 502/669 [00:05<00:01, 126.89it/s] 77%|███████▋  | 515/669 [00:05<00:01, 126.84it/s] 79%|███████▉  | 528/669 [00:05<00:01, 126.81it/s] 81%|████████  | 541/669 [00:05<00:01, 126.75it/s] 83%|████████▎ | 554/669 [00:05<00:01, 114.98it/s] 85%|████████▍ | 567/669 [00:05<00:00, 118.38it/s] 87%|████████▋ | 580/669 [00:05<00:00, 120.81it/s] 89%|████████▊ | 593/669 [00:05<00:00, 122.82it/s] 91%|█████████ | 606/669 [00:05<00:00, 123.98it/s] 93%|█████████▎| 619/669 [00:06<00:00, 125.04it/s] 94%|█████████▍| 632/669 [00:06<00:00, 125.50it/s] 96%|█████████▋| 645/669 [00:06<00:00, 125.77it/s] 98%|█████████▊| 658/669 [00:06<00:00, 126.23it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 29.24it/s][A
 12%|█▏        | 20/168 [00:00<00:01, 98.04it/s][A
 33%|███▎      | 56/168 [00:00<00:00, 206.77it/s][A
 55%|█████▍    | 92/168 [00:00<00:00, 263.15it/s][A
 77%|███████▋  | 129/168 [00:00<00:00, 298.16it/s][A
 99%|█████████▉| 166/168 [00:00<00:00, 321.08it/s][A100%|██████████| 168/168 [00:00<00:00, 247.63it/s]
2022-10-22 07:03:43,384 P23548 INFO [Metrics] logloss: 0.559607 - AUC: 0.704947
2022-10-22 07:03:43,385 P23548 INFO Save best model: monitor(max): 0.145340
2022-10-22 07:03:43,535 P23548 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 89.15it/s] 
2022-10-22 07:03:43,574 P23548 INFO Train loss: 0.640197
2022-10-22 07:03:43,574 P23548 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:43,  6.46it/s]  2%|▏         | 14/669 [00:00<00:10, 64.91it/s]  3%|▎         | 22/669 [00:00<00:10, 64.00it/s]  5%|▌         | 35/669 [00:00<00:07, 86.26it/s]  7%|▋         | 48/669 [00:00<00:06, 99.94it/s]  9%|▉         | 61/669 [00:00<00:05, 108.91it/s] 11%|█         | 74/669 [00:00<00:05, 114.80it/s] 13%|█▎        | 87/669 [00:00<00:04, 118.87it/s] 15%|█▍        | 100/669 [00:00<00:04, 121.51it/s] 17%|█▋        | 113/669 [00:01<00:04, 123.47it/s] 19%|█▉        | 126/669 [00:01<00:04, 124.77it/s] 21%|██        | 139/669 [00:01<00:04, 125.71it/s] 23%|██▎       | 152/669 [00:01<00:04, 126.41it/s] 25%|██▍       | 165/669 [00:01<00:03, 126.71it/s] 27%|██▋       | 178/669 [00:01<00:03, 126.88it/s] 29%|██▊       | 191/669 [00:01<00:03, 127.16it/s] 30%|███       | 204/669 [00:01<00:03, 127.40it/s] 32%|███▏      | 217/669 [00:01<00:03, 127.41it/s] 34%|███▍      | 230/669 [00:02<00:03, 127.55it/s] 36%|███▋      | 243/669 [00:02<00:03, 127.65it/s] 38%|███▊      | 256/669 [00:02<00:03, 127.59it/s] 40%|████      | 269/669 [00:02<00:03, 127.69it/s] 42%|████▏     | 282/669 [00:02<00:03, 127.69it/s] 44%|████▍     | 295/669 [00:02<00:02, 127.60it/s] 46%|████▌     | 308/669 [00:02<00:02, 127.69it/s] 48%|████▊     | 321/669 [00:02<00:02, 127.75it/s] 50%|████▉     | 334/669 [00:02<00:02, 127.63it/s] 52%|█████▏    | 347/669 [00:02<00:02, 127.62it/s] 54%|█████▍    | 360/669 [00:03<00:02, 127.22it/s] 56%|█████▌    | 373/669 [00:03<00:02, 127.29it/s] 58%|█████▊    | 386/669 [00:03<00:02, 127.43it/s] 60%|█████▉    | 399/669 [00:03<00:02, 127.50it/s] 62%|██████▏   | 412/669 [00:03<00:02, 127.53it/s] 64%|██████▎   | 425/669 [00:03<00:01, 127.79it/s] 65%|██████▌   | 438/669 [00:03<00:01, 128.05it/s] 67%|██████▋   | 451/669 [00:03<00:01, 128.29it/s] 69%|██████▉   | 464/669 [00:03<00:01, 128.48it/s] 71%|███████▏  | 477/669 [00:03<00:01, 128.58it/s] 73%|███████▎  | 490/669 [00:04<00:01, 128.71it/s] 75%|███████▌  | 503/669 [00:04<00:01, 128.71it/s] 77%|███████▋  | 516/669 [00:04<00:01, 128.73it/s] 79%|███████▉  | 529/669 [00:04<00:01, 128.86it/s] 81%|████████  | 542/669 [00:04<00:00, 128.85it/s] 83%|████████▎ | 555/669 [00:04<00:00, 117.82it/s] 85%|████████▍ | 568/669 [00:04<00:00, 120.87it/s] 87%|████████▋ | 581/669 [00:04<00:00, 123.15it/s] 89%|████████▉ | 594/669 [00:04<00:00, 124.80it/s] 91%|█████████ | 607/669 [00:04<00:00, 126.05it/s] 93%|█████████▎| 620/669 [00:05<00:00, 127.00it/s] 95%|█████████▍| 633/669 [00:05<00:00, 127.51it/s] 97%|█████████▋| 646/669 [00:05<00:00, 128.00it/s] 99%|█████████▊| 659/669 [00:05<00:00, 128.47it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.79it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 88.37it/s][A
 32%|███▏      | 53/168 [00:00<00:00, 188.76it/s][A
 54%|█████▎    | 90/168 [00:00<00:00, 253.58it/s][A
 76%|███████▌  | 127/168 [00:00<00:00, 292.13it/s][A
 98%|█████████▊| 165/168 [00:00<00:00, 318.54it/s][A100%|██████████| 168/168 [00:00<00:00, 240.38it/s]
2022-10-22 07:03:49,880 P23548 INFO [Metrics] logloss: 0.553468 - AUC: 0.715102
2022-10-22 07:03:49,881 P23548 INFO Save best model: monitor(max): 0.161633
2022-10-22 07:03:50,068 P23548 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 102.26it/s]
2022-10-22 07:03:50,117 P23548 INFO Train loss: 0.634587
2022-10-22 07:03:50,117 P23548 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:44,  6.37it/s]  2%|▏         | 14/669 [00:00<00:10, 64.21it/s]  3%|▎         | 22/669 [00:00<00:10, 64.14it/s]  5%|▌         | 35/669 [00:00<00:07, 86.15it/s]  7%|▋         | 48/669 [00:00<00:06, 99.73it/s]  9%|▉         | 61/669 [00:00<00:05, 108.30it/s] 11%|█         | 74/669 [00:00<00:05, 114.19it/s] 13%|█▎        | 87/669 [00:00<00:04, 118.20it/s] 15%|█▍        | 100/669 [00:00<00:04, 120.82it/s] 17%|█▋        | 113/669 [00:01<00:04, 122.82it/s] 19%|█▉        | 126/669 [00:01<00:04, 124.04it/s] 21%|██        | 139/669 [00:01<00:04, 124.98it/s] 23%|██▎       | 152/669 [00:01<00:04, 125.59it/s] 25%|██▍       | 165/669 [00:01<00:03, 126.03it/s] 27%|██▋       | 178/669 [00:01<00:03, 126.46it/s] 29%|██▊       | 191/669 [00:01<00:03, 126.64it/s] 30%|███       | 204/669 [00:01<00:03, 126.88it/s] 32%|███▏      | 217/669 [00:01<00:03, 127.01it/s] 34%|███▍      | 230/669 [00:02<00:03, 127.16it/s] 36%|███▋      | 243/669 [00:02<00:03, 127.10it/s] 38%|███▊      | 256/669 [00:02<00:03, 127.18it/s] 40%|████      | 269/669 [00:02<00:03, 127.11it/s] 42%|████▏     | 282/669 [00:02<00:03, 127.18it/s] 44%|████▍     | 295/669 [00:02<00:02, 127.21it/s] 46%|████▌     | 308/669 [00:02<00:02, 127.16it/s] 48%|████▊     | 321/669 [00:02<00:02, 127.15it/s] 50%|████▉     | 334/669 [00:02<00:02, 127.22it/s] 52%|█████▏    | 347/669 [00:02<00:02, 127.32it/s] 54%|█████▍    | 360/669 [00:03<00:02, 127.31it/s] 56%|█████▌    | 373/669 [00:03<00:02, 127.24it/s] 58%|█████▊    | 386/669 [00:03<00:02, 127.09it/s] 60%|█████▉    | 399/669 [00:03<00:02, 127.28it/s] 62%|██████▏   | 412/669 [00:03<00:02, 127.24it/s] 64%|██████▎   | 425/669 [00:03<00:01, 127.32it/s] 65%|██████▌   | 438/669 [00:03<00:01, 127.24it/s] 67%|██████▋   | 451/669 [00:03<00:01, 127.30it/s] 69%|██████▉   | 464/669 [00:03<00:01, 127.24it/s] 71%|███████▏  | 477/669 [00:03<00:01, 127.34it/s] 73%|███████▎  | 490/669 [00:04<00:01, 127.41it/s] 75%|███████▌  | 503/669 [00:04<00:01, 127.44it/s] 77%|███████▋  | 516/669 [00:04<00:01, 127.37it/s] 79%|███████▉  | 529/669 [00:04<00:01, 127.46it/s] 81%|████████  | 542/669 [00:04<00:00, 127.31it/s] 83%|████████▎ | 555/669 [00:04<00:00, 127.28it/s] 85%|████████▍ | 568/669 [00:04<00:00, 127.25it/s] 87%|████████▋ | 581/669 [00:04<00:00, 127.08it/s] 89%|████████▉ | 594/669 [00:04<00:00, 127.22it/s] 91%|█████████ | 607/669 [00:04<00:00, 127.21it/s] 93%|█████████▎| 620/669 [00:05<00:00, 127.21it/s] 95%|█████████▍| 633/669 [00:05<00:00, 127.17it/s] 97%|█████████▋| 646/669 [00:05<00:00, 127.26it/s] 99%|█████████▊| 659/669 [00:05<00:00, 127.28it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 4/168 [00:00<00:04, 39.55it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 96.57it/s][A
 32%|███▏      | 53/168 [00:00<00:00, 200.59it/s][A
 52%|█████▏    | 88/168 [00:00<00:00, 257.58it/s][A
 73%|███████▎  | 123/168 [00:00<00:00, 288.62it/s][A
 95%|█████████▍| 159/168 [00:00<00:00, 309.74it/s][A100%|██████████| 168/168 [00:00<00:00, 243.39it/s]
2022-10-22 07:03:56,423 P23548 INFO [Metrics] logloss: 0.553549 - AUC: 0.717062
2022-10-22 07:03:56,423 P23548 INFO Save best model: monitor(max): 0.163513
2022-10-22 07:03:56,590 P23548 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 102.75it/s]
2022-10-22 07:03:56,629 P23548 INFO Train loss: 0.634228
2022-10-22 07:03:56,629 P23548 INFO ************ Epoch=3 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:38,  6.77it/s]  2%|▏         | 14/669 [00:00<00:09, 66.89it/s]  3%|▎         | 22/669 [00:00<00:09, 65.18it/s]  5%|▌         | 35/669 [00:00<00:07, 87.37it/s]  7%|▋         | 48/669 [00:00<00:06, 101.10it/s]  9%|▉         | 61/669 [00:00<00:05, 110.12it/s] 11%|█         | 74/669 [00:00<00:05, 116.10it/s] 13%|█▎        | 87/669 [00:00<00:04, 120.05it/s] 15%|█▍        | 100/669 [00:00<00:04, 122.84it/s] 17%|█▋        | 113/669 [00:01<00:04, 124.58it/s] 19%|█▉        | 126/669 [00:01<00:04, 125.75it/s] 21%|██        | 139/669 [00:01<00:04, 126.55it/s] 23%|██▎       | 152/669 [00:01<00:04, 127.02it/s] 25%|██▍       | 165/669 [00:01<00:03, 127.19it/s] 27%|██▋       | 178/669 [00:01<00:03, 127.43it/s] 29%|██▊       | 191/669 [00:01<00:03, 127.76it/s] 30%|███       | 204/669 [00:01<00:03, 128.07it/s] 32%|███▏      | 217/669 [00:01<00:03, 128.38it/s] 34%|███▍      | 230/669 [00:01<00:03, 128.52it/s] 36%|███▋      | 243/669 [00:02<00:03, 128.52it/s] 38%|███▊      | 256/669 [00:02<00:03, 128.65it/s] 40%|████      | 269/669 [00:02<00:03, 128.64it/s] 42%|████▏     | 282/669 [00:02<00:03, 128.57it/s] 44%|████▍     | 295/669 [00:02<00:02, 128.59it/s] 46%|████▌     | 308/669 [00:02<00:02, 128.57it/s] 48%|████▊     | 321/669 [00:02<00:02, 128.68it/s] 50%|████▉     | 334/669 [00:02<00:02, 128.82it/s] 52%|█████▏    | 347/669 [00:02<00:02, 128.94it/s] 54%|█████▍    | 360/669 [00:03<00:02, 129.10it/s] 56%|█████▌    | 373/669 [00:03<00:02, 129.18it/s] 58%|█████▊    | 386/669 [00:03<00:02, 129.29it/s] 60%|█████▉    | 399/669 [00:03<00:02, 129.34it/s] 62%|██████▏   | 412/669 [00:03<00:01, 129.28it/s] 64%|██████▎   | 425/669 [00:03<00:01, 129.42it/s] 65%|██████▌   | 438/669 [00:03<00:01, 129.45it/s] 67%|██████▋   | 451/669 [00:03<00:01, 129.28it/s] 69%|██████▉   | 464/669 [00:03<00:01, 129.38it/s] 71%|███████▏  | 477/669 [00:03<00:01, 129.37it/s] 73%|███████▎  | 490/669 [00:04<00:01, 129.40it/s] 75%|███████▌  | 503/669 [00:04<00:01, 129.38it/s] 77%|███████▋  | 516/669 [00:04<00:01, 129.46it/s] 79%|███████▉  | 529/669 [00:04<00:01, 129.49it/s] 81%|████████  | 542/669 [00:04<00:00, 129.50it/s] 83%|████████▎ | 555/669 [00:04<00:00, 129.54it/s] 85%|████████▍ | 568/669 [00:04<00:00, 129.29it/s] 87%|████████▋ | 581/669 [00:04<00:00, 129.02it/s] 89%|████████▉ | 594/669 [00:04<00:00, 128.54it/s] 91%|█████████ | 607/669 [00:04<00:00, 128.41it/s] 93%|█████████▎| 620/669 [00:05<00:00, 128.43it/s] 95%|█████████▍| 633/669 [00:05<00:00, 128.72it/s] 97%|█████████▋| 646/669 [00:05<00:00, 128.99it/s] 99%|█████████▊| 659/669 [00:05<00:00, 129.12it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 27.93it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 94.86it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 207.83it/s][A
 54%|█████▍    | 91/168 [00:00<00:00, 265.46it/s][A
 76%|███████▌  | 128/168 [00:00<00:00, 300.10it/s][A
 98%|█████████▊| 165/168 [00:00<00:00, 321.29it/s][A100%|██████████| 168/168 [00:00<00:00, 247.53it/s]
2022-10-22 07:04:02,846 P23548 INFO [Metrics] logloss: 0.549581 - AUC: 0.720741
2022-10-22 07:04:02,846 P23548 INFO Save best model: monitor(max): 0.171160
2022-10-22 07:04:03,024 P23548 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 103.92it/s]
2022-10-22 07:04:03,067 P23548 INFO Train loss: 0.632260
2022-10-22 07:04:03,067 P23548 INFO ************ Epoch=4 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:43,  6.46it/s]  2%|▏         | 14/669 [00:00<00:10, 65.24it/s]  3%|▎         | 22/669 [00:00<00:10, 64.61it/s]  5%|▌         | 36/669 [00:00<00:07, 88.33it/s]  7%|▋         | 49/669 [00:00<00:06, 101.72it/s]  9%|▉         | 62/669 [00:00<00:05, 110.56it/s] 11%|█         | 75/669 [00:00<00:05, 116.48it/s] 13%|█▎        | 88/669 [00:00<00:04, 120.59it/s] 15%|█▌        | 101/669 [00:00<00:04, 123.37it/s] 17%|█▋        | 114/669 [00:01<00:04, 125.29it/s] 19%|█▉        | 127/669 [00:01<00:04, 126.55it/s] 21%|██        | 140/669 [00:01<00:04, 127.44it/s] 23%|██▎       | 153/669 [00:01<00:04, 128.08it/s] 25%|██▍       | 166/669 [00:01<00:03, 128.52it/s] 27%|██▋       | 179/669 [00:01<00:03, 128.84it/s] 29%|██▊       | 192/669 [00:01<00:03, 128.95it/s] 31%|███       | 205/669 [00:01<00:03, 129.05it/s] 33%|███▎      | 218/669 [00:01<00:03, 129.31it/s] 35%|███▍      | 231/669 [00:01<00:03, 129.43it/s] 36%|███▋      | 244/669 [00:02<00:03, 129.48it/s] 38%|███▊      | 257/669 [00:02<00:03, 129.48it/s] 40%|████      | 270/669 [00:02<00:03, 129.37it/s] 42%|████▏     | 283/669 [00:02<00:02, 129.27it/s] 44%|████▍     | 296/669 [00:02<00:02, 129.31it/s] 46%|████▌     | 309/669 [00:02<00:02, 129.37it/s] 48%|████▊     | 322/669 [00:02<00:02, 129.36it/s] 50%|█████     | 335/669 [00:02<00:02, 129.42it/s] 52%|█████▏    | 348/669 [00:02<00:02, 129.49it/s] 54%|█████▍    | 361/669 [00:02<00:02, 129.47it/s] 56%|█████▌    | 374/669 [00:03<00:02, 129.45it/s] 58%|█████▊    | 387/669 [00:03<00:02, 129.46it/s] 60%|█████▉    | 400/669 [00:03<00:02, 129.53it/s] 62%|██████▏   | 413/669 [00:03<00:01, 129.51it/s] 64%|██████▎   | 426/669 [00:03<00:01, 129.27it/s] 66%|██████▌   | 439/669 [00:03<00:01, 129.17it/s] 68%|██████▊   | 452/669 [00:03<00:01, 129.27it/s] 70%|██████▉   | 465/669 [00:03<00:01, 129.39it/s] 71%|███████▏  | 478/669 [00:03<00:01, 129.46it/s] 73%|███████▎  | 491/669 [00:04<00:01, 129.55it/s] 75%|███████▌  | 504/669 [00:04<00:01, 129.55it/s] 77%|███████▋  | 517/669 [00:04<00:01, 129.56it/s] 79%|███████▉  | 530/669 [00:04<00:01, 129.61it/s] 81%|████████  | 543/669 [00:04<00:00, 129.65it/s] 83%|████████▎ | 556/669 [00:04<00:00, 129.59it/s] 85%|████████▌ | 569/669 [00:04<00:00, 129.60it/s] 87%|████████▋ | 582/669 [00:04<00:00, 129.63it/s] 89%|████████▉ | 595/669 [00:04<00:00, 129.65it/s] 91%|█████████ | 609/669 [00:04<00:00, 129.78it/s] 93%|█████████▎| 622/669 [00:05<00:00, 129.72it/s] 95%|█████████▍| 635/669 [00:05<00:00, 129.67it/s] 97%|█████████▋| 648/669 [00:05<00:00, 129.71it/s] 99%|█████████▉| 661/669 [00:05<00:00, 129.72it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 28.18it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 94.48it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 207.66it/s][A
 54%|█████▍    | 91/168 [00:00<00:00, 263.60it/s][A
 76%|███████▌  | 128/168 [00:00<00:00, 299.18it/s][A
 98%|█████████▊| 165/168 [00:00<00:00, 321.36it/s][A100%|██████████| 168/168 [00:00<00:00, 245.67it/s]
2022-10-22 07:04:09,268 P23548 INFO [Metrics] logloss: 0.549168 - AUC: 0.720617
2022-10-22 07:04:09,269 P23548 INFO Save best model: monitor(max): 0.171449
2022-10-22 07:04:09,446 P23548 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 104.19it/s]
2022-10-22 07:04:09,489 P23548 INFO Train loss: 0.632988
2022-10-22 07:04:09,489 P23548 INFO ************ Epoch=5 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:46,  6.30it/s]  2%|▏         | 14/669 [00:00<00:10, 64.10it/s]  3%|▎         | 22/669 [00:00<00:10, 64.51it/s]  5%|▌         | 35/669 [00:00<00:07, 86.74it/s]  7%|▋         | 48/669 [00:00<00:06, 100.41it/s]  9%|▉         | 61/669 [00:00<00:05, 109.36it/s] 11%|█         | 74/669 [00:00<00:05, 115.32it/s] 13%|█▎        | 87/669 [00:00<00:04, 119.24it/s] 15%|█▍        | 100/669 [00:00<00:04, 122.03it/s] 17%|█▋        | 113/669 [00:01<00:04, 124.03it/s] 19%|█▉        | 126/669 [00:01<00:04, 125.28it/s] 21%|██        | 139/669 [00:01<00:04, 126.06it/s] 23%|██▎       | 152/669 [00:01<00:04, 126.58it/s] 25%|██▍       | 165/669 [00:01<00:03, 126.79it/s] 27%|██▋       | 178/669 [00:01<00:03, 127.11it/s] 29%|██▊       | 191/669 [00:01<00:03, 127.33it/s] 30%|███       | 204/669 [00:01<00:03, 127.49it/s] 32%|███▏      | 217/669 [00:01<00:03, 127.57it/s] 34%|███▍      | 230/669 [00:02<00:03, 127.51it/s] 36%|███▋      | 243/669 [00:02<00:03, 127.34it/s] 38%|███▊      | 256/669 [00:02<00:03, 127.37it/s] 40%|████      | 269/669 [00:02<00:03, 127.40it/s] 42%|████▏     | 282/669 [00:02<00:03, 127.37it/s] 44%|████▍     | 295/669 [00:02<00:02, 127.37it/s] 46%|████▌     | 308/669 [00:02<00:02, 127.53it/s] 48%|████▊     | 321/669 [00:02<00:02, 127.39it/s] 50%|████▉     | 334/669 [00:02<00:02, 127.47it/s] 52%|█████▏    | 347/669 [00:02<00:02, 127.34it/s] 54%|█████▍    | 360/669 [00:03<00:02, 127.52it/s] 56%|█████▌    | 373/669 [00:03<00:02, 127.58it/s] 58%|█████▊    | 386/669 [00:03<00:02, 127.55it/s] 60%|█████▉    | 399/669 [00:03<00:02, 127.22it/s] 62%|██████▏   | 412/669 [00:03<00:02, 127.20it/s] 64%|██████▎   | 425/669 [00:03<00:01, 127.36it/s] 65%|██████▌   | 438/669 [00:03<00:01, 127.63it/s] 67%|██████▋   | 451/669 [00:03<00:01, 127.57it/s] 69%|██████▉   | 464/669 [00:03<00:01, 127.59it/s] 71%|███████▏  | 477/669 [00:03<00:01, 127.38it/s] 73%|███████▎  | 490/669 [00:04<00:01, 127.47it/s] 75%|███████▌  | 503/669 [00:04<00:01, 127.44it/s] 77%|███████▋  | 516/669 [00:04<00:01, 127.48it/s] 79%|███████▉  | 529/669 [00:04<00:01, 127.33it/s] 81%|████████  | 542/669 [00:04<00:00, 127.29it/s] 83%|████████▎ | 555/669 [00:04<00:00, 127.17it/s] 85%|████████▍ | 568/669 [00:04<00:00, 127.08it/s] 87%|████████▋ | 581/669 [00:04<00:00, 126.95it/s] 89%|████████▉ | 594/669 [00:04<00:00, 126.71it/s] 91%|█████████ | 607/669 [00:04<00:00, 126.68it/s] 93%|█████████▎| 620/669 [00:05<00:00, 126.64it/s] 95%|█████████▍| 633/669 [00:05<00:00, 126.65it/s] 97%|█████████▋| 646/669 [00:05<00:00, 126.74it/s] 99%|█████████▊| 659/669 [00:05<00:00, 126.92it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 29.37it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 95.41it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 207.67it/s][A
 55%|█████▍    | 92/168 [00:00<00:00, 266.81it/s][A
 77%|███████▋  | 129/168 [00:00<00:00, 300.72it/s][A
 99%|█████████▉| 167/168 [00:00<00:00, 323.49it/s][A100%|██████████| 168/168 [00:00<00:00, 251.13it/s]
2022-10-22 07:04:15,764 P23548 INFO [Metrics] logloss: 0.546577 - AUC: 0.724426
2022-10-22 07:04:15,764 P23548 INFO Save best model: monitor(max): 0.177849
2022-10-22 07:04:15,940 P23548 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 103.05it/s]
2022-10-22 07:04:15,982 P23548 INFO Train loss: 0.633821
2022-10-22 07:04:15,982 P23548 INFO ************ Epoch=6 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:40,  6.64it/s]  2%|▏         | 14/669 [00:00<00:09, 65.69it/s]  3%|▎         | 22/669 [00:00<00:09, 64.73it/s]  5%|▌         | 35/669 [00:00<00:07, 86.60it/s]  7%|▋         | 48/669 [00:00<00:06, 100.03it/s]  9%|▉         | 61/669 [00:00<00:05, 108.64it/s] 11%|█         | 74/669 [00:00<00:05, 114.67it/s] 13%|█▎        | 87/669 [00:00<00:04, 118.53it/s] 15%|█▍        | 100/669 [00:00<00:04, 121.33it/s] 17%|█▋        | 113/669 [00:01<00:04, 123.15it/s] 19%|█▉        | 126/669 [00:01<00:04, 124.49it/s] 21%|██        | 139/669 [00:01<00:04, 125.37it/s] 23%|██▎       | 152/669 [00:01<00:04, 126.11it/s] 25%|██▍       | 165/669 [00:01<00:03, 126.50it/s] 27%|██▋       | 178/669 [00:01<00:03, 126.86it/s] 29%|██▊       | 191/669 [00:01<00:03, 127.03it/s] 30%|███       | 204/669 [00:01<00:03, 127.29it/s] 32%|███▏      | 217/669 [00:01<00:03, 127.45it/s] 34%|███▍      | 230/669 [00:02<00:03, 127.38it/s] 36%|███▋      | 243/669 [00:02<00:03, 127.35it/s] 38%|███▊      | 256/669 [00:02<00:03, 126.86it/s] 40%|████      | 269/669 [00:02<00:03, 126.94it/s] 42%|████▏     | 282/669 [00:02<00:03, 127.06it/s] 44%|████▍     | 295/669 [00:02<00:02, 127.04it/s] 46%|████▌     | 308/669 [00:02<00:02, 127.04it/s] 48%|████▊     | 321/669 [00:02<00:02, 127.16it/s] 50%|████▉     | 334/669 [00:02<00:02, 127.10it/s] 52%|█████▏    | 347/669 [00:02<00:02, 127.18it/s] 54%|█████▍    | 360/669 [00:03<00:02, 127.16it/s] 56%|█████▌    | 373/669 [00:03<00:02, 127.20it/s] 58%|█████▊    | 386/669 [00:03<00:02, 126.87it/s] 60%|█████▉    | 399/669 [00:03<00:02, 126.71it/s] 62%|██████▏   | 412/669 [00:03<00:02, 126.11it/s] 64%|██████▎   | 425/669 [00:03<00:01, 125.85it/s] 65%|██████▌   | 438/669 [00:03<00:01, 125.46it/s] 67%|██████▋   | 451/669 [00:03<00:01, 125.06it/s] 69%|██████▉   | 464/669 [00:03<00:01, 125.39it/s] 71%|███████▏  | 477/669 [00:03<00:01, 125.37it/s] 73%|███████▎  | 490/669 [00:04<00:01, 125.24it/s] 75%|███████▌  | 503/669 [00:04<00:01, 125.36it/s] 77%|███████▋  | 516/669 [00:04<00:01, 125.32it/s] 79%|███████▉  | 529/669 [00:04<00:01, 125.47it/s] 81%|████████  | 542/669 [00:04<00:01, 115.39it/s] 83%|████████▎ | 555/669 [00:04<00:00, 117.88it/s] 85%|████████▍ | 568/669 [00:04<00:00, 119.82it/s] 87%|████████▋ | 581/669 [00:04<00:00, 121.42it/s] 89%|████████▉ | 594/669 [00:04<00:00, 122.75it/s] 91%|█████████ | 607/669 [00:05<00:00, 123.60it/s] 93%|█████████▎| 620/669 [00:05<00:00, 124.08it/s] 95%|█████████▍| 633/669 [00:05<00:00, 124.42it/s] 97%|█████████▋| 646/669 [00:05<00:00, 125.17it/s] 99%|█████████▊| 659/669 [00:05<00:00, 125.47it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 28.37it/s][A
 10%|▉         | 16/168 [00:00<00:01, 81.96it/s][A
 31%|███       | 52/168 [00:00<00:00, 201.57it/s][A
 52%|█████▏    | 88/168 [00:00<00:00, 261.54it/s][A
 74%|███████▍  | 125/168 [00:00<00:00, 297.07it/s][A
 96%|█████████▋| 162/168 [00:00<00:00, 318.84it/s][A100%|██████████| 168/168 [00:00<00:00, 242.37it/s]
2022-10-22 07:04:22,347 P23548 INFO [Metrics] logloss: 0.546959 - AUC: 0.724457
2022-10-22 07:04:22,348 P23548 INFO Monitor(max) STOP: 0.177497 !
2022-10-22 07:04:22,348 P23548 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 07:04:22,348 P23548 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 104.48it/s]
2022-10-22 07:04:22,386 P23548 INFO Train loss: 0.650363
2022-10-22 07:04:22,386 P23548 INFO ************ Epoch=7 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:43,  6.43it/s]  2%|▏         | 14/669 [00:00<00:10, 64.02it/s]  3%|▎         | 22/669 [00:00<00:10, 63.34it/s]  5%|▌         | 35/669 [00:00<00:07, 84.74it/s]  7%|▋         | 48/669 [00:00<00:06, 98.17it/s]  9%|▉         | 61/669 [00:00<00:05, 106.92it/s] 11%|█         | 74/669 [00:00<00:05, 112.60it/s] 13%|█▎        | 87/669 [00:00<00:04, 116.68it/s] 15%|█▍        | 100/669 [00:01<00:04, 119.26it/s] 17%|█▋        | 113/669 [00:01<00:04, 121.11it/s] 19%|█▉        | 126/669 [00:01<00:04, 122.56it/s] 21%|██        | 139/669 [00:01<00:04, 123.45it/s] 23%|██▎       | 152/669 [00:01<00:04, 124.00it/s] 25%|██▍       | 165/669 [00:01<00:04, 124.74it/s] 27%|██▋       | 178/669 [00:01<00:03, 124.90it/s] 29%|██▊       | 191/669 [00:01<00:03, 125.01it/s] 30%|███       | 204/669 [00:01<00:03, 125.43it/s] 32%|███▏      | 217/669 [00:01<00:03, 125.49it/s] 34%|███▍      | 230/669 [00:02<00:03, 125.34it/s] 36%|███▋      | 243/669 [00:02<00:03, 125.23it/s] 38%|███▊      | 256/669 [00:02<00:03, 125.63it/s] 40%|████      | 269/669 [00:02<00:03, 125.69it/s] 42%|████▏     | 282/669 [00:02<00:03, 125.40it/s] 44%|████▍     | 295/669 [00:02<00:02, 125.37it/s] 46%|████▌     | 308/669 [00:02<00:02, 125.37it/s] 48%|████▊     | 321/669 [00:02<00:02, 125.15it/s] 50%|████▉     | 334/669 [00:02<00:02, 125.27it/s] 52%|█████▏    | 347/669 [00:02<00:02, 125.27it/s] 54%|█████▍    | 360/669 [00:03<00:02, 125.14it/s] 56%|█████▌    | 373/669 [00:03<00:02, 125.35it/s] 58%|█████▊    | 386/669 [00:03<00:02, 125.24it/s] 60%|█████▉    | 399/669 [00:03<00:02, 125.11it/s] 62%|██████▏   | 412/669 [00:03<00:02, 125.17it/s] 64%|██████▎   | 425/669 [00:03<00:01, 125.36it/s] 65%|██████▌   | 438/669 [00:03<00:01, 125.01it/s] 67%|██████▋   | 451/669 [00:03<00:01, 125.35it/s] 69%|██████▉   | 464/669 [00:03<00:01, 125.28it/s] 71%|███████▏  | 477/669 [00:04<00:01, 125.38it/s] 73%|███████▎  | 490/669 [00:04<00:01, 125.56it/s] 75%|███████▌  | 503/669 [00:04<00:01, 125.49it/s] 77%|███████▋  | 516/669 [00:04<00:01, 125.32it/s] 79%|███████▉  | 529/669 [00:04<00:01, 125.49it/s] 81%|████████  | 542/669 [00:04<00:01, 115.04it/s] 83%|████████▎ | 555/669 [00:04<00:00, 117.78it/s] 85%|████████▍ | 568/669 [00:04<00:00, 120.02it/s] 87%|████████▋ | 581/669 [00:04<00:00, 122.00it/s] 89%|████████▉ | 594/669 [00:04<00:00, 123.16it/s] 91%|█████████ | 607/669 [00:05<00:00, 124.07it/s] 93%|█████████▎| 620/669 [00:05<00:00, 125.25it/s] 95%|█████████▍| 633/669 [00:05<00:00, 125.73it/s] 97%|█████████▋| 646/669 [00:05<00:00, 126.11it/s] 99%|█████████▊| 659/669 [00:05<00:00, 126.54it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 28.96it/s][A
 10%|▉         | 16/168 [00:00<00:01, 81.57it/s][A
 30%|███       | 51/168 [00:00<00:00, 195.84it/s][A
 51%|█████     | 86/168 [00:00<00:00, 254.41it/s][A
 72%|███████▏  | 121/168 [00:00<00:00, 287.88it/s][A
 93%|█████████▎| 156/168 [00:00<00:00, 307.21it/s][A100%|██████████| 168/168 [00:00<00:00, 241.48it/s]
2022-10-22 07:04:28,796 P23548 INFO [Metrics] logloss: 0.544099 - AUC: 0.736737
2022-10-22 07:04:28,797 P23548 INFO Save best model: monitor(max): 0.192638
2022-10-22 07:04:28,958 P23548 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 100.95it/s]
2022-10-22 07:04:29,014 P23548 INFO Train loss: 0.545463
2022-10-22 07:04:29,014 P23548 INFO ************ Epoch=8 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:51,  6.01it/s]  2%|▏         | 14/669 [00:00<00:10, 62.22it/s]  3%|▎         | 22/669 [00:00<00:10, 63.85it/s]  5%|▌         | 35/669 [00:00<00:07, 85.77it/s]  7%|▋         | 48/669 [00:00<00:06, 99.45it/s]  9%|▉         | 61/669 [00:00<00:05, 108.10it/s] 11%|█         | 74/669 [00:00<00:05, 113.95it/s] 13%|█▎        | 87/669 [00:00<00:04, 117.98it/s] 15%|█▍        | 100/669 [00:01<00:04, 120.62it/s] 17%|█▋        | 113/669 [00:01<00:04, 122.31it/s] 19%|█▉        | 126/669 [00:01<00:04, 123.57it/s] 21%|██        | 139/669 [00:01<00:04, 124.75it/s] 23%|██▎       | 152/669 [00:01<00:04, 125.30it/s] 25%|██▍       | 165/669 [00:01<00:04, 125.64it/s] 27%|██▋       | 178/669 [00:01<00:03, 126.11it/s] 29%|██▊       | 191/669 [00:01<00:03, 126.37it/s] 30%|███       | 204/669 [00:01<00:03, 126.40it/s] 32%|███▏      | 217/669 [00:01<00:03, 126.69it/s] 34%|███▍      | 230/669 [00:02<00:03, 126.70it/s] 36%|███▋      | 243/669 [00:02<00:03, 126.78it/s] 38%|███▊      | 256/669 [00:02<00:03, 126.88it/s] 40%|████      | 269/669 [00:02<00:03, 126.70it/s] 42%|████▏     | 282/669 [00:02<00:03, 126.69it/s] 44%|████▍     | 295/669 [00:02<00:02, 126.80it/s] 46%|████▌     | 308/669 [00:02<00:02, 126.66it/s] 48%|████▊     | 321/669 [00:02<00:02, 126.71it/s] 50%|████▉     | 334/669 [00:02<00:02, 126.96it/s] 52%|█████▏    | 347/669 [00:02<00:02, 126.81it/s] 54%|█████▍    | 360/669 [00:03<00:02, 126.81it/s] 56%|█████▌    | 373/669 [00:03<00:02, 126.94it/s] 58%|█████▊    | 386/669 [00:03<00:02, 126.99it/s] 60%|█████▉    | 399/669 [00:03<00:02, 126.88it/s] 62%|██████▏   | 412/669 [00:03<00:02, 126.91it/s] 64%|██████▎   | 425/669 [00:03<00:01, 126.83it/s] 65%|██████▌   | 438/669 [00:03<00:01, 126.77it/s] 67%|██████▋   | 451/669 [00:03<00:01, 126.82it/s] 69%|██████▉   | 464/669 [00:03<00:01, 126.93it/s] 71%|███████▏  | 477/669 [00:03<00:01, 126.77it/s] 73%|███████▎  | 490/669 [00:04<00:01, 126.87it/s] 75%|███████▌  | 503/669 [00:04<00:01, 127.03it/s] 77%|███████▋  | 516/669 [00:04<00:01, 126.98it/s] 79%|███████▉  | 529/669 [00:04<00:01, 127.25it/s] 81%|████████  | 542/669 [00:04<00:01, 126.98it/s] 83%|████████▎ | 555/669 [00:04<00:00, 126.81it/s] 85%|████████▍ | 568/669 [00:04<00:00, 126.92it/s] 87%|████████▋ | 581/669 [00:04<00:00, 126.88it/s] 89%|████████▉ | 594/669 [00:04<00:00, 126.85it/s] 91%|█████████ | 607/669 [00:05<00:00, 126.86it/s] 93%|█████████▎| 620/669 [00:05<00:00, 127.08it/s] 95%|█████████▍| 633/669 [00:05<00:00, 126.90it/s] 97%|█████████▋| 646/669 [00:05<00:00, 126.71it/s] 99%|█████████▊| 659/669 [00:05<00:00, 127.11it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 28.78it/s][A
 10%|▉         | 16/168 [00:00<00:01, 81.53it/s][A
 31%|███       | 52/168 [00:00<00:00, 200.88it/s][A
 52%|█████▏    | 88/168 [00:00<00:00, 258.95it/s][A
 74%|███████▍  | 124/168 [00:00<00:00, 291.73it/s][A
 95%|█████████▌| 160/168 [00:00<00:00, 312.49it/s][A100%|██████████| 168/168 [00:00<00:00, 244.75it/s]
2022-10-22 07:04:35,335 P23548 INFO [Metrics] logloss: 0.559247 - AUC: 0.732927
2022-10-22 07:04:35,335 P23548 INFO Monitor(max) STOP: 0.173680 !
2022-10-22 07:04:35,336 P23548 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 07:04:35,336 P23548 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 105.19it/s]
2022-10-22 07:04:35,375 P23548 INFO Train loss: 0.484279
2022-10-22 07:04:35,375 P23548 INFO ************ Epoch=9 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:41,  6.58it/s]  2%|▏         | 14/669 [00:00<00:09, 65.71it/s]  3%|▎         | 22/669 [00:00<00:10, 63.88it/s]  5%|▌         | 35/669 [00:00<00:07, 86.38it/s]  7%|▋         | 48/669 [00:00<00:06, 100.17it/s]  9%|▉         | 61/669 [00:00<00:05, 109.45it/s] 11%|█         | 74/669 [00:00<00:05, 115.61it/s] 13%|█▎        | 87/669 [00:00<00:04, 119.91it/s] 15%|█▍        | 100/669 [00:00<00:04, 122.98it/s] 17%|█▋        | 113/669 [00:01<00:04, 124.98it/s] 19%|█▉        | 126/669 [00:01<00:04, 126.26it/s] 21%|██        | 139/669 [00:01<00:04, 127.10it/s] 23%|██▎       | 152/669 [00:01<00:04, 127.75it/s] 25%|██▍       | 165/669 [00:01<00:03, 128.37it/s] 27%|██▋       | 178/669 [00:01<00:03, 128.74it/s] 29%|██▊       | 191/669 [00:01<00:03, 128.96it/s] 30%|███       | 204/669 [00:01<00:03, 129.07it/s] 33%|███▎      | 218/669 [00:01<00:03, 129.37it/s] 35%|███▍      | 231/669 [00:01<00:03, 129.43it/s] 36%|███▋      | 244/669 [00:02<00:03, 129.50it/s] 38%|███▊      | 257/669 [00:02<00:03, 129.53it/s] 40%|████      | 270/669 [00:02<00:03, 129.48it/s] 42%|████▏     | 283/669 [00:02<00:02, 129.56it/s] 44%|████▍     | 296/669 [00:02<00:02, 129.60it/s] 46%|████▌     | 309/669 [00:02<00:02, 129.50it/s] 48%|████▊     | 322/669 [00:02<00:02, 129.49it/s] 50%|█████     | 335/669 [00:02<00:02, 129.47it/s] 52%|█████▏    | 348/669 [00:02<00:02, 129.51it/s] 54%|█████▍    | 361/669 [00:03<00:02, 129.37it/s] 56%|█████▌    | 374/669 [00:03<00:02, 129.40it/s] 58%|█████▊    | 387/669 [00:03<00:02, 129.46it/s] 60%|█████▉    | 400/669 [00:03<00:02, 129.48it/s] 62%|██████▏   | 413/669 [00:03<00:01, 129.56it/s] 64%|██████▎   | 426/669 [00:03<00:01, 129.59it/s] 66%|██████▌   | 439/669 [00:03<00:01, 129.59it/s] 68%|██████▊   | 452/669 [00:03<00:01, 129.50it/s] 70%|██████▉   | 465/669 [00:03<00:01, 129.53it/s] 71%|███████▏  | 478/669 [00:03<00:01, 129.57it/s] 73%|███████▎  | 491/669 [00:04<00:01, 129.61it/s] 75%|███████▌  | 504/669 [00:04<00:01, 129.60it/s] 77%|███████▋  | 517/669 [00:04<00:01, 129.57it/s] 79%|███████▉  | 530/669 [00:04<00:01, 129.63it/s] 81%|████████  | 543/669 [00:04<00:00, 129.60it/s] 83%|████████▎ | 556/669 [00:04<00:00, 129.66it/s] 85%|████████▌ | 569/669 [00:04<00:00, 127.55it/s] 87%|████████▋ | 582/669 [00:04<00:00, 128.05it/s] 89%|████████▉ | 595/669 [00:04<00:00, 128.53it/s] 91%|█████████ | 608/669 [00:04<00:00, 128.86it/s] 93%|█████████▎| 621/669 [00:05<00:00, 129.11it/s] 95%|█████████▍| 634/669 [00:05<00:00, 129.25it/s] 97%|█████████▋| 647/669 [00:05<00:00, 129.32it/s] 99%|█████████▊| 660/669 [00:05<00:00, 129.33it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.92it/s][A
 10%|▉         | 16/168 [00:00<00:01, 81.17it/s][A
 31%|███       | 52/168 [00:00<00:00, 199.71it/s][A
 53%|█████▎    | 89/168 [00:00<00:00, 262.94it/s][A
 75%|███████▌  | 126/168 [00:00<00:00, 299.84it/s][A
 96%|█████████▋| 162/168 [00:00<00:00, 319.80it/s][A100%|██████████| 168/168 [00:00<00:00, 245.91it/s]
2022-10-22 07:04:41,588 P23548 INFO [Metrics] logloss: 0.590739 - AUC: 0.731854
2022-10-22 07:04:41,589 P23548 INFO Monitor(max) STOP: 0.141115 !
2022-10-22 07:04:41,589 P23548 INFO Reduce learning rate on plateau: 0.000001
2022-10-22 07:04:41,589 P23548 INFO Early stopping at epoch=10
2022-10-22 07:04:41,589 P23548 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:06<00:00, 106.80it/s]
2022-10-22 07:04:41,631 P23548 INFO Train loss: 0.418052
2022-10-22 07:04:41,631 P23548 INFO Training finished.
2022-10-22 07:04:41,631 P23548 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_013_14edc303.model
2022-10-22 07:04:41,649 P23548 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:48,  6.17it/s]  2%|▏         | 16/669 [00:00<00:09, 66.95it/s]  8%|▊         | 52/669 [00:00<00:03, 176.00it/s] 13%|█▎        | 88/669 [00:00<00:02, 238.53it/s] 19%|█▊        | 124/669 [00:00<00:01, 277.70it/s] 24%|██▍       | 160/669 [00:00<00:01, 303.31it/s] 29%|██▉       | 196/669 [00:00<00:01, 319.99it/s] 35%|███▍      | 232/669 [00:00<00:01, 330.22it/s] 40%|████      | 268/669 [00:00<00:01, 337.05it/s] 45%|████▌     | 304/669 [00:01<00:01, 341.66it/s] 51%|█████     | 340/669 [00:01<00:00, 345.05it/s] 56%|█████▌    | 375/669 [00:01<00:00, 346.45it/s] 61%|██████▏   | 410/669 [00:01<00:00, 345.32it/s] 67%|██████▋   | 446/669 [00:01<00:00, 346.91it/s] 72%|███████▏  | 481/669 [00:01<00:00, 347.69it/s] 77%|███████▋  | 516/669 [00:01<00:00, 348.16it/s] 82%|████████▏ | 551/669 [00:01<00:00, 348.52it/s] 88%|████████▊ | 586/669 [00:01<00:00, 345.38it/s] 93%|█████████▎| 621/669 [00:02<00:00, 346.26it/s] 98%|█████████▊| 656/669 [00:02<00:00, 341.93it/s]100%|██████████| 669/669 [00:02<00:00, 304.51it/s]
2022-10-22 07:04:44,415 P23548 INFO [Metrics] logloss: 0.431950 - AUC: 0.858612
  0%|          | 0/168 [00:00<?, ?it/s]  2%|▏         | 3/168 [00:00<00:05, 28.34it/s] 10%|▉         | 16/168 [00:00<00:01, 81.76it/s] 31%|███       | 52/168 [00:00<00:00, 201.65it/s] 52%|█████▏    | 88/168 [00:00<00:00, 260.03it/s] 74%|███████▍  | 124/168 [00:00<00:00, 294.67it/s] 95%|█████████▌| 160/168 [00:00<00:00, 315.98it/s]100%|██████████| 168/168 [00:00<00:00, 243.59it/s]
2022-10-22 07:04:45,246 P23548 INFO [Metrics] logloss: 0.544099 - AUC: 0.736737
2022-10-22 07:04:45,324 P23548 INFO ******** Test evaluation ********
2022-10-22 07:04:45,324 P23548 INFO Loading data...
2022-10-22 07:04:45,325 P23548 INFO Loading test data done.
2022-10-22 07:04:48,488 P28156 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "8",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_014_31bc8f03",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 07:04:48,490 P28156 INFO Set up feature encoder...
2022-10-22 07:04:48,491 P28156 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 07:04:48,492 P28156 INFO Loading data...
2022-10-22 07:04:48,496 P28156 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 07:04:48,607 P28156 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 07:04:48,642 P28156 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 07:04:48,642 P28156 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 07:04:48,642 P28156 INFO Loading train data done.
2022-10-22 07:04:51,107 P28156 INFO Total number of parameters: 2354288.
2022-10-22 07:04:51,108 P28156 INFO Start training: 669 batches/epoch
2022-10-22 07:04:51,108 P28156 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 07:04:51.438 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:28156 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 07:04:51.470 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:28156 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<12:18,  1.11s/it]  2%|▏         | 14/669 [00:01<00:42, 15.59it/s]  3%|▎         | 22/669 [00:01<00:27, 23.51it/s]  5%|▌         | 35/669 [00:01<00:15, 40.38it/s]  7%|▋         | 48/669 [00:01<00:10, 56.68it/s]  9%|▉         | 61/669 [00:01<00:08, 71.80it/s] 11%|█         | 75/669 [00:01<00:06, 86.20it/s] 13%|█▎        | 89/669 [00:01<00:05, 98.21it/s] 15%|█▌        | 103/669 [00:01<00:05, 108.03it/s] 17%|█▋        | 117/669 [00:02<00:04, 115.68it/s] 20%|█▉        | 131/669 [00:02<00:04, 121.61it/s] 22%|██▏       | 145/669 [00:02<00:04, 126.19it/s] 24%|██▍       | 159/669 [00:02<00:03, 129.53it/s] 26%|██▌       | 173/669 [00:02<00:03, 132.10it/s] 28%|██▊       | 187/669 [00:02<00:03, 133.92it/s] 30%|███       | 201/669 [00:02<00:03, 135.10it/s] 32%|███▏      | 215/669 [00:02<00:03, 136.13it/s] 34%|███▍      | 229/669 [00:02<00:03, 136.80it/s] 36%|███▋      | 243/669 [00:02<00:03, 137.22it/s] 38%|███▊      | 257/669 [00:03<00:02, 137.39it/s] 41%|████      | 271/669 [00:03<00:02, 137.70it/s] 43%|████▎     | 285/669 [00:03<00:02, 138.05it/s] 45%|████▍     | 299/669 [00:03<00:02, 138.13it/s] 47%|████▋     | 313/669 [00:03<00:02, 138.11it/s] 49%|████▉     | 327/669 [00:03<00:02, 138.17it/s] 51%|█████     | 341/669 [00:03<00:02, 138.33it/s] 53%|█████▎    | 355/669 [00:03<00:02, 138.33it/s] 55%|█████▌    | 369/669 [00:03<00:02, 138.25it/s] 57%|█████▋    | 383/669 [00:03<00:02, 138.28it/s] 59%|█████▉    | 397/669 [00:04<00:01, 138.28it/s] 61%|██████▏   | 411/669 [00:04<00:01, 138.22it/s] 64%|██████▎   | 425/669 [00:04<00:01, 137.06it/s] 66%|██████▌   | 439/669 [00:04<00:01, 137.29it/s] 68%|██████▊   | 453/669 [00:04<00:01, 137.49it/s] 70%|██████▉   | 467/669 [00:04<00:01, 136.83it/s] 72%|███████▏  | 481/669 [00:04<00:01, 137.25it/s] 74%|███████▍  | 495/669 [00:04<00:01, 137.43it/s] 76%|███████▌  | 509/669 [00:04<00:01, 137.51it/s] 78%|███████▊  | 523/669 [00:05<00:01, 137.69it/s] 80%|████████  | 537/669 [00:05<00:00, 137.73it/s] 82%|████████▏ | 551/669 [00:05<00:00, 125.36it/s] 84%|████████▍ | 565/669 [00:05<00:00, 128.31it/s] 87%|████████▋ | 579/669 [00:05<00:00, 129.86it/s] 89%|████████▊ | 593/669 [00:05<00:00, 132.03it/s] 91%|█████████ | 607/669 [00:05<00:00, 133.57it/s] 93%|█████████▎| 621/669 [00:05<00:00, 134.49it/s] 95%|█████████▍| 635/669 [00:05<00:00, 134.92it/s] 97%|█████████▋| 649/669 [00:05<00:00, 135.59it/s] 99%|█████████▉| 663/669 [00:06<00:00, 133.69it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.71it/s][A
 12%|█▏        | 20/168 [00:00<00:01, 98.68it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 202.69it/s][A
 55%|█████▍    | 92/168 [00:00<00:00, 262.99it/s][A
 77%|███████▋  | 129/168 [00:00<00:00, 298.31it/s][A
 99%|█████████▉| 167/168 [00:00<00:00, 322.28it/s][A100%|██████████| 168/168 [00:00<00:00, 245.01it/s]
2022-10-22 07:04:58,053 P28156 INFO [Metrics] logloss: 0.563381 - AUC: 0.707400
2022-10-22 07:04:58,053 P28156 INFO Save best model: monitor(max): 0.144020
2022-10-22 07:04:58,162 P28156 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 94.34it/s] 
2022-10-22 07:04:58,202 P28156 INFO Train loss: 0.628657
2022-10-22 07:04:58,203 P28156 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:49,  6.08it/s]  2%|▏         | 15/669 [00:00<00:09, 66.07it/s]  3%|▎         | 23/669 [00:00<00:09, 65.37it/s]  6%|▌         | 37/669 [00:00<00:07, 88.61it/s]  8%|▊         | 51/669 [00:00<00:06, 102.90it/s] 10%|▉         | 65/669 [00:00<00:05, 112.27it/s] 12%|█▏        | 79/669 [00:00<00:04, 119.02it/s] 14%|█▍        | 93/669 [00:00<00:04, 123.86it/s] 16%|█▌        | 107/669 [00:01<00:04, 127.53it/s] 18%|█▊        | 121/669 [00:01<00:04, 130.30it/s] 20%|██        | 135/669 [00:01<00:04, 132.27it/s] 22%|██▏       | 149/669 [00:01<00:03, 133.78it/s] 24%|██▍       | 163/669 [00:01<00:03, 134.90it/s] 26%|██▋       | 177/669 [00:01<00:03, 135.64it/s] 29%|██▊       | 191/669 [00:01<00:03, 136.27it/s] 31%|███       | 205/669 [00:01<00:03, 136.85it/s] 33%|███▎      | 219/669 [00:01<00:03, 137.12it/s] 35%|███▍      | 233/669 [00:01<00:03, 137.22it/s] 37%|███▋      | 247/669 [00:02<00:03, 137.43it/s] 39%|███▉      | 261/669 [00:02<00:02, 137.66it/s] 41%|████      | 275/669 [00:02<00:02, 137.63it/s] 43%|████▎     | 289/669 [00:02<00:02, 137.67it/s] 45%|████▌     | 303/669 [00:02<00:02, 137.55it/s] 47%|████▋     | 317/669 [00:02<00:02, 137.46it/s] 49%|████▉     | 331/669 [00:02<00:02, 137.60it/s] 52%|█████▏    | 345/669 [00:02<00:02, 137.57it/s] 54%|█████▎    | 359/669 [00:02<00:02, 137.71it/s] 56%|█████▌    | 373/669 [00:02<00:02, 137.74it/s] 58%|█████▊    | 387/669 [00:03<00:02, 137.81it/s] 60%|█████▉    | 401/669 [00:03<00:01, 137.88it/s] 62%|██████▏   | 415/669 [00:03<00:01, 137.67it/s] 64%|██████▍   | 429/669 [00:03<00:01, 137.20it/s] 66%|██████▌   | 443/669 [00:03<00:01, 137.27it/s] 68%|██████▊   | 457/669 [00:03<00:01, 137.43it/s] 70%|███████   | 471/669 [00:03<00:01, 137.52it/s] 72%|███████▏  | 485/669 [00:03<00:01, 137.59it/s] 75%|███████▍  | 499/669 [00:03<00:01, 137.70it/s] 77%|███████▋  | 513/669 [00:03<00:01, 137.50it/s] 79%|███████▉  | 527/669 [00:04<00:01, 137.13it/s] 81%|████████  | 541/669 [00:04<00:00, 137.12it/s] 83%|████████▎ | 555/669 [00:04<00:00, 125.77it/s] 85%|████████▌ | 569/669 [00:04<00:00, 129.05it/s] 87%|████████▋ | 583/669 [00:04<00:00, 131.34it/s] 89%|████████▉ | 597/669 [00:04<00:00, 133.08it/s] 91%|█████████▏| 611/669 [00:04<00:00, 134.41it/s] 93%|█████████▎| 625/669 [00:04<00:00, 135.36it/s] 96%|█████████▌| 639/669 [00:04<00:00, 136.07it/s] 98%|█████████▊| 653/669 [00:05<00:00, 136.66it/s]100%|█████████▉| 667/669 [00:05<00:00, 135.36it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.62it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 77.42it/s][A
 33%|███▎      | 56/168 [00:00<00:00, 184.42it/s][A
 55%|█████▌    | 93/168 [00:00<00:00, 246.37it/s][A
 77%|███████▋  | 130/168 [00:00<00:00, 285.47it/s][A
 99%|█████████▉| 167/168 [00:00<00:00, 312.15it/s][A100%|██████████| 168/168 [00:00<00:00, 230.99it/s]
2022-10-22 07:05:04,216 P28156 INFO [Metrics] logloss: 0.552471 - AUC: 0.717023
2022-10-22 07:05:04,217 P28156 INFO Save best model: monitor(max): 0.164552
2022-10-22 07:05:04,353 P28156 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 108.01it/s]
2022-10-22 07:05:04,397 P28156 INFO Train loss: 0.624429
2022-10-22 07:05:04,398 P28156 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:48,  6.13it/s]  2%|▏         | 16/669 [00:00<00:09, 71.31it/s]  4%|▎         | 25/669 [00:00<00:09, 70.83it/s]  6%|▌         | 39/669 [00:00<00:06, 93.49it/s]  8%|▊         | 53/669 [00:00<00:05, 108.10it/s] 10%|█         | 68/669 [00:00<00:05, 118.73it/s] 12%|█▏        | 83/669 [00:00<00:04, 125.68it/s] 15%|█▍        | 98/669 [00:00<00:04, 130.64it/s] 17%|█▋        | 113/669 [00:01<00:04, 134.13it/s] 19%|█▉        | 128/669 [00:01<00:03, 136.47it/s] 21%|██▏       | 143/669 [00:01<00:03, 138.16it/s] 24%|██▎       | 158/669 [00:01<00:03, 139.18it/s] 26%|██▌       | 173/669 [00:01<00:03, 140.14it/s] 28%|██▊       | 188/669 [00:01<00:03, 140.81it/s] 30%|███       | 203/669 [00:01<00:03, 141.28it/s] 33%|███▎      | 218/669 [00:01<00:03, 141.47it/s] 35%|███▍      | 233/669 [00:01<00:03, 141.55it/s] 37%|███▋      | 248/669 [00:01<00:02, 141.63it/s] 39%|███▉      | 263/669 [00:02<00:02, 141.58it/s] 42%|████▏     | 278/669 [00:02<00:02, 142.21it/s] 44%|████▍     | 293/669 [00:02<00:02, 142.70it/s] 46%|████▌     | 308/669 [00:02<00:02, 143.07it/s] 48%|████▊     | 323/669 [00:02<00:02, 143.41it/s] 51%|█████     | 338/669 [00:02<00:02, 143.63it/s] 53%|█████▎    | 353/669 [00:02<00:02, 143.75it/s] 55%|█████▌    | 368/669 [00:02<00:02, 143.81it/s] 57%|█████▋    | 383/669 [00:02<00:01, 143.88it/s] 59%|█████▉    | 398/669 [00:03<00:01, 144.02it/s] 62%|██████▏   | 413/669 [00:03<00:01, 144.12it/s] 64%|██████▍   | 428/669 [00:03<00:01, 144.07it/s] 66%|██████▌   | 443/669 [00:03<00:01, 143.98it/s] 68%|██████▊   | 458/669 [00:03<00:01, 144.03it/s] 71%|███████   | 473/669 [00:03<00:01, 143.97it/s] 73%|███████▎  | 488/669 [00:03<00:01, 143.92it/s] 75%|███████▌  | 503/669 [00:03<00:01, 143.98it/s] 77%|███████▋  | 518/669 [00:03<00:01, 143.87it/s] 80%|███████▉  | 533/669 [00:03<00:00, 143.85it/s] 82%|████████▏ | 548/669 [00:04<00:00, 143.92it/s] 84%|████████▍ | 563/669 [00:04<00:00, 143.99it/s] 86%|████████▋ | 578/669 [00:04<00:00, 143.93it/s] 89%|████████▊ | 593/669 [00:04<00:00, 144.00it/s] 91%|█████████ | 608/669 [00:04<00:00, 144.03it/s] 93%|█████████▎| 623/669 [00:04<00:00, 144.10it/s] 95%|█████████▌| 638/669 [00:04<00:00, 144.08it/s] 98%|█████████▊| 653/669 [00:04<00:00, 144.16it/s]100%|█████████▉| 668/669 [00:04<00:00, 142.09it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.82it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 94.48it/s][A
 32%|███▏      | 53/168 [00:00<00:00, 196.80it/s][A
 51%|█████     | 86/168 [00:00<00:00, 246.43it/s][A
 71%|███████▏  | 120/168 [00:00<00:00, 277.93it/s][A
 92%|█████████▏| 154/168 [00:00<00:00, 298.09it/s][A100%|██████████| 168/168 [00:00<00:00, 234.38it/s]
2022-10-22 07:05:10,158 P28156 INFO [Metrics] logloss: 0.550819 - AUC: 0.721122
2022-10-22 07:05:10,158 P28156 INFO Save best model: monitor(max): 0.170303
2022-10-22 07:05:10,280 P28156 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:05<00:00, 112.72it/s]
2022-10-22 07:05:10,334 P28156 INFO Train loss: 0.623955
2022-10-22 07:05:10,334 P28156 INFO ************ Epoch=3 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:42,  6.52it/s]  2%|▏         | 15/669 [00:00<00:09, 68.68it/s]  3%|▎         | 23/669 [00:00<00:09, 66.89it/s]  6%|▌         | 37/669 [00:00<00:07, 89.89it/s]  8%|▊         | 51/669 [00:00<00:05, 103.98it/s] 10%|▉         | 65/669 [00:00<00:05, 113.23it/s] 12%|█▏        | 79/669 [00:00<00:04, 119.84it/s] 14%|█▍        | 93/669 [00:00<00:04, 124.56it/s] 16%|█▌        | 107/669 [00:01<00:04, 127.99it/s] 18%|█▊        | 121/669 [00:01<00:04, 130.49it/s] 20%|██        | 135/669 [00:01<00:04, 132.06it/s] 22%|██▏       | 149/669 [00:01<00:03, 133.32it/s] 24%|██▍       | 163/669 [00:01<00:03, 134.23it/s] 26%|██▋       | 177/669 [00:01<00:03, 135.10it/s] 29%|██▊       | 191/669 [00:01<00:03, 135.72it/s] 31%|███       | 205/669 [00:01<00:03, 136.02it/s] 33%|███▎      | 219/669 [00:01<00:03, 136.39it/s] 35%|███▍      | 233/669 [00:01<00:03, 136.53it/s] 37%|███▋      | 247/669 [00:02<00:03, 136.69it/s] 39%|███▉      | 261/669 [00:02<00:02, 136.86it/s] 41%|████      | 275/669 [00:02<00:02, 136.94it/s] 43%|████▎     | 289/669 [00:02<00:02, 136.93it/s] 45%|████▌     | 303/669 [00:02<00:02, 137.10it/s] 47%|████▋     | 317/669 [00:02<00:02, 137.21it/s] 49%|████▉     | 331/669 [00:02<00:02, 137.22it/s] 52%|█████▏    | 345/669 [00:02<00:02, 137.28it/s] 54%|█████▎    | 359/669 [00:02<00:02, 137.18it/s] 56%|█████▌    | 373/669 [00:02<00:02, 137.05it/s] 58%|█████▊    | 387/669 [00:03<00:02, 137.06it/s] 60%|█████▉    | 401/669 [00:03<00:01, 137.19it/s] 62%|██████▏   | 415/669 [00:03<00:01, 137.10it/s] 64%|██████▍   | 429/669 [00:03<00:01, 137.23it/s] 66%|██████▌   | 443/669 [00:03<00:01, 137.24it/s] 68%|██████▊   | 457/669 [00:03<00:01, 137.26it/s] 70%|███████   | 471/669 [00:03<00:01, 137.28it/s] 72%|███████▏  | 485/669 [00:03<00:01, 137.44it/s] 75%|███████▍  | 499/669 [00:03<00:01, 137.34it/s] 77%|███████▋  | 513/669 [00:03<00:01, 137.34it/s] 79%|███████▉  | 527/669 [00:04<00:01, 137.28it/s] 81%|████████  | 541/669 [00:04<00:00, 137.15it/s] 83%|████████▎ | 555/669 [00:04<00:00, 137.21it/s] 85%|████████▌ | 569/669 [00:04<00:00, 137.37it/s] 87%|████████▋ | 583/669 [00:04<00:00, 137.36it/s] 89%|████████▉ | 597/669 [00:04<00:00, 137.39it/s] 91%|█████████▏| 611/669 [00:04<00:00, 137.39it/s] 93%|█████████▎| 625/669 [00:04<00:00, 137.24it/s] 96%|█████████▌| 639/669 [00:04<00:00, 137.21it/s] 98%|█████████▊| 653/669 [00:04<00:00, 137.21it/s]100%|█████████▉| 667/669 [00:05<00:00, 134.98it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.56it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 95.41it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 206.03it/s][A
 55%|█████▍    | 92/168 [00:00<00:00, 266.82it/s][A
 77%|███████▋  | 129/168 [00:00<00:00, 302.69it/s][A
 99%|█████████▉| 167/168 [00:00<00:00, 325.60it/s][A100%|██████████| 168/168 [00:00<00:00, 247.73it/s]
2022-10-22 07:05:16,269 P28156 INFO [Metrics] logloss: 0.550659 - AUC: 0.721853
2022-10-22 07:05:16,270 P28156 INFO Save best model: monitor(max): 0.171193
2022-10-22 07:05:16,392 P28156 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 109.53it/s]
2022-10-22 07:05:16,442 P28156 INFO Train loss: 0.623328
2022-10-22 07:05:16,443 P28156 INFO ************ Epoch=4 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:50,  6.03it/s]  2%|▏         | 14/669 [00:00<00:10, 63.29it/s]  3%|▎         | 22/669 [00:00<00:10, 64.13it/s]  5%|▌         | 36/669 [00:00<00:07, 87.91it/s]  7%|▋         | 50/669 [00:00<00:06, 102.39it/s] 10%|▉         | 64/669 [00:00<00:05, 112.31it/s] 12%|█▏        | 78/669 [00:00<00:04, 118.77it/s] 14%|█▍        | 92/669 [00:00<00:04, 123.97it/s] 16%|█▌        | 106/669 [00:01<00:04, 127.82it/s] 18%|█▊        | 120/669 [00:01<00:04, 130.48it/s] 20%|██        | 134/669 [00:01<00:04, 132.47it/s] 22%|██▏       | 148/669 [00:01<00:03, 133.89it/s] 24%|██▍       | 162/669 [00:01<00:03, 134.89it/s] 26%|██▋       | 176/669 [00:01<00:03, 135.62it/s] 28%|██▊       | 190/669 [00:01<00:03, 136.11it/s] 30%|███       | 204/669 [00:01<00:03, 136.39it/s] 33%|███▎      | 218/669 [00:01<00:03, 136.73it/s] 35%|███▍      | 232/669 [00:01<00:03, 136.92it/s] 37%|███▋      | 246/669 [00:02<00:03, 136.97it/s] 39%|███▉      | 260/669 [00:02<00:02, 136.92it/s] 41%|████      | 274/669 [00:02<00:02, 137.03it/s] 43%|████▎     | 288/669 [00:02<00:02, 137.13it/s] 45%|████▌     | 302/669 [00:02<00:02, 137.26it/s] 47%|████▋     | 316/669 [00:02<00:02, 137.25it/s] 49%|████▉     | 330/669 [00:02<00:02, 137.26it/s] 51%|█████▏    | 344/669 [00:02<00:02, 137.32it/s] 54%|█████▎    | 358/669 [00:02<00:02, 137.35it/s] 56%|█████▌    | 372/669 [00:02<00:02, 137.24it/s] 58%|█████▊    | 386/669 [00:03<00:02, 137.24it/s] 60%|█████▉    | 400/669 [00:03<00:01, 137.25it/s] 62%|██████▏   | 414/669 [00:03<00:01, 137.35it/s] 64%|██████▍   | 428/669 [00:03<00:01, 137.39it/s] 66%|██████▌   | 442/669 [00:03<00:01, 137.34it/s] 68%|██████▊   | 456/669 [00:03<00:01, 137.37it/s] 70%|███████   | 470/669 [00:03<00:01, 137.53it/s] 72%|███████▏  | 484/669 [00:03<00:01, 137.54it/s] 74%|███████▍  | 498/669 [00:03<00:01, 137.40it/s] 77%|███████▋  | 512/669 [00:03<00:01, 137.37it/s] 79%|███████▊  | 526/669 [00:04<00:01, 137.41it/s] 81%|████████  | 540/669 [00:04<00:00, 137.28it/s] 83%|████████▎ | 554/669 [00:04<00:00, 137.25it/s] 85%|████████▍ | 568/669 [00:04<00:00, 137.19it/s] 87%|████████▋ | 582/669 [00:04<00:00, 137.22it/s] 89%|████████▉ | 596/669 [00:04<00:00, 137.29it/s] 91%|█████████ | 610/669 [00:04<00:00, 137.33it/s] 93%|█████████▎| 624/669 [00:04<00:00, 137.21it/s] 95%|█████████▌| 638/669 [00:04<00:00, 137.30it/s] 97%|█████████▋| 652/669 [00:04<00:00, 137.34it/s]100%|█████████▉| 666/669 [00:05<00:00, 134.69it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.66it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 95.34it/s][A
 33%|███▎      | 56/168 [00:00<00:00, 208.49it/s][A
 55%|█████▌    | 93/168 [00:00<00:00, 267.09it/s][A
 77%|███████▋  | 130/168 [00:00<00:00, 301.38it/s][A
100%|██████████| 168/168 [00:00<00:00, 326.42it/s][A100%|██████████| 168/168 [00:00<00:00, 243.83it/s]
2022-10-22 07:05:22,399 P28156 INFO [Metrics] logloss: 0.547371 - AUC: 0.723039
2022-10-22 07:05:22,399 P28156 INFO Save best model: monitor(max): 0.175668
2022-10-22 07:05:22,527 P28156 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 109.04it/s]
2022-10-22 07:05:22,579 P28156 INFO Train loss: 0.621254
2022-10-22 07:05:22,579 P28156 INFO ************ Epoch=5 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:53,  5.87it/s]  2%|▏         | 15/669 [00:00<00:09, 65.90it/s]  4%|▎         | 24/669 [00:00<00:09, 67.34it/s]  6%|▌         | 38/669 [00:00<00:06, 90.58it/s]  8%|▊         | 52/669 [00:00<00:05, 105.25it/s] 10%|▉         | 66/669 [00:00<00:05, 115.30it/s] 12%|█▏        | 80/669 [00:00<00:04, 122.73it/s] 14%|█▍        | 95/669 [00:00<00:04, 128.42it/s] 16%|█▋        | 110/669 [00:01<00:04, 132.78it/s] 19%|█▊        | 125/669 [00:01<00:04, 135.94it/s] 21%|██        | 140/669 [00:01<00:03, 138.16it/s] 23%|██▎       | 155/669 [00:01<00:03, 139.74it/s] 25%|██▌       | 170/669 [00:01<00:03, 140.94it/s] 28%|██▊       | 185/669 [00:01<00:03, 141.81it/s] 30%|██▉       | 200/669 [00:01<00:03, 142.55it/s] 32%|███▏      | 215/669 [00:01<00:03, 142.96it/s] 34%|███▍      | 230/669 [00:01<00:03, 143.27it/s] 37%|███▋      | 245/669 [00:01<00:02, 143.48it/s] 39%|███▉      | 260/669 [00:02<00:02, 143.68it/s] 41%|████      | 275/669 [00:02<00:02, 143.85it/s] 43%|████▎     | 290/669 [00:02<00:02, 143.95it/s] 46%|████▌     | 305/669 [00:02<00:02, 144.09it/s] 48%|████▊     | 320/669 [00:02<00:02, 144.01it/s] 50%|█████     | 335/669 [00:02<00:02, 144.02it/s] 52%|█████▏    | 350/669 [00:02<00:02, 144.02it/s] 55%|█████▍    | 365/669 [00:02<00:02, 144.07it/s] 57%|█████▋    | 380/669 [00:02<00:02, 144.13it/s] 59%|█████▉    | 395/669 [00:03<00:01, 144.11it/s] 61%|██████▏   | 410/669 [00:03<00:01, 144.09it/s] 64%|██████▎   | 425/669 [00:03<00:01, 144.08it/s] 66%|██████▌   | 440/669 [00:03<00:01, 143.85it/s] 68%|██████▊   | 455/669 [00:03<00:01, 143.73it/s] 70%|███████   | 470/669 [00:03<00:01, 143.57it/s] 72%|███████▏  | 485/669 [00:03<00:01, 143.58it/s] 75%|███████▍  | 500/669 [00:03<00:01, 143.63it/s] 77%|███████▋  | 515/669 [00:03<00:01, 143.64it/s] 79%|███████▉  | 530/669 [00:03<00:00, 143.50it/s] 81%|████████▏ | 545/669 [00:04<00:00, 143.55it/s] 84%|████████▎ | 560/669 [00:04<00:00, 143.61it/s] 86%|████████▌ | 575/669 [00:04<00:00, 143.65it/s] 88%|████████▊ | 590/669 [00:04<00:00, 143.60it/s] 90%|█████████ | 605/669 [00:04<00:00, 143.59it/s] 93%|█████████▎| 620/669 [00:04<00:00, 143.52it/s] 95%|█████████▍| 635/669 [00:04<00:00, 143.55it/s] 97%|█████████▋| 650/669 [00:04<00:00, 143.53it/s] 99%|█████████▉| 665/669 [00:04<00:00, 141.54it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:06, 26.35it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 91.80it/s][A
 33%|███▎      | 56/168 [00:00<00:00, 206.58it/s][A
 55%|█████▌    | 93/168 [00:00<00:00, 266.17it/s][A
 78%|███████▊  | 131/168 [00:00<00:00, 303.07it/s][A100%|██████████| 168/168 [00:00<00:00, 246.00it/s]
2022-10-22 07:05:28,316 P28156 INFO [Metrics] logloss: 0.547779 - AUC: 0.722621
2022-10-22 07:05:28,317 P28156 INFO Monitor(max) STOP: 0.174842 !
2022-10-22 07:05:28,317 P28156 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 07:05:28,317 P28156 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:05<00:00, 115.54it/s]
2022-10-22 07:05:28,370 P28156 INFO Train loss: 0.623846
2022-10-22 07:05:28,370 P28156 INFO ************ Epoch=6 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:46,  6.25it/s]  2%|▏         | 15/669 [00:00<00:09, 67.83it/s]  4%|▎         | 24/669 [00:00<00:09, 67.24it/s]  6%|▌         | 38/669 [00:00<00:07, 89.89it/s]  8%|▊         | 52/669 [00:00<00:05, 104.20it/s] 10%|▉         | 66/669 [00:00<00:05, 113.33it/s] 12%|█▏        | 80/669 [00:00<00:04, 120.34it/s] 14%|█▍        | 94/669 [00:00<00:04, 125.27it/s] 16%|█▌        | 108/669 [00:01<00:04, 128.94it/s] 18%|█▊        | 122/669 [00:01<00:04, 131.69it/s] 20%|██        | 136/669 [00:01<00:03, 133.86it/s] 22%|██▏       | 150/669 [00:01<00:03, 135.35it/s] 25%|██▍       | 164/669 [00:01<00:03, 136.39it/s] 27%|██▋       | 178/669 [00:01<00:03, 137.09it/s] 29%|██▊       | 192/669 [00:01<00:03, 137.57it/s] 31%|███       | 206/669 [00:01<00:03, 138.02it/s] 33%|███▎      | 220/669 [00:01<00:03, 138.38it/s] 35%|███▍      | 234/669 [00:01<00:03, 138.55it/s] 37%|███▋      | 248/669 [00:02<00:03, 138.52it/s] 39%|███▉      | 262/669 [00:02<00:02, 138.55it/s] 41%|████▏     | 276/669 [00:02<00:02, 138.69it/s] 43%|████▎     | 290/669 [00:02<00:02, 138.68it/s] 45%|████▌     | 304/669 [00:02<00:02, 138.66it/s] 48%|████▊     | 318/669 [00:02<00:02, 138.67it/s] 50%|████▉     | 332/669 [00:02<00:02, 138.68it/s] 52%|█████▏    | 346/669 [00:02<00:02, 138.78it/s] 54%|█████▍    | 360/669 [00:02<00:02, 138.75it/s] 56%|█████▌    | 374/669 [00:02<00:02, 138.77it/s] 58%|█████▊    | 388/669 [00:03<00:02, 138.82it/s] 60%|██████    | 402/669 [00:03<00:01, 138.49it/s] 62%|██████▏   | 416/669 [00:03<00:01, 138.20it/s] 64%|██████▍   | 430/669 [00:03<00:01, 138.23it/s] 66%|██████▋   | 444/669 [00:03<00:01, 138.39it/s] 68%|██████▊   | 458/669 [00:03<00:01, 138.54it/s] 71%|███████   | 472/669 [00:03<00:01, 138.65it/s] 73%|███████▎  | 486/669 [00:03<00:01, 138.85it/s] 75%|███████▍  | 500/669 [00:03<00:01, 138.62it/s] 77%|███████▋  | 514/669 [00:03<00:01, 138.60it/s] 79%|███████▉  | 528/669 [00:04<00:01, 138.68it/s] 81%|████████  | 542/669 [00:04<00:01, 125.98it/s] 83%|████████▎ | 556/669 [00:04<00:00, 129.34it/s] 85%|████████▌ | 570/669 [00:04<00:00, 131.91it/s] 87%|████████▋ | 584/669 [00:04<00:00, 133.91it/s] 89%|████████▉ | 598/669 [00:04<00:00, 135.22it/s] 91%|█████████▏| 612/669 [00:04<00:00, 136.16it/s] 94%|█████████▎| 626/669 [00:04<00:00, 136.77it/s] 96%|█████████▌| 640/669 [00:04<00:00, 137.22it/s] 98%|█████████▊| 654/669 [00:04<00:00, 137.42it/s]100%|█████████▉| 668/669 [00:05<00:00, 135.60it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.59it/s][A
 10%|▉         | 16/168 [00:00<00:01, 79.86it/s][A
 29%|██▉       | 49/168 [00:00<00:00, 183.65it/s][A
 49%|████▉     | 83/168 [00:00<00:00, 240.40it/s][A
 70%|██████▉   | 117/168 [00:00<00:00, 272.95it/s][A
 90%|████████▉ | 151/168 [00:00<00:00, 294.18it/s][A100%|██████████| 168/168 [00:00<00:00, 231.27it/s]
2022-10-22 07:05:34,345 P28156 INFO [Metrics] logloss: 0.541979 - AUC: 0.737379
2022-10-22 07:05:34,345 P28156 INFO Save best model: monitor(max): 0.195399
2022-10-22 07:05:34,477 P28156 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 108.77it/s]
2022-10-22 07:05:34,522 P28156 INFO Train loss: 0.545622
2022-10-22 07:05:34,522 P28156 INFO ************ Epoch=7 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:46,  6.30it/s]  2%|▏         | 15/669 [00:00<00:09, 68.01it/s]  4%|▎         | 24/669 [00:00<00:09, 69.03it/s]  6%|▌         | 38/669 [00:00<00:06, 91.43it/s]  8%|▊         | 52/669 [00:00<00:05, 105.58it/s] 10%|▉         | 66/669 [00:00<00:05, 115.79it/s] 12%|█▏        | 80/669 [00:00<00:04, 122.90it/s] 14%|█▍        | 94/669 [00:00<00:04, 128.05it/s] 16%|█▋        | 109/669 [00:01<00:04, 132.17it/s] 19%|█▊        | 124/669 [00:01<00:04, 135.46it/s] 21%|██        | 139/669 [00:01<00:03, 137.37it/s] 23%|██▎       | 154/669 [00:01<00:03, 138.60it/s] 25%|██▌       | 169/669 [00:01<00:03, 139.94it/s] 28%|██▊       | 184/669 [00:01<00:03, 140.51it/s] 30%|██▉       | 199/669 [00:01<00:03, 140.96it/s] 32%|███▏      | 214/669 [00:01<00:03, 141.39it/s] 34%|███▍      | 229/669 [00:01<00:03, 142.06it/s] 36%|███▋      | 244/669 [00:01<00:02, 142.14it/s] 39%|███▊      | 259/669 [00:02<00:02, 142.22it/s] 41%|████      | 274/669 [00:02<00:02, 142.42it/s] 43%|████▎     | 289/669 [00:02<00:02, 142.39it/s] 45%|████▌     | 304/669 [00:02<00:02, 142.48it/s] 48%|████▊     | 319/669 [00:02<00:02, 142.34it/s] 50%|████▉     | 334/669 [00:02<00:02, 142.69it/s] 52%|█████▏    | 349/669 [00:02<00:02, 142.52it/s] 54%|█████▍    | 364/669 [00:02<00:02, 143.00it/s] 57%|█████▋    | 379/669 [00:02<00:02, 142.92it/s] 59%|█████▉    | 394/669 [00:03<00:01, 142.11it/s] 61%|██████    | 409/669 [00:03<00:01, 142.05it/s] 63%|██████▎   | 424/669 [00:03<00:01, 142.13it/s] 66%|██████▌   | 439/669 [00:03<00:01, 142.51it/s] 68%|██████▊   | 454/669 [00:03<00:01, 142.44it/s] 70%|███████   | 469/669 [00:03<00:01, 142.26it/s] 72%|███████▏  | 484/669 [00:03<00:01, 142.70it/s] 75%|███████▍  | 499/669 [00:03<00:01, 142.49it/s] 77%|███████▋  | 514/669 [00:03<00:01, 142.39it/s] 79%|███████▉  | 529/669 [00:03<00:00, 142.37it/s] 81%|████████▏ | 544/669 [00:04<00:00, 131.10it/s] 84%|████████▎ | 559/669 [00:04<00:00, 134.57it/s] 86%|████████▌ | 574/669 [00:04<00:00, 136.63it/s] 88%|████████▊ | 589/669 [00:04<00:00, 138.08it/s] 90%|█████████ | 604/669 [00:04<00:00, 139.71it/s] 93%|█████████▎| 619/669 [00:04<00:00, 140.97it/s] 95%|█████████▍| 634/669 [00:04<00:00, 141.92it/s] 97%|█████████▋| 649/669 [00:04<00:00, 142.48it/s] 99%|█████████▉| 664/669 [00:04<00:00, 140.25it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:05, 28.71it/s][A
 10%|▉         | 16/168 [00:00<00:01, 82.52it/s][A
 31%|███       | 52/168 [00:00<00:00, 202.22it/s][A
 52%|█████▏    | 88/168 [00:00<00:00, 262.17it/s][A
 74%|███████▍  | 124/168 [00:00<00:00, 295.77it/s][A
 96%|█████████▌| 161/168 [00:00<00:00, 318.01it/s][A100%|██████████| 168/168 [00:00<00:00, 244.50it/s]
2022-10-22 07:05:40,319 P28156 INFO [Metrics] logloss: 0.553537 - AUC: 0.735039
2022-10-22 07:05:40,320 P28156 INFO Monitor(max) STOP: 0.181502 !
2022-10-22 07:05:40,320 P28156 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 07:05:40,320 P28156 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:05<00:00, 114.47it/s]
2022-10-22 07:05:40,367 P28156 INFO Train loss: 0.497913
2022-10-22 07:05:40,367 P28156 INFO ************ Epoch=8 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:47,  6.22it/s]  2%|▏         | 15/669 [00:00<00:09, 68.43it/s]  4%|▎         | 24/669 [00:00<00:09, 68.86it/s]  6%|▌         | 38/669 [00:00<00:06, 92.61it/s]  8%|▊         | 52/669 [00:00<00:05, 107.61it/s] 10%|▉         | 66/669 [00:00<00:05, 117.58it/s] 12%|█▏        | 80/669 [00:00<00:04, 124.28it/s] 14%|█▍        | 94/669 [00:00<00:04, 128.64it/s] 16%|█▌        | 108/669 [00:00<00:04, 131.68it/s] 18%|█▊        | 122/669 [00:01<00:04, 133.80it/s] 20%|██        | 136/669 [00:01<00:03, 135.05it/s] 22%|██▏       | 150/669 [00:01<00:03, 136.11it/s] 25%|██▍       | 164/669 [00:01<00:03, 137.01it/s] 27%|██▋       | 178/669 [00:01<00:03, 137.51it/s] 29%|██▊       | 192/669 [00:01<00:03, 138.04it/s] 31%|███       | 206/669 [00:01<00:03, 138.48it/s] 33%|███▎      | 220/669 [00:01<00:03, 138.65it/s] 35%|███▍      | 234/669 [00:01<00:03, 138.71it/s] 37%|███▋      | 248/669 [00:02<00:03, 138.80it/s] 39%|███▉      | 262/669 [00:02<00:02, 138.84it/s] 41%|████▏     | 276/669 [00:02<00:02, 138.86it/s] 43%|████▎     | 290/669 [00:02<00:02, 138.99it/s] 45%|████▌     | 304/669 [00:02<00:02, 138.86it/s] 48%|████▊     | 318/669 [00:02<00:02, 138.99it/s] 50%|████▉     | 332/669 [00:02<00:02, 138.86it/s] 52%|█████▏    | 346/669 [00:02<00:02, 138.83it/s] 54%|█████▍    | 360/669 [00:02<00:02, 138.76it/s] 56%|█████▌    | 374/669 [00:02<00:02, 138.67it/s] 58%|█████▊    | 388/669 [00:03<00:02, 138.75it/s] 60%|██████    | 402/669 [00:03<00:01, 138.77it/s] 62%|██████▏   | 416/669 [00:03<00:01, 138.83it/s] 64%|██████▍   | 430/669 [00:03<00:01, 138.83it/s] 66%|██████▋   | 444/669 [00:03<00:01, 138.84it/s] 68%|██████▊   | 458/669 [00:03<00:01, 138.59it/s] 71%|███████   | 472/669 [00:03<00:01, 138.60it/s] 73%|███████▎  | 486/669 [00:03<00:01, 138.75it/s] 75%|███████▍  | 500/669 [00:03<00:01, 138.76it/s] 77%|███████▋  | 514/669 [00:03<00:01, 138.87it/s] 79%|███████▉  | 528/669 [00:04<00:01, 138.95it/s] 81%|████████  | 542/669 [00:04<00:00, 138.80it/s] 83%|████████▎ | 556/669 [00:04<00:00, 138.71it/s] 85%|████████▌ | 570/669 [00:04<00:00, 138.78it/s] 87%|████████▋ | 584/669 [00:04<00:00, 138.86it/s] 89%|████████▉ | 598/669 [00:04<00:00, 138.80it/s] 91%|█████████▏| 612/669 [00:04<00:00, 138.72it/s] 94%|█████████▎| 626/669 [00:04<00:00, 138.76it/s] 96%|█████████▌| 640/669 [00:04<00:00, 138.61it/s] 98%|█████████▊| 654/669 [00:04<00:00, 138.51it/s]100%|█████████▉| 668/669 [00:05<00:00, 136.50it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.52it/s][A
 10%|▉         | 16/168 [00:00<00:01, 83.77it/s][A
 32%|███▏      | 53/168 [00:00<00:00, 205.59it/s][A
 54%|█████▎    | 90/168 [00:00<00:00, 266.33it/s][A
 76%|███████▌  | 127/168 [00:00<00:00, 302.51it/s][A
 98%|█████████▊| 164/168 [00:00<00:00, 324.67it/s][A100%|██████████| 168/168 [00:00<00:00, 247.75it/s]
2022-10-22 07:05:46,229 P28156 INFO [Metrics] logloss: 0.584904 - AUC: 0.731963
2022-10-22 07:05:46,229 P28156 INFO Monitor(max) STOP: 0.147059 !
2022-10-22 07:05:46,229 P28156 INFO Reduce learning rate on plateau: 0.000001
2022-10-22 07:05:46,229 P28156 INFO Early stopping at epoch=9
2022-10-22 07:05:46,230 P28156 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:05<00:00, 113.12it/s]
2022-10-22 07:05:46,273 P28156 INFO Train loss: 0.427208
2022-10-22 07:05:46,273 P28156 INFO Training finished.
2022-10-22 07:05:46,273 P28156 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_014_31bc8f03.model
2022-10-22 07:05:46,367 P28156 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:50,  6.04it/s]  2%|▏         | 16/669 [00:00<00:09, 66.82it/s]  7%|▋         | 50/669 [00:00<00:03, 168.51it/s] 13%|█▎        | 86/669 [00:00<00:02, 234.86it/s] 18%|█▊        | 122/669 [00:00<00:01, 275.95it/s] 24%|██▍       | 159/669 [00:00<00:01, 304.29it/s] 29%|██▉       | 196/669 [00:00<00:01, 322.93it/s] 35%|███▍      | 233/669 [00:00<00:01, 335.65it/s] 40%|████      | 270/669 [00:00<00:01, 344.63it/s] 46%|████▌     | 307/669 [00:01<00:01, 350.35it/s] 51%|█████▏    | 344/669 [00:01<00:00, 353.94it/s] 57%|█████▋    | 380/669 [00:01<00:00, 352.15it/s] 62%|██████▏   | 416/669 [00:01<00:00, 350.58it/s] 68%|██████▊   | 452/669 [00:01<00:00, 352.42it/s] 73%|███████▎  | 488/669 [00:01<00:00, 353.71it/s] 78%|███████▊  | 524/669 [00:01<00:00, 352.44it/s] 84%|████████▎ | 560/669 [00:01<00:00, 353.40it/s] 89%|████████▉ | 596/669 [00:01<00:00, 349.50it/s] 94%|█████████▍| 632/669 [00:02<00:00, 351.90it/s]100%|█████████▉| 668/669 [00:02<00:00, 345.49it/s]100%|██████████| 669/669 [00:02<00:00, 307.12it/s]
2022-10-22 07:05:49,131 P28156 INFO [Metrics] logloss: 0.450930 - AUC: 0.841394
  0%|          | 0/168 [00:00<?, ?it/s]  2%|▏         | 3/168 [00:00<00:06, 26.55it/s] 10%|▉         | 16/168 [00:00<00:01, 78.19it/s] 30%|██▉       | 50/168 [00:00<00:00, 189.40it/s] 51%|█████     | 85/168 [00:00<00:00, 249.97it/s] 72%|███████▏  | 121/168 [00:00<00:00, 286.80it/s] 93%|█████████▎| 156/168 [00:00<00:00, 307.77it/s]100%|██████████| 168/168 [00:00<00:00, 238.93it/s]
2022-10-22 07:05:49,973 P28156 INFO [Metrics] logloss: 0.541979 - AUC: 0.737379
2022-10-22 07:05:50,049 P28156 INFO ******** Test evaluation ********
2022-10-22 07:05:50,050 P28156 INFO Loading data...
2022-10-22 07:05:50,052 P28156 INFO Loading test data done.
2022-10-22 07:05:53,602 P32353 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_015_8d7237a7",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 07:05:53,604 P32353 INFO Set up feature encoder...
2022-10-22 07:05:53,604 P32353 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 07:05:53,605 P32353 INFO Loading data...
2022-10-22 07:05:53,609 P32353 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 07:05:53,710 P32353 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 07:05:53,745 P32353 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 07:05:53,745 P32353 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 07:05:53,745 P32353 INFO Loading train data done.
2022-10-22 07:05:56,275 P32353 INFO Total number of parameters: 4161832.
2022-10-22 07:05:56,275 P32353 INFO Start training: 669 batches/epoch
2022-10-22 07:05:56,275 P32353 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 07:05:56.614 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:32353 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 07:05:56.647 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:32353 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<12:20,  1.11s/it]  2%|▏         | 13/669 [00:01<00:45, 14.37it/s]  3%|▎         | 22/669 [00:01<00:27, 23.22it/s]  5%|▌         | 34/669 [00:01<00:16, 38.09it/s]  7%|▋         | 46/669 [00:01<00:11, 52.73it/s]  9%|▊         | 58/669 [00:01<00:09, 66.40it/s] 11%|█         | 71/669 [00:01<00:07, 79.36it/s] 13%|█▎        | 84/669 [00:01<00:06, 90.39it/s] 14%|█▍        | 97/669 [00:01<00:05, 99.27it/s] 16%|█▋        | 110/669 [00:02<00:05, 105.99it/s] 18%|█▊        | 123/669 [00:02<00:04, 111.22it/s] 20%|██        | 136/669 [00:02<00:04, 114.97it/s] 22%|██▏       | 149/669 [00:02<00:04, 117.74it/s] 24%|██▍       | 162/669 [00:02<00:04, 119.67it/s] 26%|██▌       | 175/669 [00:02<00:04, 120.87it/s] 28%|██▊       | 188/669 [00:02<00:03, 121.92it/s] 30%|███       | 201/669 [00:02<00:03, 122.71it/s] 32%|███▏      | 214/669 [00:02<00:03, 123.25it/s] 34%|███▍      | 227/669 [00:03<00:03, 123.83it/s] 36%|███▌      | 240/669 [00:03<00:03, 124.15it/s] 38%|███▊      | 253/669 [00:03<00:03, 124.50it/s] 40%|███▉      | 266/669 [00:03<00:03, 124.72it/s] 42%|████▏     | 279/669 [00:03<00:03, 124.90it/s] 44%|████▎     | 292/669 [00:03<00:03, 125.09it/s] 46%|████▌     | 305/669 [00:03<00:02, 125.06it/s] 48%|████▊     | 318/669 [00:03<00:02, 125.01it/s] 49%|████▉     | 331/669 [00:03<00:02, 125.09it/s] 51%|█████▏    | 344/669 [00:03<00:02, 125.13it/s] 53%|█████▎    | 357/669 [00:04<00:02, 125.04it/s] 55%|█████▌    | 370/669 [00:04<00:02, 125.04it/s] 57%|█████▋    | 383/669 [00:04<00:02, 125.07it/s] 59%|█████▉    | 396/669 [00:04<00:02, 125.08it/s] 61%|██████    | 409/669 [00:04<00:02, 125.02it/s] 63%|██████▎   | 422/669 [00:04<00:01, 125.18it/s] 65%|██████▌   | 435/669 [00:04<00:01, 125.20it/s] 67%|██████▋   | 448/669 [00:04<00:01, 125.20it/s] 69%|██████▉   | 461/669 [00:04<00:01, 125.15it/s] 71%|███████   | 474/669 [00:05<00:01, 125.21it/s] 73%|███████▎  | 487/669 [00:05<00:01, 125.03it/s] 75%|███████▍  | 500/669 [00:05<00:01, 124.78it/s] 77%|███████▋  | 513/669 [00:05<00:01, 124.56it/s] 79%|███████▊  | 526/669 [00:05<00:01, 124.79it/s] 81%|████████  | 539/669 [00:05<00:01, 124.96it/s] 83%|████████▎ | 552/669 [00:05<00:01, 113.95it/s] 84%|████████▍ | 565/669 [00:05<00:00, 116.88it/s] 86%|████████▋ | 578/669 [00:05<00:00, 118.88it/s] 88%|████████▊ | 591/669 [00:05<00:00, 120.53it/s] 90%|█████████ | 604/669 [00:06<00:00, 121.65it/s] 92%|█████████▏| 617/669 [00:06<00:00, 122.52it/s] 94%|█████████▍| 630/669 [00:06<00:00, 123.22it/s] 96%|█████████▌| 643/669 [00:06<00:00, 123.79it/s] 98%|█████████▊| 656/669 [00:06<00:00, 124.13it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.71it/s][A
 12%|█▏        | 20/168 [00:00<00:01, 93.35it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 197.08it/s][A
 54%|█████▎    | 90/168 [00:00<00:00, 252.40it/s][A
 74%|███████▍  | 125/168 [00:00<00:00, 285.73it/s][A
 95%|█████████▌| 160/168 [00:00<00:00, 306.73it/s][A100%|██████████| 168/168 [00:00<00:00, 239.28it/s]
2022-10-22 07:06:03,734 P32353 INFO [Metrics] logloss: 0.557803 - AUC: 0.707294
2022-10-22 07:06:03,734 P32353 INFO Save best model: monitor(max): 0.149490
2022-10-22 07:06:03,876 P32353 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 32.41it/s] 100%|██████████| 669/669 [00:07<00:00, 87.60it/s]
2022-10-22 07:06:03,914 P32353 INFO Train loss: 0.638621
2022-10-22 07:06:03,914 P32353 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:45,  6.35it/s]  2%|▏         | 14/669 [00:00<00:10, 63.16it/s]  3%|▎         | 22/669 [00:00<00:10, 63.05it/s]  5%|▌         | 35/669 [00:00<00:07, 84.10it/s]  7%|▋         | 48/669 [00:00<00:06, 97.26it/s]  9%|▉         | 61/669 [00:00<00:05, 105.77it/s] 11%|█         | 74/669 [00:00<00:05, 111.32it/s] 13%|█▎        | 87/669 [00:00<00:05, 115.15it/s] 15%|█▍        | 100/669 [00:01<00:04, 117.84it/s] 17%|█▋        | 113/669 [00:01<00:04, 119.45it/s] 19%|█▉        | 126/669 [00:01<00:04, 120.76it/s] 21%|██        | 139/669 [00:01<00:04, 121.67it/s] 23%|██▎       | 152/669 [00:01<00:04, 122.24it/s] 25%|██▍       | 165/669 [00:01<00:04, 122.60it/s] 27%|██▋       | 178/669 [00:01<00:03, 123.13it/s] 29%|██▊       | 191/669 [00:01<00:03, 123.57it/s] 30%|███       | 204/669 [00:01<00:03, 123.67it/s] 32%|███▏      | 217/669 [00:01<00:03, 123.70it/s] 34%|███▍      | 230/669 [00:02<00:03, 123.65it/s] 36%|███▋      | 243/669 [00:02<00:03, 123.85it/s] 38%|███▊      | 256/669 [00:02<00:03, 124.07it/s] 40%|████      | 269/669 [00:02<00:03, 123.96it/s] 42%|████▏     | 282/669 [00:02<00:03, 123.83it/s] 44%|████▍     | 295/669 [00:02<00:03, 123.61it/s] 46%|████▌     | 308/669 [00:02<00:02, 123.06it/s] 48%|████▊     | 321/669 [00:02<00:02, 123.31it/s] 50%|████▉     | 334/669 [00:02<00:02, 123.64it/s] 52%|█████▏    | 347/669 [00:03<00:02, 123.61it/s] 54%|█████▍    | 360/669 [00:03<00:02, 123.63it/s] 56%|█████▌    | 373/669 [00:03<00:02, 123.79it/s] 58%|█████▊    | 386/669 [00:03<00:02, 123.94it/s] 60%|█████▉    | 399/669 [00:03<00:02, 123.86it/s] 62%|██████▏   | 412/669 [00:03<00:02, 123.74it/s] 64%|██████▎   | 425/669 [00:03<00:01, 123.76it/s] 65%|██████▌   | 438/669 [00:03<00:01, 123.94it/s] 67%|██████▋   | 451/669 [00:03<00:01, 124.13it/s] 69%|██████▉   | 464/669 [00:03<00:01, 123.98it/s] 71%|███████▏  | 477/669 [00:04<00:01, 123.60it/s] 73%|███████▎  | 490/669 [00:04<00:01, 123.60it/s] 75%|███████▌  | 503/669 [00:04<00:01, 123.38it/s] 77%|███████▋  | 516/669 [00:04<00:01, 123.52it/s] 79%|███████▉  | 529/669 [00:04<00:01, 123.80it/s] 81%|████████  | 542/669 [00:04<00:01, 123.86it/s] 83%|████████▎ | 555/669 [00:04<00:00, 114.47it/s] 85%|████████▍ | 568/669 [00:04<00:00, 117.13it/s] 87%|████████▋ | 581/669 [00:04<00:00, 119.23it/s] 89%|████████▉ | 594/669 [00:05<00:00, 120.54it/s] 91%|█████████ | 607/669 [00:05<00:00, 121.28it/s] 93%|█████████▎| 620/669 [00:05<00:00, 122.06it/s] 95%|█████████▍| 633/669 [00:05<00:00, 122.72it/s] 97%|█████████▋| 646/669 [00:05<00:00, 123.02it/s] 99%|█████████▊| 659/669 [00:05<00:00, 123.21it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.60it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 80.52it/s][A
 32%|███▏      | 54/168 [00:00<00:00, 183.17it/s][A
 54%|█████▎    | 90/168 [00:00<00:00, 243.65it/s][A
 75%|███████▌  | 126/168 [00:00<00:00, 281.74it/s][A
 96%|█████████▋| 162/168 [00:00<00:00, 306.68it/s][A100%|██████████| 168/168 [00:00<00:00, 226.99it/s]
2022-10-22 07:06:10,444 P32353 INFO [Metrics] logloss: 0.551652 - AUC: 0.717781
2022-10-22 07:06:10,445 P32353 INFO Save best model: monitor(max): 0.166129
2022-10-22 07:06:10,613 P32353 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 99.12it/s] 
2022-10-22 07:06:10,664 P32353 INFO Train loss: 0.637175
2022-10-22 07:06:10,664 P32353 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:48,  6.18it/s]  2%|▏         | 14/669 [00:00<00:10, 62.61it/s]  3%|▎         | 22/669 [00:00<00:10, 63.44it/s]  5%|▌         | 35/669 [00:00<00:07, 84.93it/s]  7%|▋         | 48/669 [00:00<00:06, 98.32it/s]  9%|▉         | 61/669 [00:00<00:05, 106.96it/s] 11%|█         | 74/669 [00:00<00:05, 112.50it/s] 13%|█▎        | 87/669 [00:00<00:05, 115.94it/s] 15%|█▍        | 100/669 [00:01<00:04, 118.29it/s] 17%|█▋        | 113/669 [00:01<00:04, 120.12it/s] 19%|█▉        | 126/669 [00:01<00:04, 121.52it/s] 21%|██        | 139/669 [00:01<00:04, 122.52it/s] 23%|██▎       | 152/669 [00:01<00:04, 123.29it/s] 25%|██▍       | 165/669 [00:01<00:04, 123.82it/s] 27%|██▋       | 178/669 [00:01<00:03, 124.20it/s] 29%|██▊       | 191/669 [00:01<00:03, 124.33it/s] 30%|███       | 204/669 [00:01<00:03, 124.53it/s] 32%|███▏      | 217/669 [00:01<00:03, 124.79it/s] 34%|███▍      | 230/669 [00:02<00:03, 124.85it/s] 36%|███▋      | 243/669 [00:02<00:03, 124.88it/s] 38%|███▊      | 256/669 [00:02<00:03, 124.91it/s] 40%|████      | 269/669 [00:02<00:03, 124.91it/s] 42%|████▏     | 282/669 [00:02<00:03, 124.93it/s] 44%|████▍     | 295/669 [00:02<00:02, 125.00it/s] 46%|████▌     | 308/669 [00:02<00:02, 124.91it/s] 48%|████▊     | 321/669 [00:02<00:02, 124.79it/s] 50%|████▉     | 334/669 [00:02<00:02, 124.89it/s] 52%|█████▏    | 347/669 [00:02<00:02, 125.00it/s] 54%|█████▍    | 360/669 [00:03<00:02, 125.11it/s] 56%|█████▌    | 373/669 [00:03<00:02, 125.08it/s] 58%|█████▊    | 386/669 [00:03<00:02, 125.02it/s] 60%|█████▉    | 399/669 [00:03<00:02, 125.09it/s] 62%|██████▏   | 412/669 [00:03<00:02, 125.05it/s] 64%|██████▎   | 425/669 [00:03<00:01, 124.98it/s] 65%|██████▌   | 438/669 [00:03<00:01, 125.03it/s] 67%|██████▋   | 451/669 [00:03<00:01, 125.02it/s] 69%|██████▉   | 464/669 [00:03<00:01, 124.97it/s] 71%|███████▏  | 477/669 [00:04<00:01, 125.03it/s] 73%|███████▎  | 490/669 [00:04<00:01, 125.04it/s] 75%|███████▌  | 503/669 [00:04<00:01, 124.99it/s] 77%|███████▋  | 516/669 [00:04<00:01, 125.02it/s] 79%|███████▉  | 529/669 [00:04<00:01, 125.05it/s] 81%|████████  | 542/669 [00:04<00:01, 124.99it/s] 83%|████████▎ | 555/669 [00:04<00:00, 125.05it/s] 85%|████████▍ | 568/669 [00:04<00:00, 124.96it/s] 87%|████████▋ | 581/669 [00:04<00:00, 124.96it/s] 89%|████████▉ | 594/669 [00:04<00:00, 125.00it/s] 91%|█████████ | 607/669 [00:05<00:00, 125.10it/s] 93%|█████████▎| 620/669 [00:05<00:00, 125.03it/s] 95%|█████████▍| 633/669 [00:05<00:00, 124.95it/s] 97%|█████████▋| 646/669 [00:05<00:00, 125.00it/s] 99%|█████████▊| 659/669 [00:05<00:00, 125.00it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.31it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 92.49it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 200.91it/s][A
 54%|█████▍    | 91/168 [00:00<00:00, 257.43it/s][A
 76%|███████▌  | 127/168 [00:00<00:00, 291.92it/s][A
 97%|█████████▋| 163/168 [00:00<00:00, 313.87it/s][A100%|██████████| 168/168 [00:00<00:00, 234.89it/s]
2022-10-22 07:06:17,093 P32353 INFO [Metrics] logloss: 0.551323 - AUC: 0.721224
2022-10-22 07:06:17,093 P32353 INFO Save best model: monitor(max): 0.169901
2022-10-22 07:06:17,266 P32353 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 100.64it/s]
2022-10-22 07:06:17,313 P32353 INFO Train loss: 0.629335
2022-10-22 07:06:17,313 P32353 INFO ************ Epoch=3 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:47,  6.19it/s]  2%|▏         | 14/669 [00:00<00:10, 62.79it/s]  3%|▎         | 22/669 [00:00<00:10, 63.31it/s]  5%|▌         | 35/669 [00:00<00:07, 84.51it/s]  7%|▋         | 48/669 [00:00<00:06, 97.45it/s]  9%|▉         | 61/669 [00:00<00:05, 106.11it/s] 11%|█         | 74/669 [00:00<00:05, 112.03it/s] 13%|█▎        | 87/669 [00:00<00:05, 114.68it/s] 15%|█▍        | 100/669 [00:01<00:04, 117.39it/s] 17%|█▋        | 113/669 [00:01<00:04, 118.85it/s] 19%|█▉        | 126/669 [00:01<00:04, 119.72it/s] 21%|██        | 139/669 [00:01<00:04, 120.50it/s] 23%|██▎       | 152/669 [00:01<00:04, 121.29it/s] 25%|██▍       | 165/669 [00:01<00:04, 121.42it/s] 27%|██▋       | 178/669 [00:01<00:04, 121.76it/s] 29%|██▊       | 191/669 [00:01<00:03, 122.35it/s] 30%|███       | 204/669 [00:01<00:03, 122.11it/s] 32%|███▏      | 217/669 [00:01<00:03, 122.36it/s] 34%|███▍      | 230/669 [00:02<00:03, 122.27it/s] 36%|███▋      | 243/669 [00:02<00:03, 122.15it/s] 38%|███▊      | 256/669 [00:02<00:03, 122.45it/s] 40%|████      | 269/669 [00:02<00:03, 122.46it/s] 42%|████▏     | 282/669 [00:02<00:03, 122.25it/s] 44%|████▍     | 295/669 [00:02<00:03, 122.59it/s] 46%|████▌     | 308/669 [00:02<00:02, 122.73it/s] 48%|████▊     | 321/669 [00:02<00:02, 122.29it/s] 50%|████▉     | 334/669 [00:02<00:02, 122.29it/s] 52%|█████▏    | 347/669 [00:03<00:02, 122.53it/s] 54%|█████▍    | 360/669 [00:03<00:02, 122.03it/s] 56%|█████▌    | 373/669 [00:03<00:02, 122.18it/s] 58%|█████▊    | 386/669 [00:03<00:02, 122.10it/s] 60%|█████▉    | 399/669 [00:03<00:02, 121.61it/s] 62%|██████▏   | 412/669 [00:03<00:02, 122.34it/s] 64%|██████▎   | 425/669 [00:03<00:01, 122.28it/s] 65%|██████▌   | 438/669 [00:03<00:01, 122.14it/s] 67%|██████▋   | 451/669 [00:03<00:01, 122.48it/s] 69%|██████▉   | 464/669 [00:03<00:01, 123.28it/s] 71%|███████▏  | 477/669 [00:04<00:01, 124.06it/s] 73%|███████▎  | 490/669 [00:04<00:01, 124.89it/s] 75%|███████▌  | 503/669 [00:04<00:01, 125.70it/s] 77%|███████▋  | 516/669 [00:04<00:01, 126.11it/s] 79%|███████▉  | 529/669 [00:04<00:01, 126.32it/s] 81%|████████  | 542/669 [00:04<00:01, 126.56it/s] 83%|████████▎ | 555/669 [00:04<00:00, 126.40it/s] 85%|████████▍ | 568/669 [00:04<00:00, 126.36it/s] 87%|████████▋ | 581/669 [00:04<00:00, 126.21it/s] 89%|████████▉ | 594/669 [00:05<00:00, 126.53it/s] 91%|█████████ | 607/669 [00:05<00:00, 126.63it/s] 93%|█████████▎| 620/669 [00:05<00:00, 126.53it/s] 95%|█████████▍| 633/669 [00:05<00:00, 126.73it/s] 97%|█████████▋| 646/669 [00:05<00:00, 126.61it/s] 99%|█████████▊| 659/669 [00:05<00:00, 126.44it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.77it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 96.36it/s][A
 32%|███▏      | 54/168 [00:00<00:00, 203.38it/s][A
 54%|█████▎    | 90/168 [00:00<00:00, 260.82it/s][A
 75%|███████▌  | 126/168 [00:00<00:00, 294.64it/s][A
 96%|█████████▋| 162/168 [00:00<00:00, 315.64it/s][A100%|██████████| 168/168 [00:00<00:00, 244.80it/s]
2022-10-22 07:06:23,759 P32353 INFO [Metrics] logloss: 0.547477 - AUC: 0.724458
2022-10-22 07:06:23,760 P32353 INFO Save best model: monitor(max): 0.176981
2022-10-22 07:06:23,979 P32353 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 99.63it/s] 
2022-10-22 07:06:24,028 P32353 INFO Train loss: 0.623480
2022-10-22 07:06:24,028 P32353 INFO ************ Epoch=4 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:50,  6.03it/s]  2%|▏         | 14/669 [00:00<00:10, 61.64it/s]  3%|▎         | 22/669 [00:00<00:10, 62.23it/s]  5%|▌         | 35/669 [00:00<00:07, 83.77it/s]  7%|▋         | 48/669 [00:00<00:06, 96.96it/s]  9%|▉         | 61/669 [00:00<00:05, 105.35it/s] 11%|█         | 74/669 [00:00<00:05, 111.09it/s] 13%|█▎        | 87/669 [00:00<00:05, 114.92it/s] 15%|█▍        | 100/669 [00:01<00:04, 117.36it/s] 17%|█▋        | 113/669 [00:01<00:04, 119.29it/s] 19%|█▉        | 126/669 [00:01<00:04, 120.40it/s] 21%|██        | 139/669 [00:01<00:04, 121.28it/s] 23%|██▎       | 152/669 [00:01<00:04, 122.08it/s] 25%|██▍       | 165/669 [00:01<00:04, 122.29it/s] 27%|██▋       | 178/669 [00:01<00:04, 122.56it/s] 29%|██▊       | 191/669 [00:01<00:03, 122.78it/s] 30%|███       | 204/669 [00:01<00:03, 122.80it/s] 32%|███▏      | 217/669 [00:01<00:03, 123.12it/s] 34%|███▍      | 230/669 [00:02<00:03, 123.27it/s] 36%|███▋      | 243/669 [00:02<00:03, 123.24it/s] 38%|███▊      | 256/669 [00:02<00:03, 123.18it/s] 40%|████      | 269/669 [00:02<00:03, 123.11it/s] 42%|████▏     | 282/669 [00:02<00:03, 122.91it/s] 44%|████▍     | 295/669 [00:02<00:03, 122.66it/s] 46%|████▌     | 308/669 [00:02<00:02, 122.75it/s] 48%|████▊     | 321/669 [00:02<00:02, 122.64it/s] 50%|████▉     | 334/669 [00:02<00:02, 122.82it/s] 52%|█████▏    | 347/669 [00:03<00:02, 122.79it/s] 54%|█████▍    | 360/669 [00:03<00:02, 122.82it/s] 56%|█████▌    | 373/669 [00:03<00:02, 122.68it/s] 58%|█████▊    | 386/669 [00:03<00:02, 122.83it/s] 60%|█████▉    | 399/669 [00:03<00:02, 123.06it/s] 62%|██████▏   | 412/669 [00:03<00:02, 122.95it/s] 64%|██████▎   | 425/669 [00:03<00:01, 123.20it/s] 65%|██████▌   | 438/669 [00:03<00:01, 123.13it/s] 67%|██████▋   | 451/669 [00:03<00:01, 123.14it/s] 69%|██████▉   | 464/669 [00:03<00:01, 123.33it/s] 71%|███████▏  | 477/669 [00:04<00:01, 123.29it/s] 73%|███████▎  | 490/669 [00:04<00:01, 123.23it/s] 75%|███████▌  | 503/669 [00:04<00:01, 123.26it/s] 77%|███████▋  | 516/669 [00:04<00:01, 123.23it/s] 79%|███████▉  | 529/669 [00:04<00:01, 123.18it/s] 81%|████████  | 542/669 [00:04<00:01, 123.14it/s] 83%|████████▎ | 555/669 [00:04<00:00, 123.04it/s] 85%|████████▍ | 568/669 [00:04<00:00, 123.07it/s] 87%|████████▋ | 581/669 [00:04<00:00, 123.06it/s] 89%|████████▉ | 594/669 [00:05<00:00, 122.85it/s] 91%|█████████ | 607/669 [00:05<00:00, 122.74it/s] 93%|█████████▎| 620/669 [00:05<00:00, 122.93it/s] 95%|█████████▍| 633/669 [00:05<00:00, 122.77it/s] 97%|█████████▋| 646/669 [00:05<00:00, 122.89it/s] 99%|█████████▊| 659/669 [00:05<00:00, 122.94it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.81it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 83.47it/s][A
 28%|██▊       | 47/168 [00:00<00:00, 158.07it/s][A
 49%|████▉     | 82/168 [00:00<00:00, 224.56it/s][A
 70%|██████▉   | 117/168 [00:00<00:00, 266.23it/s][A
 91%|█████████ | 153/168 [00:00<00:00, 294.91it/s][A100%|██████████| 168/168 [00:00<00:00, 220.85it/s]
2022-10-22 07:06:30,588 P32353 INFO [Metrics] logloss: 0.547752 - AUC: 0.723185
2022-10-22 07:06:30,589 P32353 INFO Monitor(max) STOP: 0.175434 !
2022-10-22 07:06:30,589 P32353 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 07:06:30,589 P32353 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 101.25it/s]
2022-10-22 07:06:30,636 P32353 INFO Train loss: 0.629611
2022-10-22 07:06:30,637 P32353 INFO ************ Epoch=5 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:46,  6.28it/s]  2%|▏         | 14/669 [00:00<00:10, 63.42it/s]  3%|▎         | 22/669 [00:00<00:10, 63.56it/s]  5%|▌         | 35/669 [00:00<00:07, 84.71it/s]  7%|▋         | 48/669 [00:00<00:06, 97.65it/s]  9%|▉         | 61/669 [00:00<00:05, 106.00it/s] 11%|█         | 74/669 [00:00<00:05, 111.56it/s] 13%|█▎        | 87/669 [00:00<00:05, 115.12it/s] 15%|█▍        | 100/669 [00:01<00:04, 117.45it/s] 17%|█▋        | 113/669 [00:01<00:04, 119.30it/s] 19%|█▉        | 126/669 [00:01<00:04, 120.71it/s] 21%|██        | 139/669 [00:01<00:04, 121.51it/s] 23%|██▎       | 152/669 [00:01<00:04, 122.12it/s] 25%|██▍       | 165/669 [00:01<00:04, 122.68it/s] 27%|██▋       | 178/669 [00:01<00:03, 122.77it/s] 29%|██▊       | 191/669 [00:01<00:03, 122.98it/s] 30%|███       | 204/669 [00:01<00:03, 123.25it/s] 32%|███▏      | 217/669 [00:01<00:03, 123.42it/s] 34%|███▍      | 230/669 [00:02<00:03, 123.41it/s] 36%|███▋      | 243/669 [00:02<00:03, 123.50it/s] 38%|███▊      | 256/669 [00:02<00:03, 123.62it/s] 40%|████      | 269/669 [00:02<00:03, 123.60it/s] 42%|████▏     | 282/669 [00:02<00:03, 123.44it/s] 44%|████▍     | 295/669 [00:02<00:03, 123.52it/s] 46%|████▌     | 308/669 [00:02<00:02, 123.57it/s] 48%|████▊     | 321/669 [00:02<00:02, 123.58it/s] 50%|████▉     | 334/669 [00:02<00:02, 123.59it/s] 52%|█████▏    | 347/669 [00:03<00:02, 123.56it/s] 54%|█████▍    | 360/669 [00:03<00:02, 123.63it/s] 56%|█████▌    | 373/669 [00:03<00:02, 123.64it/s] 58%|█████▊    | 386/669 [00:03<00:02, 123.85it/s] 60%|█████▉    | 399/669 [00:03<00:02, 123.79it/s] 62%|██████▏   | 412/669 [00:03<00:02, 123.68it/s] 64%|██████▎   | 425/669 [00:03<00:01, 123.65it/s] 65%|██████▌   | 438/669 [00:03<00:01, 123.76it/s] 67%|██████▋   | 451/669 [00:03<00:01, 123.65it/s] 69%|██████▉   | 464/669 [00:03<00:01, 123.68it/s] 71%|███████▏  | 477/669 [00:04<00:01, 123.74it/s] 73%|███████▎  | 490/669 [00:04<00:01, 123.79it/s] 75%|███████▌  | 503/669 [00:04<00:01, 123.69it/s] 77%|███████▋  | 516/669 [00:04<00:01, 123.71it/s] 79%|███████▉  | 529/669 [00:04<00:01, 124.39it/s] 81%|████████  | 542/669 [00:04<00:01, 125.34it/s] 83%|████████▎ | 555/669 [00:04<00:00, 125.86it/s] 85%|████████▍ | 568/669 [00:04<00:00, 125.96it/s] 87%|████████▋ | 581/669 [00:04<00:00, 126.22it/s] 89%|████████▉ | 594/669 [00:05<00:00, 126.55it/s] 91%|█████████ | 607/669 [00:05<00:00, 126.50it/s] 93%|█████████▎| 620/669 [00:05<00:00, 126.47it/s] 95%|█████████▍| 633/669 [00:05<00:00, 126.80it/s] 97%|█████████▋| 646/669 [00:05<00:00, 126.67it/s] 99%|█████████▊| 659/669 [00:05<00:00, 126.55it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  2%|▏         | 3/168 [00:00<00:06, 26.84it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 92.16it/s][A
 32%|███▏      | 53/168 [00:00<00:00, 195.75it/s][A
 52%|█████▏    | 87/168 [00:00<00:00, 249.77it/s][A
 73%|███████▎  | 122/168 [00:00<00:00, 283.33it/s][A
 93%|█████████▎| 157/168 [00:00<00:00, 304.10it/s][A100%|██████████| 168/168 [00:00<00:00, 237.42it/s]
2022-10-22 07:06:37,081 P32353 INFO [Metrics] logloss: 0.540309 - AUC: 0.738543
2022-10-22 07:06:37,082 P32353 INFO Save best model: monitor(max): 0.198234
2022-10-22 07:06:37,249 P32353 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 100.48it/s]
2022-10-22 07:06:37,295 P32353 INFO Train loss: 0.552522
2022-10-22 07:06:37,296 P32353 INFO ************ Epoch=6 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:48,  6.16it/s]  2%|▏         | 13/669 [00:00<00:11, 59.43it/s]  3%|▎         | 21/669 [00:00<00:10, 60.23it/s]  5%|▌         | 34/669 [00:00<00:07, 81.67it/s]  7%|▋         | 46/669 [00:00<00:06, 93.91it/s]  9%|▊         | 58/669 [00:00<00:05, 101.95it/s] 10%|█         | 70/669 [00:00<00:05, 107.39it/s] 12%|█▏        | 83/669 [00:00<00:05, 111.66it/s] 14%|█▍        | 95/669 [00:01<00:05, 114.11it/s] 16%|█▌        | 108/669 [00:01<00:04, 115.79it/s] 18%|█▊        | 121/669 [00:01<00:04, 117.23it/s] 20%|██        | 134/669 [00:01<00:04, 118.21it/s] 22%|██▏       | 146/669 [00:01<00:04, 118.57it/s] 24%|██▎       | 158/669 [00:01<00:04, 118.82it/s] 25%|██▌       | 170/669 [00:01<00:04, 119.12it/s] 27%|██▋       | 182/669 [00:01<00:04, 114.74it/s] 29%|██▉       | 194/669 [00:01<00:04, 115.88it/s] 31%|███       | 206/669 [00:01<00:03, 116.97it/s] 33%|███▎      | 219/669 [00:02<00:03, 117.74it/s] 35%|███▍      | 231/669 [00:02<00:03, 118.37it/s] 36%|███▋      | 243/669 [00:02<00:03, 118.83it/s] 38%|███▊      | 256/669 [00:02<00:03, 119.37it/s] 40%|████      | 268/669 [00:02<00:03, 119.51it/s] 42%|████▏     | 281/669 [00:02<00:03, 119.80it/s] 44%|████▍     | 293/669 [00:02<00:03, 119.83it/s] 46%|████▌     | 305/669 [00:02<00:03, 119.82it/s] 47%|████▋     | 317/669 [00:02<00:02, 119.73it/s] 49%|████▉     | 329/669 [00:02<00:02, 119.79it/s] 51%|█████     | 342/669 [00:03<00:02, 119.66it/s] 53%|█████▎    | 354/669 [00:03<00:02, 119.74it/s] 55%|█████▍    | 366/669 [00:03<00:02, 119.77it/s] 57%|█████▋    | 378/669 [00:03<00:02, 119.78it/s] 58%|█████▊    | 391/669 [00:03<00:02, 120.01it/s] 60%|██████    | 404/669 [00:03<00:02, 120.11it/s] 62%|██████▏   | 417/669 [00:03<00:02, 119.82it/s] 64%|██████▍   | 429/669 [00:03<00:02, 119.86it/s] 66%|██████▌   | 442/669 [00:03<00:01, 120.03it/s] 68%|██████▊   | 455/669 [00:04<00:01, 121.23it/s] 70%|██████▉   | 468/669 [00:04<00:01, 122.15it/s] 72%|███████▏  | 481/669 [00:04<00:01, 122.54it/s] 74%|███████▍  | 494/669 [00:04<00:01, 122.52it/s] 76%|███████▌  | 507/669 [00:04<00:01, 123.04it/s] 78%|███████▊  | 520/669 [00:04<00:01, 123.38it/s] 80%|███████▉  | 533/669 [00:04<00:01, 123.51it/s] 82%|████████▏ | 546/669 [00:04<00:01, 113.29it/s] 84%|████████▎ | 559/669 [00:04<00:00, 116.22it/s] 86%|████████▌ | 572/669 [00:05<00:00, 118.59it/s] 87%|████████▋ | 585/669 [00:05<00:00, 120.25it/s] 89%|████████▉ | 598/669 [00:05<00:00, 121.33it/s] 91%|█████████▏| 611/669 [00:05<00:00, 122.01it/s] 93%|█████████▎| 624/669 [00:05<00:00, 122.53it/s] 95%|█████████▌| 637/669 [00:05<00:00, 123.14it/s] 97%|█████████▋| 650/669 [00:05<00:00, 123.62it/s] 99%|█████████▉| 663/669 [00:05<00:00, 121.35it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.50it/s][A
 10%|▉         | 16/168 [00:00<00:01, 80.14it/s][A
 30%|██▉       | 50/168 [00:00<00:00, 189.52it/s][A
 51%|█████     | 86/168 [00:00<00:00, 251.18it/s][A
 73%|███████▎  | 122/168 [00:00<00:00, 287.25it/s][A
 94%|█████████▍| 158/168 [00:00<00:00, 310.01it/s][A100%|██████████| 168/168 [00:00<00:00, 236.13it/s]
2022-10-22 07:06:43,933 P32353 INFO [Metrics] logloss: 0.547179 - AUC: 0.737355
2022-10-22 07:06:43,933 P32353 INFO Monitor(max) STOP: 0.190176 !
2022-10-22 07:06:43,933 P32353 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 07:06:43,934 P32353 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 99.98it/s] 
2022-10-22 07:06:43,988 P32353 INFO Train loss: 0.509777
2022-10-22 07:06:43,988 P32353 INFO ************ Epoch=7 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:47,  6.21it/s]  2%|▏         | 14/669 [00:00<00:10, 62.73it/s]  3%|▎         | 22/669 [00:00<00:10, 63.44it/s]  5%|▌         | 35/669 [00:00<00:07, 84.83it/s]  7%|▋         | 48/669 [00:00<00:06, 98.09it/s]  9%|▉         | 61/669 [00:00<00:05, 106.69it/s] 11%|█         | 74/669 [00:00<00:05, 112.42it/s] 13%|█▎        | 87/669 [00:00<00:05, 116.22it/s] 15%|█▍        | 100/669 [00:01<00:04, 118.54it/s] 17%|█▋        | 113/669 [00:01<00:04, 120.19it/s] 19%|█▉        | 126/669 [00:01<00:04, 121.32it/s] 21%|██        | 139/669 [00:01<00:04, 122.38it/s] 23%|██▎       | 152/669 [00:01<00:04, 123.04it/s] 25%|██▍       | 165/669 [00:01<00:04, 123.60it/s] 27%|██▋       | 178/669 [00:01<00:03, 124.03it/s] 29%|██▊       | 191/669 [00:01<00:03, 124.26it/s] 30%|███       | 204/669 [00:01<00:03, 124.30it/s] 32%|███▏      | 217/669 [00:01<00:03, 124.15it/s] 34%|███▍      | 230/669 [00:02<00:03, 124.13it/s] 36%|███▋      | 243/669 [00:02<00:03, 124.16it/s] 38%|███▊      | 256/669 [00:02<00:03, 124.26it/s] 40%|████      | 269/669 [00:02<00:03, 124.28it/s] 42%|████▏     | 282/669 [00:02<00:03, 124.30it/s] 44%|████▍     | 295/669 [00:02<00:03, 123.96it/s] 46%|████▌     | 308/669 [00:02<00:02, 123.99it/s] 48%|████▊     | 321/669 [00:02<00:02, 124.11it/s] 50%|████▉     | 334/669 [00:02<00:02, 124.29it/s] 52%|█████▏    | 347/669 [00:03<00:02, 124.44it/s] 54%|█████▍    | 360/669 [00:03<00:02, 124.52it/s] 56%|█████▌    | 373/669 [00:03<00:02, 124.60it/s] 58%|█████▊    | 386/669 [00:03<00:02, 124.67it/s] 60%|█████▉    | 399/669 [00:03<00:02, 124.49it/s] 62%|██████▏   | 412/669 [00:03<00:02, 124.38it/s] 64%|██████▎   | 425/669 [00:03<00:01, 124.43it/s] 65%|██████▌   | 438/669 [00:03<00:01, 124.34it/s] 67%|██████▋   | 451/669 [00:03<00:01, 124.37it/s] 69%|██████▉   | 464/669 [00:03<00:01, 124.46it/s] 71%|███████▏  | 477/669 [00:04<00:01, 124.57it/s] 73%|███████▎  | 490/669 [00:04<00:01, 124.64it/s] 75%|███████▌  | 503/669 [00:04<00:01, 124.72it/s] 77%|███████▋  | 516/669 [00:04<00:01, 124.73it/s] 79%|███████▉  | 529/669 [00:04<00:01, 124.65it/s] 81%|████████  | 542/669 [00:04<00:01, 115.48it/s] 83%|████████▎ | 555/669 [00:04<00:00, 117.92it/s] 85%|████████▍ | 568/669 [00:04<00:00, 119.73it/s] 87%|████████▋ | 581/669 [00:04<00:00, 121.03it/s] 89%|████████▉ | 594/669 [00:05<00:00, 122.03it/s] 91%|█████████ | 607/669 [00:05<00:00, 122.88it/s] 93%|█████████▎| 620/669 [00:05<00:00, 123.50it/s] 95%|█████████▍| 633/669 [00:05<00:00, 123.84it/s] 97%|█████████▋| 646/669 [00:05<00:00, 124.08it/s] 99%|█████████▊| 659/669 [00:05<00:00, 124.28it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:16,  9.95it/s][A
 10%|▉         | 16/168 [00:00<00:01, 78.21it/s][A
 27%|██▋       | 45/168 [00:00<00:00, 164.03it/s][A
 46%|████▌     | 77/168 [00:00<00:00, 221.20it/s][A
 65%|██████▌   | 110/168 [00:00<00:00, 256.51it/s][A
 85%|████████▌ | 143/168 [00:00<00:00, 278.92it/s][A100%|██████████| 168/168 [00:00<00:00, 220.48it/s]
2022-10-22 07:06:50,509 P32353 INFO [Metrics] logloss: 0.578225 - AUC: 0.735248
2022-10-22 07:06:50,510 P32353 INFO Monitor(max) STOP: 0.157023 !
2022-10-22 07:06:50,510 P32353 INFO Reduce learning rate on plateau: 0.000001
2022-10-22 07:06:50,510 P32353 INFO Early stopping at epoch=8
2022-10-22 07:06:50,510 P32353 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:06<00:00, 101.60it/s]
2022-10-22 07:06:50,564 P32353 INFO Train loss: 0.435859
2022-10-22 07:06:50,564 P32353 INFO Training finished.
2022-10-22 07:06:50,564 P32353 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_015_8d7237a7.model
2022-10-22 07:06:50,657 P32353 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:56,  5.74it/s]  2%|▏         | 16/669 [00:00<00:09, 65.86it/s]  8%|▊         | 52/669 [00:00<00:03, 174.41it/s] 13%|█▎        | 87/669 [00:00<00:02, 235.07it/s] 18%|█▊        | 123/669 [00:00<00:01, 274.33it/s] 24%|██▍       | 159/669 [00:00<00:01, 300.00it/s] 29%|██▉       | 195/669 [00:00<00:01, 316.74it/s] 35%|███▍      | 231/669 [00:00<00:01, 327.28it/s] 40%|███▉      | 267/669 [00:01<00:01, 334.50it/s] 45%|████▌     | 302/669 [00:01<00:01, 337.07it/s] 50%|█████     | 337/669 [00:01<00:00, 340.51it/s] 56%|█████▌    | 373/669 [00:01<00:00, 343.46it/s] 61%|██████    | 409/669 [00:01<00:00, 345.86it/s] 66%|██████▋   | 444/669 [00:01<00:00, 346.52it/s] 72%|███████▏  | 479/669 [00:01<00:00, 346.86it/s] 77%|███████▋  | 514/669 [00:01<00:00, 347.50it/s] 82%|████████▏ | 549/669 [00:01<00:00, 347.74it/s] 87%|████████▋ | 584/669 [00:01<00:00, 348.26it/s] 93%|█████████▎| 620/669 [00:02<00:00, 348.97it/s] 98%|█████████▊| 655/669 [00:02<00:00, 348.74it/s]100%|██████████| 669/669 [00:02<00:00, 301.77it/s]
2022-10-22 07:06:53,452 P32353 INFO [Metrics] logloss: 0.460927 - AUC: 0.831406
  0%|          | 0/168 [00:00<?, ?it/s]  1%|          | 1/168 [00:00<00:17,  9.80it/s]  9%|▉         | 15/168 [00:00<00:02, 71.47it/s] 13%|█▎        | 22/168 [00:00<00:02, 70.66it/s] 30%|███       | 51/168 [00:00<00:00, 150.60it/s] 48%|████▊     | 80/168 [00:00<00:00, 197.01it/s] 68%|██████▊   | 114/168 [00:00<00:00, 242.93it/s] 89%|████████▉ | 150/168 [00:00<00:00, 279.59it/s]100%|██████████| 168/168 [00:00<00:00, 201.96it/s]
2022-10-22 07:06:54,422 P32353 INFO [Metrics] logloss: 0.540309 - AUC: 0.738543
2022-10-22 07:06:54,498 P32353 INFO ******** Test evaluation ********
2022-10-22 07:06:54,498 P32353 INFO Loading data...
2022-10-22 07:06:54,501 P32353 INFO Loading test data done.
2022-10-22 07:06:58,641 P36148 INFO {
    "batch_norm": "False",
    "batch_size": "1024",
    "data_format": "csv",
    "data_root": "../data/",
    "dataset_id": "yelp_no_feature_3d3ae056",
    "debug": "False",
    "embedding_dim": "8",
    "embedding_regularizer": "0.01",
    "epochs": "50",
    "every_x_epochs": "1",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['user_id', 'business_id'], 'type': 'categorical'}]",
    "gpu": "0",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'target'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DeepFM",
    "model_id": "DeepFM_yelp_no_feature_016_fbdc55c7",
    "model_root": "../models/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_dropout": "0.03",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "patience": "2",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "train_data": "../data/train.csv",
    "use_hdf5": "True",
    "valid_data": "../data/valid.csv",
    "verbose": "1",
    "version": "pytorch"
}
2022-10-22 07:06:58,642 P36148 INFO Set up feature encoder...
2022-10-22 07:06:58,643 P36148 INFO Load feature_map from json: ../data/yelp_no_feature_3d3ae056/feature_map.json
2022-10-22 07:06:58,644 P36148 INFO Loading data...
2022-10-22 07:06:58,648 P36148 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/train.h5
2022-10-22 07:06:58,746 P36148 INFO Loading data from h5: ../data/yelp_no_feature_3d3ae056/valid.h5
2022-10-22 07:06:58,780 P36148 INFO Train samples: total/684064, pos/472869, neg/211195, ratio/69.13%, blocks/1
2022-10-22 07:06:58,780 P36148 INFO Validation samples: total/171016, pos/118244, neg/52772, ratio/69.14%, blocks/1
2022-10-22 07:06:58,780 P36148 INFO Loading train data done.
2022-10-22 07:07:01,245 P36148 INFO Total number of parameters: 2354288.
2022-10-22 07:07:01,246 P36148 INFO Start training: 669 batches/epoch
2022-10-22 07:07:01,246 P36148 INFO ************ Epoch=1 start ************
  0%|          | 0/669 [00:00<?, ?it/s][2022-10-22 07:07:01.582 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:36148 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2022-10-22 07:07:01.615 pytorch-1-8-gpu-p-ml-g4dn-16xlarge-bbc9fe4ddef20be8f6dec3a6fd9c:36148 INFO profiler_config_parser.py:102] Unable to find config at /opt/ml/input/config/profilerconfig.json. Profiler is disabled.
  0%|          | 1/669 [00:01<12:22,  1.11s/it]  2%|▏         | 14/669 [00:01<00:42, 15.47it/s]  3%|▎         | 22/669 [00:01<00:27, 23.62it/s]  5%|▌         | 35/669 [00:01<00:15, 40.26it/s]  7%|▋         | 48/669 [00:01<00:11, 56.43it/s]  9%|▉         | 61/669 [00:01<00:08, 71.40it/s] 11%|█         | 74/669 [00:01<00:07, 84.64it/s] 13%|█▎        | 88/669 [00:01<00:06, 96.58it/s] 15%|█▌        | 102/669 [00:01<00:05, 106.46it/s] 17%|█▋        | 116/669 [00:02<00:04, 113.86it/s] 19%|█▉        | 130/669 [00:02<00:04, 119.46it/s] 22%|██▏       | 144/669 [00:02<00:04, 124.05it/s] 24%|██▎       | 158/669 [00:02<00:04, 127.08it/s] 26%|██▌       | 172/669 [00:02<00:03, 129.46it/s] 28%|██▊       | 186/669 [00:02<00:03, 131.32it/s] 30%|██▉       | 200/669 [00:02<00:03, 132.85it/s] 32%|███▏      | 214/669 [00:02<00:03, 133.67it/s] 34%|███▍      | 228/669 [00:02<00:03, 134.20it/s] 36%|███▌      | 242/669 [00:03<00:03, 134.71it/s] 38%|███▊      | 256/669 [00:03<00:03, 135.35it/s] 40%|████      | 270/669 [00:03<00:02, 135.93it/s] 42%|████▏     | 284/669 [00:03<00:02, 136.05it/s] 45%|████▍     | 298/669 [00:03<00:02, 136.01it/s] 47%|████▋     | 312/669 [00:03<00:02, 136.19it/s] 49%|████▊     | 326/669 [00:03<00:02, 136.19it/s] 51%|█████     | 340/669 [00:03<00:02, 136.00it/s] 53%|█████▎    | 354/669 [00:03<00:02, 136.07it/s] 55%|█████▌    | 368/669 [00:03<00:02, 136.16it/s] 57%|█████▋    | 382/669 [00:04<00:02, 136.03it/s] 59%|█████▉    | 396/669 [00:04<00:02, 136.04it/s] 61%|██████▏   | 410/669 [00:04<00:01, 136.27it/s] 63%|██████▎   | 424/669 [00:04<00:01, 136.13it/s] 65%|██████▌   | 438/669 [00:04<00:01, 135.90it/s] 68%|██████▊   | 452/669 [00:04<00:01, 135.83it/s] 70%|██████▉   | 466/669 [00:04<00:01, 135.99it/s] 72%|███████▏  | 480/669 [00:04<00:01, 135.92it/s] 74%|███████▍  | 494/669 [00:04<00:01, 135.91it/s] 76%|███████▌  | 508/669 [00:04<00:01, 136.15it/s] 78%|███████▊  | 522/669 [00:05<00:01, 136.02it/s] 80%|████████  | 536/669 [00:05<00:00, 135.97it/s] 82%|████████▏ | 550/669 [00:05<00:00, 123.49it/s] 84%|████████▍ | 564/669 [00:05<00:00, 127.67it/s] 86%|████████▋ | 578/669 [00:05<00:00, 129.82it/s] 88%|████████▊ | 592/669 [00:05<00:00, 131.40it/s] 91%|█████████ | 606/669 [00:05<00:00, 132.89it/s] 93%|█████████▎| 620/669 [00:05<00:00, 133.78it/s] 95%|█████████▍| 634/669 [00:05<00:00, 133.62it/s] 97%|█████████▋| 648/669 [00:06<00:00, 134.16it/s] 99%|█████████▉| 662/669 [00:06<00:00, 134.02it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:18,  9.26it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 91.54it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 200.76it/s][A
 54%|█████▍    | 91/168 [00:00<00:00, 258.14it/s][A
 76%|███████▌  | 128/168 [00:00<00:00, 294.29it/s][A
 96%|█████████▌| 161/168 [00:00<00:00, 305.41it/s][A100%|██████████| 168/168 [00:00<00:00, 237.31it/s]
2022-10-22 07:07:08,279 P36148 INFO [Metrics] logloss: 0.562584 - AUC: 0.710138
2022-10-22 07:07:08,280 P36148 INFO Save best model: monitor(max): 0.147554
2022-10-22 07:07:08,397 P36148 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:07<00:00, 93.09it/s] 
2022-10-22 07:07:08,435 P36148 INFO Train loss: 0.628319
2022-10-22 07:07:08,435 P36148 INFO ************ Epoch=1 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:49,  6.12it/s]  2%|▏         | 14/669 [00:00<00:10, 62.00it/s]  3%|▎         | 22/669 [00:00<00:11, 57.33it/s]  5%|▌         | 35/669 [00:00<00:07, 79.70it/s]  7%|▋         | 48/669 [00:00<00:06, 94.49it/s]  9%|▉         | 61/669 [00:00<00:05, 105.21it/s] 11%|█         | 75/669 [00:00<00:05, 113.17it/s] 13%|█▎        | 89/669 [00:00<00:04, 118.77it/s] 15%|█▌        | 103/669 [00:01<00:04, 122.66it/s] 17%|█▋        | 117/669 [00:01<00:04, 125.40it/s] 20%|█▉        | 131/669 [00:01<00:04, 127.61it/s] 22%|██▏       | 145/669 [00:01<00:04, 129.10it/s] 24%|██▍       | 159/669 [00:01<00:03, 130.12it/s] 26%|██▌       | 173/669 [00:01<00:03, 130.69it/s] 28%|██▊       | 187/669 [00:01<00:03, 131.28it/s] 30%|███       | 201/669 [00:01<00:03, 131.64it/s] 32%|███▏      | 215/669 [00:01<00:03, 131.98it/s] 34%|███▍      | 229/669 [00:02<00:03, 132.12it/s] 36%|███▋      | 243/669 [00:02<00:03, 132.29it/s] 38%|███▊      | 257/669 [00:02<00:03, 132.42it/s] 41%|████      | 271/669 [00:02<00:03, 132.48it/s] 43%|████▎     | 285/669 [00:02<00:02, 132.53it/s] 45%|████▍     | 299/669 [00:02<00:02, 132.52it/s] 47%|████▋     | 313/669 [00:02<00:02, 132.63it/s] 49%|████▉     | 327/669 [00:02<00:02, 132.67it/s] 51%|█████     | 341/669 [00:02<00:02, 132.59it/s] 53%|█████▎    | 355/669 [00:02<00:02, 132.53it/s] 55%|█████▌    | 369/669 [00:03<00:02, 132.31it/s] 57%|█████▋    | 383/669 [00:03<00:02, 132.03it/s] 59%|█████▉    | 397/669 [00:03<00:02, 132.06it/s] 61%|██████▏   | 411/669 [00:03<00:01, 132.19it/s] 64%|██████▎   | 425/669 [00:03<00:01, 132.32it/s] 66%|██████▌   | 439/669 [00:03<00:01, 132.60it/s] 68%|██████▊   | 453/669 [00:03<00:01, 132.55it/s] 70%|██████▉   | 467/669 [00:03<00:01, 132.40it/s] 72%|███████▏  | 481/669 [00:03<00:01, 132.41it/s] 74%|███████▍  | 495/669 [00:04<00:01, 132.53it/s] 76%|███████▌  | 509/669 [00:04<00:01, 132.62it/s] 78%|███████▊  | 523/669 [00:04<00:01, 132.60it/s] 80%|████████  | 537/669 [00:04<00:00, 132.64it/s] 82%|████████▏ | 551/669 [00:04<00:00, 122.61it/s] 84%|████████▍ | 565/669 [00:04<00:00, 125.34it/s] 87%|████████▋ | 579/669 [00:04<00:00, 127.53it/s] 89%|████████▊ | 593/669 [00:04<00:00, 128.99it/s] 91%|█████████ | 607/669 [00:04<00:00, 130.10it/s] 93%|█████████▎| 621/669 [00:04<00:00, 130.75it/s] 95%|█████████▍| 635/669 [00:05<00:00, 131.12it/s] 97%|█████████▋| 649/669 [00:05<00:00, 131.59it/s] 99%|█████████▉| 663/669 [00:05<00:00, 129.83it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 2/168 [00:00<00:08, 19.41it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 76.96it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 181.10it/s][A
 54%|█████▍    | 91/168 [00:00<00:00, 240.90it/s][A
 76%|███████▌  | 127/168 [00:00<00:00, 278.83it/s][A
 98%|█████████▊| 164/168 [00:00<00:00, 306.06it/s][A100%|██████████| 168/168 [00:00<00:00, 224.49it/s]
2022-10-22 07:07:14,675 P36148 INFO [Metrics] logloss: 0.551358 - AUC: 0.718674
2022-10-22 07:07:14,675 P36148 INFO Save best model: monitor(max): 0.167316
2022-10-22 07:07:14,816 P36148 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 103.98it/s]
2022-10-22 07:07:14,870 P36148 INFO Train loss: 0.622568
2022-10-22 07:07:14,870 P36148 INFO ************ Epoch=2 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:54,  5.85it/s]  2%|▏         | 14/669 [00:00<00:10, 61.94it/s]  3%|▎         | 22/669 [00:00<00:10, 63.23it/s]  5%|▌         | 35/669 [00:00<00:07, 85.13it/s]  7%|▋         | 48/669 [00:00<00:06, 98.74it/s]  9%|▉         | 62/669 [00:00<00:05, 109.16it/s] 11%|█▏        | 76/669 [00:00<00:05, 115.99it/s] 13%|█▎        | 90/669 [00:00<00:04, 121.16it/s] 16%|█▌        | 104/669 [00:01<00:04, 125.01it/s] 18%|█▊        | 118/669 [00:01<00:04, 128.16it/s] 20%|█▉        | 132/669 [00:01<00:04, 130.16it/s] 22%|██▏       | 146/669 [00:01<00:03, 131.63it/s] 24%|██▍       | 160/669 [00:01<00:03, 133.10it/s] 26%|██▌       | 174/669 [00:01<00:03, 133.76it/s] 28%|██▊       | 188/669 [00:01<00:03, 134.20it/s] 30%|███       | 202/669 [00:01<00:03, 134.61it/s] 32%|███▏      | 216/669 [00:01<00:03, 135.13it/s] 34%|███▍      | 230/669 [00:01<00:03, 135.23it/s] 36%|███▋      | 244/669 [00:02<00:03, 135.28it/s] 39%|███▊      | 258/669 [00:02<00:03, 135.61it/s] 41%|████      | 272/669 [00:02<00:02, 135.69it/s] 43%|████▎     | 286/669 [00:02<00:02, 135.55it/s] 45%|████▍     | 300/669 [00:02<00:02, 135.57it/s] 47%|████▋     | 314/669 [00:02<00:02, 135.70it/s] 49%|████▉     | 328/669 [00:02<00:02, 135.34it/s] 51%|█████     | 342/669 [00:02<00:02, 135.46it/s] 53%|█████▎    | 356/669 [00:02<00:02, 135.98it/s] 55%|█████▌    | 370/669 [00:02<00:02, 136.42it/s] 57%|█████▋    | 384/669 [00:03<00:02, 136.57it/s] 59%|█████▉    | 398/669 [00:03<00:01, 136.26it/s] 62%|██████▏   | 412/669 [00:03<00:01, 136.32it/s] 64%|██████▎   | 426/669 [00:03<00:01, 136.18it/s] 66%|██████▌   | 440/669 [00:03<00:01, 136.04it/s] 68%|██████▊   | 454/669 [00:03<00:01, 136.04it/s] 70%|██████▉   | 468/669 [00:03<00:01, 136.24it/s] 72%|███████▏  | 482/669 [00:03<00:01, 136.21it/s] 74%|███████▍  | 496/669 [00:03<00:01, 136.04it/s] 76%|███████▌  | 510/669 [00:04<00:01, 136.20it/s] 78%|███████▊  | 524/669 [00:04<00:01, 136.20it/s] 80%|████████  | 538/669 [00:04<00:00, 136.05it/s] 83%|████████▎ | 552/669 [00:04<00:00, 135.88it/s] 85%|████████▍ | 566/669 [00:04<00:00, 136.02it/s] 87%|████████▋ | 580/669 [00:04<00:00, 135.85it/s] 89%|████████▉ | 594/669 [00:04<00:00, 135.81it/s] 91%|█████████ | 608/669 [00:04<00:00, 135.92it/s] 93%|█████████▎| 622/669 [00:04<00:00, 135.93it/s] 95%|█████████▌| 636/669 [00:04<00:00, 135.81it/s] 97%|█████████▋| 650/669 [00:05<00:00, 135.79it/s] 99%|█████████▉| 664/669 [00:05<00:00, 133.70it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.38it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 90.36it/s][A
 32%|███▏      | 54/168 [00:00<00:00, 195.16it/s][A
 54%|█████▎    | 90/168 [00:00<00:00, 254.41it/s][A
 75%|███████▌  | 126/168 [00:00<00:00, 289.89it/s][A
 96%|█████████▌| 161/168 [00:00<00:00, 308.75it/s][A100%|██████████| 168/168 [00:00<00:00, 235.65it/s]
2022-10-22 07:07:20,908 P36148 INFO [Metrics] logloss: 0.550309 - AUC: 0.722194
2022-10-22 07:07:20,908 P36148 INFO Save best model: monitor(max): 0.171885
2022-10-22 07:07:21,036 P36148 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 107.67it/s]
2022-10-22 07:07:21,084 P36148 INFO Train loss: 0.625530
2022-10-22 07:07:21,084 P36148 INFO ************ Epoch=3 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:50,  6.04it/s]  2%|▏         | 14/669 [00:00<00:10, 61.78it/s]  3%|▎         | 22/669 [00:00<00:10, 61.65it/s]  5%|▌         | 35/669 [00:00<00:07, 82.70it/s]  7%|▋         | 48/669 [00:00<00:06, 95.73it/s]  9%|▉         | 61/669 [00:00<00:05, 104.79it/s] 11%|█         | 74/669 [00:00<00:05, 111.17it/s] 13%|█▎        | 87/669 [00:00<00:05, 115.32it/s] 15%|█▍        | 100/669 [00:01<00:04, 118.60it/s] 17%|█▋        | 113/669 [00:01<00:04, 121.00it/s] 19%|█▉        | 126/669 [00:01<00:04, 122.42it/s] 21%|██        | 139/669 [00:01<00:04, 123.63it/s] 23%|██▎       | 152/669 [00:01<00:04, 124.65it/s] 25%|██▍       | 165/669 [00:01<00:04, 124.95it/s] 27%|██▋       | 178/669 [00:01<00:03, 125.36it/s] 29%|██▊       | 191/669 [00:01<00:03, 126.06it/s] 30%|███       | 204/669 [00:01<00:03, 125.96it/s] 32%|███▏      | 217/669 [00:01<00:03, 126.26it/s] 34%|███▍      | 230/669 [00:02<00:03, 126.51it/s] 36%|███▋      | 243/669 [00:02<00:03, 126.41it/s] 38%|███▊      | 256/669 [00:02<00:03, 126.72it/s] 40%|████      | 269/669 [00:02<00:03, 126.89it/s] 42%|████▏     | 282/669 [00:02<00:03, 126.44it/s] 44%|████▍     | 295/669 [00:02<00:02, 126.67it/s] 46%|████▌     | 308/669 [00:02<00:02, 126.74it/s] 48%|████▊     | 321/669 [00:02<00:02, 126.52it/s] 50%|████▉     | 334/669 [00:02<00:02, 126.74it/s] 52%|█████▏    | 347/669 [00:02<00:02, 126.93it/s] 54%|█████▍    | 360/669 [00:03<00:02, 126.77it/s] 56%|█████▌    | 373/669 [00:03<00:02, 126.95it/s] 58%|█████▊    | 386/669 [00:03<00:02, 127.04it/s] 60%|█████▉    | 399/669 [00:03<00:02, 126.79it/s] 62%|██████▏   | 412/669 [00:03<00:02, 126.79it/s] 64%|██████▎   | 425/669 [00:03<00:01, 126.88it/s] 65%|██████▌   | 438/669 [00:03<00:01, 126.66it/s] 67%|██████▋   | 451/669 [00:03<00:01, 126.92it/s] 69%|██████▉   | 464/669 [00:03<00:01, 127.00it/s] 71%|███████▏  | 477/669 [00:04<00:01, 126.76it/s] 73%|███████▎  | 490/669 [00:04<00:01, 126.73it/s] 75%|███████▌  | 503/669 [00:04<00:01, 126.98it/s] 77%|███████▋  | 516/669 [00:04<00:01, 126.65it/s] 79%|███████▉  | 529/669 [00:04<00:01, 126.81it/s] 81%|████████  | 542/669 [00:04<00:01, 126.91it/s] 83%|████████▎ | 555/669 [00:04<00:00, 126.66it/s] 85%|████████▍ | 568/669 [00:04<00:00, 126.79it/s] 87%|████████▋ | 581/669 [00:04<00:00, 127.05it/s] 89%|████████▉ | 594/669 [00:04<00:00, 126.55it/s] 91%|█████████ | 607/669 [00:05<00:00, 126.40it/s] 93%|█████████▎| 620/669 [00:05<00:00, 126.75it/s] 95%|█████████▍| 633/669 [00:05<00:00, 126.50it/s] 97%|█████████▋| 646/669 [00:05<00:00, 126.40it/s] 99%|█████████▊| 659/669 [00:05<00:00, 126.10it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.39it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 92.11it/s][A
 32%|███▏      | 54/168 [00:00<00:00, 197.45it/s][A
 54%|█████▎    | 90/168 [00:00<00:00, 255.01it/s][A
 75%|███████▌  | 126/168 [00:00<00:00, 289.32it/s][A
 96%|█████████▋| 162/168 [00:00<00:00, 311.21it/s][A100%|██████████| 168/168 [00:00<00:00, 235.09it/s]
2022-10-22 07:07:27,466 P36148 INFO [Metrics] logloss: 0.550397 - AUC: 0.722125
2022-10-22 07:07:27,466 P36148 INFO Monitor(max) STOP: 0.171727 !
2022-10-22 07:07:27,466 P36148 INFO Reduce learning rate on plateau: 0.000100
2022-10-22 07:07:27,466 P36148 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 103.79it/s]
2022-10-22 07:07:27,531 P36148 INFO Train loss: 0.623045
2022-10-22 07:07:27,531 P36148 INFO ************ Epoch=4 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:55,  5.79it/s]  2%|▏         | 14/669 [00:00<00:10, 61.54it/s]  3%|▎         | 22/669 [00:00<00:10, 62.43it/s]  5%|▌         | 36/669 [00:00<00:07, 86.33it/s]  7%|▋         | 50/669 [00:00<00:06, 100.97it/s] 10%|▉         | 64/669 [00:00<00:05, 110.99it/s] 12%|█▏        | 78/669 [00:00<00:05, 117.76it/s] 14%|█▍        | 92/669 [00:00<00:04, 123.22it/s] 16%|█▌        | 106/669 [00:01<00:04, 127.39it/s] 18%|█▊        | 120/669 [00:01<00:04, 130.18it/s] 20%|██        | 134/669 [00:01<00:04, 132.11it/s] 22%|██▏       | 148/669 [00:01<00:03, 133.78it/s] 24%|██▍       | 162/669 [00:01<00:03, 135.01it/s] 26%|██▋       | 176/669 [00:01<00:03, 135.63it/s] 28%|██▊       | 190/669 [00:01<00:03, 136.00it/s] 30%|███       | 204/669 [00:01<00:03, 136.86it/s] 33%|███▎      | 218/669 [00:01<00:03, 137.11it/s] 35%|███▍      | 232/669 [00:01<00:03, 137.12it/s] 37%|███▋      | 246/669 [00:02<00:03, 137.40it/s] 39%|███▉      | 260/669 [00:02<00:02, 137.33it/s] 41%|████      | 274/669 [00:02<00:02, 137.22it/s] 43%|████▎     | 288/669 [00:02<00:02, 137.18it/s] 45%|████▌     | 302/669 [00:02<00:02, 137.39it/s] 47%|████▋     | 316/669 [00:02<00:02, 137.16it/s] 49%|████▉     | 330/669 [00:02<00:02, 137.10it/s] 51%|█████▏    | 344/669 [00:02<00:02, 137.50it/s] 54%|█████▎    | 358/669 [00:02<00:02, 137.48it/s] 56%|█████▌    | 372/669 [00:02<00:02, 137.83it/s] 58%|█████▊    | 386/669 [00:03<00:02, 137.65it/s] 60%|█████▉    | 400/669 [00:03<00:01, 137.86it/s] 62%|██████▏   | 414/669 [00:03<00:01, 137.66it/s] 64%|██████▍   | 428/669 [00:03<00:01, 137.46it/s] 66%|██████▌   | 442/669 [00:03<00:01, 137.58it/s] 68%|██████▊   | 456/669 [00:03<00:01, 137.42it/s] 70%|███████   | 470/669 [00:03<00:01, 137.15it/s] 72%|███████▏  | 484/669 [00:03<00:01, 137.15it/s] 74%|███████▍  | 498/669 [00:03<00:01, 137.25it/s] 77%|███████▋  | 512/669 [00:03<00:01, 137.29it/s] 79%|███████▊  | 526/669 [00:04<00:01, 137.22it/s] 81%|████████  | 540/669 [00:04<00:00, 137.36it/s] 83%|████████▎ | 554/669 [00:04<00:00, 137.19it/s] 85%|████████▍ | 568/669 [00:04<00:00, 137.02it/s] 87%|████████▋ | 582/669 [00:04<00:00, 137.30it/s] 89%|████████▉ | 596/669 [00:04<00:00, 137.47it/s] 91%|█████████ | 610/669 [00:04<00:00, 137.39it/s] 93%|█████████▎| 624/669 [00:04<00:00, 137.26it/s] 95%|█████████▌| 638/669 [00:04<00:00, 137.53it/s] 97%|█████████▋| 652/669 [00:05<00:00, 137.51it/s]100%|█████████▉| 666/669 [00:05<00:00, 134.93it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.60it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 92.37it/s][A
 33%|███▎      | 55/168 [00:00<00:00, 201.60it/s][A
 54%|█████▍    | 91/168 [00:00<00:00, 259.07it/s][A
 76%|███████▌  | 127/168 [00:00<00:00, 293.79it/s][A
 98%|█████████▊| 164/168 [00:00<00:00, 316.53it/s][A100%|██████████| 168/168 [00:00<00:00, 243.62it/s]
2022-10-22 07:07:33,494 P36148 INFO [Metrics] logloss: 0.540558 - AUC: 0.737747
2022-10-22 07:07:33,494 P36148 INFO Save best model: monitor(max): 0.197189
2022-10-22 07:07:33,614 P36148 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 109.18it/s]
2022-10-22 07:07:33,660 P36148 INFO Train loss: 0.551027
2022-10-22 07:07:33,660 P36148 INFO ************ Epoch=5 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:50,  6.02it/s]  2%|▏         | 14/669 [00:00<00:10, 62.52it/s]  3%|▎         | 22/669 [00:00<00:10, 62.71it/s]  5%|▌         | 35/669 [00:00<00:07, 85.09it/s]  7%|▋         | 48/669 [00:00<00:06, 99.00it/s]  9%|▉         | 61/669 [00:00<00:05, 108.10it/s] 11%|█         | 74/669 [00:00<00:05, 114.85it/s] 13%|█▎        | 88/669 [00:00<00:04, 119.81it/s] 15%|█▌        | 102/669 [00:01<00:04, 123.48it/s] 17%|█▋        | 116/669 [00:01<00:04, 126.15it/s] 19%|█▉        | 130/669 [00:01<00:04, 128.19it/s] 22%|██▏       | 144/669 [00:01<00:04, 129.44it/s] 24%|██▎       | 158/669 [00:01<00:03, 130.35it/s] 26%|██▌       | 172/669 [00:01<00:03, 131.05it/s] 28%|██▊       | 186/669 [00:01<00:03, 131.54it/s] 30%|██▉       | 200/669 [00:01<00:03, 131.88it/s] 32%|███▏      | 214/669 [00:01<00:03, 132.03it/s] 34%|███▍      | 228/669 [00:01<00:03, 132.30it/s] 36%|███▌      | 242/669 [00:02<00:03, 132.48it/s] 38%|███▊      | 256/669 [00:02<00:03, 132.70it/s] 40%|████      | 270/669 [00:02<00:03, 132.75it/s] 42%|████▏     | 284/669 [00:02<00:02, 132.71it/s] 45%|████▍     | 298/669 [00:02<00:02, 132.81it/s] 47%|████▋     | 312/669 [00:02<00:02, 132.86it/s] 49%|████▊     | 326/669 [00:02<00:02, 133.00it/s] 51%|█████     | 340/669 [00:02<00:02, 132.83it/s] 53%|█████▎    | 354/669 [00:02<00:02, 132.45it/s] 55%|█████▌    | 368/669 [00:03<00:02, 132.54it/s] 57%|█████▋    | 382/669 [00:03<00:02, 132.63it/s] 59%|█████▉    | 396/669 [00:03<00:02, 132.68it/s] 61%|██████▏   | 410/669 [00:03<00:01, 132.63it/s] 63%|██████▎   | 424/669 [00:03<00:01, 132.89it/s] 65%|██████▌   | 438/669 [00:03<00:01, 132.89it/s] 68%|██████▊   | 452/669 [00:03<00:01, 132.88it/s] 70%|██████▉   | 466/669 [00:03<00:01, 132.78it/s] 72%|███████▏  | 480/669 [00:03<00:01, 132.95it/s] 74%|███████▍  | 494/669 [00:03<00:01, 132.99it/s] 76%|███████▌  | 508/669 [00:04<00:01, 133.06it/s] 78%|███████▊  | 522/669 [00:04<00:01, 133.03it/s] 80%|████████  | 536/669 [00:04<00:00, 133.01it/s] 82%|████████▏ | 550/669 [00:04<00:00, 132.99it/s] 84%|████████▍ | 564/669 [00:04<00:00, 133.02it/s] 86%|████████▋ | 578/669 [00:04<00:00, 132.89it/s] 88%|████████▊ | 592/669 [00:04<00:00, 132.84it/s] 91%|█████████ | 606/669 [00:04<00:00, 132.96it/s] 93%|█████████▎| 620/669 [00:04<00:00, 132.78it/s] 95%|█████████▍| 634/669 [00:05<00:00, 132.69it/s] 97%|█████████▋| 648/669 [00:05<00:00, 132.68it/s] 99%|█████████▉| 662/669 [00:05<00:00, 132.83it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:18,  9.18it/s][A
 11%|█▏        | 19/168 [00:00<00:01, 89.62it/s][A
 30%|██▉       | 50/168 [00:00<00:00, 177.69it/s][A
 49%|████▉     | 82/168 [00:00<00:00, 228.30it/s][A
 68%|██████▊   | 114/168 [00:00<00:00, 258.57it/s][A
 86%|████████▋ | 145/168 [00:00<00:00, 274.81it/s][A100%|██████████| 168/168 [00:00<00:00, 219.26it/s]
2022-10-22 07:07:39,854 P36148 INFO [Metrics] logloss: 0.547574 - AUC: 0.736128
2022-10-22 07:07:39,855 P36148 INFO Monitor(max) STOP: 0.188554 !
2022-10-22 07:07:39,855 P36148 INFO Reduce learning rate on plateau: 0.000010
2022-10-22 07:07:39,855 P36148 INFO --- 669/669 batches finished ---
100%|██████████| 669/669 [00:06<00:00, 107.22it/s]
2022-10-22 07:07:39,900 P36148 INFO Train loss: 0.505060
2022-10-22 07:07:39,900 P36148 INFO ************ Epoch=6 end ************
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:49,  6.07it/s]  2%|▏         | 15/669 [00:00<00:09, 65.96it/s]  3%|▎         | 23/669 [00:00<00:09, 65.06it/s]  5%|▌         | 36/669 [00:00<00:07, 86.67it/s]  7%|▋         | 50/669 [00:00<00:06, 101.62it/s] 10%|▉         | 64/669 [00:00<00:05, 111.03it/s] 12%|█▏        | 78/669 [00:00<00:04, 118.55it/s] 14%|█▍        | 92/669 [00:00<00:04, 122.39it/s] 16%|█▌        | 106/669 [00:01<00:04, 126.05it/s] 18%|█▊        | 120/669 [00:01<00:04, 129.40it/s] 20%|██        | 134/669 [00:01<00:04, 131.39it/s] 22%|██▏       | 148/669 [00:01<00:03, 133.08it/s] 24%|██▍       | 162/669 [00:01<00:03, 134.33it/s] 26%|██▋       | 176/669 [00:01<00:03, 135.31it/s] 28%|██▊       | 190/669 [00:01<00:03, 135.56it/s] 30%|███       | 204/669 [00:01<00:03, 136.02it/s] 33%|███▎      | 218/669 [00:01<00:03, 136.73it/s] 35%|███▍      | 232/669 [00:01<00:03, 136.73it/s] 37%|███▋      | 246/669 [00:02<00:03, 136.66it/s] 39%|███▉      | 260/669 [00:02<00:02, 136.94it/s] 41%|████      | 274/669 [00:02<00:02, 137.20it/s] 43%|████▎     | 288/669 [00:02<00:02, 137.18it/s] 45%|████▌     | 302/669 [00:02<00:02, 137.08it/s] 47%|████▋     | 316/669 [00:02<00:02, 137.18it/s] 49%|████▉     | 330/669 [00:02<00:02, 137.28it/s] 51%|█████▏    | 344/669 [00:02<00:02, 137.19it/s] 54%|█████▎    | 358/669 [00:02<00:02, 137.48it/s] 56%|█████▌    | 372/669 [00:02<00:02, 137.38it/s] 58%|█████▊    | 386/669 [00:03<00:02, 137.18it/s] 60%|█████▉    | 400/669 [00:03<00:01, 137.05it/s] 62%|██████▏   | 414/669 [00:03<00:01, 137.27it/s] 64%|██████▍   | 428/669 [00:03<00:01, 137.16it/s] 66%|██████▌   | 442/669 [00:03<00:01, 137.03it/s] 68%|██████▊   | 456/669 [00:03<00:01, 137.36it/s] 70%|███████   | 470/669 [00:03<00:01, 137.47it/s] 72%|███████▏  | 484/669 [00:03<00:01, 137.25it/s] 74%|███████▍  | 498/669 [00:03<00:01, 137.14it/s] 77%|███████▋  | 512/669 [00:03<00:01, 137.54it/s] 79%|███████▊  | 526/669 [00:04<00:01, 137.41it/s] 81%|████████  | 540/669 [00:04<00:00, 137.40it/s] 83%|████████▎ | 554/669 [00:04<00:00, 125.73it/s] 85%|████████▍ | 568/669 [00:04<00:00, 129.20it/s] 87%|████████▋ | 582/669 [00:04<00:00, 131.54it/s] 89%|████████▉ | 596/669 [00:04<00:00, 133.18it/s] 91%|█████████ | 610/669 [00:04<00:00, 134.72it/s] 93%|█████████▎| 624/669 [00:04<00:00, 135.14it/s] 95%|█████████▌| 638/669 [00:04<00:00, 135.86it/s] 97%|█████████▋| 652/669 [00:05<00:00, 136.69it/s]100%|█████████▉| 666/669 [00:05<00:00, 134.64it/s]
  0%|          | 0/168 [00:00<?, ?it/s][A
  1%|          | 1/168 [00:00<00:17,  9.32it/s][A
 10%|▉         | 16/168 [00:00<00:01, 80.07it/s][A
 30%|███       | 51/168 [00:00<00:00, 193.52it/s][A
 52%|█████▏    | 87/168 [00:00<00:00, 253.79it/s][A
 73%|███████▎  | 123/168 [00:00<00:00, 288.92it/s][A
 95%|█████████▍| 159/168 [00:00<00:00, 309.91it/s][A100%|██████████| 168/168 [00:00<00:00, 238.98it/s]
2022-10-22 07:07:45,907 P36148 INFO [Metrics] logloss: 0.580699 - AUC: 0.733062
2022-10-22 07:07:45,908 P36148 INFO Monitor(max) STOP: 0.152363 !
2022-10-22 07:07:45,908 P36148 INFO Reduce learning rate on plateau: 0.000001
2022-10-22 07:07:45,908 P36148 INFO Early stopping at epoch=7
2022-10-22 07:07:45,908 P36148 INFO --- 669/669 batches finished ---
100%|█████████▉| 668/669 [00:06<00:00, 110.40it/s]
2022-10-22 07:07:45,952 P36148 INFO Train loss: 0.432123
2022-10-22 07:07:45,952 P36148 INFO Training finished.
2022-10-22 07:07:45,952 P36148 INFO Load best model: /root/w210_proj/deepfm/models/yelp_no_feature_3d3ae056/DeepFM_yelp_no_feature_016_fbdc55c7.model
2022-10-22 07:07:46,040 P36148 INFO ****** Validation evaluation ******
  0%|          | 0/669 [00:00<?, ?it/s]  0%|          | 1/669 [00:00<01:55,  5.79it/s]  2%|▏         | 16/669 [00:00<00:10, 65.21it/s]  8%|▊         | 51/669 [00:00<00:03, 170.95it/s] 13%|█▎        | 86/669 [00:00<00:02, 232.78it/s] 18%|█▊        | 121/669 [00:00<00:02, 270.03it/s] 23%|██▎       | 156/669 [00:00<00:01, 294.88it/s] 29%|██▊       | 191/669 [00:00<00:01, 311.99it/s] 34%|███▍      | 226/669 [00:00<00:01, 323.46it/s] 39%|███▉      | 262/669 [00:00<00:01, 332.79it/s] 45%|████▍     | 298/669 [00:01<00:01, 338.21it/s] 50%|████▉     | 334/669 [00:01<00:00, 342.24it/s] 55%|█████▌    | 370/669 [00:01<00:00, 345.48it/s] 61%|██████    | 406/669 [00:01<00:00, 347.42it/s] 66%|██████▌   | 442/669 [00:01<00:00, 348.46it/s] 71%|███████▏  | 477/669 [00:01<00:00, 344.67it/s] 77%|███████▋  | 513/669 [00:01<00:00, 346.73it/s] 82%|████████▏ | 548/669 [00:01<00:00, 298.10it/s] 87%|████████▋ | 583/669 [00:01<00:00, 311.74it/s] 92%|█████████▏| 618/669 [00:02<00:00, 322.20it/s] 97%|█████████▋| 652/669 [00:02<00:00, 326.35it/s]100%|██████████| 669/669 [00:02<00:00, 293.08it/s]
2022-10-22 07:07:48,901 P36148 INFO [Metrics] logloss: 0.460563 - AUC: 0.832851
  0%|          | 0/168 [00:00<?, ?it/s]  1%|          | 1/168 [00:00<00:17,  9.68it/s] 10%|▉         | 16/168 [00:00<00:02, 73.59it/s] 29%|██▊       | 48/168 [00:00<00:00, 171.10it/s] 48%|████▊     | 80/168 [00:00<00:00, 224.10it/s] 67%|██████▋   | 112/168 [00:00<00:00, 256.41it/s] 86%|████████▋ | 145/168 [00:00<00:00, 277.73it/s]100%|██████████| 168/168 [00:00<00:00, 217.65it/s]
2022-10-22 07:07:49,813 P36148 INFO [Metrics] logloss: 0.540558 - AUC: 0.737747
2022-10-22 07:07:49,874 P36148 INFO ******** Test evaluation ********
2022-10-22 07:07:49,874 P36148 INFO Loading data...
2022-10-22 07:07:49,875 P36148 INFO Loading test data done.
